!function(t){function e(n){if(i[n])return i[n].exports;var o=i[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var i={};e.m=t,e.c=i,e.i=function(t){return t},e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=99)}([function(t,e,i){(function(n){var o,r;!function(s){var a="object"==typeof self&&self.self===self&&self||"object"==typeof n&&n.global===n&&n;o=[i(10),i(9),e],void 0!==(r=function(t,e,i){a.Backbone=s(a,i,t,e)}.apply(e,o))&&(t.exports=r)}(function(t,e,i,n){var o=t.Backbone,r=Array.prototype.slice;e.VERSION="1.3.3",e.$=n,e.noConflict=function(){return t.Backbone=o,this},e.emulateHTTP=!1,e.emulateJSON=!1;var s=function(t,e,n){switch(t){case 1:return function(){return i[e](this[n])};case 2:return function(t){return i[e](this[n],t)};case 3:return function(t,o){return i[e](this[n],l(t,this),o)};case 4:return function(t,o,r){return i[e](this[n],l(t,this),o,r)};default:return function(){var t=r.call(arguments);return t.unshift(this[n]),i[e].apply(i,t)}}},a=function(t,e,n){i.each(e,function(e,o){i[o]&&(t.prototype[o]=s(e,o,n))})},l=function(t,e){return i.isFunction(t)?t:i.isObject(t)&&!e._isModel(t)?c(t):i.isString(t)?function(e){return e.get(t)}:t},c=function(t){var e=i.matches(t);return function(t){return e(t.attributes)}},u=e.Events={},h=/\s+/,m=function(t,e,n,o,r){var s,a=0;if(n&&"object"==typeof n){void 0!==o&&"context"in r&&void 0===r.context&&(r.context=o);for(s=i.keys(n);a<s.length;a++)e=m(t,e,s[a],n[s[a]],r)}else if(n&&h.test(n))for(s=n.split(h);a<s.length;a++)e=t(e,s[a],o,r);else e=t(e,n,o,r);return e};u.on=function(t,e,i){return p(this,t,e,i)};var p=function(t,e,i,n,o){if(t._events=m(f,t._events||{},e,i,{context:n,ctx:t,listening:o}),o){(t._listeners||(t._listeners={}))[o.id]=o}return t};u.listenTo=function(t,e,n){if(!t)return this;var o=t._listenId||(t._listenId=i.uniqueId("l")),r=this._listeningTo||(this._listeningTo={}),s=r[o];if(!s){var a=this._listenId||(this._listenId=i.uniqueId("l"));s=r[o]={obj:t,objId:o,id:a,listeningTo:r,count:0}}return p(t,e,n,this,s),this};var f=function(t,e,i,n){if(i){var o=t[e]||(t[e]=[]),r=n.context,s=n.ctx,a=n.listening;a&&a.count++,o.push({callback:i,context:r,ctx:r||s,listening:a})}return t};u.off=function(t,e,i){return this._events?(this._events=m(_,this._events,t,e,{context:i,listeners:this._listeners}),this):this},u.stopListening=function(t,e,n){var o=this._listeningTo;if(!o)return this;for(var r=t?[t._listenId]:i.keys(o),s=0;s<r.length;s++){var a=o[r[s]];if(!a)break;a.obj.off(e,n,this)}return this};var _=function(t,e,n,o){if(t){var r,s=0,a=o.context,l=o.listeners;if(e||n||a){for(var c=e?[e]:i.keys(t);s<c.length;s++){e=c[s];var u=t[e];if(!u)break;for(var h=[],m=0;m<u.length;m++){var p=u[m];n&&n!==p.callback&&n!==p.callback._callback||a&&a!==p.context?h.push(p):(r=p.listening)&&0==--r.count&&(delete l[r.id],delete r.listeningTo[r.objId])}h.length?t[e]=h:delete t[e]}return t}for(var f=i.keys(l);s<f.length;s++)r=l[f[s]],delete l[r.id],delete r.listeningTo[r.objId]}};u.once=function(t,e,n){var o=m(y,{},t,e,i.bind(this.off,this));return"string"==typeof t&&null==n&&(e=void 0),this.on(o,e,n)},u.listenToOnce=function(t,e,n){var o=m(y,{},e,n,i.bind(this.stopListening,this,t));return this.listenTo(t,o)};var y=function(t,e,n,o){if(n){var r=t[e]=i.once(function(){o(e,r),n.apply(this,arguments)});r._callback=n}return t};u.trigger=function(t){if(!this._events)return this;for(var e=Math.max(0,arguments.length-1),i=Array(e),n=0;n<e;n++)i[n]=arguments[n+1];return m(d,this._events,t,void 0,i),this};var d=function(t,e,i,n){if(t){var o=t[e],r=t.all;o&&r&&(r=r.slice()),o&&v(o,n),r&&v(r,[e].concat(n))}return t},v=function(t,e){var i,n=-1,o=t.length,r=e[0],s=e[1],a=e[2];switch(e.length){case 0:for(;++n<o;)(i=t[n]).callback.call(i.ctx);return;case 1:for(;++n<o;)(i=t[n]).callback.call(i.ctx,r);return;case 2:for(;++n<o;)(i=t[n]).callback.call(i.ctx,r,s);return;case 3:for(;++n<o;)(i=t[n]).callback.call(i.ctx,r,s,a);return;default:for(;++n<o;)(i=t[n]).callback.apply(i.ctx,e);return}};u.bind=u.on,u.unbind=u.off,i.extend(e,u);var g=e.Model=function(t,e){var n=t||{};e||(e={}),this.cid=i.uniqueId(this.cidPrefix),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(n=this.parse(n,e)||{});var o=i.result(this,"defaults");n=i.defaults(i.extend({},o,n),o),this.set(n,e),this.changed={},this.initialize.apply(this,arguments)};i.extend(g.prototype,u,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",initialize:function(){},toJSON:function(t){return i.clone(this.attributes)},sync:function(){return e.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return i.escape(this.get(t))},has:function(t){return null!=this.get(t)},matches:function(t){return!!i.iteratee(t,this)(this.attributes)},set:function(t,e,n){if(null==t)return this;var o;if("object"==typeof t?(o=t,n=e):(o={})[t]=e,n||(n={}),!this._validate(o,n))return!1;var r=n.unset,s=n.silent,a=[],l=this._changing;this._changing=!0,l||(this._previousAttributes=i.clone(this.attributes),this.changed={});var c=this.attributes,u=this.changed,h=this._previousAttributes;for(var m in o)e=o[m],i.isEqual(c[m],e)||a.push(m),i.isEqual(h[m],e)?delete u[m]:u[m]=e,r?delete c[m]:c[m]=e;if(this.idAttribute in o&&(this.id=this.get(this.idAttribute)),!s){a.length&&(this._pending=n);for(var p=0;p<a.length;p++)this.trigger("change:"+a[p],this,c[a[p]],n)}if(l)return this;if(!s)for(;this._pending;)n=this._pending,this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,i.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var n in this.attributes)e[n]=void 0;return this.set(e,i.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!i.isEmpty(this.changed):i.has(this.changed,t)},changedAttributes:function(t){if(!t)return!!this.hasChanged()&&i.clone(this.changed);var e=this._changing?this._previousAttributes:this.attributes,n={};for(var o in t){var r=t[o];i.isEqual(e[o],r)||(n[o]=r)}return!!i.size(n)&&n},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return i.clone(this._previousAttributes)},fetch:function(t){t=i.extend({parse:!0},t);var e=this,n=t.success;return t.success=function(i){var o=t.parse?e.parse(i,t):i;if(!e.set(o,t))return!1;n&&n.call(t.context,e,i,t),e.trigger("sync",e,i,t)},P(this,t),this.sync("read",this,t)},save:function(t,e,n){var o;null==t||"object"==typeof t?(o=t,n=e):(o={})[t]=e,n=i.extend({validate:!0,parse:!0},n);var r=n.wait;if(o&&!r){if(!this.set(o,n))return!1}else if(!this._validate(o,n))return!1;var s=this,a=n.success,l=this.attributes;n.success=function(t){s.attributes=l;var e=n.parse?s.parse(t,n):t;if(r&&(e=i.extend({},o,e)),e&&!s.set(e,n))return!1;a&&a.call(n.context,s,t,n),s.trigger("sync",s,t,n)},P(this,n),o&&r&&(this.attributes=i.extend({},l,o));var c=this.isNew()?"create":n.patch?"patch":"update";"patch"!==c||n.attrs||(n.attrs=o);var u=this.sync(c,this,n);return this.attributes=l,u},destroy:function(t){t=t?i.clone(t):{};var e=this,n=t.success,o=t.wait,r=function(){e.stopListening(),e.trigger("destroy",e,e.collection,t)};t.success=function(i){o&&r(),n&&n.call(t.context,e,i,t),e.isNew()||e.trigger("sync",e,i,t)};var s=!1;return this.isNew()?i.defer(t.success):(P(this,t),s=this.sync("delete",this,t)),o||r(),s},url:function(){var t=i.result(this,"urlRoot")||i.result(this.collection,"url")||I();if(this.isNew())return t;var e=this.get(this.idAttribute);return t.replace(/[^\/]$/,"$&/")+encodeURIComponent(e)},parse:function(t,e){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(t){return this._validate({},i.extend({},t,{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=i.extend({},this.attributes,t);var n=this.validationError=this.validate(t,e)||null;return!n||(this.trigger("invalid",this,n,i.extend(e,{validationError:n})),!1)}}),a(g,{keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1},"attributes");var x=e.Collection=function(t,e){e||(e={}),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,i.extend({silent:!0},e))},b={add:!0,remove:!0,merge:!0},C={add:!0,remove:!1},S=function(t,e,i){i=Math.min(Math.max(i,0),t.length);var n,o=Array(t.length-i),r=e.length;for(n=0;n<o.length;n++)o[n]=t[n+i];for(n=0;n<r;n++)t[n+i]=e[n];for(n=0;n<o.length;n++)t[n+r+i]=o[n]};i.extend(x.prototype,u,{model:g,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return e.sync.apply(this,arguments)},add:function(t,e){return this.set(t,i.extend({merge:!1},e,C))},remove:function(t,e){e=i.extend({},e);var n=!i.isArray(t);t=n?[t]:t.slice();var o=this._removeModels(t,e);return!e.silent&&o.length&&(e.changes={added:[],merged:[],removed:o},this.trigger("update",this,e)),n?o[0]:o},set:function(t,e){if(null!=t){e=i.extend({},b,e),e.parse&&!this._isModel(t)&&(t=this.parse(t,e)||[]);var n=!i.isArray(t);t=n?[t]:t.slice();var o=e.at;null!=o&&(o=+o),o>this.length&&(o=this.length),o<0&&(o+=this.length+1);var r,s,a=[],l=[],c=[],u=[],h={},m=e.add,p=e.merge,f=e.remove,_=!1,y=this.comparator&&null==o&&!1!==e.sort,d=i.isString(this.comparator)?this.comparator:null;for(s=0;s<t.length;s++){r=t[s];var v=this.get(r);if(v){if(p&&r!==v){var g=this._isModel(r)?r.attributes:r;e.parse&&(g=v.parse(g,e)),v.set(g,e),c.push(v),y&&!_&&(_=v.hasChanged(d))}h[v.cid]||(h[v.cid]=!0,a.push(v)),t[s]=v}else m&&(r=t[s]=this._prepareModel(r,e))&&(l.push(r),this._addReference(r,e),h[r.cid]=!0,a.push(r))}if(f){for(s=0;s<this.length;s++)r=this.models[s],h[r.cid]||u.push(r);u.length&&this._removeModels(u,e)}var x=!1,C=!y&&m&&f;if(a.length&&C?(x=this.length!==a.length||i.some(this.models,function(t,e){return t!==a[e]}),this.models.length=0,S(this.models,a,0),this.length=this.models.length):l.length&&(y&&(_=!0),S(this.models,l,null==o?this.length:o),this.length=this.models.length),_&&this.sort({silent:!0}),!e.silent){for(s=0;s<l.length;s++)null!=o&&(e.index=o+s),r=l[s],r.trigger("add",r,this,e);(_||x)&&this.trigger("sort",this,e),(l.length||u.length||c.length)&&(e.changes={added:l,removed:u,merged:c},this.trigger("update",this,e))}return n?t[0]:t}},reset:function(t,e){e=e?i.clone(e):{};for(var n=0;n<this.models.length;n++)this._removeReference(this.models[n],e);return e.previousModels=this.models,this._reset(),t=this.add(t,i.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},push:function(t,e){return this.add(t,i.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t)},unshift:function(t,e){return this.add(t,i.extend({at:0},e))},shift:function(t){var e=this.at(0);return this.remove(e,t)},slice:function(){return r.apply(this.models,arguments)},get:function(t){if(null!=t)return this._byId[t]||this._byId[this.modelId(t.attributes||t)]||t.cid&&this._byId[t.cid]},has:function(t){return null!=this.get(t)},at:function(t){return t<0&&(t+=this.length),this.models[t]},where:function(t,e){return this[e?"find":"filter"](t)},findWhere:function(t){return this.where(t,!0)},sort:function(t){var e=this.comparator;if(!e)throw new Error("Cannot sort a set without a comparator");t||(t={});var n=e.length;return i.isFunction(e)&&(e=i.bind(e,this)),1===n||i.isString(e)?this.models=this.sortBy(e):this.models.sort(e),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return this.map(t+"")},fetch:function(t){t=i.extend({parse:!0},t);var e=t.success,n=this;return t.success=function(i){var o=t.reset?"reset":"set";n[o](i,t),e&&e.call(t.context,n,i,t),n.trigger("sync",n,i,t)},P(this,t),this.sync("read",this,t)},create:function(t,e){e=e?i.clone(e):{};var n=e.wait;if(!(t=this._prepareModel(t,e)))return!1;n||this.add(t,e);var o=this,r=e.success;return e.success=function(t,e,i){n&&o.add(t,i),r&&r.call(i.context,t,e,i)},t.save(null,e),t},parse:function(t,e){return t},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(t){return t[this.model.prototype.idAttribute||"id"]},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(this._isModel(t))return t.collection||(t.collection=this),t;e=e?i.clone(e):{},e.collection=this;var n=new this.model(t,e);return n.validationError?(this.trigger("invalid",this,n.validationError,e),!1):n},_removeModels:function(t,e){for(var i=[],n=0;n<t.length;n++){var o=this.get(t[n]);if(o){var r=this.indexOf(o);this.models.splice(r,1),this.length--,delete this._byId[o.cid];var s=this.modelId(o.attributes);null!=s&&delete this._byId[s],e.silent||(e.index=r,o.trigger("remove",o,this,e)),i.push(o),this._removeReference(o,e)}}return i},_isModel:function(t){return t instanceof g},_addReference:function(t,e){this._byId[t.cid]=t;var i=this.modelId(t.attributes);null!=i&&(this._byId[i]=t),t.on("all",this._onModelEvent,this)},_removeReference:function(t,e){delete this._byId[t.cid];var i=this.modelId(t.attributes);null!=i&&delete this._byId[i],this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,i,n){if(e){if(("add"===t||"remove"===t)&&i!==this)return;if("destroy"===t&&this.remove(e,n),"change"===t){var o=this.modelId(e.previousAttributes()),r=this.modelId(e.attributes);o!==r&&(null!=o&&delete this._byId[o],null!=r&&(this._byId[r]=e))}}this.trigger.apply(this,arguments)}}),a(x,{forEach:3,each:3,map:3,collect:3,reduce:0,foldl:0,inject:0,reduceRight:0,foldr:0,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:3,includes:3,contains:3,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3,groupBy:3,countBy:3,sortBy:3,indexBy:3,findIndex:3,findLastIndex:3},"models");var w=e.View=function(t){this.cid=i.uniqueId("view"),i.extend(this,i.pick(t,A)),this._ensureElement(),this.initialize.apply(this,arguments)},A=["model","collection","el","id","attributes","className","tagName","events"];i.extend(w.prototype,u,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(t){return this.undelegateEvents(),this._setElement(t),this.delegateEvents(),this},_setElement:function(t){this.$el=t instanceof e.$?t:e.$(t),this.el=this.$el[0]},delegateEvents:function(t){if(t||(t=i.result(this,"events")),!t)return this;this.undelegateEvents();for(var e in t){var n=t[e];if(i.isFunction(n)||(n=this[n]),n){var o=e.match(/^(\S+)\s*(.*)$/);this.delegate(o[1],o[2],i.bind(n,this))}}return this},delegate:function(t,e,i){return this.$el.on(t+".delegateEvents"+this.cid,e,i),this},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(t,e,i){return this.$el.off(t+".delegateEvents"+this.cid,e,i),this},_createElement:function(t){return document.createElement(t)},_ensureElement:function(){if(this.el)this.setElement(i.result(this,"el"));else{var t=i.extend({},i.result(this,"attributes"));this.id&&(t.id=i.result(this,"id")),this.className&&(t.class=i.result(this,"className")),this.setElement(this._createElement(i.result(this,"tagName"))),this._setAttributes(t)}},_setAttributes:function(t){this.$el.attr(t)}}),e.sync=function(t,n,o){var r=D[t];i.defaults(o||(o={}),{emulateHTTP:e.emulateHTTP,emulateJSON:e.emulateJSON});var s={type:r,dataType:"json"};if(o.url||(s.url=i.result(n,"url")||I()),null!=o.data||!n||"create"!==t&&"update"!==t&&"patch"!==t||(s.contentType="application/json",s.data=JSON.stringify(o.attrs||n.toJSON(o))),o.emulateJSON&&(s.contentType="application/x-www-form-urlencoded",s.data=s.data?{model:s.data}:{}),o.emulateHTTP&&("PUT"===r||"DELETE"===r||"PATCH"===r)){s.type="POST",o.emulateJSON&&(s.data._method=r);var a=o.beforeSend;o.beforeSend=function(t){if(t.setRequestHeader("X-HTTP-Method-Override",r),a)return a.apply(this,arguments)}}"GET"===s.type||o.emulateJSON||(s.processData=!1);var l=o.error;o.error=function(t,e,i){o.textStatus=e,o.errorThrown=i,l&&l.call(o.context,t,e,i)};var c=o.xhr=e.ajax(i.extend(s,o));return n.trigger("request",n,c,o),c};var D={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};e.ajax=function(){return e.$.ajax.apply(e.$,arguments)};var M=e.Router=function(t){t||(t={}),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)};i.extend(M.prototype,u,{initialize:function(){},route:function(t,n,o){i.isRegExp(t)||(t=this._routeToRegExp(t)),i.isFunction(n)&&(o=n,n=""),o||(o=this[n]);var r=this;return e.history.route(t,function(i){var s=r._extractParameters(t,i);!1!==r.execute(o,s,n)&&(r.trigger.apply(r,["route:"+n].concat(s)),r.trigger("route",n,s),e.history.trigger("route",r,n,s))}),this},execute:function(t,e,i){t&&t.apply(this,e)},navigate:function(t,i){return e.history.navigate(t,i),this},_bindRoutes:function(){if(this.routes){this.routes=i.result(this,"routes");for(var t,e=i.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace(/[\-{}\[\]+?.,\\\^$|#\s]/g,"\\$&").replace(/\((.*?)\)/g,"(?:$1)?").replace(/(\(\?)?:\w+/g,function(t,e){return e?t:"([^/?]+)"}).replace(/\*\w+/g,"([^?]*?)"),new RegExp("^"+t+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(t,e){var n=t.exec(e).slice(1);return i.map(n,function(t,e){return e===n.length-1?t||null:t?decodeURIComponent(t):null})}});var k=e.History=function(){this.handlers=[],this.checkUrl=i.bind(this.checkUrl,this),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)};k.started=!1,i.extend(k.prototype,u,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root&&!this.getSearch()},matchRoot:function(){return this.decodeFragment(this.location.pathname).slice(0,this.root.length-1)+"/"===this.root},decodeFragment:function(t){return decodeURI(t.replace(/%25/g,"%2525"))},getSearch:function(){var t=this.location.href.replace(/#.*/,"").match(/\?.+/);return t?t[0]:""},getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getPath:function(){var t=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return"/"===t.charAt(0)?t.slice(1):t},getFragment:function(t){return null==t&&(t=this._usePushState||!this._wantsHashChange?this.getPath():this.getHash()),t.replace(/^[#\/]|\s+$/g,"")},start:function(t){if(k.started)throw new Error("Backbone.history has already been started");if(k.started=!0,this.options=i.extend({root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._hasHashChange="onhashchange"in window&&(void 0===document.documentMode||document.documentMode>7),this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.history||!this.history.pushState),this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(/^\/+|\/+$/g,"/"),this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){var e=this.root.slice(0,-1)||"/";return this.location.replace(e+"#"+this.getPath()),!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1;var n=document.body,o=n.insertBefore(this.iframe,n.firstChild).contentWindow;o.document.open(),o.document.close(),o.location.hash="#"+this.fragment}var r=window.addEventListener||function(t,e){return attachEvent("on"+t,e)};if(this._usePushState?r("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?r("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),!this.options.silent)return this.loadUrl()},stop:function(){var t=window.removeEventListener||function(t,e){return detachEvent("on"+t,e)};this._usePushState?t("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&t("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),k.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(t){var e=this.getFragment();if(e===this.fragment&&this.iframe&&(e=this.getHash(this.iframe.contentWindow)),e===this.fragment)return!1;this.iframe&&this.navigate(e),this.loadUrl()},loadUrl:function(t){return!!this.matchRoot()&&(t=this.fragment=this.getFragment(t),i.some(this.handlers,function(e){if(e.route.test(t))return e.callback(t),!0}))},navigate:function(t,e){if(!k.started)return!1;e&&!0!==e||(e={trigger:!!e}),t=this.getFragment(t||"");var i=this.root;""!==t&&"?"!==t.charAt(0)||(i=i.slice(0,-1)||"/");var n=i+t;if(t=this.decodeFragment(t.replace(/#.*$/,"")),this.fragment!==t){if(this.fragment=t,this._usePushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);if(this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getHash(this.iframe.contentWindow)){var o=this.iframe.contentWindow;e.replace||(o.document.open(),o.document.close()),this._updateHash(o.location,t,e.replace)}}return e.trigger?this.loadUrl(t):void 0}},_updateHash:function(t,e,i){if(i){var n=t.href.replace(/(javascript:|#).*$/,"");t.replace(n+"#"+e)}else t.hash="#"+e}}),e.history=new k;var B=function(t,e){var n,o=this;return n=t&&i.has(t,"constructor")?t.constructor:function(){return o.apply(this,arguments)},i.extend(n,o,e),n.prototype=i.create(o.prototype,t),n.prototype.constructor=n,n.__super__=o.prototype,n};g.extend=x.extend=M.extend=w.extend=k.extend=B;var I=function(){throw new Error('A "url" property or function must be specified')},P=function(t,e){var i=e.error;e.error=function(n){i&&i.call(e.context,t,n,e),t.trigger("error",t,n,e)}};return e})}).call(e,i(8))},function(t,e,i){!function(e,i){t.exports=i()}(0,function(){return function(t){function e(n){if(i[n])return i[n].exports;var o=i[n]={exports:{},id:n,loaded:!1};return t[n].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){"use strict";function n(){var t=d();return t.compile=function(e,i){return u.compile(e,i,t)},t.precompile=function(e,i){return u.precompile(e,i,t)},t.AST=l.default,t.Compiler=u.Compiler,t.JavaScriptCompiler=m.default,t.Parser=c.parser,t.parse=c.parse,t}var o=i(1).default;e.__esModule=!0;var r=i(2),s=o(r),a=i(24),l=o(a),c=i(25),u=i(30),h=i(31),m=o(h),p=i(28),f=o(p),_=i(23),y=o(_),d=s.default.create,v=n();v.create=n,y.default(v),v.Visitor=f.default,v.default=v,e.default=v,t.exports=e.default},function(t,e){"use strict";e.default=function(t){return t&&t.__esModule?t:{default:t}},e.__esModule=!0},function(t,e,i){"use strict";function n(){var t=new a.HandlebarsEnvironment;return p.extend(t,a),t.SafeString=c.default,t.Exception=h.default,t.Utils=p,t.escapeExpression=p.escapeExpression,t.VM=_,t.template=function(e){return _.template(e,t)},t}var o=i(3).default,r=i(1).default;e.__esModule=!0;var s=i(4),a=o(s),l=i(21),c=r(l),u=i(6),h=r(u),m=i(5),p=o(m),f=i(22),_=o(f),y=i(23),d=r(y),v=n();v.create=n,d.default(v),v.default=v,e.default=v,t.exports=e.default},function(t,e){"use strict";e.default=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e},e.__esModule=!0},function(t,e,i){"use strict";function n(t,e,i){this.helpers=t||{},this.partials=e||{},this.decorators=i||{},l.registerDefaultHelpers(this),c.registerDefaultDecorators(this)}var o=i(1).default;e.__esModule=!0,e.HandlebarsEnvironment=n;var r=i(5),s=i(6),a=o(s),l=i(10),c=i(18),u=i(20),h=o(u);e.VERSION="4.0.5";e.COMPILER_REVISION=7;var m={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1",7:">= 4.0.0"};e.REVISION_CHANGES=m;var p="[object Object]";n.prototype={constructor:n,logger:h.default,log:h.default.log,registerHelper:function(t,e){if(r.toString.call(t)===p){if(e)throw new a.default("Arg not supported with multiple helpers");r.extend(this.helpers,t)}else this.helpers[t]=e},unregisterHelper:function(t){delete this.helpers[t]},registerPartial:function(t,e){if(r.toString.call(t)===p)r.extend(this.partials,t);else{if(void 0===e)throw new a.default('Attempting to register a partial called "'+t+'" as undefined');this.partials[t]=e}},unregisterPartial:function(t){delete this.partials[t]},registerDecorator:function(t,e){if(r.toString.call(t)===p){if(e)throw new a.default("Arg not supported with multiple decorators");r.extend(this.decorators,t)}else this.decorators[t]=e},unregisterDecorator:function(t){delete this.decorators[t]}};var f=h.default.log;e.log=f,e.createFrame=r.createFrame,e.logger=h.default},function(t,e){"use strict";function i(t){return u[t]}function n(t){for(var e=1;e<arguments.length;e++)for(var i in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],i)&&(t[i]=arguments[e][i]);return t}function o(t,e){for(var i=0,n=t.length;i<n;i++)if(t[i]===e)return i;return-1}function r(t){if("string"!=typeof t){if(t&&t.toHTML)return t.toHTML();if(null==t)return"";if(!t)return t+"";t=""+t}return m.test(t)?t.replace(h,i):t}function s(t){return!t&&0!==t||!(!_(t)||0!==t.length)}function a(t){var e=n({},t);return e._parent=t,e}function l(t,e){return t.path=e,t}function c(t,e){return(t?t+".":"")+e}e.__esModule=!0,e.extend=n,e.indexOf=o,e.escapeExpression=r,e.isEmpty=s,e.createFrame=a,e.blockParams=l,e.appendContextPath=c;var u={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;","=":"&#x3D;"},h=/[&<>"'`=]/g,m=/[&<>"'`=]/,p=Object.prototype.toString;e.toString=p;var f=function(t){return"function"==typeof t};f(/x/)&&(e.isFunction=f=function(t){return"function"==typeof t&&"[object Function]"===p.call(t)}),e.isFunction=f;var _=Array.isArray||function(t){return!(!t||"object"!=typeof t)&&"[object Array]"===p.call(t)};e.isArray=_},function(t,e,i){"use strict";function n(t,e){var i=e&&e.loc,s=void 0,a=void 0;i&&(s=i.start.line,a=i.start.column,t+=" - "+s+":"+a);for(var l=Error.prototype.constructor.call(this,t),c=0;c<r.length;c++)this[r[c]]=l[r[c]];Error.captureStackTrace&&Error.captureStackTrace(this,n);try{i&&(this.lineNumber=s,o?Object.defineProperty(this,"column",{value:a}):this.column=a)}catch(t){}}var o=i(7).default;e.__esModule=!0;var r=["description","fileName","lineNumber","message","name","number","stack"];n.prototype=new Error,e.default=n,t.exports=e.default},function(t,e,i){t.exports={default:i(8),__esModule:!0}},function(t,e,i){var n=i(9);t.exports=function(t,e,i){return n.setDesc(t,e,i)}},function(t,e){var i=Object;t.exports={create:i.create,getProto:i.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:i.getOwnPropertyDescriptor,setDesc:i.defineProperty,setDescs:i.defineProperties,getKeys:i.keys,getNames:i.getOwnPropertyNames,getSymbols:i.getOwnPropertySymbols,each:[].forEach}},function(t,e,i){"use strict";function n(t){s.default(t),l.default(t),u.default(t),m.default(t),f.default(t),y.default(t),v.default(t)}var o=i(1).default;e.__esModule=!0,e.registerDefaultHelpers=n;var r=i(11),s=o(r),a=i(12),l=o(a),c=i(13),u=o(c),h=i(14),m=o(h),p=i(15),f=o(p),_=i(16),y=o(_),d=i(17),v=o(d)},function(t,e,i){"use strict";e.__esModule=!0;var n=i(5);e.default=function(t){t.registerHelper("blockHelperMissing",function(e,i){var o=i.inverse,r=i.fn;if(!0===e)return r(this);if(!1===e||null==e)return o(this);if(n.isArray(e))return e.length>0?(i.ids&&(i.ids=[i.name]),t.helpers.each(e,i)):o(this);if(i.data&&i.ids){var s=n.createFrame(i.data);s.contextPath=n.appendContextPath(i.data.contextPath,i.name),i={data:s}}return r(e,i)})},t.exports=e.default},function(t,e,i){"use strict";var n=i(1).default;e.__esModule=!0;var o=i(5),r=i(6),s=n(r);e.default=function(t){t.registerHelper("each",function(t,e){function i(e,i,r){c&&(c.key=e,c.index=i,c.first=0===i,c.last=!!r,u&&(c.contextPath=u+e)),l+=n(t[e],{data:c,blockParams:o.blockParams([t[e],e],[u+e,null])})}if(!e)throw new s.default("Must pass iterator to #each");var n=e.fn,r=e.inverse,a=0,l="",c=void 0,u=void 0;if(e.data&&e.ids&&(u=o.appendContextPath(e.data.contextPath,e.ids[0])+"."),o.isFunction(t)&&(t=t.call(this)),e.data&&(c=o.createFrame(e.data)),t&&"object"==typeof t)if(o.isArray(t))for(var h=t.length;a<h;a++)a in t&&i(a,a,a===t.length-1);else{var m=void 0;for(var p in t)t.hasOwnProperty(p)&&(void 0!==m&&i(m,a-1),m=p,a++);void 0!==m&&i(m,a-1,!0)}return 0===a&&(l=r(this)),l})},t.exports=e.default},function(t,e,i){"use strict";var n=i(1).default;e.__esModule=!0;var o=i(6),r=n(o);e.default=function(t){t.registerHelper("helperMissing",function(){if(1!==arguments.length)throw new r.default('Missing helper: "'+arguments[arguments.length-1].name+'"')})},t.exports=e.default},function(t,e,i){"use strict";e.__esModule=!0;var n=i(5);e.default=function(t){t.registerHelper("if",function(t,e){return n.isFunction(t)&&(t=t.call(this)),!e.hash.includeZero&&!t||n.isEmpty(t)?e.inverse(this):e.fn(this)}),t.registerHelper("unless",function(e,i){return t.helpers.if.call(this,e,{fn:i.inverse,inverse:i.fn,hash:i.hash})})},t.exports=e.default},function(t,e){"use strict";e.__esModule=!0,e.default=function(t){t.registerHelper("log",function(){for(var e=[void 0],i=arguments[arguments.length-1],n=0;n<arguments.length-1;n++)e.push(arguments[n]);var o=1;null!=i.hash.level?o=i.hash.level:i.data&&null!=i.data.level&&(o=i.data.level),e[0]=o,t.log.apply(t,e)})},t.exports=e.default},function(t,e){"use strict";e.__esModule=!0,e.default=function(t){t.registerHelper("lookup",function(t,e){return t&&t[e]})},t.exports=e.default},function(t,e,i){"use strict";e.__esModule=!0;var n=i(5);e.default=function(t){t.registerHelper("with",function(t,e){n.isFunction(t)&&(t=t.call(this));var i=e.fn;if(n.isEmpty(t))return e.inverse(this);var o=e.data;return e.data&&e.ids&&(o=n.createFrame(e.data),o.contextPath=n.appendContextPath(e.data.contextPath,e.ids[0])),i(t,{data:o,blockParams:n.blockParams([t],[o&&o.contextPath])})})},t.exports=e.default},function(t,e,i){"use strict";function n(t){s.default(t)}var o=i(1).default;e.__esModule=!0,e.registerDefaultDecorators=n;var r=i(19),s=o(r)},function(t,e,i){"use strict";e.__esModule=!0;var n=i(5);e.default=function(t){t.registerDecorator("inline",function(t,e,i,o){var r=t;return e.partials||(e.partials={},r=function(o,r){var s=i.partials;i.partials=n.extend({},s,e.partials);var a=t(o,r);return i.partials=s,a}),e.partials[o.args[0]]=o.fn,r})},t.exports=e.default},function(t,e,i){"use strict";e.__esModule=!0;var n=i(5),o={methodMap:["debug","info","warn","error"],level:"info",lookupLevel:function(t){if("string"==typeof t){var e=n.indexOf(o.methodMap,t.toLowerCase());t=e>=0?e:parseInt(t,10)}return t},log:function(t){if(t=o.lookupLevel(t),"undefined"!=typeof console&&o.lookupLevel(o.level)<=t){var e=o.methodMap[t];console[e]||(e="log");for(var i=arguments.length,n=Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];console[e].apply(console,n)}}};e.default=o,t.exports=e.default},function(t,e){"use strict";function i(t){this.string=t}e.__esModule=!0,i.prototype.toString=i.prototype.toHTML=function(){return""+this.string},e.default=i,t.exports=e.default},function(t,e,i){"use strict";function n(t){var e=t&&t[0]||1,i=d.COMPILER_REVISION;if(e!==i){if(e<i){var n=d.REVISION_CHANGES[i],o=d.REVISION_CHANGES[e];throw new y.default("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+n+") or downgrade your runtime to an older version ("+o+").")}throw new y.default("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+t[1]+").")}}function o(t,e){function i(i,n,o){o.hash&&(n=f.extend({},n,o.hash),o.ids&&(o.ids[0]=!0)),i=e.VM.resolvePartial.call(this,i,n,o);var r=e.VM.invokePartial.call(this,i,n,o);if(null==r&&e.compile&&(o.partials[o.name]=e.compile(i,t.compilerOptions,e),r=o.partials[o.name](n,o)),null!=r){if(o.indent){for(var s=r.split("\n"),a=0,l=s.length;a<l&&(s[a]||a+1!==l);a++)s[a]=o.indent+s[a];r=s.join("\n")}return r}throw new y.default("The partial "+o.name+" could not be compiled when running in runtime-only mode")}function n(e){function i(e){return""+t.main(o,e,o.helpers,o.partials,s,l,a)}var r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],s=r.data;n._setup(r),!r.partial&&t.useData&&(s=c(e,s));var a=void 0,l=t.useBlockParams?[]:void 0;return t.useDepths&&(a=r.depths?e!=r.depths[0]?[e].concat(r.depths):r.depths:[e]),(i=u(t.main,i,o,r.depths||[],s,l))(e,r)}if(!e)throw new y.default("No environment passed to template");if(!t||!t.main)throw new y.default("Unknown template object: "+typeof t);t.main.decorator=t.main_d,e.VM.checkRevision(t.compiler);var o={strict:function(t,e){if(!(e in t))throw new y.default('"'+e+'" not defined in '+t);return t[e]},lookup:function(t,e){for(var i=t.length,n=0;n<i;n++)if(t[n]&&null!=t[n][e])return t[n][e]},lambda:function(t,e){return"function"==typeof t?t.call(e):t},escapeExpression:f.escapeExpression,invokePartial:i,fn:function(e){var i=t[e];return i.decorator=t[e+"_d"],i},programs:[],program:function(t,e,i,n,o){var s=this.programs[t],a=this.fn(t);return e||o||n||i?s=r(this,t,a,e,i,n,o):s||(s=this.programs[t]=r(this,t,a)),s},data:function(t,e){for(;t&&e--;)t=t._parent;return t},merge:function(t,e){var i=t||e;return t&&e&&t!==e&&(i=f.extend({},e,t)),i},noop:e.VM.noop,compilerInfo:t.compiler};return n.isTop=!0,n._setup=function(i){i.partial?(o.helpers=i.helpers,o.partials=i.partials,o.decorators=i.decorators):(o.helpers=o.merge(i.helpers,e.helpers),t.usePartial&&(o.partials=o.merge(i.partials,e.partials)),(t.usePartial||t.useDecorators)&&(o.decorators=o.merge(i.decorators,e.decorators)))},n._child=function(e,i,n,s){if(t.useBlockParams&&!n)throw new y.default("must pass block params");if(t.useDepths&&!s)throw new y.default("must pass parent depths");return r(o,e,t[e],i,0,n,s)},n}function r(t,e,i,n,o,r,s){function a(e){var o=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],a=s;return s&&e!=s[0]&&(a=[e].concat(s)),i(t,e,t.helpers,t.partials,o.data||n,r&&[o.blockParams].concat(r),a)}return a=u(i,a,t,s,n,r),a.program=e,a.depth=s?s.length:0,a.blockParams=o||0,a}function s(t,e,i){if(t)t.call||i.name||(i.name=t,t=i.partials[t]);else if("@partial-block"===i.name){for(var n=i.data;n["partial-block"]===l;)n=n._parent;t=n["partial-block"],n["partial-block"]=l}else t=i.partials[i.name];return t}function a(t,e,i){i.partial=!0,i.ids&&(i.data.contextPath=i.ids[0]||i.data.contextPath);var n=void 0;if(i.fn&&i.fn!==l&&(i.data=d.createFrame(i.data),n=i.data["partial-block"]=i.fn,n.partials&&(i.partials=f.extend({},i.partials,n.partials))),void 0===t&&n&&(t=n),void 0===t)throw new y.default("The partial "+i.name+" could not be found");if(t instanceof Function)return t(e,i)}function l(){return""}function c(t,e){return e&&"root"in e||(e=e?d.createFrame(e):{},e.root=t),e}function u(t,e,i,n,o,r){if(t.decorator){var s={};e=t.decorator(e,s,i,n&&n[0],o,r,n),f.extend(e,s)}return e}var h=i(3).default,m=i(1).default;e.__esModule=!0,e.checkRevision=n,e.template=o,e.wrapProgram=r,e.resolvePartial=s,e.invokePartial=a,e.noop=l;var p=i(5),f=h(p),_=i(6),y=m(_),d=i(4)},function(t,e){(function(i){"use strict";e.__esModule=!0,e.default=function(t){var e=void 0!==i?i:window,n=e.Handlebars;t.noConflict=function(){return e.Handlebars===t&&(e.Handlebars=n),t}},t.exports=e.default}).call(e,function(){return this}())},function(t,e){"use strict";e.__esModule=!0;var i={helpers:{helperExpression:function(t){return"SubExpression"===t.type||("MustacheStatement"===t.type||"BlockStatement"===t.type)&&!!(t.params&&t.params.length||t.hash)},scopedId:function(t){return/^\.|this\b/.test(t.original)},simpleId:function(t){return 1===t.parts.length&&!i.helpers.scopedId(t)&&!t.depth}}};e.default=i,t.exports=e.default},function(t,e,i){"use strict";function n(t,e){return"Program"===t.type?t:(a.default.yy=p,p.locInfo=function(t){return new p.SourceLocation(e&&e.srcName,t)},new c.default(e).accept(a.default.parse(t)))}var o=i(1).default,r=i(3).default;e.__esModule=!0,e.parse=n;var s=i(26),a=o(s),l=i(27),c=o(l),u=i(29),h=r(u),m=i(5);e.parser=a.default;var p={};m.extend(p,h)},function(t,e){"use strict";var i=function(){function t(){this.yy={}}var e={trace:function(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,program_repetition0:6,statement:7,mustache:8,block:9,rawBlock:10,partial:11,partialBlock:12,content:13,COMMENT:14,CONTENT:15,openRawBlock:16,rawBlock_repetition_plus0:17,END_RAW_BLOCK:18,OPEN_RAW_BLOCK:19,helperName:20,openRawBlock_repetition0:21,openRawBlock_option0:22,CLOSE_RAW_BLOCK:23,openBlock:24,block_option0:25,closeBlock:26,openInverse:27,block_option1:28,OPEN_BLOCK:29,openBlock_repetition0:30,openBlock_option0:31,openBlock_option1:32,CLOSE:33,OPEN_INVERSE:34,openInverse_repetition0:35,openInverse_option0:36,openInverse_option1:37,openInverseChain:38,OPEN_INVERSE_CHAIN:39,openInverseChain_repetition0:40,openInverseChain_option0:41,openInverseChain_option1:42,inverseAndProgram:43,INVERSE:44,inverseChain:45,inverseChain_option0:46,OPEN_ENDBLOCK:47,OPEN:48,mustache_repetition0:49,mustache_option0:50,OPEN_UNESCAPED:51,mustache_repetition1:52,mustache_option1:53,CLOSE_UNESCAPED:54,OPEN_PARTIAL:55,partialName:56,partial_repetition0:57,partial_option0:58,openPartialBlock:59,OPEN_PARTIAL_BLOCK:60,openPartialBlock_repetition0:61,openPartialBlock_option0:62,param:63,sexpr:64,OPEN_SEXPR:65,sexpr_repetition0:66,sexpr_option0:67,CLOSE_SEXPR:68,hash:69,hash_repetition_plus0:70,hashSegment:71,ID:72,EQUALS:73,blockParams:74,OPEN_BLOCK_PARAMS:75,blockParams_repetition_plus0:76,CLOSE_BLOCK_PARAMS:77,path:78,dataName:79,STRING:80,NUMBER:81,BOOLEAN:82,UNDEFINED:83,NULL:84,DATA:85,pathSegments:86,SEP:87,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",14:"COMMENT",15:"CONTENT",18:"END_RAW_BLOCK",19:"OPEN_RAW_BLOCK",23:"CLOSE_RAW_BLOCK",29:"OPEN_BLOCK",33:"CLOSE",34:"OPEN_INVERSE",39:"OPEN_INVERSE_CHAIN",44:"INVERSE",47:"OPEN_ENDBLOCK",48:"OPEN",51:"OPEN_UNESCAPED",54:"CLOSE_UNESCAPED",55:"OPEN_PARTIAL",60:"OPEN_PARTIAL_BLOCK",65:"OPEN_SEXPR",68:"CLOSE_SEXPR",72:"ID",73:"EQUALS",75:"OPEN_BLOCK_PARAMS",77:"CLOSE_BLOCK_PARAMS",80:"STRING",81:"NUMBER",82:"BOOLEAN",83:"UNDEFINED",84:"NULL",85:"DATA",87:"SEP"},productions_:[0,[3,2],[4,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[13,1],[10,3],[16,5],[9,4],[9,4],[24,6],[27,6],[38,6],[43,2],[45,3],[45,1],[26,3],[8,5],[8,5],[11,5],[12,3],[59,5],[63,1],[63,1],[64,5],[69,1],[71,3],[74,3],[20,1],[20,1],[20,1],[20,1],[20,1],[20,1],[20,1],[56,1],[56,1],[79,2],[78,1],[86,3],[86,1],[6,0],[6,2],[17,1],[17,2],[21,0],[21,2],[22,0],[22,1],[25,0],[25,1],[28,0],[28,1],[30,0],[30,2],[31,0],[31,1],[32,0],[32,1],[35,0],[35,2],[36,0],[36,1],[37,0],[37,1],[40,0],[40,2],[41,0],[41,1],[42,0],[42,1],[46,0],[46,1],[49,0],[49,2],[50,0],[50,1],[52,0],[52,2],[53,0],[53,1],[57,0],[57,2],[58,0],[58,1],[61,0],[61,2],[62,0],[62,1],[66,0],[66,2],[67,0],[67,1],[70,1],[70,2],[76,1],[76,2]],performAction:function(t,e,i,n,o,r,s){var a=r.length-1;switch(o){case 1:return r[a-1];case 2:this.$=n.prepareProgram(r[a]);break;case 3:case 4:case 5:case 6:case 7:case 8:this.$=r[a];break;case 9:this.$={type:"CommentStatement",value:n.stripComment(r[a]),strip:n.stripFlags(r[a],r[a]),loc:n.locInfo(this._$)};break;case 10:this.$={type:"ContentStatement",original:r[a],value:r[a],loc:n.locInfo(this._$)};break;case 11:this.$=n.prepareRawBlock(r[a-2],r[a-1],r[a],this._$);break;case 12:this.$={path:r[a-3],params:r[a-2],hash:r[a-1]};break;case 13:this.$=n.prepareBlock(r[a-3],r[a-2],r[a-1],r[a],!1,this._$);break;case 14:this.$=n.prepareBlock(r[a-3],r[a-2],r[a-1],r[a],!0,this._$);break;case 15:this.$={open:r[a-5],path:r[a-4],params:r[a-3],hash:r[a-2],blockParams:r[a-1],strip:n.stripFlags(r[a-5],r[a])};break;case 16:case 17:this.$={path:r[a-4],params:r[a-3],hash:r[a-2],blockParams:r[a-1],strip:n.stripFlags(r[a-5],r[a])};break;case 18:this.$={strip:n.stripFlags(r[a-1],r[a-1]),program:r[a]};break;case 19:var l=n.prepareBlock(r[a-2],r[a-1],r[a],r[a],!1,this._$),c=n.prepareProgram([l],r[a-1].loc);c.chained=!0,this.$={strip:r[a-2].strip,program:c,chain:!0};break;case 20:this.$=r[a];break;case 21:this.$={path:r[a-1],strip:n.stripFlags(r[a-2],r[a])};break;case 22:case 23:this.$=n.prepareMustache(r[a-3],r[a-2],r[a-1],r[a-4],n.stripFlags(r[a-4],r[a]),this._$);break;case 24:this.$={type:"PartialStatement",name:r[a-3],params:r[a-2],hash:r[a-1],indent:"",strip:n.stripFlags(r[a-4],r[a]),loc:n.locInfo(this._$)};break;case 25:this.$=n.preparePartialBlock(r[a-2],r[a-1],r[a],this._$);break;case 26:this.$={path:r[a-3],params:r[a-2],hash:r[a-1],strip:n.stripFlags(r[a-4],r[a])};break;case 27:case 28:this.$=r[a];break;case 29:this.$={type:"SubExpression",path:r[a-3],params:r[a-2],hash:r[a-1],loc:n.locInfo(this._$)};break;case 30:this.$={type:"Hash",pairs:r[a],loc:n.locInfo(this._$)};break;case 31:this.$={type:"HashPair",key:n.id(r[a-2]),value:r[a],loc:n.locInfo(this._$)};break;case 32:this.$=n.id(r[a-1]);break;case 33:case 34:this.$=r[a];break;case 35:this.$={type:"StringLiteral",value:r[a],original:r[a],loc:n.locInfo(this._$)};break;case 36:this.$={type:"NumberLiteral",value:Number(r[a]),original:Number(r[a]),loc:n.locInfo(this._$)};break;case 37:this.$={type:"BooleanLiteral",value:"true"===r[a],original:"true"===r[a],loc:n.locInfo(this._$)};break;case 38:this.$={type:"UndefinedLiteral",original:void 0,value:void 0,loc:n.locInfo(this._$)};break;case 39:this.$={type:"NullLiteral",original:null,value:null,loc:n.locInfo(this._$)};break;case 40:case 41:this.$=r[a];break;case 42:this.$=n.preparePath(!0,r[a],this._$);break;case 43:this.$=n.preparePath(!1,r[a],this._$);break;case 44:r[a-2].push({part:n.id(r[a]),original:r[a],separator:r[a-1]}),this.$=r[a-2];break;case 45:this.$=[{part:n.id(r[a]),original:r[a]}];break;case 46:this.$=[];break;case 47:r[a-1].push(r[a]);break;case 48:this.$=[r[a]];break;case 49:r[a-1].push(r[a]);break;case 50:this.$=[];break;case 51:r[a-1].push(r[a]);break;case 58:this.$=[];break;case 59:r[a-1].push(r[a]);break;case 64:this.$=[];break;case 65:r[a-1].push(r[a]);break;case 70:this.$=[];break;case 71:r[a-1].push(r[a]);break;case 78:this.$=[];break;case 79:r[a-1].push(r[a]);break;case 82:this.$=[];break;case 83:r[a-1].push(r[a]);break;case 86:this.$=[];break;case 87:r[a-1].push(r[a]);break;case 90:this.$=[];break;case 91:r[a-1].push(r[a]);break;case 94:this.$=[];break;case 95:r[a-1].push(r[a]);break;case 98:this.$=[r[a]];break;case 99:r[a-1].push(r[a]);break;case 100:this.$=[r[a]];break;case 101:r[a-1].push(r[a])}},table:[{3:1,4:2,5:[2,46],6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{1:[3]},{5:[1,4]},{5:[2,2],7:5,8:6,9:7,10:8,11:9,12:10,13:11,14:[1,12],15:[1,20],16:17,19:[1,23],24:15,27:16,29:[1,21],34:[1,22],39:[2,2],44:[2,2],47:[2,2],48:[1,13],51:[1,14],55:[1,18],59:19,60:[1,24]},{1:[2,1]},{5:[2,47],14:[2,47],15:[2,47],19:[2,47],29:[2,47],34:[2,47],39:[2,47],44:[2,47],47:[2,47],48:[2,47],51:[2,47],55:[2,47],60:[2,47]},{5:[2,3],14:[2,3],15:[2,3],19:[2,3],29:[2,3],34:[2,3],39:[2,3],44:[2,3],47:[2,3],48:[2,3],51:[2,3],55:[2,3],60:[2,3]},{5:[2,4],14:[2,4],15:[2,4],19:[2,4],29:[2,4],34:[2,4],39:[2,4],44:[2,4],47:[2,4],48:[2,4],51:[2,4],55:[2,4],60:[2,4]},{5:[2,5],14:[2,5],15:[2,5],19:[2,5],29:[2,5],34:[2,5],39:[2,5],44:[2,5],47:[2,5],48:[2,5],51:[2,5],55:[2,5],60:[2,5]},{5:[2,6],14:[2,6],15:[2,6],19:[2,6],29:[2,6],34:[2,6],39:[2,6],44:[2,6],47:[2,6],48:[2,6],51:[2,6],55:[2,6],60:[2,6]},{5:[2,7],14:[2,7],15:[2,7],19:[2,7],29:[2,7],34:[2,7],39:[2,7],44:[2,7],47:[2,7],48:[2,7],51:[2,7],55:[2,7],60:[2,7]},{5:[2,8],14:[2,8],15:[2,8],19:[2,8],29:[2,8],34:[2,8],39:[2,8],44:[2,8],47:[2,8],48:[2,8],51:[2,8],55:[2,8],60:[2,8]},{5:[2,9],14:[2,9],15:[2,9],19:[2,9],29:[2,9],34:[2,9],39:[2,9],44:[2,9],47:[2,9],48:[2,9],51:[2,9],55:[2,9],60:[2,9]},{20:25,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:36,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:37,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],39:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{4:38,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{13:40,15:[1,20],17:39},{20:42,56:41,64:43,65:[1,44],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:45,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{5:[2,10],14:[2,10],15:[2,10],18:[2,10],19:[2,10],29:[2,10],34:[2,10],39:[2,10],44:[2,10],47:[2,10],48:[2,10],51:[2,10],55:[2,10],60:[2,10]},{20:46,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:47,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:48,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:42,56:49,64:43,65:[1,44],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[2,78],49:50,65:[2,78],72:[2,78],80:[2,78],81:[2,78],82:[2,78],83:[2,78],84:[2,78],85:[2,78]},{23:[2,33],33:[2,33],54:[2,33],65:[2,33],68:[2,33],72:[2,33],75:[2,33],80:[2,33],81:[2,33],82:[2,33],83:[2,33],84:[2,33],85:[2,33]},{23:[2,34],33:[2,34],54:[2,34],65:[2,34],68:[2,34],72:[2,34],75:[2,34],80:[2,34],81:[2,34],82:[2,34],83:[2,34],84:[2,34],85:[2,34]},{23:[2,35],33:[2,35],54:[2,35],65:[2,35],68:[2,35],72:[2,35],75:[2,35],80:[2,35],81:[2,35],82:[2,35],83:[2,35],84:[2,35],85:[2,35]},{23:[2,36],33:[2,36],54:[2,36],65:[2,36],68:[2,36],72:[2,36],75:[2,36],80:[2,36],81:[2,36],82:[2,36],83:[2,36],84:[2,36],85:[2,36]},{23:[2,37],33:[2,37],54:[2,37],65:[2,37],68:[2,37],72:[2,37],75:[2,37],80:[2,37],81:[2,37],82:[2,37],83:[2,37],84:[2,37],85:[2,37]},{23:[2,38],33:[2,38],54:[2,38],65:[2,38],68:[2,38],72:[2,38],75:[2,38],80:[2,38],81:[2,38],82:[2,38],83:[2,38],84:[2,38],85:[2,38]},{23:[2,39],33:[2,39],54:[2,39],65:[2,39],68:[2,39],72:[2,39],75:[2,39],80:[2,39],81:[2,39],82:[2,39],83:[2,39],84:[2,39],85:[2,39]},{23:[2,43],33:[2,43],54:[2,43],65:[2,43],68:[2,43],72:[2,43],75:[2,43],80:[2,43],81:[2,43],82:[2,43],83:[2,43],84:[2,43],85:[2,43],87:[1,51]},{72:[1,35],86:52},{23:[2,45],33:[2,45],54:[2,45],65:[2,45],68:[2,45],72:[2,45],75:[2,45],80:[2,45],81:[2,45],82:[2,45],83:[2,45],84:[2,45],85:[2,45],87:[2,45]},{52:53,54:[2,82],65:[2,82],72:[2,82],80:[2,82],81:[2,82],82:[2,82],83:[2,82],84:[2,82],85:[2,82]},{25:54,38:56,39:[1,58],43:57,44:[1,59],45:55,47:[2,54]},{28:60,43:61,44:[1,59],47:[2,56]},{13:63,15:[1,20],18:[1,62]},{15:[2,48],18:[2,48]},{33:[2,86],57:64,65:[2,86],72:[2,86],80:[2,86],81:[2,86],82:[2,86],83:[2,86],84:[2,86],85:[2,86]},{33:[2,40],65:[2,40],72:[2,40],80:[2,40],81:[2,40],82:[2,40],83:[2,40],84:[2,40],85:[2,40]},{33:[2,41],65:[2,41],72:[2,41],80:[2,41],81:[2,41],82:[2,41],83:[2,41],84:[2,41],85:[2,41]},{20:65,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{26:66,47:[1,67]},{30:68,33:[2,58],65:[2,58],72:[2,58],75:[2,58],80:[2,58],81:[2,58],82:[2,58],83:[2,58],84:[2,58],85:[2,58]},{33:[2,64],35:69,65:[2,64],72:[2,64],75:[2,64],80:[2,64],81:[2,64],82:[2,64],83:[2,64],84:[2,64],85:[2,64]},{21:70,23:[2,50],65:[2,50],72:[2,50],80:[2,50],81:[2,50],82:[2,50],83:[2,50],84:[2,50],85:[2,50]},{33:[2,90],61:71,65:[2,90],72:[2,90],80:[2,90],81:[2,90],82:[2,90],83:[2,90],84:[2,90],85:[2,90]},{20:75,33:[2,80],50:72,63:73,64:76,65:[1,44],69:74,70:77,71:78,72:[1,79],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{72:[1,80]},{23:[2,42],33:[2,42],54:[2,42],65:[2,42],68:[2,42],72:[2,42],75:[2,42],80:[2,42],81:[2,42],82:[2,42],83:[2,42],84:[2,42],85:[2,42],87:[1,51]},{20:75,53:81,54:[2,84],63:82,64:76,65:[1,44],69:83,70:77,71:78,72:[1,79],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{26:84,47:[1,67]},{47:[2,55]},{4:85,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],39:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{47:[2,20]},{20:86,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:87,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{26:88,47:[1,67]},{47:[2,57]},{5:[2,11],14:[2,11],15:[2,11],19:[2,11],29:[2,11],34:[2,11],39:[2,11],44:[2,11],47:[2,11],48:[2,11],51:[2,11],55:[2,11],60:[2,11]},{15:[2,49],18:[2,49]},{20:75,33:[2,88],58:89,63:90,64:76,65:[1,44],69:91,70:77,71:78,72:[1,79],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{65:[2,94],66:92,68:[2,94],72:[2,94],80:[2,94],81:[2,94],82:[2,94],83:[2,94],84:[2,94],85:[2,94]},{5:[2,25],14:[2,25],15:[2,25],19:[2,25],29:[2,25],34:[2,25],39:[2,25],44:[2,25],47:[2,25],48:[2,25],51:[2,25],55:[2,25],60:[2,25]},{20:93,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:75,31:94,33:[2,60],63:95,64:76,65:[1,44],69:96,70:77,71:78,72:[1,79],75:[2,60],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:75,33:[2,66],36:97,63:98,64:76,65:[1,44],69:99,70:77,71:78,72:[1,79],75:[2,66],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:75,22:100,23:[2,52],63:101,64:76,65:[1,44],69:102,70:77,71:78,72:[1,79],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:75,33:[2,92],62:103,63:104,64:76,65:[1,44],69:105,70:77,71:78,72:[1,79],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[1,106]},{33:[2,79],65:[2,79],72:[2,79],80:[2,79],81:[2,79],82:[2,79],83:[2,79],84:[2,79],85:[2,79]},{33:[2,81]},{23:[2,27],33:[2,27],54:[2,27],65:[2,27],68:[2,27],72:[2,27],75:[2,27],80:[2,27],81:[2,27],82:[2,27],83:[2,27],84:[2,27],85:[2,27]},{23:[2,28],33:[2,28],54:[2,28],65:[2,28],68:[2,28],72:[2,28],75:[2,28],80:[2,28],81:[2,28],82:[2,28],83:[2,28],84:[2,28],85:[2,28]},{23:[2,30],33:[2,30],54:[2,30],68:[2,30],71:107,72:[1,108],75:[2,30]},{23:[2,98],33:[2,98],54:[2,98],68:[2,98],72:[2,98],75:[2,98]},{23:[2,45],33:[2,45],54:[2,45],65:[2,45],68:[2,45],72:[2,45],73:[1,109],75:[2,45],80:[2,45],81:[2,45],82:[2,45],83:[2,45],84:[2,45],85:[2,45],87:[2,45]},{23:[2,44],33:[2,44],54:[2,44],65:[2,44],68:[2,44],72:[2,44],75:[2,44],80:[2,44],81:[2,44],82:[2,44],83:[2,44],84:[2,44],85:[2,44],87:[2,44]},{54:[1,110]},{54:[2,83],65:[2,83],72:[2,83],80:[2,83],81:[2,83],82:[2,83],83:[2,83],84:[2,83],85:[2,83]},{54:[2,85]},{5:[2,13],14:[2,13],15:[2,13],19:[2,13],29:[2,13],34:[2,13],39:[2,13],44:[2,13],47:[2,13],48:[2,13],51:[2,13],55:[2,13],60:[2,13]},{38:56,39:[1,58],43:57,44:[1,59],45:112,46:111,47:[2,76]},{33:[2,70],40:113,65:[2,70],72:[2,70],75:[2,70],80:[2,70],81:[2,70],82:[2,70],83:[2,70],84:[2,70],85:[2,70]},{47:[2,18]},{5:[2,14],14:[2,14],15:[2,14],19:[2,14],29:[2,14],34:[2,14],39:[2,14],44:[2,14],47:[2,14],48:[2,14],51:[2,14],55:[2,14],60:[2,14]},{33:[1,114]},{33:[2,87],65:[2,87],72:[2,87],80:[2,87],81:[2,87],82:[2,87],83:[2,87],84:[2,87],85:[2,87]},{33:[2,89]},{20:75,63:116,64:76,65:[1,44],67:115,68:[2,96],69:117,70:77,71:78,72:[1,79],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[1,118]},{32:119,33:[2,62],74:120,75:[1,121]},{33:[2,59],65:[2,59],72:[2,59],75:[2,59],80:[2,59],81:[2,59],82:[2,59],83:[2,59],84:[2,59],85:[2,59]},{33:[2,61],75:[2,61]},{33:[2,68],37:122,74:123,75:[1,121]},{33:[2,65],65:[2,65],72:[2,65],75:[2,65],80:[2,65],81:[2,65],82:[2,65],83:[2,65],84:[2,65],85:[2,65]},{33:[2,67],75:[2,67]},{23:[1,124]},{23:[2,51],65:[2,51],72:[2,51],80:[2,51],81:[2,51],82:[2,51],83:[2,51],84:[2,51],85:[2,51]},{23:[2,53]},{33:[1,125]},{33:[2,91],65:[2,91],72:[2,91],80:[2,91],81:[2,91],82:[2,91],83:[2,91],84:[2,91],85:[2,91]},{33:[2,93]},{5:[2,22],14:[2,22],15:[2,22],19:[2,22],29:[2,22],34:[2,22],39:[2,22],44:[2,22],47:[2,22],48:[2,22],51:[2,22],55:[2,22],60:[2,22]},{23:[2,99],33:[2,99],54:[2,99],68:[2,99],72:[2,99],75:[2,99]},{73:[1,109]},{20:75,63:126,64:76,65:[1,44],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{5:[2,23],14:[2,23],15:[2,23],19:[2,23],29:[2,23],34:[2,23],39:[2,23],44:[2,23],47:[2,23],48:[2,23],51:[2,23],55:[2,23],60:[2,23]},{47:[2,19]},{47:[2,77]},{20:75,33:[2,72],41:127,63:128,64:76,65:[1,44],69:129,70:77,71:78,72:[1,79],75:[2,72],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{5:[2,24],14:[2,24],15:[2,24],19:[2,24],29:[2,24],34:[2,24],39:[2,24],44:[2,24],47:[2,24],48:[2,24],51:[2,24],55:[2,24],60:[2,24]},{68:[1,130]},{65:[2,95],68:[2,95],72:[2,95],80:[2,95],81:[2,95],82:[2,95],83:[2,95],84:[2,95],85:[2,95]},{68:[2,97]},{5:[2,21],14:[2,21],15:[2,21],19:[2,21],29:[2,21],34:[2,21],39:[2,21],44:[2,21],47:[2,21],48:[2,21],51:[2,21],55:[2,21],60:[2,21]},{33:[1,131]},{33:[2,63]},{72:[1,133],76:132},{33:[1,134]},{33:[2,69]},{15:[2,12]},{14:[2,26],15:[2,26],19:[2,26],29:[2,26],34:[2,26],47:[2,26],48:[2,26],51:[2,26],55:[2,26],60:[2,26]},{23:[2,31],33:[2,31],54:[2,31],68:[2,31],72:[2,31],75:[2,31]},{33:[2,74],42:135,74:136,75:[1,121]},{33:[2,71],65:[2,71],72:[2,71],75:[2,71],80:[2,71],81:[2,71],82:[2,71],83:[2,71],84:[2,71],85:[2,71]},{33:[2,73],75:[2,73]},{23:[2,29],33:[2,29],54:[2,29],65:[2,29],68:[2,29],72:[2,29],75:[2,29],80:[2,29],81:[2,29],82:[2,29],83:[2,29],84:[2,29],85:[2,29]},{14:[2,15],15:[2,15],19:[2,15],29:[2,15],34:[2,15],39:[2,15],44:[2,15],47:[2,15],48:[2,15],51:[2,15],55:[2,15],60:[2,15]},{72:[1,138],77:[1,137]},{72:[2,100],77:[2,100]},{14:[2,16],15:[2,16],19:[2,16],29:[2,16],34:[2,16],44:[2,16],47:[2,16],48:[2,16],51:[2,16],55:[2,16],60:[2,16]},{33:[1,139]},{33:[2,75]},{33:[2,32]},{72:[2,101],77:[2,101]},{14:[2,17],15:[2,17],19:[2,17],29:[2,17],34:[2,17],39:[2,17],44:[2,17],47:[2,17],48:[2,17],51:[2,17],55:[2,17],60:[2,17]}],defaultActions:{4:[2,1],55:[2,55],57:[2,20],61:[2,57],74:[2,81],83:[2,85],87:[2,18],91:[2,89],102:[2,53],105:[2,93],111:[2,19],112:[2,77],117:[2,97],120:[2,63],123:[2,69],124:[2,12],136:[2,75],137:[2,32]},parseError:function(t,e){throw new Error(t)},parse:function(t){var e=this,i=[0],n=[null],o=[],r=this.table,s="",a=0,l=0,c=0;this.lexer.setInput(t),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,void 0===this.lexer.yylloc&&(this.lexer.yylloc={});var u=this.lexer.yylloc;o.push(u);var h=this.lexer.options&&this.lexer.options.ranges;"function"==typeof this.yy.parseError&&(this.parseError=this.yy.parseError);for(var m,p,f,_,y,d,v,g,x,b={};;){if(f=i[i.length-1],this.defaultActions[f]?_=this.defaultActions[f]:(null!==m&&void 0!==m||(m=function(){var t;return t=e.lexer.lex()||1,"number"!=typeof t&&(t=e.symbols_[t]||t),t}()),_=r[f]&&r[f][m]),void 0===_||!_.length||!_[0]){var C="";if(!c){x=[];for(d in r[f])this.terminals_[d]&&d>2&&x.push("'"+this.terminals_[d]+"'");C=this.lexer.showPosition?"Parse error on line "+(a+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+x.join(", ")+", got '"+(this.terminals_[m]||m)+"'":"Parse error on line "+(a+1)+": Unexpected "+(1==m?"end of input":"'"+(this.terminals_[m]||m)+"'"),this.parseError(C,{text:this.lexer.match,token:this.terminals_[m]||m,line:this.lexer.yylineno,loc:u,expected:x})}}if(_[0]instanceof Array&&_.length>1)throw new Error("Parse Error: multiple actions possible at state: "+f+", token: "+m);switch(_[0]){case 1:i.push(m),n.push(this.lexer.yytext),o.push(this.lexer.yylloc),i.push(_[1]),m=null,p?(m=p,p=null):(l=this.lexer.yyleng,s=this.lexer.yytext,a=this.lexer.yylineno,u=this.lexer.yylloc,c>0&&c--);break;case 2:if(v=this.productions_[_[1]][1],b.$=n[n.length-v],b._$={first_line:o[o.length-(v||1)].first_line,last_line:o[o.length-1].last_line,first_column:o[o.length-(v||1)].first_column,last_column:o[o.length-1].last_column},h&&(b._$.range=[o[o.length-(v||1)].range[0],o[o.length-1].range[1]]),void 0!==(y=this.performAction.call(b,s,l,a,this.yy,_[1],n,o)))return y;v&&(i=i.slice(0,-1*v*2),n=n.slice(0,-1*v),o=o.slice(0,-1*v)),i.push(this.productions_[_[1]][0]),n.push(b.$),o.push(b._$),g=r[i[i.length-2]][i[i.length-1]],i.push(g);break;case 3:return!0}}return!0}},i=function(){var t={EOF:1,parseError:function(t,e){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,e)},setInput:function(t){return this._input=t,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var t=this._input[0];return this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t,t.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),t},unput:function(t){var e=t.length,i=t.split(/(?:\r\n?|\n)/g);this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-e-1),this.offset-=e;var n=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),i.length-1&&(this.yylineno-=i.length-1);var o=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:i?(i.length===n.length?this.yylloc.first_column:0)+n[n.length-i.length].length-i[0].length:this.yylloc.first_column-e},this.options.ranges&&(this.yylloc.range=[o[0],o[0]+this.yyleng-e]),this},more:function(){return this._more=!0,this},less:function(t){this.unput(this.match.slice(t))},pastInput:function(){var t=this.matched.substr(0,this.matched.length-this.match.length);return(t.length>20?"...":"")+t.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var t=this.match;return t.length<20&&(t+=this._input.substr(0,20-t.length)),(t.substr(0,20)+(t.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var t=this.pastInput(),e=new Array(t.length+1).join("-");return t+this.upcomingInput()+"\n"+e+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var t,e,i,n,o;this._more||(this.yytext="",this.match="");for(var r=this._currentRules(),s=0;s<r.length&&(!(i=this._input.match(this.rules[r[s]]))||e&&!(i[0].length>e[0].length)||(e=i,n=s,this.options.flex));s++);return e?(o=e[0].match(/(?:\r\n?|\n).*/g),o&&(this.yylineno+=o.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:o?o[o.length-1].length-o[o.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],t=this.performAction.call(this,this.yy,this,r[n],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),t||void 0):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var t=this.next();return void 0!==t?t:this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(t){this.begin(t)}};return t.options={},t.performAction=function(t,e,i,n){function o(t,i){return e.yytext=e.yytext.substr(t,e.yyleng-i)}switch(i){case 0:if("\\\\"===e.yytext.slice(-2)?(o(0,1),this.begin("mu")):"\\"===e.yytext.slice(-1)?(o(0,1),this.begin("emu")):this.begin("mu"),e.yytext)return 15;break;case 1:return 15;case 2:return this.popState(),15;case 3:return this.begin("raw"),15;case 4:return this.popState(),"raw"===this.conditionStack[this.conditionStack.length-1]?15:(e.yytext=e.yytext.substr(5,e.yyleng-9),"END_RAW_BLOCK");case 5:return 15;case 6:return this.popState(),14;case 7:return 65;case 8:return 68;case 9:return 19;case 10:return this.popState(),this.begin("raw"),23;case 11:return 55;case 12:return 60;case 13:return 29;case 14:return 47;case 15:case 16:return this.popState(),44;case 17:return 34;case 18:return 39;case 19:return 51;case 20:return 48;case 21:this.unput(e.yytext),this.popState(),this.begin("com");break;case 22:return this.popState(),14;case 23:return 48;case 24:return 73;case 25:case 26:return 72;case 27:return 87;case 28:break;case 29:return this.popState(),54;case 30:return this.popState(),33;case 31:return e.yytext=o(1,2).replace(/\\"/g,'"'),80;case 32:return e.yytext=o(1,2).replace(/\\'/g,"'"),80;case 33:return 85;case 34:case 35:return 82;case 36:return 83;case 37:return 84;case 38:return 81;case 39:return 75;case 40:return 77;case 41:return 72;case 42:return e.yytext=e.yytext.replace(/\\([\\\]])/g,"$1"),72;case 43:return"INVALID";case 44:return 5}},t.rules=[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|\\\{\{|\\\\\{\{|$)))/,/^(?:\{\{\{\{(?=[^\/]))/,/^(?:\{\{\{\{\/[^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=[=}\s\/.])\}\}\}\})/,/^(?:[^\x00]*?(?=(\{\{\{\{)))/,/^(?:[\s\S]*?--(~)?\}\})/,/^(?:\()/,/^(?:\))/,/^(?:\{\{\{\{)/,/^(?:\}\}\}\})/,/^(?:\{\{(~)?>)/,/^(?:\{\{(~)?#>)/,/^(?:\{\{(~)?#\*?)/,/^(?:\{\{(~)?\/)/,/^(?:\{\{(~)?\^\s*(~)?\}\})/,/^(?:\{\{(~)?\s*else\s*(~)?\}\})/,/^(?:\{\{(~)?\^)/,/^(?:\{\{(~)?\s*else\b)/,/^(?:\{\{(~)?\{)/,/^(?:\{\{(~)?&)/,/^(?:\{\{(~)?!--)/,/^(?:\{\{(~)?![\s\S]*?\}\})/,/^(?:\{\{(~)?\*?)/,/^(?:=)/,/^(?:\.\.)/,/^(?:\.(?=([=~}\s\/.)|])))/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}(~)?\}\})/,/^(?:(~)?\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=([~}\s)])))/,/^(?:false(?=([~}\s)])))/,/^(?:undefined(?=([~}\s)])))/,/^(?:null(?=([~}\s)])))/,/^(?:-?[0-9]+(?:\.[0-9]+)?(?=([~}\s)])))/,/^(?:as\s+\|)/,/^(?:\|)/,/^(?:([^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=([=~}\s\/.)|]))))/,/^(?:\[(\\\]|[^\]])*\])/,/^(?:.)/,/^(?:$)/],t.conditions={mu:{rules:[7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],inclusive:!1},emu:{rules:[2],inclusive:!1},com:{rules:[6],inclusive:!1},raw:{rules:[3,4,5],inclusive:!1},INITIAL:{rules:[0,1,44],inclusive:!0}},t}();return e.lexer=i,t.prototype=e,e.Parser=t,new t}();e.__esModule=!0,e.default=i},function(t,e,i){"use strict";function n(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];this.options=t}function o(t,e,i){void 0===e&&(e=t.length);var n=t[e-1],o=t[e-2];return n?"ContentStatement"===n.type?(o||!i?/\r?\n\s*?$/:/(^|\r?\n)\s*?$/).test(n.original):void 0:i}function r(t,e,i){void 0===e&&(e=-1);var n=t[e+1],o=t[e+2];return n?"ContentStatement"===n.type?(o||!i?/^\s*?\r?\n/:/^\s*?(\r?\n|$)/).test(n.original):void 0:i}function s(t,e,i){var n=t[null==e?0:e+1];if(n&&"ContentStatement"===n.type&&(i||!n.rightStripped)){var o=n.value;n.value=n.value.replace(i?/^\s+/:/^[ \t]*\r?\n?/,""),n.rightStripped=n.value!==o}}function a(t,e,i){var n=t[null==e?t.length-1:e-1];if(n&&"ContentStatement"===n.type&&(i||!n.leftStripped)){var o=n.value;return n.value=n.value.replace(i?/\s+$/:/[ \t]+$/,""),n.leftStripped=n.value!==o,n.leftStripped}}var l=i(1).default;e.__esModule=!0;var c=i(28),u=l(c);n.prototype=new u.default,n.prototype.Program=function(t){var e=!this.options.ignoreStandalone,i=!this.isRootSeen;this.isRootSeen=!0;for(var n=t.body,l=0,c=n.length;l<c;l++){var u=n[l],h=this.accept(u);if(h){var m=o(n,l,i),p=r(n,l,i),f=h.openStandalone&&m,_=h.closeStandalone&&p,y=h.inlineStandalone&&m&&p;h.close&&s(n,l,!0),h.open&&a(n,l,!0),e&&y&&(s(n,l),a(n,l)&&"PartialStatement"===u.type&&(u.indent=/([ \t]+$)/.exec(n[l-1].original)[1])),e&&f&&(s((u.program||u.inverse).body),a(n,l)),e&&_&&(s(n,l),a((u.inverse||u.program).body))}}return t},n.prototype.BlockStatement=n.prototype.DecoratorBlock=n.prototype.PartialBlockStatement=function(t){this.accept(t.program),this.accept(t.inverse);var e=t.program||t.inverse,i=t.program&&t.inverse,n=i,l=i;if(i&&i.chained)for(n=i.body[0].program;l.chained;)l=l.body[l.body.length-1].program;var c={open:t.openStrip.open,close:t.closeStrip.close,openStandalone:r(e.body),closeStandalone:o((n||e).body)};if(t.openStrip.close&&s(e.body,null,!0),i){var u=t.inverseStrip;u.open&&a(e.body,null,!0),u.close&&s(n.body,null,!0),t.closeStrip.open&&a(l.body,null,!0),!this.options.ignoreStandalone&&o(e.body)&&r(n.body)&&(a(e.body),s(n.body))}else t.closeStrip.open&&a(e.body,null,!0);return c},n.prototype.Decorator=n.prototype.MustacheStatement=function(t){return t.strip},n.prototype.PartialStatement=n.prototype.CommentStatement=function(t){var e=t.strip||{};return{inlineStandalone:!0,open:e.open,close:e.close}},e.default=n,t.exports=e.default},function(t,e,i){"use strict";function n(){this.parents=[]}function o(t){this.acceptRequired(t,"path"),this.acceptArray(t.params),this.acceptKey(t,"hash")}function r(t){o.call(this,t),this.acceptKey(t,"program"),this.acceptKey(t,"inverse")}function s(t){this.acceptRequired(t,"name"),this.acceptArray(t.params),this.acceptKey(t,"hash")}var a=i(1).default;e.__esModule=!0;var l=i(6),c=a(l);n.prototype={constructor:n,mutating:!1,acceptKey:function(t,e){var i=this.accept(t[e]);if(this.mutating){if(i&&!n.prototype[i.type])throw new c.default('Unexpected node type "'+i.type+'" found when accepting '+e+" on "+t.type);t[e]=i}},acceptRequired:function(t,e){if(this.acceptKey(t,e),!t[e])throw new c.default(t.type+" requires "+e)},acceptArray:function(t){for(var e=0,i=t.length;e<i;e++)this.acceptKey(t,e),t[e]||(t.splice(e,1),e--,i--)},accept:function(t){if(t){if(!this[t.type])throw new c.default("Unknown type: "+t.type,t);this.current&&this.parents.unshift(this.current),this.current=t;var e=this[t.type](t);return this.current=this.parents.shift(),!this.mutating||e?e:!1!==e?t:void 0}},Program:function(t){this.acceptArray(t.body)},MustacheStatement:o,Decorator:o,BlockStatement:r,DecoratorBlock:r,PartialStatement:s,PartialBlockStatement:function(t){s.call(this,t),this.acceptKey(t,"program")},ContentStatement:function(){},CommentStatement:function(){},SubExpression:o,PathExpression:function(){},StringLiteral:function(){},NumberLiteral:function(){},BooleanLiteral:function(){},UndefinedLiteral:function(){},NullLiteral:function(){},Hash:function(t){this.acceptArray(t.pairs)},HashPair:function(t){this.acceptRequired(t,"value")}},e.default=n,t.exports=e.default},function(t,e,i){"use strict";function n(t,e){if(e=e.path?e.path.original:e,t.path.original!==e){var i={loc:t.path.loc};throw new y.default(t.path.original+" doesn't match "+e,i)}}function o(t,e){this.source=t,this.start={line:e.first_line,column:e.first_column},this.end={line:e.last_line,column:e.last_column}}function r(t){return/^\[.*\]$/.test(t)?t.substr(1,t.length-2):t}function s(t,e){return{open:"~"===t.charAt(2),close:"~"===e.charAt(e.length-3)}}function a(t){return t.replace(/^\{\{~?\!-?-?/,"").replace(/-?-?~?\}\}$/,"")}function l(t,e,i){i=this.locInfo(i);for(var n=t?"@":"",o=[],r=0,s="",a=0,l=e.length;a<l;a++){var c=e[a].part,u=e[a].original!==c;if(n+=(e[a].separator||"")+c,u||".."!==c&&"."!==c&&"this"!==c)o.push(c);else{if(o.length>0)throw new y.default("Invalid path: "+n,{loc:i});".."===c&&(r++,s+="../")}}return{type:"PathExpression",data:t,depth:r,parts:o,original:n,loc:i}}function c(t,e,i,n,o,r){var s=n.charAt(3)||n.charAt(2),a="{"!==s&&"&"!==s;return{type:/\*/.test(n)?"Decorator":"MustacheStatement",path:t,params:e,hash:i,escaped:a,strip:o,loc:this.locInfo(r)}}function u(t,e,i,o){n(t,i),o=this.locInfo(o);var r={type:"Program",body:e,strip:{},loc:o};return{type:"BlockStatement",path:t.path,params:t.params,hash:t.hash,program:r,openStrip:{},inverseStrip:{},closeStrip:{},loc:o}}function h(t,e,i,o,r,s){o&&o.path&&n(t,o);var a=/\*/.test(t.open);e.blockParams=t.blockParams;var l=void 0,c=void 0;if(i){if(a)throw new y.default("Unexpected inverse block on decorator",i);i.chain&&(i.program.body[0].closeStrip=o.strip),c=i.strip,l=i.program}return r&&(r=l,l=e,e=r),{type:a?"DecoratorBlock":"BlockStatement",path:t.path,params:t.params,hash:t.hash,program:e,inverse:l,openStrip:t.strip,inverseStrip:c,closeStrip:o&&o.strip,loc:this.locInfo(s)}}function m(t,e){if(!e&&t.length){var i=t[0].loc,n=t[t.length-1].loc;i&&n&&(e={source:i.source,start:{line:i.start.line,column:i.start.column},end:{line:n.end.line,column:n.end.column}})}return{type:"Program",body:t,strip:{},loc:e}}function p(t,e,i,o){return n(t,i),{type:"PartialBlockStatement",name:t.path,params:t.params,hash:t.hash,program:e,openStrip:t.strip,closeStrip:i&&i.strip,loc:this.locInfo(o)}}var f=i(1).default;e.__esModule=!0,e.SourceLocation=o,e.id=r,e.stripFlags=s,e.stripComment=a,e.preparePath=l,e.prepareMustache=c,e.prepareRawBlock=u,e.prepareBlock=h,e.prepareProgram=m,e.preparePartialBlock=p;var _=i(6),y=f(_)},function(t,e,i){"use strict";function n(){}function o(t,e,i){if(null==t||"string"!=typeof t&&"Program"!==t.type)throw new u.default("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+t);e=e||{},"data"in e||(e.data=!0),e.compat&&(e.useDepths=!0);var n=i.parse(t,e),o=(new i.Compiler).compile(n,e);return(new i.JavaScriptCompiler).compile(o,e)}function r(t,e,i){function n(){var n=i.parse(t,e),o=(new i.Compiler).compile(n,e),r=(new i.JavaScriptCompiler).compile(o,e,void 0,!0);return i.template(r)}function o(t,e){return r||(r=n()),r.call(this,t,e)}if(void 0===e&&(e={}),null==t||"string"!=typeof t&&"Program"!==t.type)throw new u.default("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+t);"data"in e||(e.data=!0),e.compat&&(e.useDepths=!0);var r=void 0;return o._setup=function(t){return r||(r=n()),r._setup(t)},o._child=function(t,e,i,o){return r||(r=n()),r._child(t,e,i,o)},o}function s(t,e){if(t===e)return!0;if(h.isArray(t)&&h.isArray(e)&&t.length===e.length){for(var i=0;i<t.length;i++)if(!s(t[i],e[i]))return!1;return!0}}function a(t){if(!t.path.parts){var e=t.path;t.path={type:"PathExpression",data:!1,depth:0,parts:[e.original+""],original:e.original+"",loc:e.loc}}}var l=i(1).default;e.__esModule=!0,e.Compiler=n,e.precompile=o,e.compile=r;var c=i(6),u=l(c),h=i(5),m=i(24),p=l(m),f=[].slice;n.prototype={compiler:n,equals:function(t){var e=this.opcodes.length;if(t.opcodes.length!==e)return!1;for(var i=0;i<e;i++){var n=this.opcodes[i],o=t.opcodes[i];if(n.opcode!==o.opcode||!s(n.args,o.args))return!1}e=this.children.length;for(var i=0;i<e;i++)if(!this.children[i].equals(t.children[i]))return!1;return!0},guid:0,compile:function(t,e){this.sourceNode=[],this.opcodes=[],this.children=[],this.options=e,this.stringParams=e.stringParams,this.trackIds=e.trackIds,e.blockParams=e.blockParams||[];var i=e.knownHelpers;if(e.knownHelpers={helperMissing:!0,blockHelperMissing:!0,each:!0,if:!0,unless:!0,with:!0,log:!0,lookup:!0},i)for(var n in i)n in i&&(e.knownHelpers[n]=i[n]);return this.accept(t)},compileProgram:function(t){var e=new this.compiler,i=e.compile(t,this.options),n=this.guid++;return this.usePartial=this.usePartial||i.usePartial,this.children[n]=i,this.useDepths=this.useDepths||i.useDepths,n},accept:function(t){if(!this[t.type])throw new u.default("Unknown type: "+t.type,t);this.sourceNode.unshift(t);var e=this[t.type](t);return this.sourceNode.shift(),e},Program:function(t){this.options.blockParams.unshift(t.blockParams);for(var e=t.body,i=e.length,n=0;n<i;n++)this.accept(e[n]);return this.options.blockParams.shift(),this.isSimple=1===i,this.blockParams=t.blockParams?t.blockParams.length:0,this},BlockStatement:function(t){a(t);var e=t.program,i=t.inverse;e=e&&this.compileProgram(e),i=i&&this.compileProgram(i);var n=this.classifySexpr(t);"helper"===n?this.helperSexpr(t,e,i):"simple"===n?(this.simpleSexpr(t),this.opcode("pushProgram",e),this.opcode("pushProgram",i),this.opcode("emptyHash"),this.opcode("blockValue",t.path.original)):(this.ambiguousSexpr(t,e,i),this.opcode("pushProgram",e),this.opcode("pushProgram",i),this.opcode("emptyHash"),this.opcode("ambiguousBlockValue")),this.opcode("append")},DecoratorBlock:function(t){var e=t.program&&this.compileProgram(t.program),i=this.setupFullMustacheParams(t,e,void 0),n=t.path;this.useDecorators=!0,this.opcode("registerDecorator",i.length,n.original)},PartialStatement:function(t){this.usePartial=!0;var e=t.program;e&&(e=this.compileProgram(t.program));var i=t.params;if(i.length>1)throw new u.default("Unsupported number of partial arguments: "+i.length,t);i.length||(this.options.explicitPartialContext?this.opcode("pushLiteral","undefined"):i.push({type:"PathExpression",parts:[],depth:0}));var n=t.name.original,o="SubExpression"===t.name.type;o&&this.accept(t.name),this.setupFullMustacheParams(t,e,void 0,!0);var r=t.indent||"";this.options.preventIndent&&r&&(this.opcode("appendContent",r),r=""),this.opcode("invokePartial",o,n,r),this.opcode("append")},PartialBlockStatement:function(t){this.PartialStatement(t)},MustacheStatement:function(t){this.SubExpression(t),t.escaped&&!this.options.noEscape?this.opcode("appendEscaped"):this.opcode("append")},Decorator:function(t){this.DecoratorBlock(t)},ContentStatement:function(t){t.value&&this.opcode("appendContent",t.value)},CommentStatement:function(){},SubExpression:function(t){a(t);var e=this.classifySexpr(t);"simple"===e?this.simpleSexpr(t):"helper"===e?this.helperSexpr(t):this.ambiguousSexpr(t)},ambiguousSexpr:function(t,e,i){var n=t.path,o=n.parts[0],r=null!=e||null!=i;this.opcode("getContext",n.depth),this.opcode("pushProgram",e),this.opcode("pushProgram",i),n.strict=!0,this.accept(n),this.opcode("invokeAmbiguous",o,r)},simpleSexpr:function(t){var e=t.path;e.strict=!0,this.accept(e),this.opcode("resolvePossibleLambda")},helperSexpr:function(t,e,i){var n=this.setupFullMustacheParams(t,e,i),o=t.path,r=o.parts[0];if(this.options.knownHelpers[r])this.opcode("invokeKnownHelper",n.length,r);else{if(this.options.knownHelpersOnly)throw new u.default("You specified knownHelpersOnly, but used the unknown helper "+r,t);o.strict=!0,o.falsy=!0,this.accept(o),this.opcode("invokeHelper",n.length,o.original,p.default.helpers.simpleId(o))}},PathExpression:function(t){this.addDepth(t.depth),this.opcode("getContext",t.depth);var e=t.parts[0],i=p.default.helpers.scopedId(t),n=!t.depth&&!i&&this.blockParamIndex(e);n?this.opcode("lookupBlockParam",n,t.parts):e?t.data?(this.options.data=!0,this.opcode("lookupData",t.depth,t.parts,t.strict)):this.opcode("lookupOnContext",t.parts,t.falsy,t.strict,i):this.opcode("pushContext")},StringLiteral:function(t){this.opcode("pushString",t.value)},NumberLiteral:function(t){this.opcode("pushLiteral",t.value)},BooleanLiteral:function(t){this.opcode("pushLiteral",t.value)},UndefinedLiteral:function(){this.opcode("pushLiteral","undefined")},NullLiteral:function(){this.opcode("pushLiteral","null")},Hash:function(t){var e=t.pairs,i=0,n=e.length;for(this.opcode("pushHash");i<n;i++)this.pushParam(e[i].value);for(;i--;)this.opcode("assignToHash",e[i].key);this.opcode("popHash")},opcode:function(t){this.opcodes.push({opcode:t,args:f.call(arguments,1),loc:this.sourceNode[0].loc})},addDepth:function(t){t&&(this.useDepths=!0)},classifySexpr:function(t){var e=p.default.helpers.simpleId(t.path),i=e&&!!this.blockParamIndex(t.path.parts[0]),n=!i&&p.default.helpers.helperExpression(t),o=!i&&(n||e);if(o&&!n){var r=t.path.parts[0],s=this.options;s.knownHelpers[r]?n=!0:s.knownHelpersOnly&&(o=!1)}return n?"helper":o?"ambiguous":"simple"},pushParams:function(t){for(var e=0,i=t.length;e<i;e++)this.pushParam(t[e])},pushParam:function(t){var e=null!=t.value?t.value:t.original||"";if(this.stringParams)e.replace&&(e=e.replace(/^(\.?\.\/)*/g,"").replace(/\//g,".")),t.depth&&this.addDepth(t.depth),this.opcode("getContext",t.depth||0),this.opcode("pushStringParam",e,t.type),"SubExpression"===t.type&&this.accept(t);else{if(this.trackIds){var i=void 0;if(!t.parts||p.default.helpers.scopedId(t)||t.depth||(i=this.blockParamIndex(t.parts[0])),i){var n=t.parts.slice(1).join(".");this.opcode("pushId","BlockParam",i,n)}else e=t.original||e,e.replace&&(e=e.replace(/^this(?:\.|$)/,"").replace(/^\.\//,"").replace(/^\.$/,"")),this.opcode("pushId",t.type,e)}this.accept(t)}},setupFullMustacheParams:function(t,e,i,n){var o=t.params;return this.pushParams(o),this.opcode("pushProgram",e),this.opcode("pushProgram",i),t.hash?this.accept(t.hash):this.opcode("emptyHash",n),o},blockParamIndex:function(t){for(var e=0,i=this.options.blockParams.length;e<i;e++){var n=this.options.blockParams[e],o=n&&h.indexOf(n,t);if(n&&o>=0)return[e,o]}}}},function(t,e,i){"use strict";function n(t){this.value=t}function o(){}function r(t,e,i,n){var o=e.popStack(),r=0,s=i.length;for(t&&s--;r<s;r++)o=e.nameLookup(o,i[r],n);return t?[e.aliasable("container.strict"),"(",o,", ",e.quotedString(i[r]),")"]:o}var s=i(1).default;e.__esModule=!0;var a=i(4),l=i(6),c=s(l),u=i(5),h=i(32),m=s(h);o.prototype={nameLookup:function(t,e){return o.isValidJavaScriptVariableName(e)?[t,".",e]:[t,"[",JSON.stringify(e),"]"]},depthedLookup:function(t){return[this.aliasable("container.lookup"),'(depths, "',t,'")']},compilerInfo:function(){var t=a.COMPILER_REVISION;return[t,a.REVISION_CHANGES[t]]},appendToBuffer:function(t,e,i){return u.isArray(t)||(t=[t]),t=this.source.wrap(t,e),this.environment.isSimple?["return ",t,";"]:i?["buffer += ",t,";"]:(t.appendToBuffer=!0,t)},initializeBuffer:function(){return this.quotedString("")},compile:function(t,e,i,n){this.environment=t,this.options=e,this.stringParams=this.options.stringParams,this.trackIds=this.options.trackIds,this.precompile=!n,this.name=this.environment.name,this.isChild=!!i,this.context=i||{decorators:[],programs:[],environments:[]},this.preamble(),this.stackSlot=0,this.stackVars=[],this.aliases={},this.registers={list:[]},this.hashes=[],this.compileStack=[],this.inlineStack=[],this.blockParams=[],this.compileChildren(t,e),this.useDepths=this.useDepths||t.useDepths||t.useDecorators||this.options.compat,this.useBlockParams=this.useBlockParams||t.useBlockParams;var o=t.opcodes,r=void 0,s=void 0,a=void 0,l=void 0;for(a=0,l=o.length;a<l;a++)r=o[a],this.source.currentLocation=r.loc,s=s||r.loc,this[r.opcode].apply(this,r.args);if(this.source.currentLocation=s,this.pushSource(""),this.stackSlot||this.inlineStack.length||this.compileStack.length)throw new c.default("Compile completed with content left on stack");this.decorators.isEmpty()?this.decorators=void 0:(this.useDecorators=!0,this.decorators.prepend("var decorators = container.decorators;\n"),this.decorators.push("return fn;"),n?this.decorators=Function.apply(this,["fn","props","container","depth0","data","blockParams","depths",this.decorators.merge()]):(this.decorators.prepend("function(fn, props, container, depth0, data, blockParams, depths) {\n"),this.decorators.push("}\n"),this.decorators=this.decorators.merge()));var u=this.createFunctionContext(n);if(this.isChild)return u;var h={compiler:this.compilerInfo(),main:u};this.decorators&&(h.main_d=this.decorators,h.useDecorators=!0);var m=this.context,p=m.programs,f=m.decorators;for(a=0,l=p.length;a<l;a++)p[a]&&(h[a]=p[a],f[a]&&(h[a+"_d"]=f[a],h.useDecorators=!0));return this.environment.usePartial&&(h.usePartial=!0),this.options.data&&(h.useData=!0),this.useDepths&&(h.useDepths=!0),this.useBlockParams&&(h.useBlockParams=!0),this.options.compat&&(h.compat=!0),n?h.compilerOptions=this.options:(h.compiler=JSON.stringify(h.compiler),this.source.currentLocation={start:{line:1,column:0}},h=this.objectLiteral(h),e.srcName?(h=h.toStringWithSourceMap({file:e.destName}),h.map=h.map&&h.map.toString()):h=h.toString()),h},preamble:function(){this.lastContext=0,this.source=new m.default(this.options.srcName),this.decorators=new m.default(this.options.srcName)},createFunctionContext:function(t){var e="",i=this.stackVars.concat(this.registers.list);i.length>0&&(e+=", "+i.join(", "));var n=0;for(var o in this.aliases){var r=this.aliases[o];this.aliases.hasOwnProperty(o)&&r.children&&r.referenceCount>1&&(e+=", alias"+ ++n+"="+o,r.children[0]="alias"+n)}var s=["container","depth0","helpers","partials","data"];(this.useBlockParams||this.useDepths)&&s.push("blockParams"),this.useDepths&&s.push("depths");var a=this.mergeSource(e);return t?(s.push(a),Function.apply(this,s)):this.source.wrap(["function(",s.join(","),") {\n  ",a,"}"])},mergeSource:function(t){var e=this.environment.isSimple,i=!this.forceBuffer,n=void 0,o=void 0,r=void 0,s=void 0;return this.source.each(function(t){t.appendToBuffer?(r?t.prepend("  + "):r=t,s=t):(r&&(o?r.prepend("buffer += "):n=!0,s.add(";"),r=s=void 0),o=!0,e||(i=!1))}),i?r?(r.prepend("return "),s.add(";")):o||this.source.push('return "";'):(t+=", buffer = "+(n?"":this.initializeBuffer()),r?(r.prepend("return buffer + "),s.add(";")):this.source.push("return buffer;")),t&&this.source.prepend("var "+t.substring(2)+(n?"":";\n")),this.source.merge()},blockValue:function(t){var e=this.aliasable("helpers.blockHelperMissing"),i=[this.contextName(0)];this.setupHelperArgs(t,0,i);var n=this.popStack();i.splice(1,0,n),this.push(this.source.functionCall(e,"call",i))},ambiguousBlockValue:function(){var t=this.aliasable("helpers.blockHelperMissing"),e=[this.contextName(0)];this.setupHelperArgs("",0,e,!0),this.flushInline();var i=this.topStack();e.splice(1,0,i),this.pushSource(["if (!",this.lastHelper,") { ",i," = ",this.source.functionCall(t,"call",e),"}"])},appendContent:function(t){this.pendingContent?t=this.pendingContent+t:this.pendingLocation=this.source.currentLocation,this.pendingContent=t},append:function(){if(this.isInline())this.replaceStack(function(t){return[" != null ? ",t,' : ""']}),this.pushSource(this.appendToBuffer(this.popStack()));else{var t=this.popStack();this.pushSource(["if (",t," != null) { ",this.appendToBuffer(t,void 0,!0)," }"]),this.environment.isSimple&&this.pushSource(["else { ",this.appendToBuffer("''",void 0,!0)," }"])}},appendEscaped:function(){this.pushSource(this.appendToBuffer([this.aliasable("container.escapeExpression"),"(",this.popStack(),")"]))},getContext:function(t){this.lastContext=t},pushContext:function(){this.pushStackLiteral(this.contextName(this.lastContext))},lookupOnContext:function(t,e,i,n){var o=0;n||!this.options.compat||this.lastContext?this.pushContext():this.push(this.depthedLookup(t[o++])),this.resolvePath("context",t,o,e,i)},lookupBlockParam:function(t,e){this.useBlockParams=!0,this.push(["blockParams[",t[0],"][",t[1],"]"]),this.resolvePath("context",e,1)},lookupData:function(t,e,i){t?this.pushStackLiteral("container.data(data, "+t+")"):this.pushStackLiteral("data"),this.resolvePath("data",e,0,!0,i)},resolvePath:function(t,e,i,n,o){var s=this;if(this.options.strict||this.options.assumeObjects)return void this.push(r(this.options.strict&&o,this,e,t));for(var a=e.length;i<a;i++)this.replaceStack(function(o){var r=s.nameLookup(o,e[i],t);return n?[" && ",r]:[" != null ? ",r," : ",o]})},resolvePossibleLambda:function(){this.push([this.aliasable("container.lambda"),"(",this.popStack(),", ",this.contextName(0),")"])},pushStringParam:function(t,e){this.pushContext(),this.pushString(e),"SubExpression"!==e&&("string"==typeof t?this.pushString(t):this.pushStackLiteral(t))},emptyHash:function(t){this.trackIds&&this.push("{}"),this.stringParams&&(this.push("{}"),this.push("{}")),this.pushStackLiteral(t?"undefined":"{}")},pushHash:function(){this.hash&&this.hashes.push(this.hash),this.hash={values:[],types:[],contexts:[],ids:[]}},popHash:function(){var t=this.hash;this.hash=this.hashes.pop(),this.trackIds&&this.push(this.objectLiteral(t.ids)),this.stringParams&&(this.push(this.objectLiteral(t.contexts)),this.push(this.objectLiteral(t.types))),this.push(this.objectLiteral(t.values))},pushString:function(t){this.pushStackLiteral(this.quotedString(t))},pushLiteral:function(t){this.pushStackLiteral(t)},pushProgram:function(t){null!=t?this.pushStackLiteral(this.programExpression(t)):this.pushStackLiteral(null)},registerDecorator:function(t,e){var i=this.nameLookup("decorators",e,"decorator"),n=this.setupHelperArgs(e,t);this.decorators.push(["fn = ",this.decorators.functionCall(i,"",["fn","props","container",n])," || fn;"])},invokeHelper:function(t,e,i){var n=this.popStack(),o=this.setupHelper(t,e),r=i?[o.name," || "]:"",s=["("].concat(r,n);this.options.strict||s.push(" || ",this.aliasable("helpers.helperMissing")),s.push(")"),this.push(this.source.functionCall(s,"call",o.callParams))},invokeKnownHelper:function(t,e){var i=this.setupHelper(t,e);this.push(this.source.functionCall(i.name,"call",i.callParams))},invokeAmbiguous:function(t,e){this.useRegister("helper");var i=this.popStack();this.emptyHash();var n=this.setupHelper(0,t,e),o=this.lastHelper=this.nameLookup("helpers",t,"helper"),r=["(","(helper = ",o," || ",i,")"];this.options.strict||(r[0]="(helper = ",r.push(" != null ? helper : ",this.aliasable("helpers.helperMissing"))),this.push(["(",r,n.paramsInit?["),(",n.paramsInit]:[],"),","(typeof helper === ",this.aliasable('"function"')," ? ",this.source.functionCall("helper","call",n.callParams)," : helper))"])},invokePartial:function(t,e,i){var n=[],o=this.setupParams(e,1,n);t&&(e=this.popStack(),delete o.name),i&&(o.indent=JSON.stringify(i)),o.helpers="helpers",o.partials="partials",o.decorators="container.decorators",t?n.unshift(e):n.unshift(this.nameLookup("partials",e,"partial")),this.options.compat&&(o.depths="depths"),o=this.objectLiteral(o),n.push(o),this.push(this.source.functionCall("container.invokePartial","",n))},assignToHash:function(t){var e=this.popStack(),i=void 0,n=void 0,o=void 0;this.trackIds&&(o=this.popStack()),this.stringParams&&(n=this.popStack(),i=this.popStack());var r=this.hash;i&&(r.contexts[t]=i),n&&(r.types[t]=n),o&&(r.ids[t]=o),r.values[t]=e},pushId:function(t,e,i){"BlockParam"===t?this.pushStackLiteral("blockParams["+e[0]+"].path["+e[1]+"]"+(i?" + "+JSON.stringify("."+i):"")):"PathExpression"===t?this.pushString(e):"SubExpression"===t?this.pushStackLiteral("true"):this.pushStackLiteral("null")},compiler:o,compileChildren:function(t,e){for(var i=t.children,n=void 0,o=void 0,r=0,s=i.length;r<s;r++){n=i[r],o=new this.compiler;var a=this.matchExistingProgram(n);if(null==a){this.context.programs.push("");var l=this.context.programs.length;n.index=l,n.name="program"+l,this.context.programs[l]=o.compile(n,e,this.context,!this.precompile),this.context.decorators[l]=o.decorators,this.context.environments[l]=n,this.useDepths=this.useDepths||o.useDepths,this.useBlockParams=this.useBlockParams||o.useBlockParams,n.useDepths=this.useDepths,n.useBlockParams=this.useBlockParams}else n.index=a.index,n.name="program"+a.index,this.useDepths=this.useDepths||a.useDepths,this.useBlockParams=this.useBlockParams||a.useBlockParams}},matchExistingProgram:function(t){for(var e=0,i=this.context.environments.length;e<i;e++){var n=this.context.environments[e];if(n&&n.equals(t))return n}},programExpression:function(t){var e=this.environment.children[t],i=[e.index,"data",e.blockParams];return(this.useBlockParams||this.useDepths)&&i.push("blockParams"),this.useDepths&&i.push("depths"),"container.program("+i.join(", ")+")"},useRegister:function(t){this.registers[t]||(this.registers[t]=!0,this.registers.list.push(t))},push:function(t){return t instanceof n||(t=this.source.wrap(t)),this.inlineStack.push(t),t},pushStackLiteral:function(t){this.push(new n(t))},pushSource:function(t){this.pendingContent&&(this.source.push(this.appendToBuffer(this.source.quotedString(this.pendingContent),this.pendingLocation)),this.pendingContent=void 0),t&&this.source.push(t)},replaceStack:function(t){var e=["("],i=void 0,o=void 0,r=void 0;if(!this.isInline())throw new c.default("replaceStack on non-inline");var s=this.popStack(!0);if(s instanceof n)i=[s.value],e=["(",i],r=!0;else{o=!0;var a=this.incrStack();e=["((",this.push(a)," = ",s,")"],i=this.topStack()}var l=t.call(this,i);r||this.popStack(),o&&this.stackSlot--,this.push(e.concat(l,")"))},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),this.topStackName()},topStackName:function(){return"stack"+this.stackSlot},flushInline:function(){var t=this.inlineStack;this.inlineStack=[];for(var e=0,i=t.length;e<i;e++){var o=t[e];if(o instanceof n)this.compileStack.push(o);else{var r=this.incrStack();this.pushSource([r," = ",o,";"]),this.compileStack.push(r)}}},isInline:function(){return this.inlineStack.length},popStack:function(t){var e=this.isInline(),i=(e?this.inlineStack:this.compileStack).pop();if(!t&&i instanceof n)return i.value;if(!e){if(!this.stackSlot)throw new c.default("Invalid stack pop");this.stackSlot--}return i},topStack:function(){var t=this.isInline()?this.inlineStack:this.compileStack,e=t[t.length-1];return e instanceof n?e.value:e},contextName:function(t){return this.useDepths&&t?"depths["+t+"]":"depth"+t},quotedString:function(t){return this.source.quotedString(t)},objectLiteral:function(t){return this.source.objectLiteral(t)},aliasable:function(t){var e=this.aliases[t];return e?(e.referenceCount++,e):(e=this.aliases[t]=this.source.wrap(t),e.aliasable=!0,e.referenceCount=1,e)},setupHelper:function(t,e,i){var n=[];return{params:n,paramsInit:this.setupHelperArgs(e,t,n,i),name:this.nameLookup("helpers",e,"helper"),callParams:[this.aliasable(this.contextName(0)+" != null ? "+this.contextName(0)+" : {}")].concat(n)}},setupParams:function(t,e,i){var n={},o=[],r=[],s=[],a=!i,l=void 0;a&&(i=[]),n.name=this.quotedString(t),n.hash=this.popStack(),this.trackIds&&(n.hashIds=this.popStack()),this.stringParams&&(n.hashTypes=this.popStack(),n.hashContexts=this.popStack());var c=this.popStack(),u=this.popStack();(u||c)&&(n.fn=u||"container.noop",n.inverse=c||"container.noop");for(var h=e;h--;)l=this.popStack(),i[h]=l,this.trackIds&&(s[h]=this.popStack()),this.stringParams&&(r[h]=this.popStack(),o[h]=this.popStack());return a&&(n.args=this.source.generateArray(i)),this.trackIds&&(n.ids=this.source.generateArray(s)),this.stringParams&&(n.types=this.source.generateArray(r),n.contexts=this.source.generateArray(o)),this.options.data&&(n.data="data"),this.useBlockParams&&(n.blockParams="blockParams"),n},setupHelperArgs:function(t,e,i,n){var o=this.setupParams(t,e,i);return o=this.objectLiteral(o),n?(this.useRegister("options"),i.push("options"),["options=",o]):i?(i.push(o),""):o}},function(){for(var t="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield await null true false".split(" "),e=o.RESERVED_WORDS={},i=0,n=t.length;i<n;i++)e[t[i]]=!0}(),o.isValidJavaScriptVariableName=function(t){return!o.RESERVED_WORDS[t]&&/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(t)},e.default=o,t.exports=e.default},function(t,e,i){"use strict";function n(t,e,i){if(r.isArray(t)){for(var n=[],o=0,s=t.length;o<s;o++)n.push(e.wrap(t[o],i));return n}return"boolean"==typeof t||"number"==typeof t?t+"":t}function o(t){this.srcFile=t,this.source=[]}e.__esModule=!0;var r=i(5),s=void 0;s||(s=function(t,e,i,n){this.src="",n&&this.add(n)},s.prototype={add:function(t){r.isArray(t)&&(t=t.join("")),this.src+=t},prepend:function(t){r.isArray(t)&&(t=t.join("")),this.src=t+this.src},toStringWithSourceMap:function(){return{code:this.toString()}},toString:function(){return this.src}}),o.prototype={isEmpty:function(){return!this.source.length},prepend:function(t,e){this.source.unshift(this.wrap(t,e))},push:function(t,e){this.source.push(this.wrap(t,e))},merge:function(){var t=this.empty();return this.each(function(e){t.add(["  ",e,"\n"])}),t},each:function(t){for(var e=0,i=this.source.length;e<i;e++)t(this.source[e])},empty:function(){var t=this.currentLocation||{start:{}};return new s(t.start.line,t.start.column,this.srcFile)},wrap:function(t){var e=arguments.length<=1||void 0===arguments[1]?this.currentLocation||{start:{}}:arguments[1];return t instanceof s?t:(t=n(t,this,e),new s(e.start.line,e.start.column,this.srcFile,t))},functionCall:function(t,e,i){return i=this.generateList(i),this.wrap([t,e?"."+e+"(":"(",i,")"])},quotedString:function(t){return'"'+(t+"").replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},objectLiteral:function(t){var e=[];for(var i in t)if(t.hasOwnProperty(i)){var o=n(t[i],this);"undefined"!==o&&e.push([this.quotedString(i),":",o])}var r=this.generateList(e);return r.prepend("{"),r.add("}"),r},generateList:function(t){for(var e=this.empty(),i=0,o=t.length;i<o;i++)i&&e.add(","),e.add(n(t[i],this));return e},generateArray:function(t){var e=this.generateList(t);return e.prepend("["),e.add("]"),e}},e.default=o,t.exports=e.default}])})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i.d(e,"PLAYER_DEFENDED_ATTACK_EVT",function(){return n}),i.d(e,"PLAYER_SWITCHED_TO_OFFENSE_EVT",function(){return o}),i.d(e,"PLAYER_USED_SKILL_EVT",function(){return r}),i.d(e,"SCENE_TRANSITION_EVT",function(){return s}),i.d(e,"TRAINING_TUTORIAL_COMPLETED_EVT",function(){return a}),i.d(e,"BATTLE_VICTORY_COND",function(){return l}),i.d(e,"BATTLE_DEFEAT_COND",function(){return c}),i.d(e,"SID_TRAINING1",function(){return u}),i.d(e,"SID_TRAINING2",function(){return h}),i.d(e,"SID_TRAINING3",function(){return m}),i.d(e,"SID_BABY_SLIME",function(){return p}),i.d(e,"SID_SLIME_BLAST",function(){return f}),i.d(e,"SID_PROTOTYPE_BATTLE",function(){return _}),i.d(e,"SID_PL_LOSE",function(){return y}),i.d(e,"TRN_FADEOUT",function(){return d}),i.d(e,"TRN_NEXT",function(){return v}),i.d(e,"TRN_LOSE",function(){return g});var n="player_defended_attack",o="player_switched_to_offensive_stance",r="player_used_a_skill",s="scene_transition",a="tutorial_completed",l="victory",c="defeat",u="training_scene_1",h="training_scene_2",m="training_scene_3",p="baby_slime",f="slime_blaster",_="prototype_battle",y="player_lose_scene",d="fadeout",v="next",g="lose"},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(17);i.d(e,"SOUND_LETTER_TYPED",function(){return o}),i.d(e,"SOUND_SWORD_SLASH",function(){return r}),i.d(e,"SOUNDS",function(){return s});var o="LETTER_TYPED",r="SWORD_SLASH",s={LETTER_TYPED:n.SND_TYPEWRITER,SWORD_SLASH:n.SND_SWORD_SWIPE}},function(t,e,i){!function(){var i={VERSION:"2.4.0",Result:{SUCCEEDED:1,NOTRANSITION:2,CANCELLED:3,PENDING:4},Error:{INVALID_TRANSITION:100,PENDING_TRANSITION:200,INVALID_CALLBACK:300},WILDCARD:"*",ASYNC:"async",create:function(t,e){var n="string"==typeof t.initial?{state:t.initial}:t.initial,o=t.terminal||t.final,r=e||t.target||{},s=t.events||[],a=t.callbacks||{},l={},c={},u=function(t){var e=Array.isArray(t.from)?t.from:t.from?[t.from]:[i.WILDCARD];l[t.name]=l[t.name]||{};for(var n=0;n<e.length;n++)c[e[n]]=c[e[n]]||[],c[e[n]].push(t.name),l[t.name][e[n]]=t.to||e[n];t.to&&(c[t.to]=c[t.to]||[])};n&&(n.event=n.event||"startup",u({name:n.event,from:"none",to:n.state}));for(var h=0;h<s.length;h++)u(s[h]);for(var m in l)l.hasOwnProperty(m)&&(r[m]=i.buildEvent(m,l[m]));for(var m in a)a.hasOwnProperty(m)&&(r[m]=a[m]);return r.current="none",r.is=function(t){return Array.isArray(t)?t.indexOf(this.current)>=0:this.current===t},r.can=function(t){return!this.transition&&void 0!==l[t]&&(l[t].hasOwnProperty(this.current)||l[t].hasOwnProperty(i.WILDCARD))},r.cannot=function(t){return!this.can(t)},r.transitions=function(){return(c[this.current]||[]).concat(c[i.WILDCARD]||[])},r.isFinished=function(){return this.is(o)},r.error=t.error||function(t,e,i,n,o,r,s){throw s||r},r.states=function(){return Object.keys(c).sort()},n&&!n.defer&&r[n.event](),r},doCallback:function(t,e,n,o,r,s){if(e)try{return e.apply(t,[n,o,r].concat(s))}catch(e){return t.error(n,o,r,s,i.Error.INVALID_CALLBACK,"an exception occurred in a caller-provided callback function",e)}},beforeAnyEvent:function(t,e,n,o,r){return i.doCallback(t,t.onbeforeevent,e,n,o,r)},afterAnyEvent:function(t,e,n,o,r){return i.doCallback(t,t.onafterevent||t.onevent,e,n,o,r)},leaveAnyState:function(t,e,n,o,r){return i.doCallback(t,t.onleavestate,e,n,o,r)},enterAnyState:function(t,e,n,o,r){return i.doCallback(t,t.onenterstate||t.onstate,e,n,o,r)},changeState:function(t,e,n,o,r){return i.doCallback(t,t.onchangestate,e,n,o,r)},beforeThisEvent:function(t,e,n,o,r){return i.doCallback(t,t["onbefore"+e],e,n,o,r)},afterThisEvent:function(t,e,n,o,r){return i.doCallback(t,t["onafter"+e]||t["on"+e],e,n,o,r)},leaveThisState:function(t,e,n,o,r){return i.doCallback(t,t["onleave"+n],e,n,o,r)},enterThisState:function(t,e,n,o,r){return i.doCallback(t,t["onenter"+o]||t["on"+o],e,n,o,r)},beforeEvent:function(t,e,n,o,r){if(!1===i.beforeThisEvent(t,e,n,o,r)||!1===i.beforeAnyEvent(t,e,n,o,r))return!1},afterEvent:function(t,e,n,o,r){i.afterThisEvent(t,e,n,o,r),i.afterAnyEvent(t,e,n,o,r)},leaveState:function(t,e,n,o,r){var s=i.leaveThisState(t,e,n,o,r),a=i.leaveAnyState(t,e,n,o,r);return!1!==s&&!1!==a&&(i.ASYNC===s||i.ASYNC===a?i.ASYNC:void 0)},enterState:function(t,e,n,o,r){i.enterThisState(t,e,n,o,r),i.enterAnyState(t,e,n,o,r)},buildEvent:function(t,e){return function(){var n=this.current,o=e[n]||(e[i.WILDCARD]!=i.WILDCARD?e[i.WILDCARD]:n)||n,r=Array.prototype.slice.call(arguments);if(this.transition)return this.error(t,n,o,r,i.Error.PENDING_TRANSITION,"event "+t+" inappropriate because previous transition did not complete");if(this.cannot(t))return this.error(t,n,o,r,i.Error.INVALID_TRANSITION,"event "+t+" inappropriate in current state "+this.current);if(!1===i.beforeEvent(this,t,n,o,r))return i.Result.CANCELLED;if(n===o)return i.afterEvent(this,t,n,o,r),i.Result.NOTRANSITION;var s=this;this.transition=function(){return s.transition=null,s.current=o,i.enterState(s,t,n,o,r),i.changeState(s,t,n,o,r),i.afterEvent(s,t,n,o,r),i.Result.SUCCEEDED},this.transition.cancel=function(){s.transition=null,i.afterEvent(s,t,n,o,r)};var a=i.leaveState(this,t,n,o,r);return!1===a?(this.transition=null,i.Result.CANCELLED):i.ASYNC===a?i.Result.PENDING:this.transition?this.transition():void 0}}};void 0!==t&&t.exports&&(e=t.exports=i),e.StateMachine=i}()},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i.d(e,"ANIM_READY",function(){return n}),i.d(e,"ANIM_LIGHT_ATTACK",function(){return o}),i.d(e,"ANIM_MED_ATTACK",function(){return r}),i.d(e,"ANIM_HEAVY_ATTACK",function(){return s}),i.d(e,"ANIM_SPECIAL_ATTACK",function(){return a}),i.d(e,"ANIM_GUARD",function(){return l}),i.d(e,"ANIM_DASH",function(){return c}),i.d(e,"ANIM_JUMP",function(){return u}),i.d(e,"ANIM_ENTER",function(){return h}),i.d(e,"ANIM_CHARGE",function(){return m}),i.d(e,"ANIM_HIT",function(){return p});var n="ANIM_READY",o="ANIM_LIGHT_ATTACK",r="ANIM_MED_ATTACK",s="ANIM_HEAVY_ATTACK",a="ANIM_SPECIAL_ATTACK",l="ANIM_GUARD",c="ANIM_DASH",u="ANIM_JUMP",h="ANIM_ENTER",m="ANIM_CHARGE",p="ANIM_HIT"},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){s&&console.log(t,e)}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=!1,a=function(){function t(){n(this,t)}return r(t,null,[{key:"retrieve",value:function(t,e){if(!t)throw"ERROR: TextLibrarian.retrieve called without a text library";return e||(e={}),this.getTextFromLibrary(t,e)}},{key:"getTextFromLibrary",value:function(t,e){var i,n,r,s,a;for(o("DEBUG: BEGIN LIB REQ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~"),o("DEBUG: options are ---->",e),i=[],s=_.sample(t),n=t.indexOf(s),r=0,i.push(s),a=e.minLength&&e.maxLength?_.random(e.minLength,e.maxLength):e.minLength,o("DEBUG: target length determined as ---->",a);;){if(r+=1,this.lengthOfOutputString(i)>a)return o("DEBUG: finished building string from library -----------> ",i),o("DEBUG: END LIB REQ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~"),o("~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~"),i.join(" ");if(n+1>t.length){var l=_.sample(t);n=t.indexOf(l),i.push(l)}else i.push(t[++n]);if(r>=20)return i.join(" ")}}},{key:"lengthOfOutputString",value:function(t){return t.join(" ").length}}]),t}();e.default=a},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(3),o=i(4);Crafty.c("TextFragment",{_correct_characters:"",_current_position:null,_incorrect_characters:"",_text:"",_textFragFsm:null,textFragment:function(t){return this._initTextFragFsm(),this._text=t,this},activate:function(){this._textFragFsm.activate()},complete:function(){this._textFragFsm.finish()},errorCount:function(){return this._incorrect_characters.length},getCorrectCharacters:function(){return this._correct_characters},getIncorrectCharacters:function(){return this._incorrect_characters},getNextChar:function(){return this._text[this._current_position]},getRemainingCharacters:function(){return this.getText().slice(this._current_position)},getText:function(){return this._text},getTextStatus:function(){return{typed:this.getCorrectCharacters()||"",missed:this.getIncorrectCharacters()||"",rest:this.getRemainingCharacters()||""}},isActive:function(){return this._textFragFsm.is("active")},isComplete:function(){return this._textFragFsm.is("completed")},isCooling:function(){return this._textFragFsm.is("cooling")},isProcessed:function(){return this._textFragFsm.is("processed")},processed:function(){return this._textFragFsm.process()},textLength:function(){return this._text.length},matchFirstChar:function(t){return this._text[0]==t},matchNextChar:function(t){return this.getNextChar()==t},restart:function(){this._textFragFsm.restart()},setText:function(t){this._text=t},successPct:function(){return this.isComplete()?100*(1-this._incorrect_characters.length/this._correct_characters.length):(this._correct_characters.length-this._incorrect_characters.length)/this._text.length*100},takeInput:function(t){return this._text[this._current_position]==t?(this._correctInput(),this._checkForCompletion(),this._triggerRedraw(),!0):(this._wrongInput(t),this._triggerRedraw(),!1)},wasPerfect:function(){return this.successPct()>=99.9},_checkForCompletion:function(){this._correct_characters.length==this._text.length&&this.complete()},_clearTimestamps:function(){this.completed_at=null,this.started_at=null},_correctInput:function(t){this._correct_characters+=this._text[this._current_position],this._current_position++,Crafty.trigger("PlaySound",n.SOUND_LETTER_TYPED)},_getClasses:function(){return this._classes.concat(this._classesFunc(this._currentTime()))},_getClassesForDom:function(){return _.reduce(this._getClasses(),function(t,e){return t+" "+e},"")},_initTextFragFsm:function(){var t=this;this._textFragFsm=o.create({initial:"ready",events:[{name:"activate",from:"ready",to:"active"},{name:"finish",from:"active",to:"completed"},{name:"process",from:"completed",to:"processed"},{name:"restart",from:"completed",to:"ready"},{name:"restart",from:"processed",to:"ready"},{name:"cancel",from:"active",to:"ready"}],callbacks:{onactivate:function(e,i,n){t._onActivate()},oncomplete:function(e,i,n){t._onComplete()},onrestart:function(e,i,n){t._onRestart()},oncancel:function(e,i,n){t._onRestart()}}})},_onActivate:function(){this._current_position=0,this._tagStartedTimestamp(),this.z=99999,Crafty.trigger("TextFragmentActivated",this),this._triggerRedraw()},_onComplete:function(){console.log("DEBUG: TEXT FRAGMENT COMPONENT _COMPLETE ~~~~~~~~"),this._tagCompletedTimestamp(),this._triggerRedraw(),Crafty.trigger("TextFragmentCompleted",this),this.trigger("TextFragmentCompleted")},_onRestart:function(){this._incorrect_characters="",this._correct_characters="",this._current_position=null,this._clearTimestamps(),this._triggerRedraw()},_tagStartedTimestamp:function(){this.started_at=new Date},_tagCompletedTimestamp:function(){this.completed_at=new Date},_triggerRedraw:function(){this.trigger("TextFragmentRedraw")},_wrongInput:function(t){this._incorrect_characters+=t,this.trigger("InputIncorrect")}})},function(t,e){var i;i=function(){return this}();try{i=i||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(i=window)}t.exports=i},function(t,e,i){var n,o;!function(e,i){"use strict";"object"==typeof t&&"object"==typeof t.exports?t.exports=e.document?i(e,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return i(t)}:i(e)}("undefined"!=typeof window?window:this,function(i,r){"use strict";function s(t,e){e=e||st;var i=e.createElement("script");i.text=t,e.head.appendChild(i).parentNode.removeChild(i)}function a(t){var e=!!t&&"length"in t&&t.length,i=vt.type(t);return"function"!==i&&!vt.isWindow(t)&&("array"===i||0===e||"number"==typeof e&&e>0&&e-1 in t)}function l(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()}function c(t,e,i){return vt.isFunction(e)?vt.grep(t,function(t,n){return!!e.call(t,n,t)!==i}):e.nodeType?vt.grep(t,function(t){return t===e!==i}):"string"!=typeof e?vt.grep(t,function(t){return ht.call(e,t)>-1!==i}):At.test(e)?vt.filter(e,t,i):(e=vt.filter(e,t),vt.grep(t,function(t){return ht.call(e,t)>-1!==i&&1===t.nodeType}))}function u(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}function h(t){var e={};return vt.each(t.match(It)||[],function(t,i){e[i]=!0}),e}function m(t){return t}function p(t){throw t}function f(t,e,i,n){var o;try{t&&vt.isFunction(o=t.promise)?o.call(t).done(e).fail(i):t&&vt.isFunction(o=t.then)?o.call(t,e,i):e.apply(void 0,[t].slice(n))}catch(t){i.apply(void 0,[t])}}function _(){st.removeEventListener("DOMContentLoaded",_),i.removeEventListener("load",_),vt.ready()}function y(){this.expando=vt.expando+y.uid++}function d(t){return"true"===t||"false"!==t&&("null"===t?null:t===+t+""?+t:Nt.test(t)?JSON.parse(t):t)}function v(t,e,i){var n;if(void 0===i&&1===t.nodeType)if(n="data-"+e.replace(Ft,"-$&").toLowerCase(),"string"==typeof(i=t.getAttribute(n))){try{i=d(i)}catch(t){}Rt.set(t,e,i)}else i=void 0;return i}function g(t,e,i,n){var o,r=1,s=20,a=n?function(){return n.cur()}:function(){return vt.css(t,e,"")},l=a(),c=i&&i[3]||(vt.cssNumber[e]?"":"px"),u=(vt.cssNumber[e]||"px"!==c&&+l)&&Gt.exec(vt.css(t,e));if(u&&u[3]!==c){c=c||u[3],i=i||[],u=+l||1;do{r=r||".5",u/=r,vt.style(t,e,u+c)}while(r!==(r=a()/l)&&1!==r&&--s)}return i&&(u=+u||+l||0,o=i[1]?u+(i[1]+1)*i[2]:+i[2],n&&(n.unit=c,n.start=u,n.end=o)),o}function x(t){var e,i=t.ownerDocument,n=t.nodeName,o=Ht[n];return o||(e=i.body.appendChild(i.createElement(n)),o=vt.css(e,"display"),e.parentNode.removeChild(e),"none"===o&&(o="block"),Ht[n]=o,o)}function b(t,e){for(var i,n,o=[],r=0,s=t.length;r<s;r++)n=t[r],n.style&&(i=n.style.display,e?("none"===i&&(o[r]=Lt.get(n,"display")||null,o[r]||(n.style.display="")),""===n.style.display&&jt(n)&&(o[r]=x(n))):"none"!==i&&(o[r]="none",Lt.set(n,"display",i)));for(r=0;r<s;r++)null!=o[r]&&(t[r].style.display=o[r]);return t}function C(t,e){var i;return i=void 0!==t.getElementsByTagName?t.getElementsByTagName(e||"*"):void 0!==t.querySelectorAll?t.querySelectorAll(e||"*"):[],void 0===e||e&&l(t,e)?vt.merge([t],i):i}function S(t,e){for(var i=0,n=t.length;i<n;i++)Lt.set(t[i],"globalEval",!e||Lt.get(e[i],"globalEval"))}function w(t,e,i,n,o){for(var r,s,a,l,c,u,h=e.createDocumentFragment(),m=[],p=0,f=t.length;p<f;p++)if((r=t[p])||0===r)if("object"===vt.type(r))vt.merge(m,r.nodeType?[r]:r);else if(Kt.test(r)){for(s=s||h.appendChild(e.createElement("div")),a=(Ut.exec(r)||["",""])[1].toLowerCase(),l=$t[a]||$t._default,s.innerHTML=l[1]+vt.htmlPrefilter(r)+l[2],u=l[0];u--;)s=s.lastChild;vt.merge(m,s.childNodes),s=h.firstChild,s.textContent=""}else m.push(e.createTextNode(r));for(h.textContent="",p=0;r=m[p++];)if(n&&vt.inArray(r,n)>-1)o&&o.push(r);else if(c=vt.contains(r.ownerDocument,r),s=C(h.appendChild(r),"script"),c&&S(s),i)for(u=0;r=s[u++];)Wt.test(r.type||"")&&i.push(r);return h}function A(){return!0}function D(){return!1}function M(){try{return st.activeElement}catch(t){}}function k(t,e,i,n,o,r){var s,a;if("object"==typeof e){"string"!=typeof i&&(n=n||i,i=void 0);for(a in e)k(t,a,i,n,e[a],r);return t}if(null==n&&null==o?(o=i,n=i=void 0):null==o&&("string"==typeof i?(o=n,n=void 0):(o=n,n=i,i=void 0)),!1===o)o=D;else if(!o)return t;return 1===r&&(s=o,o=function(t){return vt().off(t),s.apply(this,arguments)},o.guid=s.guid||(s.guid=vt.guid++)),t.each(function(){vt.event.add(this,e,o,n,i)})}function B(t,e){return l(t,"table")&&l(11!==e.nodeType?e:e.firstChild,"tr")?vt(">tbody",t)[0]||t:t}function I(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function P(t){var e=ie.exec(t.type);return e?t.type=e[1]:t.removeAttribute("type"),t}function T(t,e){var i,n,o,r,s,a,l,c;if(1===e.nodeType){if(Lt.hasData(t)&&(r=Lt.access(t),s=Lt.set(e,r),c=r.events)){delete s.handle,s.events={};for(o in c)for(i=0,n=c[o].length;i<n;i++)vt.event.add(e,o,c[o][i])}Rt.hasData(t)&&(a=Rt.access(t),l=vt.extend({},a),Rt.set(e,l))}}function E(t,e){var i=e.nodeName.toLowerCase();"input"===i&&qt.test(t.type)?e.checked=t.checked:"input"!==i&&"textarea"!==i||(e.defaultValue=t.defaultValue)}function V(t,e,i,n){e=ct.apply([],e);var o,r,a,l,c,u,h=0,m=t.length,p=m-1,f=e[0],_=vt.isFunction(f);if(_||m>1&&"string"==typeof f&&!dt.checkClone&&ee.test(f))return t.each(function(o){var r=t.eq(o);_&&(e[0]=f.call(this,o,r.html())),V(r,e,i,n)});if(m&&(o=w(e,t[0].ownerDocument,!1,t,n),r=o.firstChild,1===o.childNodes.length&&(o=r),r||n)){for(a=vt.map(C(o,"script"),I),l=a.length;h<m;h++)c=o,h!==p&&(c=vt.clone(c,!0,!0),l&&vt.merge(a,C(c,"script"))),i.call(t[h],c,h);if(l)for(u=a[a.length-1].ownerDocument,vt.map(a,P),h=0;h<l;h++)c=a[h],Wt.test(c.type||"")&&!Lt.access(c,"globalEval")&&vt.contains(u,c)&&(c.src?vt._evalUrl&&vt._evalUrl(c.src):s(c.textContent.replace(ne,""),u))}return t}function L(t,e,i){for(var n,o=e?vt.filter(e,t):t,r=0;null!=(n=o[r]);r++)i||1!==n.nodeType||vt.cleanData(C(n)),n.parentNode&&(i&&vt.contains(n.ownerDocument,n)&&S(C(n,"script")),n.parentNode.removeChild(n));return t}function R(t,e,i){var n,o,r,s,a=t.style;return i=i||se(t),i&&(s=i.getPropertyValue(e)||i[e],""!==s||vt.contains(t.ownerDocument,t)||(s=vt.style(t,e)),!dt.pixelMarginRight()&&re.test(s)&&oe.test(e)&&(n=a.width,o=a.minWidth,r=a.maxWidth,a.minWidth=a.maxWidth=a.width=s,s=i.width,a.width=n,a.minWidth=o,a.maxWidth=r)),void 0!==s?s+"":s}function N(t,e){return{get:function(){return t()?void delete this.get:(this.get=e).apply(this,arguments)}}}function F(t){if(t in me)return t;for(var e=t[0].toUpperCase()+t.slice(1),i=he.length;i--;)if((t=he[i]+e)in me)return t}function O(t){var e=vt.cssProps[t];return e||(e=vt.cssProps[t]=F(t)||t),e}function G(t,e,i){var n=Gt.exec(e);return n?Math.max(0,n[2]-(i||0))+(n[3]||"px"):e}function J(t,e,i,n,o){var r,s=0;for(r=i===(n?"border":"content")?4:"width"===e?1:0;r<4;r+=2)"margin"===i&&(s+=vt.css(t,i+Jt[r],!0,o)),n?("content"===i&&(s-=vt.css(t,"padding"+Jt[r],!0,o)),"margin"!==i&&(s-=vt.css(t,"border"+Jt[r]+"Width",!0,o))):(s+=vt.css(t,"padding"+Jt[r],!0,o),"padding"!==i&&(s+=vt.css(t,"border"+Jt[r]+"Width",!0,o)));return s}function j(t,e,i){var n,o=se(t),r=R(t,e,o),s="border-box"===vt.css(t,"boxSizing",!1,o);return re.test(r)?r:(n=s&&(dt.boxSizingReliable()||r===t.style[e]),"auto"===r&&(r=t["offset"+e[0].toUpperCase()+e.slice(1)]),(r=parseFloat(r)||0)+J(t,e,i||(s?"border":"content"),n,o)+"px")}function z(t,e,i,n,o){return new z.prototype.init(t,e,i,n,o)}function H(){fe&&(!1===st.hidden&&i.requestAnimationFrame?i.requestAnimationFrame(H):i.setTimeout(H,vt.fx.interval),vt.fx.tick())}function q(){return i.setTimeout(function(){pe=void 0}),pe=vt.now()}function U(t,e){var i,n=0,o={height:t};for(e=e?1:0;n<4;n+=2-e)i=Jt[n],o["margin"+i]=o["padding"+i]=t;return e&&(o.opacity=o.width=t),o}function W(t,e,i){for(var n,o=(Y.tweeners[e]||[]).concat(Y.tweeners["*"]),r=0,s=o.length;r<s;r++)if(n=o[r].call(i,e,t))return n}function $(t,e,i){var n,o,r,s,a,l,c,u,h="width"in e||"height"in e,m=this,p={},f=t.style,_=t.nodeType&&jt(t),y=Lt.get(t,"fxshow");i.queue||(s=vt._queueHooks(t,"fx"),null==s.unqueued&&(s.unqueued=0,a=s.empty.fire,s.empty.fire=function(){s.unqueued||a()}),s.unqueued++,m.always(function(){m.always(function(){s.unqueued--,vt.queue(t,"fx").length||s.empty.fire()})}));for(n in e)if(o=e[n],_e.test(o)){if(delete e[n],r=r||"toggle"===o,o===(_?"hide":"show")){if("show"!==o||!y||void 0===y[n])continue;_=!0}p[n]=y&&y[n]||vt.style(t,n)}if((l=!vt.isEmptyObject(e))||!vt.isEmptyObject(p)){h&&1===t.nodeType&&(i.overflow=[f.overflow,f.overflowX,f.overflowY],c=y&&y.display,null==c&&(c=Lt.get(t,"display")),u=vt.css(t,"display"),"none"===u&&(c?u=c:(b([t],!0),c=t.style.display||c,u=vt.css(t,"display"),b([t]))),("inline"===u||"inline-block"===u&&null!=c)&&"none"===vt.css(t,"float")&&(l||(m.done(function(){f.display=c}),null==c&&(u=f.display,c="none"===u?"":u)),f.display="inline-block")),i.overflow&&(f.overflow="hidden",m.always(function(){f.overflow=i.overflow[0],f.overflowX=i.overflow[1],f.overflowY=i.overflow[2]})),l=!1;for(n in p)l||(y?"hidden"in y&&(_=y.hidden):y=Lt.access(t,"fxshow",{display:c}),r&&(y.hidden=!_),_&&b([t],!0),m.done(function(){_||b([t]),Lt.remove(t,"fxshow");for(n in p)vt.style(t,n,p[n])})),l=W(_?y[n]:0,n,m),n in y||(y[n]=l.start,_&&(l.end=l.start,l.start=0))}}function K(t,e){var i,n,o,r,s;for(i in t)if(n=vt.camelCase(i),o=e[n],r=t[i],Array.isArray(r)&&(o=r[1],r=t[i]=r[0]),i!==n&&(t[n]=r,delete t[i]),(s=vt.cssHooks[n])&&"expand"in s){r=s.expand(r),delete t[n];for(i in r)i in t||(t[i]=r[i],e[i]=o)}else e[n]=o}function Y(t,e,i){var n,o,r=0,s=Y.prefilters.length,a=vt.Deferred().always(function(){delete l.elem}),l=function(){if(o)return!1;for(var e=pe||q(),i=Math.max(0,c.startTime+c.duration-e),n=i/c.duration||0,r=1-n,s=0,l=c.tweens.length;s<l;s++)c.tweens[s].run(r);return a.notifyWith(t,[c,r,i]),r<1&&l?i:(l||a.notifyWith(t,[c,1,0]),a.resolveWith(t,[c]),!1)},c=a.promise({elem:t,props:vt.extend({},e),opts:vt.extend(!0,{specialEasing:{},easing:vt.easing._default},i),originalProperties:e,originalOptions:i,startTime:pe||q(),duration:i.duration,tweens:[],createTween:function(e,i){var n=vt.Tween(t,c.opts,e,i,c.opts.specialEasing[e]||c.opts.easing);return c.tweens.push(n),n},stop:function(e){var i=0,n=e?c.tweens.length:0;if(o)return this;for(o=!0;i<n;i++)c.tweens[i].run(1);return e?(a.notifyWith(t,[c,1,0]),a.resolveWith(t,[c,e])):a.rejectWith(t,[c,e]),this}}),u=c.props;for(K(u,c.opts.specialEasing);r<s;r++)if(n=Y.prefilters[r].call(c,t,u,c.opts))return vt.isFunction(n.stop)&&(vt._queueHooks(c.elem,c.opts.queue).stop=vt.proxy(n.stop,n)),n;return vt.map(u,W,c),vt.isFunction(c.opts.start)&&c.opts.start.call(t,c),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always),vt.fx.timer(vt.extend(l,{elem:t,anim:c,queue:c.opts.queue})),c}function X(t){return(t.match(It)||[]).join(" ")}function Z(t){return t.getAttribute&&t.getAttribute("class")||""}function Q(t,e,i,n){var o;if(Array.isArray(e))vt.each(e,function(e,o){i||Ae.test(t)?n(t,o):Q(t+"["+("object"==typeof o&&null!=o?e:"")+"]",o,i,n)});else if(i||"object"!==vt.type(e))n(t,e);else for(o in e)Q(t+"["+o+"]",e[o],i,n)}function tt(t){return function(e,i){"string"!=typeof e&&(i=e,e="*");var n,o=0,r=e.toLowerCase().match(It)||[];if(vt.isFunction(i))for(;n=r[o++];)"+"===n[0]?(n=n.slice(1)||"*",(t[n]=t[n]||[]).unshift(i)):(t[n]=t[n]||[]).push(i)}}function et(t,e,i,n){function o(a){var l;return r[a]=!0,vt.each(t[a]||[],function(t,a){var c=a(e,i,n);return"string"!=typeof c||s||r[c]?s?!(l=c):void 0:(e.dataTypes.unshift(c),o(c),!1)}),l}var r={},s=t===Te;return o(e.dataTypes[0])||!r["*"]&&o("*")}function it(t,e){var i,n,o=vt.ajaxSettings.flatOptions||{};for(i in e)void 0!==e[i]&&((o[i]?t:n||(n={}))[i]=e[i]);return n&&vt.extend(!0,t,n),t}function nt(t,e,i){for(var n,o,r,s,a=t.contents,l=t.dataTypes;"*"===l[0];)l.shift(),void 0===n&&(n=t.mimeType||e.getResponseHeader("Content-Type"));if(n)for(o in a)if(a[o]&&a[o].test(n)){l.unshift(o);break}if(l[0]in i)r=l[0];else{for(o in i){if(!l[0]||t.converters[o+" "+l[0]]){r=o;break}s||(s=o)}r=r||s}if(r)return r!==l[0]&&l.unshift(r),i[r]}function ot(t,e,i,n){var o,r,s,a,l,c={},u=t.dataTypes.slice();if(u[1])for(s in t.converters)c[s.toLowerCase()]=t.converters[s];for(r=u.shift();r;)if(t.responseFields[r]&&(i[t.responseFields[r]]=e),!l&&n&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),l=r,r=u.shift())if("*"===r)r=l;else if("*"!==l&&l!==r){if(!(s=c[l+" "+r]||c["* "+r]))for(o in c)if(a=o.split(" "),a[1]===r&&(s=c[l+" "+a[0]]||c["* "+a[0]])){!0===s?s=c[o]:!0!==c[o]&&(r=a[0],u.unshift(a[1]));break}if(!0!==s)if(s&&t.throws)e=s(e);else try{e=s(e)}catch(t){return{state:"parsererror",error:s?t:"No conversion from "+l+" to "+r}}}return{state:"success",data:e}}var rt=[],st=i.document,at=Object.getPrototypeOf,lt=rt.slice,ct=rt.concat,ut=rt.push,ht=rt.indexOf,mt={},pt=mt.toString,ft=mt.hasOwnProperty,_t=ft.toString,yt=_t.call(Object),dt={},vt=function(t,e){return new vt.fn.init(t,e)},gt=function(t,e){return e.toUpperCase()};vt.fn=vt.prototype={jquery:"3.2.1",constructor:vt,length:0,toArray:function(){return lt.call(this)},get:function(t){return null==t?lt.call(this):t<0?this[t+this.length]:this[t]},pushStack:function(t){var e=vt.merge(this.constructor(),t);return e.prevObject=this,e},each:function(t){return vt.each(this,t)},map:function(t){return this.pushStack(vt.map(this,function(e,i){return t.call(e,i,e)}))},slice:function(){return this.pushStack(lt.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,i=+t+(t<0?e:0);return this.pushStack(i>=0&&i<e?[this[i]]:[])},end:function(){return this.prevObject||this.constructor()},push:ut,sort:rt.sort,splice:rt.splice},vt.extend=vt.fn.extend=function(){var t,e,i,n,o,r,s=arguments[0]||{},a=1,l=arguments.length,c=!1;for("boolean"==typeof s&&(c=s,s=arguments[a]||{},a++),"object"==typeof s||vt.isFunction(s)||(s={}),a===l&&(s=this,a--);a<l;a++)if(null!=(t=arguments[a]))for(e in t)i=s[e],n=t[e],s!==n&&(c&&n&&(vt.isPlainObject(n)||(o=Array.isArray(n)))?(o?(o=!1,r=i&&Array.isArray(i)?i:[]):r=i&&vt.isPlainObject(i)?i:{},s[e]=vt.extend(c,r,n)):void 0!==n&&(s[e]=n));return s},vt.extend({expando:"jQuery"+("3.2.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isFunction:function(t){return"function"===vt.type(t)},isWindow:function(t){return null!=t&&t===t.window},isNumeric:function(t){var e=vt.type(t);return("number"===e||"string"===e)&&!isNaN(t-parseFloat(t))},isPlainObject:function(t){var e,i;return!(!t||"[object Object]"!==pt.call(t))&&(!(e=at(t))||"function"==typeof(i=ft.call(e,"constructor")&&e.constructor)&&_t.call(i)===yt)},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},type:function(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?mt[pt.call(t)]||"object":typeof t},globalEval:function(t){s(t)},camelCase:function(t){return t.replace(/^-ms-/,"ms-").replace(/-([a-z])/g,gt)},each:function(t,e){var i,n=0;if(a(t))for(i=t.length;n<i&&!1!==e.call(t[n],n,t[n]);n++);else for(n in t)if(!1===e.call(t[n],n,t[n]))break;return t},trim:function(t){return null==t?"":(t+"").replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},makeArray:function(t,e){var i=e||[];return null!=t&&(a(Object(t))?vt.merge(i,"string"==typeof t?[t]:t):ut.call(i,t)),i},inArray:function(t,e,i){return null==e?-1:ht.call(e,t,i)},merge:function(t,e){for(var i=+e.length,n=0,o=t.length;n<i;n++)t[o++]=e[n];return t.length=o,t},grep:function(t,e,i){for(var n=[],o=0,r=t.length,s=!i;o<r;o++)!e(t[o],o)!==s&&n.push(t[o]);return n},map:function(t,e,i){var n,o,r=0,s=[];if(a(t))for(n=t.length;r<n;r++)null!=(o=e(t[r],r,i))&&s.push(o);else for(r in t)null!=(o=e(t[r],r,i))&&s.push(o);return ct.apply([],s)},guid:1,proxy:function(t,e){var i,n,o;if("string"==typeof e&&(i=t[e],e=t,t=i),vt.isFunction(t))return n=lt.call(arguments,2),o=function(){return t.apply(e||this,n.concat(lt.call(arguments)))},o.guid=t.guid=t.guid||vt.guid++,o},now:Date.now,support:dt}),"function"==typeof Symbol&&(vt.fn[Symbol.iterator]=rt[Symbol.iterator]),vt.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(t,e){mt["[object "+e+"]"]=e.toLowerCase()});var xt=function(t){function e(t,e,i,n){var o,r,s,a,l,u,m,p=e&&e.ownerDocument,f=e?e.nodeType:9;if(i=i||[],"string"!=typeof t||!t||1!==f&&9!==f&&11!==f)return i;if(!n&&((e?e.ownerDocument||e:O)!==P&&I(e),e=e||P,E)){if(11!==f&&(l=_t.exec(t)))if(o=l[1]){if(9===f){if(!(s=e.getElementById(o)))return i;if(s.id===o)return i.push(s),i}else if(p&&(s=p.getElementById(o))&&N(e,s)&&s.id===o)return i.push(s),i}else{if(l[2])return Y.apply(i,e.getElementsByTagName(t)),i;if((o=l[3])&&x.getElementsByClassName&&e.getElementsByClassName)return Y.apply(i,e.getElementsByClassName(o)),i}if(x.qsa&&!H[t+" "]&&(!V||!V.test(t))){if(1!==f)p=e,m=t;else if("object"!==e.nodeName.toLowerCase()){for((a=e.getAttribute("id"))?a=a.replace(gt,xt):e.setAttribute("id",a=F),u=w(t),r=u.length;r--;)u[r]="#"+a+" "+h(u[r]);m=u.join(","),p=yt.test(t)&&c(e.parentNode)||e}if(m)try{return Y.apply(i,p.querySelectorAll(m)),i}catch(t){}finally{a===F&&e.removeAttribute("id")}}}return D(t.replace(rt,"$1"),e,i,n)}function i(){function t(i,n){return e.push(i+" ")>b.cacheLength&&delete t[e.shift()],t[i+" "]=n}var e=[];return t}function n(t){return t[F]=!0,t}function o(t){var e=P.createElement("fieldset");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function r(t,e){for(var i=t.split("|"),n=i.length;n--;)b.attrHandle[i[n]]=e}function s(t,e){var i=e&&t,n=i&&1===t.nodeType&&1===e.nodeType&&t.sourceIndex-e.sourceIndex;if(n)return n;if(i)for(;i=i.nextSibling;)if(i===e)return-1;return t?1:-1}function a(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&Ct(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function l(t){return n(function(e){return e=+e,n(function(i,n){for(var o,r=t([],i.length,e),s=r.length;s--;)i[o=r[s]]&&(i[o]=!(n[o]=i[o]))})})}function c(t){return t&&void 0!==t.getElementsByTagName&&t}function u(){}function h(t){for(var e=0,i=t.length,n="";e<i;e++)n+=t[e].value;return n}function m(t,e,i){var n=e.dir,o=e.next,r=o||n,s=i&&"parentNode"===r,a=J++;return e.first?function(e,i,o){for(;e=e[n];)if(1===e.nodeType||s)return t(e,i,o);return!1}:function(e,i,l){var c,u,h,m=[G,a];if(l){for(;e=e[n];)if((1===e.nodeType||s)&&t(e,i,l))return!0}else for(;e=e[n];)if(1===e.nodeType||s)if(h=e[F]||(e[F]={}),u=h[e.uniqueID]||(h[e.uniqueID]={}),o&&o===e.nodeName.toLowerCase())e=e[n]||e;else{if((c=u[r])&&c[0]===G&&c[1]===a)return m[2]=c[2];if(u[r]=m,m[2]=t(e,i,l))return!0}return!1}}function p(t){return t.length>1?function(e,i,n){for(var o=t.length;o--;)if(!t[o](e,i,n))return!1;return!0}:t[0]}function f(t,i,n){for(var o=0,r=i.length;o<r;o++)e(t,i[o],n);return n}function _(t,e,i,n,o){for(var r,s=[],a=0,l=t.length,c=null!=e;a<l;a++)(r=t[a])&&(i&&!i(r,n,o)||(s.push(r),c&&e.push(a)));return s}function y(t,e,i,o,r,s){return o&&!o[F]&&(o=y(o)),r&&!r[F]&&(r=y(r,s)),n(function(n,s,a,l){var c,u,h,m=[],p=[],y=s.length,d=n||f(e||"*",a.nodeType?[a]:a,[]),v=!t||!n&&e?d:_(d,m,t,a,l),g=i?r||(n?t:y||o)?[]:s:v;if(i&&i(v,g,a,l),o)for(c=_(g,p),o(c,[],a,l),u=c.length;u--;)(h=c[u])&&(g[p[u]]=!(v[p[u]]=h));if(n){if(r||t){if(r){for(c=[],u=g.length;u--;)(h=g[u])&&c.push(v[u]=h);r(null,g=[],c,l)}for(u=g.length;u--;)(h=g[u])&&(c=r?Z(n,h):m[u])>-1&&(n[c]=!(s[c]=h))}}else g=_(g===s?g.splice(y,g.length):g),r?r(null,s,g,l):Y.apply(s,g)})}function d(t){for(var e,i,n,o=t.length,r=b.relative[t[0].type],s=r||b.relative[" "],a=r?1:0,l=m(function(t){return t===e},s,!0),c=m(function(t){return Z(e,t)>-1},s,!0),u=[function(t,i,n){var o=!r&&(n||i!==M)||((e=i).nodeType?l(t,i,n):c(t,i,n));return e=null,o}];a<o;a++)if(i=b.relative[t[a].type])u=[m(p(u),i)];else{if(i=b.filter[t[a].type].apply(null,t[a].matches),i[F]){for(n=++a;n<o&&!b.relative[t[n].type];n++);return y(a>1&&p(u),a>1&&h(t.slice(0,a-1).concat({value:" "===t[a-2].type?"*":""})).replace(rt,"$1"),i,a<n&&d(t.slice(a,n)),n<o&&d(t=t.slice(n)),n<o&&h(t))}u.push(i)}return p(u)}function v(t,i){var o=i.length>0,r=t.length>0,s=function(n,s,a,l,c){var u,h,m,p=0,f="0",y=n&&[],d=[],v=M,g=n||r&&b.find.TAG("*",c),x=G+=null==v?1:Math.random()||.1,C=g.length;for(c&&(M=s===P||s||c);f!==C&&null!=(u=g[f]);f++){if(r&&u){for(h=0,s||u.ownerDocument===P||(I(u),a=!E);m=t[h++];)if(m(u,s||P,a)){l.push(u);break}c&&(G=x)}o&&((u=!m&&u)&&p--,n&&y.push(u))}if(p+=f,o&&f!==p){for(h=0;m=i[h++];)m(y,d,s,a);if(n){if(p>0)for(;f--;)y[f]||d[f]||(d[f]=$.call(l));d=_(d)}Y.apply(l,d),c&&!n&&d.length>0&&p+i.length>1&&e.uniqueSort(l)}return c&&(G=x,M=v),y};return o?n(s):s}var g,x,b,C,S,w,A,D,M,k,B,I,P,T,E,V,L,R,N,F="sizzle"+1*new Date,O=t.document,G=0,J=0,j=i(),z=i(),H=i(),q=function(t,e){return t===e&&(B=!0),0},U={}.hasOwnProperty,W=[],$=W.pop,K=W.push,Y=W.push,X=W.slice,Z=function(t,e){for(var i=0,n=t.length;i<n;i++)if(t[i]===e)return i;return-1},Q="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",tt="[\\x20\\t\\r\\n\\f]",et="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",it="\\["+tt+"*("+et+")(?:"+tt+"*([*^$|!~]?=)"+tt+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+et+"))|)"+tt+"*\\]",nt=":("+et+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+it+")*)|.*)\\)|)",ot=new RegExp(tt+"+","g"),rt=new RegExp("^"+tt+"+|((?:^|[^\\\\])(?:\\\\.)*)"+tt+"+$","g"),st=new RegExp("^"+tt+"*,"+tt+"*"),at=new RegExp("^"+tt+"*([>+~]|"+tt+")"+tt+"*"),lt=new RegExp("="+tt+"*([^\\]'\"]*?)"+tt+"*\\]","g"),ct=new RegExp(nt),ut=new RegExp("^"+et+"$"),ht={ID:new RegExp("^#("+et+")"),CLASS:new RegExp("^\\.("+et+")"),TAG:new RegExp("^("+et+"|[*])"),ATTR:new RegExp("^"+it),PSEUDO:new RegExp("^"+nt),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+tt+"*(even|odd|(([+-]|)(\\d*)n|)"+tt+"*(?:([+-]|)"+tt+"*(\\d+)|))"+tt+"*\\)|)","i"),bool:new RegExp("^(?:"+Q+")$","i"),needsContext:new RegExp("^"+tt+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+tt+"*((?:-\\d)?\\d*)"+tt+"*\\)|)(?=[^-]|$)","i")},mt=/^(?:input|select|textarea|button)$/i,pt=/^h\d$/i,ft=/^[^{]+\{\s*\[native \w/,_t=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,yt=/[+~]/,dt=new RegExp("\\\\([\\da-f]{1,6}"+tt+"?|("+tt+")|.)","ig"),vt=function(t,e,i){var n="0x"+e-65536;return n!==n||i?e:n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320)},gt=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,xt=function(t,e){return e?"\0"===t?"�":t.slice(0,-1)+"\\"+t.charCodeAt(t.length-1).toString(16)+" ":"\\"+t},bt=function(){I()},Ct=m(function(t){return!0===t.disabled&&("form"in t||"label"in t)},{dir:"parentNode",next:"legend"});try{Y.apply(W=X.call(O.childNodes),O.childNodes),W[O.childNodes.length].nodeType}catch(t){Y={apply:W.length?function(t,e){K.apply(t,X.call(e))}:function(t,e){for(var i=t.length,n=0;t[i++]=e[n++];);t.length=i-1}}}x=e.support={},S=e.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return!!e&&"HTML"!==e.nodeName},I=e.setDocument=function(t){var e,i,n=t?t.ownerDocument||t:O;return n!==P&&9===n.nodeType&&n.documentElement?(P=n,T=P.documentElement,E=!S(P),O!==P&&(i=P.defaultView)&&i.top!==i&&(i.addEventListener?i.addEventListener("unload",bt,!1):i.attachEvent&&i.attachEvent("onunload",bt)),x.attributes=o(function(t){return t.className="i",!t.getAttribute("className")}),x.getElementsByTagName=o(function(t){return t.appendChild(P.createComment("")),!t.getElementsByTagName("*").length}),x.getElementsByClassName=ft.test(P.getElementsByClassName),x.getById=o(function(t){return T.appendChild(t).id=F,!P.getElementsByName||!P.getElementsByName(F).length}),x.getById?(b.filter.ID=function(t){var e=t.replace(dt,vt);return function(t){return t.getAttribute("id")===e}},b.find.ID=function(t,e){if(void 0!==e.getElementById&&E){var i=e.getElementById(t);return i?[i]:[]}}):(b.filter.ID=function(t){var e=t.replace(dt,vt);return function(t){var i=void 0!==t.getAttributeNode&&t.getAttributeNode("id");return i&&i.value===e}},b.find.ID=function(t,e){if(void 0!==e.getElementById&&E){var i,n,o,r=e.getElementById(t);if(r){if((i=r.getAttributeNode("id"))&&i.value===t)return[r];for(o=e.getElementsByName(t),n=0;r=o[n++];)if((i=r.getAttributeNode("id"))&&i.value===t)return[r]}return[]}}),b.find.TAG=x.getElementsByTagName?function(t,e){return void 0!==e.getElementsByTagName?e.getElementsByTagName(t):x.qsa?e.querySelectorAll(t):void 0}:function(t,e){var i,n=[],o=0,r=e.getElementsByTagName(t);if("*"===t){for(;i=r[o++];)1===i.nodeType&&n.push(i);return n}return r},b.find.CLASS=x.getElementsByClassName&&function(t,e){if(void 0!==e.getElementsByClassName&&E)return e.getElementsByClassName(t)},L=[],V=[],(x.qsa=ft.test(P.querySelectorAll))&&(o(function(t){T.appendChild(t).innerHTML="<a id='"+F+"'></a><select id='"+F+"-\r\\' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&V.push("[*^$]="+tt+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||V.push("\\["+tt+"*(?:value|"+Q+")"),t.querySelectorAll("[id~="+F+"-]").length||V.push("~="),t.querySelectorAll(":checked").length||V.push(":checked"),t.querySelectorAll("a#"+F+"+*").length||V.push(".#.+[+~]")}),o(function(t){t.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var e=P.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&V.push("name"+tt+"*[*^$|!~]?="),2!==t.querySelectorAll(":enabled").length&&V.push(":enabled",":disabled"),T.appendChild(t).disabled=!0,2!==t.querySelectorAll(":disabled").length&&V.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),V.push(",.*:")})),(x.matchesSelector=ft.test(R=T.matches||T.webkitMatchesSelector||T.mozMatchesSelector||T.oMatchesSelector||T.msMatchesSelector))&&o(function(t){x.disconnectedMatch=R.call(t,"*"),R.call(t,"[s!='']:x"),L.push("!=",nt)}),V=V.length&&new RegExp(V.join("|")),L=L.length&&new RegExp(L.join("|")),e=ft.test(T.compareDocumentPosition),N=e||ft.test(T.contains)?function(t,e){var i=9===t.nodeType?t.documentElement:t,n=e&&e.parentNode;return t===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):t.compareDocumentPosition&&16&t.compareDocumentPosition(n)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},q=e?function(t,e){if(t===e)return B=!0,0;var i=!t.compareDocumentPosition-!e.compareDocumentPosition;return i||(i=(t.ownerDocument||t)===(e.ownerDocument||e)?t.compareDocumentPosition(e):1,1&i||!x.sortDetached&&e.compareDocumentPosition(t)===i?t===P||t.ownerDocument===O&&N(O,t)?-1:e===P||e.ownerDocument===O&&N(O,e)?1:k?Z(k,t)-Z(k,e):0:4&i?-1:1)}:function(t,e){if(t===e)return B=!0,0;var i,n=0,o=t.parentNode,r=e.parentNode,a=[t],l=[e];if(!o||!r)return t===P?-1:e===P?1:o?-1:r?1:k?Z(k,t)-Z(k,e):0;if(o===r)return s(t,e);for(i=t;i=i.parentNode;)a.unshift(i);for(i=e;i=i.parentNode;)l.unshift(i);for(;a[n]===l[n];)n++;return n?s(a[n],l[n]):a[n]===O?-1:l[n]===O?1:0},P):P},e.matches=function(t,i){return e(t,null,null,i)},e.matchesSelector=function(t,i){if((t.ownerDocument||t)!==P&&I(t),i=i.replace(lt,"='$1']"),x.matchesSelector&&E&&!H[i+" "]&&(!L||!L.test(i))&&(!V||!V.test(i)))try{var n=R.call(t,i);if(n||x.disconnectedMatch||t.document&&11!==t.document.nodeType)return n}catch(t){}return e(i,P,null,[t]).length>0},e.contains=function(t,e){return(t.ownerDocument||t)!==P&&I(t),N(t,e)},e.attr=function(t,e){(t.ownerDocument||t)!==P&&I(t);var i=b.attrHandle[e.toLowerCase()],n=i&&U.call(b.attrHandle,e.toLowerCase())?i(t,e,!E):void 0;return void 0!==n?n:x.attributes||!E?t.getAttribute(e):(n=t.getAttributeNode(e))&&n.specified?n.value:null},e.escape=function(t){return(t+"").replace(gt,xt)},e.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},e.uniqueSort=function(t){var e,i=[],n=0,o=0;if(B=!x.detectDuplicates,k=!x.sortStable&&t.slice(0),t.sort(q),B){for(;e=t[o++];)e===t[o]&&(n=i.push(o));for(;n--;)t.splice(i[n],1)}return k=null,t},C=e.getText=function(t){var e,i="",n=0,o=t.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)i+=C(t)}else if(3===o||4===o)return t.nodeValue}else for(;e=t[n++];)i+=C(e);return i},b=e.selectors={cacheLength:50,createPseudo:n,match:ht,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(dt,vt),t[3]=(t[3]||t[4]||t[5]||"").replace(dt,vt),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||e.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&e.error(t[0]),t},PSEUDO:function(t){var e,i=!t[6]&&t[2];return ht.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":i&&ct.test(i)&&(e=w(i,!0))&&(e=i.indexOf(")",i.length-e)-i.length)&&(t[0]=t[0].slice(0,e),t[2]=i.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(dt,vt).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=j[t+" "];return e||(e=new RegExp("(^|"+tt+")"+t+"("+tt+"|$)"))&&j(t,function(t){return e.test("string"==typeof t.className&&t.className||void 0!==t.getAttribute&&t.getAttribute("class")||"")})},ATTR:function(t,i,n){return function(o){var r=e.attr(o,t);return null==r?"!="===i:!i||(r+="","="===i?r===n:"!="===i?r!==n:"^="===i?n&&0===r.indexOf(n):"*="===i?n&&r.indexOf(n)>-1:"$="===i?n&&r.slice(-n.length)===n:"~="===i?(" "+r.replace(ot," ")+" ").indexOf(n)>-1:"|="===i&&(r===n||r.slice(0,n.length+1)===n+"-"))}},CHILD:function(t,e,i,n,o){var r="nth"!==t.slice(0,3),s="last"!==t.slice(-4),a="of-type"===e;return 1===n&&0===o?function(t){return!!t.parentNode}:function(e,i,l){var c,u,h,m,p,f,_=r!==s?"nextSibling":"previousSibling",y=e.parentNode,d=a&&e.nodeName.toLowerCase(),v=!l&&!a,g=!1;if(y){if(r){for(;_;){for(m=e;m=m[_];)if(a?m.nodeName.toLowerCase()===d:1===m.nodeType)return!1;f=_="only"===t&&!f&&"nextSibling"}return!0}if(f=[s?y.firstChild:y.lastChild],s&&v){for(m=y,h=m[F]||(m[F]={}),u=h[m.uniqueID]||(h[m.uniqueID]={}),c=u[t]||[],p=c[0]===G&&c[1],g=p&&c[2],m=p&&y.childNodes[p];m=++p&&m&&m[_]||(g=p=0)||f.pop();)if(1===m.nodeType&&++g&&m===e){u[t]=[G,p,g];break}}else if(v&&(m=e,h=m[F]||(m[F]={}),u=h[m.uniqueID]||(h[m.uniqueID]={}),c=u[t]||[],p=c[0]===G&&c[1],g=p),!1===g)for(;(m=++p&&m&&m[_]||(g=p=0)||f.pop())&&((a?m.nodeName.toLowerCase()!==d:1!==m.nodeType)||!++g||(v&&(h=m[F]||(m[F]={}),u=h[m.uniqueID]||(h[m.uniqueID]={}),u[t]=[G,g]),m!==e)););return(g-=o)===n||g%n==0&&g/n>=0}}},PSEUDO:function(t,i){var o,r=b.pseudos[t]||b.setFilters[t.toLowerCase()]||e.error("unsupported pseudo: "+t);return r[F]?r(i):r.length>1?(o=[t,t,"",i],b.setFilters.hasOwnProperty(t.toLowerCase())?n(function(t,e){for(var n,o=r(t,i),s=o.length;s--;)n=Z(t,o[s]),t[n]=!(e[n]=o[s])}):function(t){return r(t,0,o)}):r}},pseudos:{not:n(function(t){var e=[],i=[],o=A(t.replace(rt,"$1"));return o[F]?n(function(t,e,i,n){for(var r,s=o(t,null,n,[]),a=t.length;a--;)(r=s[a])&&(t[a]=!(e[a]=r))}):function(t,n,r){return e[0]=t,o(e,null,r,i),e[0]=null,!i.pop()}}),has:n(function(t){return function(i){return e(t,i).length>0}}),contains:n(function(t){return t=t.replace(dt,vt),function(e){return(e.textContent||e.innerText||C(e)).indexOf(t)>-1}}),lang:n(function(t){return ut.test(t||"")||e.error("unsupported lang: "+t),t=t.replace(dt,vt).toLowerCase(),function(e){var i;do{if(i=E?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(i=i.toLowerCase())===t||0===i.indexOf(t+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var i=t.location&&t.location.hash;return i&&i.slice(1)===e.id},root:function(t){return t===T},focus:function(t){return t===P.activeElement&&(!P.hasFocus||P.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:a(!1),disabled:a(!0),checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!b.pseudos.empty(t)},header:function(t){return pt.test(t.nodeName)},input:function(t){return mt.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:l(function(){return[0]}),last:l(function(t,e){return[e-1]}),eq:l(function(t,e,i){return[i<0?i+e:i]}),even:l(function(t,e){for(var i=0;i<e;i+=2)t.push(i);return t}),odd:l(function(t,e){for(var i=1;i<e;i+=2)t.push(i);return t}),lt:l(function(t,e,i){for(var n=i<0?i+e:i;--n>=0;)t.push(n);return t}),gt:l(function(t,e,i){for(var n=i<0?i+e:i;++n<e;)t.push(n);return t})}},b.pseudos.nth=b.pseudos.eq;for(g in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})b.pseudos[g]=function(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}(g);for(g in{submit:!0,reset:!0})b.pseudos[g]=function(t){return function(e){var i=e.nodeName.toLowerCase();return("input"===i||"button"===i)&&e.type===t}}(g);return u.prototype=b.filters=b.pseudos,b.setFilters=new u,w=e.tokenize=function(t,i){var n,o,r,s,a,l,c,u=z[t+" "];if(u)return i?0:u.slice(0);for(a=t,l=[],c=b.preFilter;a;){n&&!(o=st.exec(a))||(o&&(a=a.slice(o[0].length)||a),l.push(r=[])),n=!1,(o=at.exec(a))&&(n=o.shift(),r.push({value:n,type:o[0].replace(rt," ")}),a=a.slice(n.length));for(s in b.filter)!(o=ht[s].exec(a))||c[s]&&!(o=c[s](o))||(n=o.shift(),r.push({value:n,type:s,matches:o}),a=a.slice(n.length));if(!n)break}return i?a.length:a?e.error(t):z(t,l).slice(0)},A=e.compile=function(t,e){var i,n=[],o=[],r=H[t+" "];if(!r){for(e||(e=w(t)),i=e.length;i--;)r=d(e[i]),r[F]?n.push(r):o.push(r);r=H(t,v(o,n)),r.selector=t}return r},D=e.select=function(t,e,i,n){var o,r,s,a,l,u="function"==typeof t&&t,m=!n&&w(t=u.selector||t);if(i=i||[],1===m.length){if(r=m[0]=m[0].slice(0),r.length>2&&"ID"===(s=r[0]).type&&9===e.nodeType&&E&&b.relative[r[1].type]){if(!(e=(b.find.ID(s.matches[0].replace(dt,vt),e)||[])[0]))return i;u&&(e=e.parentNode),t=t.slice(r.shift().value.length)}for(o=ht.needsContext.test(t)?0:r.length;o--&&(s=r[o],!b.relative[a=s.type]);)if((l=b.find[a])&&(n=l(s.matches[0].replace(dt,vt),yt.test(r[0].type)&&c(e.parentNode)||e))){if(r.splice(o,1),!(t=n.length&&h(r)))return Y.apply(i,n),i;break}}return(u||A(t,m))(n,e,!E,i,!e||yt.test(t)&&c(e.parentNode)||e),i},x.sortStable=F.split("").sort(q).join("")===F,x.detectDuplicates=!!B,I(),x.sortDetached=o(function(t){return 1&t.compareDocumentPosition(P.createElement("fieldset"))}),o(function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")})||r("type|href|height|width",function(t,e,i){if(!i)return t.getAttribute(e,"type"===e.toLowerCase()?1:2)}),x.attributes&&o(function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")})||r("value",function(t,e,i){if(!i&&"input"===t.nodeName.toLowerCase())return t.defaultValue}),o(function(t){return null==t.getAttribute("disabled")})||r(Q,function(t,e,i){var n;if(!i)return!0===t[e]?e.toLowerCase():(n=t.getAttributeNode(e))&&n.specified?n.value:null}),e}(i);vt.find=xt,vt.expr=xt.selectors,vt.expr[":"]=vt.expr.pseudos,vt.uniqueSort=vt.unique=xt.uniqueSort,vt.text=xt.getText,vt.isXMLDoc=xt.isXML,vt.contains=xt.contains,vt.escapeSelector=xt.escape;var bt=function(t,e,i){for(var n=[],o=void 0!==i;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(o&&vt(t).is(i))break;n.push(t)}return n},Ct=function(t,e){for(var i=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&i.push(t);return i},St=vt.expr.match.needsContext,wt=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i,At=/^.[^:#\[\.,]*$/;vt.filter=function(t,e,i){var n=e[0];return i&&(t=":not("+t+")"),1===e.length&&1===n.nodeType?vt.find.matchesSelector(n,t)?[n]:[]:vt.find.matches(t,vt.grep(e,function(t){return 1===t.nodeType}))},vt.fn.extend({find:function(t){var e,i,n=this.length,o=this;if("string"!=typeof t)return this.pushStack(vt(t).filter(function(){for(e=0;e<n;e++)if(vt.contains(o[e],this))return!0}));for(i=this.pushStack([]),e=0;e<n;e++)vt.find(t,o[e],i);return n>1?vt.uniqueSort(i):i},filter:function(t){return this.pushStack(c(this,t||[],!1))},not:function(t){return this.pushStack(c(this,t||[],!0))},is:function(t){return!!c(this,"string"==typeof t&&St.test(t)?vt(t):t||[],!1).length}});var Dt,Mt=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(vt.fn.init=function(t,e,i){var n,o;if(!t)return this;if(i=i||Dt,"string"==typeof t){if(!(n="<"===t[0]&&">"===t[t.length-1]&&t.length>=3?[null,t,null]:Mt.exec(t))||!n[1]&&e)return!e||e.jquery?(e||i).find(t):this.constructor(e).find(t);if(n[1]){if(e=e instanceof vt?e[0]:e,vt.merge(this,vt.parseHTML(n[1],e&&e.nodeType?e.ownerDocument||e:st,!0)),wt.test(n[1])&&vt.isPlainObject(e))for(n in e)vt.isFunction(this[n])?this[n](e[n]):this.attr(n,e[n]);return this}return o=st.getElementById(n[2]),o&&(this[0]=o,this.length=1),this}return t.nodeType?(this[0]=t,this.length=1,this):vt.isFunction(t)?void 0!==i.ready?i.ready(t):t(vt):vt.makeArray(t,this)}).prototype=vt.fn,Dt=vt(st);var kt=/^(?:parents|prev(?:Until|All))/,Bt={children:!0,contents:!0,next:!0,prev:!0};vt.fn.extend({has:function(t){var e=vt(t,this),i=e.length;return this.filter(function(){for(var t=0;t<i;t++)if(vt.contains(this,e[t]))return!0})},closest:function(t,e){var i,n=0,o=this.length,r=[],s="string"!=typeof t&&vt(t);if(!St.test(t))for(;n<o;n++)for(i=this[n];i&&i!==e;i=i.parentNode)if(i.nodeType<11&&(s?s.index(i)>-1:1===i.nodeType&&vt.find.matchesSelector(i,t))){r.push(i);break}return this.pushStack(r.length>1?vt.uniqueSort(r):r)},index:function(t){return t?"string"==typeof t?ht.call(vt(t),this[0]):ht.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(vt.uniqueSort(vt.merge(this.get(),vt(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),vt.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return bt(t,"parentNode")},parentsUntil:function(t,e,i){return bt(t,"parentNode",i)},next:function(t){return u(t,"nextSibling")},prev:function(t){return u(t,"previousSibling")},nextAll:function(t){return bt(t,"nextSibling")},prevAll:function(t){return bt(t,"previousSibling")},nextUntil:function(t,e,i){return bt(t,"nextSibling",i)},prevUntil:function(t,e,i){return bt(t,"previousSibling",i)},siblings:function(t){return Ct((t.parentNode||{}).firstChild,t)},children:function(t){return Ct(t.firstChild)},contents:function(t){return l(t,"iframe")?t.contentDocument:(l(t,"template")&&(t=t.content||t),vt.merge([],t.childNodes))}},function(t,e){vt.fn[t]=function(i,n){var o=vt.map(this,e,i);return"Until"!==t.slice(-5)&&(n=i),n&&"string"==typeof n&&(o=vt.filter(n,o)),this.length>1&&(Bt[t]||vt.uniqueSort(o),kt.test(t)&&o.reverse()),this.pushStack(o)}});var It=/[^\x20\t\r\n\f]+/g;vt.Callbacks=function(t){t="string"==typeof t?h(t):vt.extend({},t);var e,i,n,o,r=[],s=[],a=-1,l=function(){for(o=o||t.once,n=e=!0;s.length;a=-1)for(i=s.shift();++a<r.length;)!1===r[a].apply(i[0],i[1])&&t.stopOnFalse&&(a=r.length,i=!1);t.memory||(i=!1),e=!1,o&&(r=i?[]:"")},c={add:function(){return r&&(i&&!e&&(a=r.length-1,s.push(i)),function e(i){vt.each(i,function(i,n){vt.isFunction(n)?t.unique&&c.has(n)||r.push(n):n&&n.length&&"string"!==vt.type(n)&&e(n)})}(arguments),i&&!e&&l()),this},remove:function(){return vt.each(arguments,function(t,e){for(var i;(i=vt.inArray(e,r,i))>-1;)r.splice(i,1),i<=a&&a--}),this},has:function(t){return t?vt.inArray(t,r)>-1:r.length>0},empty:function(){return r&&(r=[]),this},disable:function(){return o=s=[],r=i="",this},disabled:function(){return!r},lock:function(){return o=s=[],i||e||(r=i=""),this},locked:function(){return!!o},fireWith:function(t,i){return o||(i=i||[],i=[t,i.slice?i.slice():i],s.push(i),e||l()),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!n}};return c},vt.extend({Deferred:function(t){var e=[["notify","progress",vt.Callbacks("memory"),vt.Callbacks("memory"),2],["resolve","done",vt.Callbacks("once memory"),vt.Callbacks("once memory"),0,"resolved"],["reject","fail",vt.Callbacks("once memory"),vt.Callbacks("once memory"),1,"rejected"]],n="pending",o={state:function(){return n},always:function(){return r.done(arguments).fail(arguments),this},catch:function(t){return o.then(null,t)},pipe:function(){var t=arguments;return vt.Deferred(function(i){vt.each(e,function(e,n){var o=vt.isFunction(t[n[4]])&&t[n[4]];r[n[1]](function(){var t=o&&o.apply(this,arguments);t&&vt.isFunction(t.promise)?t.promise().progress(i.notify).done(i.resolve).fail(i.reject):i[n[0]+"With"](this,o?[t]:arguments)})}),t=null}).promise()},then:function(t,n,o){function r(t,e,n,o){return function(){var a=this,l=arguments,c=function(){var i,c;if(!(t<s)){if((i=n.apply(a,l))===e.promise())throw new TypeError("Thenable self-resolution");c=i&&("object"==typeof i||"function"==typeof i)&&i.then,vt.isFunction(c)?o?c.call(i,r(s,e,m,o),r(s,e,p,o)):(s++,c.call(i,r(s,e,m,o),r(s,e,p,o),r(s,e,m,e.notifyWith))):(n!==m&&(a=void 0,l=[i]),(o||e.resolveWith)(a,l))}},u=o?c:function(){try{c()}catch(i){vt.Deferred.exceptionHook&&vt.Deferred.exceptionHook(i,u.stackTrace),t+1>=s&&(n!==p&&(a=void 0,l=[i]),e.rejectWith(a,l))}};t?u():(vt.Deferred.getStackHook&&(u.stackTrace=vt.Deferred.getStackHook()),i.setTimeout(u))}}var s=0;return vt.Deferred(function(i){e[0][3].add(r(0,i,vt.isFunction(o)?o:m,i.notifyWith)),e[1][3].add(r(0,i,vt.isFunction(t)?t:m)),e[2][3].add(r(0,i,vt.isFunction(n)?n:p))}).promise()},promise:function(t){return null!=t?vt.extend(t,o):o}},r={};return vt.each(e,function(t,i){var s=i[2],a=i[5];o[i[1]]=s.add,a&&s.add(function(){n=a},e[3-t][2].disable,e[0][2].lock),s.add(i[3].fire),r[i[0]]=function(){return r[i[0]+"With"](this===r?void 0:this,arguments),this},r[i[0]+"With"]=s.fireWith}),o.promise(r),t&&t.call(r,r),r},when:function(t){var e=arguments.length,i=e,n=Array(i),o=lt.call(arguments),r=vt.Deferred(),s=function(t){return function(i){n[t]=this,o[t]=arguments.length>1?lt.call(arguments):i,--e||r.resolveWith(n,o)}};if(e<=1&&(f(t,r.done(s(i)).resolve,r.reject,!e),"pending"===r.state()||vt.isFunction(o[i]&&o[i].then)))return r.then();for(;i--;)f(o[i],s(i),r.reject);return r.promise()}});var Pt=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;vt.Deferred.exceptionHook=function(t,e){i.console&&i.console.warn&&t&&Pt.test(t.name)&&i.console.warn("jQuery.Deferred exception: "+t.message,t.stack,e)},vt.readyException=function(t){i.setTimeout(function(){throw t})};var Tt=vt.Deferred();vt.fn.ready=function(t){return Tt.then(t).catch(function(t){vt.readyException(t)}),this},vt.extend({isReady:!1,readyWait:1,ready:function(t){(!0===t?--vt.readyWait:vt.isReady)||(vt.isReady=!0,!0!==t&&--vt.readyWait>0||Tt.resolveWith(st,[vt]))}}),vt.ready.then=Tt.then,"complete"===st.readyState||"loading"!==st.readyState&&!st.documentElement.doScroll?i.setTimeout(vt.ready):(st.addEventListener("DOMContentLoaded",_),i.addEventListener("load",_));var Et=function(t,e,i,n,o,r,s){var a=0,l=t.length,c=null==i;if("object"===vt.type(i)){o=!0;for(a in i)Et(t,e,a,i[a],!0,r,s)}else if(void 0!==n&&(o=!0,vt.isFunction(n)||(s=!0),c&&(s?(e.call(t,n),e=null):(c=e,e=function(t,e,i){return c.call(vt(t),i)})),e))for(;a<l;a++)e(t[a],i,s?n:n.call(t[a],a,e(t[a],i)));return o?t:c?e.call(t):l?e(t[0],i):r},Vt=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType};y.uid=1,y.prototype={cache:function(t){var e=t[this.expando];return e||(e={},Vt(t)&&(t.nodeType?t[this.expando]=e:Object.defineProperty(t,this.expando,{value:e,configurable:!0}))),e},set:function(t,e,i){var n,o=this.cache(t);if("string"==typeof e)o[vt.camelCase(e)]=i;else for(n in e)o[vt.camelCase(n)]=e[n];return o},get:function(t,e){return void 0===e?this.cache(t):t[this.expando]&&t[this.expando][vt.camelCase(e)]},access:function(t,e,i){return void 0===e||e&&"string"==typeof e&&void 0===i?this.get(t,e):(this.set(t,e,i),void 0!==i?i:e)},remove:function(t,e){var i,n=t[this.expando];if(void 0!==n){if(void 0!==e){Array.isArray(e)?e=e.map(vt.camelCase):(e=vt.camelCase(e),e=e in n?[e]:e.match(It)||[]),i=e.length;for(;i--;)delete n[e[i]]}(void 0===e||vt.isEmptyObject(n))&&(t.nodeType?t[this.expando]=void 0:delete t[this.expando])}},hasData:function(t){var e=t[this.expando];return void 0!==e&&!vt.isEmptyObject(e)}};var Lt=new y,Rt=new y,Nt=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Ft=/[A-Z]/g;vt.extend({hasData:function(t){return Rt.hasData(t)||Lt.hasData(t)},data:function(t,e,i){return Rt.access(t,e,i)},removeData:function(t,e){Rt.remove(t,e)},_data:function(t,e,i){return Lt.access(t,e,i)},_removeData:function(t,e){Lt.remove(t,e)}}),vt.fn.extend({data:function(t,e){var i,n,o,r=this[0],s=r&&r.attributes;if(void 0===t){if(this.length&&(o=Rt.get(r),1===r.nodeType&&!Lt.get(r,"hasDataAttrs"))){for(i=s.length;i--;)s[i]&&(n=s[i].name,0===n.indexOf("data-")&&(n=vt.camelCase(n.slice(5)),v(r,n,o[n])));Lt.set(r,"hasDataAttrs",!0)}return o}return"object"==typeof t?this.each(function(){Rt.set(this,t)}):Et(this,function(e){var i;if(r&&void 0===e){if(void 0!==(i=Rt.get(r,t)))return i;if(void 0!==(i=v(r,t)))return i}else this.each(function(){Rt.set(this,t,e)})},null,e,arguments.length>1,null,!0)},removeData:function(t){return this.each(function(){Rt.remove(this,t)})}}),vt.extend({queue:function(t,e,i){var n;if(t)return e=(e||"fx")+"queue",n=Lt.get(t,e),i&&(!n||Array.isArray(i)?n=Lt.access(t,e,vt.makeArray(i)):n.push(i)),n||[]},dequeue:function(t,e){e=e||"fx";var i=vt.queue(t,e),n=i.length,o=i.shift(),r=vt._queueHooks(t,e),s=function(){vt.dequeue(t,e)};"inprogress"===o&&(o=i.shift(),n--),o&&("fx"===e&&i.unshift("inprogress"),delete r.stop,o.call(t,s,r)),!n&&r&&r.empty.fire()},_queueHooks:function(t,e){var i=e+"queueHooks";return Lt.get(t,i)||Lt.access(t,i,{empty:vt.Callbacks("once memory").add(function(){Lt.remove(t,[e+"queue",i])})})}}),vt.fn.extend({queue:function(t,e){var i=2;return"string"!=typeof t&&(e=t,t="fx",i--),arguments.length<i?vt.queue(this[0],t):void 0===e?this:this.each(function(){var i=vt.queue(this,t,e);vt._queueHooks(this,t),"fx"===t&&"inprogress"!==i[0]&&vt.dequeue(this,t)})},dequeue:function(t){return this.each(function(){vt.dequeue(this,t)})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var i,n=1,o=vt.Deferred(),r=this,s=this.length,a=function(){--n||o.resolveWith(r,[r])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";s--;)(i=Lt.get(r[s],t+"queueHooks"))&&i.empty&&(n++,i.empty.add(a));return a(),o.promise(e)}});var Ot=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Gt=new RegExp("^(?:([+-])=|)("+Ot+")([a-z%]*)$","i"),Jt=["Top","Right","Bottom","Left"],jt=function(t,e){return t=e||t,"none"===t.style.display||""===t.style.display&&vt.contains(t.ownerDocument,t)&&"none"===vt.css(t,"display")},zt=function(t,e,i,n){var o,r,s={};for(r in e)s[r]=t.style[r],t.style[r]=e[r];o=i.apply(t,n||[]);for(r in e)t.style[r]=s[r];return o},Ht={};vt.fn.extend({show:function(){return b(this,!0)},hide:function(){return b(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each(function(){jt(this)?vt(this).show():vt(this).hide()})}});var qt=/^(?:checkbox|radio)$/i,Ut=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i,Wt=/^$|\/(?:java|ecma)script/i,$t={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};$t.optgroup=$t.option,$t.tbody=$t.tfoot=$t.colgroup=$t.caption=$t.thead,$t.th=$t.td;var Kt=/<|&#?\w+;/;!function(){var t=st.createDocumentFragment(),e=t.appendChild(st.createElement("div")),i=st.createElement("input");i.setAttribute("type","radio"),i.setAttribute("checked","checked"),i.setAttribute("name","t"),e.appendChild(i),dt.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,e.innerHTML="<textarea>x</textarea>",dt.noCloneChecked=!!e.cloneNode(!0).lastChild.defaultValue}();var Yt=st.documentElement,Xt=/^key/,Zt=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Qt=/^([^.]*)(?:\.(.+)|)/;vt.event={global:{},add:function(t,e,i,n,o){var r,s,a,l,c,u,h,m,p,f,_,y=Lt.get(t);if(y)for(i.handler&&(r=i,i=r.handler,o=r.selector),o&&vt.find.matchesSelector(Yt,o),i.guid||(i.guid=vt.guid++),(l=y.events)||(l=y.events={}),(s=y.handle)||(s=y.handle=function(e){return void 0!==vt&&vt.event.triggered!==e.type?vt.event.dispatch.apply(t,arguments):void 0}),e=(e||"").match(It)||[""],c=e.length;c--;)a=Qt.exec(e[c])||[],p=_=a[1],f=(a[2]||"").split(".").sort(),p&&(h=vt.event.special[p]||{},p=(o?h.delegateType:h.bindType)||p,h=vt.event.special[p]||{},u=vt.extend({type:p,origType:_,data:n,handler:i,guid:i.guid,selector:o,needsContext:o&&vt.expr.match.needsContext.test(o),namespace:f.join(".")},r),(m=l[p])||(m=l[p]=[],m.delegateCount=0,h.setup&&!1!==h.setup.call(t,n,f,s)||t.addEventListener&&t.addEventListener(p,s)),h.add&&(h.add.call(t,u),u.handler.guid||(u.handler.guid=i.guid)),o?m.splice(m.delegateCount++,0,u):m.push(u),vt.event.global[p]=!0)},remove:function(t,e,i,n,o){var r,s,a,l,c,u,h,m,p,f,_,y=Lt.hasData(t)&&Lt.get(t);if(y&&(l=y.events)){for(e=(e||"").match(It)||[""],c=e.length;c--;)if(a=Qt.exec(e[c])||[],p=_=a[1],f=(a[2]||"").split(".").sort(),p){for(h=vt.event.special[p]||{},p=(n?h.delegateType:h.bindType)||p,m=l[p]||[],a=a[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=r=m.length;r--;)u=m[r],!o&&_!==u.origType||i&&i.guid!==u.guid||a&&!a.test(u.namespace)||n&&n!==u.selector&&("**"!==n||!u.selector)||(m.splice(r,1),u.selector&&m.delegateCount--,h.remove&&h.remove.call(t,u));s&&!m.length&&(h.teardown&&!1!==h.teardown.call(t,f,y.handle)||vt.removeEvent(t,p,y.handle),delete l[p])}else for(p in l)vt.event.remove(t,p+e[c],i,n,!0);vt.isEmptyObject(l)&&Lt.remove(t,"handle events")}},dispatch:function(t){var e,i,n,o,r,s,a=vt.event.fix(t),l=new Array(arguments.length),c=(Lt.get(this,"events")||{})[a.type]||[],u=vt.event.special[a.type]||{};for(l[0]=a,e=1;e<arguments.length;e++)l[e]=arguments[e];if(a.delegateTarget=this,!u.preDispatch||!1!==u.preDispatch.call(this,a)){for(s=vt.event.handlers.call(this,a,c),e=0;(o=s[e++])&&!a.isPropagationStopped();)for(a.currentTarget=o.elem,i=0;(r=o.handlers[i++])&&!a.isImmediatePropagationStopped();)a.rnamespace&&!a.rnamespace.test(r.namespace)||(a.handleObj=r,a.data=r.data,void 0!==(n=((vt.event.special[r.origType]||{}).handle||r.handler).apply(o.elem,l))&&!1===(a.result=n)&&(a.preventDefault(),a.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,a),a.result}},handlers:function(t,e){var i,n,o,r,s,a=[],l=e.delegateCount,c=t.target;if(l&&c.nodeType&&!("click"===t.type&&t.button>=1))for(;c!==this;c=c.parentNode||this)if(1===c.nodeType&&("click"!==t.type||!0!==c.disabled)){for(r=[],s={},i=0;i<l;i++)n=e[i],o=n.selector+" ",void 0===s[o]&&(s[o]=n.needsContext?vt(o,this).index(c)>-1:vt.find(o,this,null,[c]).length),s[o]&&r.push(n);r.length&&a.push({elem:c,handlers:r})}return c=this,l<e.length&&a.push({elem:c,handlers:e.slice(l)}),a},addProp:function(t,e){Object.defineProperty(vt.Event.prototype,t,{enumerable:!0,configurable:!0,get:vt.isFunction(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(t){return t[vt.expando]?t:new vt.Event(t)},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==M()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===M()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&l(this,"input"))return this.click(),!1},_default:function(t){return l(t.target,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}}},vt.removeEvent=function(t,e,i){t.removeEventListener&&t.removeEventListener(e,i)},vt.Event=function(t,e){if(!(this instanceof vt.Event))return new vt.Event(t,e);t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?A:D,this.target=t.target&&3===t.target.nodeType?t.target.parentNode:t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget):this.type=t,e&&vt.extend(this,e),this.timeStamp=t&&t.timeStamp||vt.now(),this[vt.expando]=!0},vt.Event.prototype={constructor:vt.Event,isDefaultPrevented:D,isPropagationStopped:D,isImmediatePropagationStopped:D,isSimulated:!1,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=A,t&&!this.isSimulated&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=A,t&&!this.isSimulated&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=A,t&&!this.isSimulated&&t.stopImmediatePropagation(),this.stopPropagation()}},vt.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(t){var e=t.button;return null==t.which&&Xt.test(t.type)?null!=t.charCode?t.charCode:t.keyCode:!t.which&&void 0!==e&&Zt.test(t.type)?1&e?1:2&e?3:4&e?2:0:t.which}},vt.event.addProp),vt.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(t,e){vt.event.special[t]={delegateType:e,bindType:e,handle:function(t){var i,n=this,o=t.relatedTarget,r=t.handleObj;return o&&(o===n||vt.contains(n,o))||(t.type=r.origType,i=r.handler.apply(this,arguments),t.type=e),i}}}),vt.fn.extend({on:function(t,e,i,n){return k(this,t,e,i,n)},one:function(t,e,i,n){return k(this,t,e,i,n,1)},off:function(t,e,i){var n,o;if(t&&t.preventDefault&&t.handleObj)return n=t.handleObj,vt(t.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"==typeof t){for(o in t)this.off(o,e,t[o]);return this}return!1!==e&&"function"!=typeof e||(i=e,e=void 0),!1===i&&(i=D),this.each(function(){vt.event.remove(this,t,i,e)})}});var te=/<script|<style|<link/i,ee=/checked\s*(?:[^=]|=\s*.checked.)/i,ie=/^true\/(.*)/,ne=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;vt.extend({htmlPrefilter:function(t){return t.replace(/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,"<$1></$2>")},clone:function(t,e,i){var n,o,r,s,a=t.cloneNode(!0),l=vt.contains(t.ownerDocument,t);if(!(dt.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||vt.isXMLDoc(t)))for(s=C(a),r=C(t),n=0,o=r.length;n<o;n++)E(r[n],s[n]);if(e)if(i)for(r=r||C(t),s=s||C(a),n=0,o=r.length;n<o;n++)T(r[n],s[n]);else T(t,a);return s=C(a,"script"),s.length>0&&S(s,!l&&C(t,"script")),a},cleanData:function(t){for(var e,i,n,o=vt.event.special,r=0;void 0!==(i=t[r]);r++)if(Vt(i)){if(e=i[Lt.expando]){if(e.events)for(n in e.events)o[n]?vt.event.remove(i,n):vt.removeEvent(i,n,e.handle);i[Lt.expando]=void 0}i[Rt.expando]&&(i[Rt.expando]=void 0)}}}),vt.fn.extend({detach:function(t){return L(this,t,!0)},remove:function(t){return L(this,t)},text:function(t){return Et(this,function(t){return void 0===t?vt.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)})},null,t,arguments.length)},append:function(){return V(this,arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){B(this,t).appendChild(t)}})},prepend:function(){return V(this,arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=B(this,t);e.insertBefore(t,e.firstChild)}})},before:function(){return V(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return V(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(vt.cleanData(C(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map(function(){return vt.clone(this,t,e)})},html:function(t){return Et(this,function(t){var e=this[0]||{},i=0,n=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!te.test(t)&&!$t[(Ut.exec(t)||["",""])[1].toLowerCase()]){t=vt.htmlPrefilter(t);try{for(;i<n;i++)e=this[i]||{},1===e.nodeType&&(vt.cleanData(C(e,!1)),e.innerHTML=t);e=0}catch(t){}}e&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(){var t=[];return V(this,arguments,function(e){var i=this.parentNode;vt.inArray(this,t)<0&&(vt.cleanData(C(this)),i&&i.replaceChild(e,this))},t)}}),vt.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,e){vt.fn[t]=function(t){for(var i,n=[],o=vt(t),r=o.length-1,s=0;s<=r;s++)i=s===r?this:this.clone(!0),vt(o[s])[e](i),ut.apply(n,i.get());return this.pushStack(n)}});var oe=/^margin/,re=new RegExp("^("+Ot+")(?!px)[a-z%]+$","i"),se=function(t){var e=t.ownerDocument.defaultView;return e&&e.opener||(e=i),e.getComputedStyle(t)};!function(){function t(){if(a){a.style.cssText="box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",a.innerHTML="",Yt.appendChild(s);var t=i.getComputedStyle(a);e="1%"!==t.top,r="2px"===t.marginLeft,n="4px"===t.width,a.style.marginRight="50%",o="4px"===t.marginRight,Yt.removeChild(s),a=null}}var e,n,o,r,s=st.createElement("div"),a=st.createElement("div");a.style&&(a.style.backgroundClip="content-box",a.cloneNode(!0).style.backgroundClip="",dt.clearCloneStyle="content-box"===a.style.backgroundClip,s.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",s.appendChild(a),vt.extend(dt,{pixelPosition:function(){return t(),e},boxSizingReliable:function(){return t(),n},pixelMarginRight:function(){return t(),o},reliableMarginLeft:function(){return t(),r}}))}();var ae=/^(none|table(?!-c[ea]).+)/,le=/^--/,ce={position:"absolute",visibility:"hidden",display:"block"},ue={letterSpacing:"0",fontWeight:"400"},he=["Webkit","Moz","ms"],me=st.createElement("div").style;vt.extend({cssHooks:{opacity:{get:function(t,e){if(e){var i=R(t,"opacity");return""===i?"1":i}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(t,e,i,n){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var o,r,s,a=vt.camelCase(e),l=le.test(e),c=t.style;if(l||(e=O(a)),s=vt.cssHooks[e]||vt.cssHooks[a],void 0===i)return s&&"get"in s&&void 0!==(o=s.get(t,!1,n))?o:c[e];r=typeof i,"string"===r&&(o=Gt.exec(i))&&o[1]&&(i=g(t,e,o),r="number"),null!=i&&i===i&&("number"===r&&(i+=o&&o[3]||(vt.cssNumber[a]?"":"px")),dt.clearCloneStyle||""!==i||0!==e.indexOf("background")||(c[e]="inherit"),s&&"set"in s&&void 0===(i=s.set(t,i,n))||(l?c.setProperty(e,i):c[e]=i))}},css:function(t,e,i,n){var o,r,s,a=vt.camelCase(e);return le.test(e)||(e=O(a)),s=vt.cssHooks[e]||vt.cssHooks[a],s&&"get"in s&&(o=s.get(t,!0,i)),void 0===o&&(o=R(t,e,n)),"normal"===o&&e in ue&&(o=ue[e]),""===i||i?(r=parseFloat(o),!0===i||isFinite(r)?r||0:o):o}}),vt.each(["height","width"],function(t,e){vt.cssHooks[e]={get:function(t,i,n){if(i)return!ae.test(vt.css(t,"display"))||t.getClientRects().length&&t.getBoundingClientRect().width?j(t,e,n):zt(t,ce,function(){return j(t,e,n)})},set:function(t,i,n){var o,r=n&&se(t),s=n&&J(t,e,n,"border-box"===vt.css(t,"boxSizing",!1,r),r);return s&&(o=Gt.exec(i))&&"px"!==(o[3]||"px")&&(t.style[e]=i,i=vt.css(t,e)),G(t,i,s)}}}),vt.cssHooks.marginLeft=N(dt.reliableMarginLeft,function(t,e){if(e)return(parseFloat(R(t,"marginLeft"))||t.getBoundingClientRect().left-zt(t,{marginLeft:0},function(){return t.getBoundingClientRect().left}))+"px"}),vt.each({margin:"",padding:"",border:"Width"},function(t,e){vt.cssHooks[t+e]={expand:function(i){for(var n=0,o={},r="string"==typeof i?i.split(" "):[i];n<4;n++)o[t+Jt[n]+e]=r[n]||r[n-2]||r[0];return o}},oe.test(t)||(vt.cssHooks[t+e].set=G)}),vt.fn.extend({css:function(t,e){return Et(this,function(t,e,i){var n,o,r={},s=0;if(Array.isArray(e)){for(n=se(t),o=e.length;s<o;s++)r[e[s]]=vt.css(t,e[s],!1,n);return r}return void 0!==i?vt.style(t,e,i):vt.css(t,e)},t,e,arguments.length>1)}}),vt.Tween=z,z.prototype={constructor:z,init:function(t,e,i,n,o,r){this.elem=t,this.prop=i,this.easing=o||vt.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=n,this.unit=r||(vt.cssNumber[i]?"":"px")},cur:function(){var t=z.propHooks[this.prop];return t&&t.get?t.get(this):z.propHooks._default.get(this)},run:function(t){var e,i=z.propHooks[this.prop];return this.options.duration?this.pos=e=vt.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):z.propHooks._default.set(this),this}},z.prototype.init.prototype=z.prototype,z.propHooks={_default:{get:function(t){var e;return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(e=vt.css(t.elem,t.prop,""),e&&"auto"!==e?e:0)},set:function(t){vt.fx.step[t.prop]?vt.fx.step[t.prop](t):1!==t.elem.nodeType||null==t.elem.style[vt.cssProps[t.prop]]&&!vt.cssHooks[t.prop]?t.elem[t.prop]=t.now:vt.style(t.elem,t.prop,t.now+t.unit)}}},z.propHooks.scrollTop=z.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},vt.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},_default:"swing"},vt.fx=z.prototype.init,vt.fx.step={};var pe,fe,_e=/^(?:toggle|show|hide)$/,ye=/queueHooks$/;vt.Animation=vt.extend(Y,{tweeners:{"*":[function(t,e){var i=this.createTween(t,e);return g(i.elem,t,Gt.exec(e),i),i}]},tweener:function(t,e){vt.isFunction(t)?(e=t,t=["*"]):t=t.match(It);for(var i,n=0,o=t.length;n<o;n++)i=t[n],Y.tweeners[i]=Y.tweeners[i]||[],Y.tweeners[i].unshift(e)},prefilters:[$],prefilter:function(t,e){e?Y.prefilters.unshift(t):Y.prefilters.push(t)}}),vt.speed=function(t,e,i){var n=t&&"object"==typeof t?vt.extend({},t):{complete:i||!i&&e||vt.isFunction(t)&&t,duration:t,easing:i&&e||e&&!vt.isFunction(e)&&e};return vt.fx.off?n.duration=0:"number"!=typeof n.duration&&(n.duration in vt.fx.speeds?n.duration=vt.fx.speeds[n.duration]:n.duration=vt.fx.speeds._default),null!=n.queue&&!0!==n.queue||(n.queue="fx"),n.old=n.complete,n.complete=function(){vt.isFunction(n.old)&&n.old.call(this),n.queue&&vt.dequeue(this,n.queue)},n},vt.fn.extend({fadeTo:function(t,e,i,n){return this.filter(jt).css("opacity",0).show().end().animate({opacity:e},t,i,n)},animate:function(t,e,i,n){var o=vt.isEmptyObject(t),r=vt.speed(e,i,n),s=function(){var e=Y(this,vt.extend({},t),r);(o||Lt.get(this,"finish"))&&e.stop(!0)};return s.finish=s,o||!1===r.queue?this.each(s):this.queue(r.queue,s)},stop:function(t,e,i){var n=function(t){var e=t.stop;delete t.stop,e(i)};return"string"!=typeof t&&(i=e,e=t,t=void 0),e&&!1!==t&&this.queue(t||"fx",[]),this.each(function(){var e=!0,o=null!=t&&t+"queueHooks",r=vt.timers,s=Lt.get(this);if(o)s[o]&&s[o].stop&&n(s[o]);else for(o in s)s[o]&&s[o].stop&&ye.test(o)&&n(s[o]);for(o=r.length;o--;)r[o].elem!==this||null!=t&&r[o].queue!==t||(r[o].anim.stop(i),e=!1,r.splice(o,1));!e&&i||vt.dequeue(this,t)})},finish:function(t){return!1!==t&&(t=t||"fx"),this.each(function(){var e,i=Lt.get(this),n=i[t+"queue"],o=i[t+"queueHooks"],r=vt.timers,s=n?n.length:0;for(i.finish=!0,vt.queue(this,t,[]),o&&o.stop&&o.stop.call(this,!0),e=r.length;e--;)r[e].elem===this&&r[e].queue===t&&(r[e].anim.stop(!0),r.splice(e,1));for(e=0;e<s;e++)n[e]&&n[e].finish&&n[e].finish.call(this);delete i.finish})}}),vt.each(["toggle","show","hide"],function(t,e){var i=vt.fn[e];vt.fn[e]=function(t,n,o){return null==t||"boolean"==typeof t?i.apply(this,arguments):this.animate(U(e,!0),t,n,o)}}),vt.each({slideDown:U("show"),slideUp:U("hide"),slideToggle:U("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,e){vt.fn[t]=function(t,i,n){return this.animate(e,t,i,n)}}),vt.timers=[],vt.fx.tick=function(){var t,e=0,i=vt.timers;for(pe=vt.now();e<i.length;e++)(t=i[e])()||i[e]!==t||i.splice(e--,1);i.length||vt.fx.stop(),pe=void 0},vt.fx.timer=function(t){vt.timers.push(t),vt.fx.start()},vt.fx.interval=13,vt.fx.start=function(){fe||(fe=!0,H())},vt.fx.stop=function(){fe=null},vt.fx.speeds={slow:600,fast:200,_default:400},vt.fn.delay=function(t,e){return t=vt.fx?vt.fx.speeds[t]||t:t,e=e||"fx",this.queue(e,function(e,n){var o=i.setTimeout(e,t);n.stop=function(){i.clearTimeout(o)}})},function(){var t=st.createElement("input"),e=st.createElement("select"),i=e.appendChild(st.createElement("option"));t.type="checkbox",dt.checkOn=""!==t.value,dt.optSelected=i.selected,t=st.createElement("input"),t.value="t",t.type="radio",dt.radioValue="t"===t.value}();var de,ve=vt.expr.attrHandle;vt.fn.extend({attr:function(t,e){return Et(this,vt.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each(function(){vt.removeAttr(this,t)})}}),vt.extend({attr:function(t,e,i){var n,o,r=t.nodeType;if(3!==r&&8!==r&&2!==r)return void 0===t.getAttribute?vt.prop(t,e,i):(1===r&&vt.isXMLDoc(t)||(o=vt.attrHooks[e.toLowerCase()]||(vt.expr.match.bool.test(e)?de:void 0)),void 0!==i?null===i?void vt.removeAttr(t,e):o&&"set"in o&&void 0!==(n=o.set(t,i,e))?n:(t.setAttribute(e,i+""),i):o&&"get"in o&&null!==(n=o.get(t,e))?n:(n=vt.find.attr(t,e),null==n?void 0:n))},attrHooks:{type:{set:function(t,e){if(!dt.radioValue&&"radio"===e&&l(t,"input")){var i=t.value;return t.setAttribute("type",e),i&&(t.value=i),e}}}},removeAttr:function(t,e){var i,n=0,o=e&&e.match(It);if(o&&1===t.nodeType)for(;i=o[n++];)t.removeAttribute(i)}}),de={set:function(t,e,i){return!1===e?vt.removeAttr(t,i):t.setAttribute(i,i),i}},vt.each(vt.expr.match.bool.source.match(/\w+/g),function(t,e){var i=ve[e]||vt.find.attr;ve[e]=function(t,e,n){var o,r,s=e.toLowerCase();return n||(r=ve[s],ve[s]=o,o=null!=i(t,e,n)?s:null,ve[s]=r),o}});var ge=/^(?:input|select|textarea|button)$/i,xe=/^(?:a|area)$/i;vt.fn.extend({prop:function(t,e){return Et(this,vt.prop,t,e,arguments.length>1)},removeProp:function(t){return this.each(function(){delete this[vt.propFix[t]||t]})}}),vt.extend({prop:function(t,e,i){var n,o,r=t.nodeType;if(3!==r&&8!==r&&2!==r)return 1===r&&vt.isXMLDoc(t)||(e=vt.propFix[e]||e,o=vt.propHooks[e]),void 0!==i?o&&"set"in o&&void 0!==(n=o.set(t,i,e))?n:t[e]=i:o&&"get"in o&&null!==(n=o.get(t,e))?n:t[e]},propHooks:{tabIndex:{get:function(t){var e=vt.find.attr(t,"tabindex");return e?parseInt(e,10):ge.test(t.nodeName)||xe.test(t.nodeName)&&t.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),dt.optSelected||(vt.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null},set:function(t){var e=t.parentNode;e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex)}}),vt.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){vt.propFix[this.toLowerCase()]=this}),vt.fn.extend({addClass:function(t){var e,i,n,o,r,s,a,l=0;if(vt.isFunction(t))return this.each(function(e){vt(this).addClass(t.call(this,e,Z(this)))});if("string"==typeof t&&t)for(e=t.match(It)||[];i=this[l++];)if(o=Z(i),n=1===i.nodeType&&" "+X(o)+" "){for(s=0;r=e[s++];)n.indexOf(" "+r+" ")<0&&(n+=r+" ");a=X(n),o!==a&&i.setAttribute("class",a)}return this},removeClass:function(t){var e,i,n,o,r,s,a,l=0;if(vt.isFunction(t))return this.each(function(e){vt(this).removeClass(t.call(this,e,Z(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof t&&t)for(e=t.match(It)||[];i=this[l++];)if(o=Z(i),n=1===i.nodeType&&" "+X(o)+" "){for(s=0;r=e[s++];)for(;n.indexOf(" "+r+" ")>-1;)n=n.replace(" "+r+" "," ");a=X(n),o!==a&&i.setAttribute("class",a)}return this},toggleClass:function(t,e){var i=typeof t;return"boolean"==typeof e&&"string"===i?e?this.addClass(t):this.removeClass(t):vt.isFunction(t)?this.each(function(i){vt(this).toggleClass(t.call(this,i,Z(this),e),e)}):this.each(function(){var e,n,o,r;if("string"===i)for(n=0,o=vt(this),r=t.match(It)||[];e=r[n++];)o.hasClass(e)?o.removeClass(e):o.addClass(e);else void 0!==t&&"boolean"!==i||(e=Z(this),e&&Lt.set(this,"__className__",e),this.setAttribute&&this.setAttribute("class",e||!1===t?"":Lt.get(this,"__className__")||""))})},hasClass:function(t){var e,i,n=0;for(e=" "+t+" ";i=this[n++];)if(1===i.nodeType&&(" "+X(Z(i))+" ").indexOf(e)>-1)return!0;return!1}});vt.fn.extend({val:function(t){var e,i,n,o=this[0];{if(arguments.length)return n=vt.isFunction(t),this.each(function(i){var o;1===this.nodeType&&(o=n?t.call(this,i,vt(this).val()):t,null==o?o="":"number"==typeof o?o+="":Array.isArray(o)&&(o=vt.map(o,function(t){return null==t?"":t+""})),(e=vt.valHooks[this.type]||vt.valHooks[this.nodeName.toLowerCase()])&&"set"in e&&void 0!==e.set(this,o,"value")||(this.value=o))});if(o)return(e=vt.valHooks[o.type]||vt.valHooks[o.nodeName.toLowerCase()])&&"get"in e&&void 0!==(i=e.get(o,"value"))?i:(i=o.value,"string"==typeof i?i.replace(/\r/g,""):null==i?"":i)}}}),vt.extend({valHooks:{option:{get:function(t){var e=vt.find.attr(t,"value");return null!=e?e:X(vt.text(t))}},select:{get:function(t){var e,i,n,o=t.options,r=t.selectedIndex,s="select-one"===t.type,a=s?null:[],c=s?r+1:o.length;for(n=r<0?c:s?r:0;n<c;n++)if(i=o[n],(i.selected||n===r)&&!i.disabled&&(!i.parentNode.disabled||!l(i.parentNode,"optgroup"))){if(e=vt(i).val(),s)return e;a.push(e)}return a},set:function(t,e){for(var i,n,o=t.options,r=vt.makeArray(e),s=o.length;s--;)n=o[s],(n.selected=vt.inArray(vt.valHooks.option.get(n),r)>-1)&&(i=!0);return i||(t.selectedIndex=-1),r}}}}),vt.each(["radio","checkbox"],function(){vt.valHooks[this]={set:function(t,e){if(Array.isArray(e))return t.checked=vt.inArray(vt(t).val(),e)>-1}},dt.checkOn||(vt.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})});var be=/^(?:focusinfocus|focusoutblur)$/;vt.extend(vt.event,{trigger:function(t,e,n,o){var r,s,a,l,c,u,h,m=[n||st],p=ft.call(t,"type")?t.type:t,f=ft.call(t,"namespace")?t.namespace.split("."):[];if(s=a=n=n||st,3!==n.nodeType&&8!==n.nodeType&&!be.test(p+vt.event.triggered)&&(p.indexOf(".")>-1&&(f=p.split("."),p=f.shift(),f.sort()),c=p.indexOf(":")<0&&"on"+p,t=t[vt.expando]?t:new vt.Event(p,"object"==typeof t&&t),t.isTrigger=o?2:3,t.namespace=f.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=n),e=null==e?[t]:vt.makeArray(e,[t]),h=vt.event.special[p]||{},o||!h.trigger||!1!==h.trigger.apply(n,e))){if(!o&&!h.noBubble&&!vt.isWindow(n)){for(l=h.delegateType||p,be.test(l+p)||(s=s.parentNode);s;s=s.parentNode)m.push(s),a=s;a===(n.ownerDocument||st)&&m.push(a.defaultView||a.parentWindow||i)}for(r=0;(s=m[r++])&&!t.isPropagationStopped();)t.type=r>1?l:h.bindType||p,u=(Lt.get(s,"events")||{})[t.type]&&Lt.get(s,"handle"),u&&u.apply(s,e),(u=c&&s[c])&&u.apply&&Vt(s)&&(t.result=u.apply(s,e),!1===t.result&&t.preventDefault());return t.type=p,o||t.isDefaultPrevented()||h._default&&!1!==h._default.apply(m.pop(),e)||!Vt(n)||c&&vt.isFunction(n[p])&&!vt.isWindow(n)&&(a=n[c],a&&(n[c]=null),vt.event.triggered=p,n[p](),vt.event.triggered=void 0,a&&(n[c]=a)),t.result}},simulate:function(t,e,i){var n=vt.extend(new vt.Event,i,{type:t,isSimulated:!0});vt.event.trigger(n,null,e)}}),vt.fn.extend({trigger:function(t,e){return this.each(function(){vt.event.trigger(t,e,this)})},triggerHandler:function(t,e){var i=this[0];if(i)return vt.event.trigger(t,e,i,!0)}}),vt.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(t,e){vt.fn[e]=function(t,i){return arguments.length>0?this.on(e,null,t,i):this.trigger(e)}}),vt.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}}),dt.focusin="onfocusin"in i,dt.focusin||vt.each({focus:"focusin",blur:"focusout"},function(t,e){var i=function(t){vt.event.simulate(e,t.target,vt.event.fix(t))};vt.event.special[e]={setup:function(){var n=this.ownerDocument||this,o=Lt.access(n,e);o||n.addEventListener(t,i,!0),Lt.access(n,e,(o||0)+1)},teardown:function(){var n=this.ownerDocument||this,o=Lt.access(n,e)-1;o?Lt.access(n,e,o):(n.removeEventListener(t,i,!0),Lt.remove(n,e))}}});var Ce=i.location,Se=vt.now(),we=/\?/;vt.parseXML=function(t){var e;if(!t||"string"!=typeof t)return null;try{e=(new i.DOMParser).parseFromString(t,"text/xml")}catch(t){e=void 0}return e&&!e.getElementsByTagName("parsererror").length||vt.error("Invalid XML: "+t),e};var Ae=/\[\]$/,De=/^(?:submit|button|image|reset|file)$/i,Me=/^(?:input|select|textarea|keygen)/i;vt.param=function(t,e){var i,n=[],o=function(t,e){var i=vt.isFunction(e)?e():e;n[n.length]=encodeURIComponent(t)+"="+encodeURIComponent(null==i?"":i)};if(Array.isArray(t)||t.jquery&&!vt.isPlainObject(t))vt.each(t,function(){o(this.name,this.value)});else for(i in t)Q(i,t[i],e,o);return n.join("&")},vt.fn.extend({serialize:function(){return vt.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=vt.prop(this,"elements");return t?vt.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!vt(this).is(":disabled")&&Me.test(this.nodeName)&&!De.test(t)&&(this.checked||!qt.test(t))}).map(function(t,e){var i=vt(this).val();return null==i?null:Array.isArray(i)?vt.map(i,function(t){return{name:e.name,value:t.replace(/\r?\n/g,"\r\n")}}):{name:e.name,value:i.replace(/\r?\n/g,"\r\n")}}).get()}});var ke=/^(.*?):[ \t]*([^\r\n]*)$/gm,Be=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Ie=/^(?:GET|HEAD)$/,Pe={},Te={},Ee="*/".concat("*"),Ve=st.createElement("a");Ve.href=Ce.href,vt.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Ce.href,type:"GET",isLocal:Be.test(Ce.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Ee,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":vt.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?it(it(t,vt.ajaxSettings),e):it(vt.ajaxSettings,t)},ajaxPrefilter:tt(Pe),ajaxTransport:tt(Te),ajax:function(t,e){function n(t,e,n,a){var c,m,p,x,b,C=e;u||(u=!0,l&&i.clearTimeout(l),o=void 0,s=a||"",S.readyState=t>0?4:0,c=t>=200&&t<300||304===t,n&&(x=nt(f,S,n)),x=ot(f,x,S,c),c?(f.ifModified&&(b=S.getResponseHeader("Last-Modified"),b&&(vt.lastModified[r]=b),(b=S.getResponseHeader("etag"))&&(vt.etag[r]=b)),204===t||"HEAD"===f.type?C="nocontent":304===t?C="notmodified":(C=x.state,m=x.data,p=x.error,c=!p)):(p=C,!t&&C||(C="error",t<0&&(t=0))),S.status=t,S.statusText=(e||C)+"",c?d.resolveWith(_,[m,C,S]):d.rejectWith(_,[S,C,p]),S.statusCode(g),g=void 0,h&&y.trigger(c?"ajaxSuccess":"ajaxError",[S,f,c?m:p]),v.fireWith(_,[S,C]),h&&(y.trigger("ajaxComplete",[S,f]),--vt.active||vt.event.trigger("ajaxStop")))}"object"==typeof t&&(e=t,t=void 0),e=e||{};var o,r,s,a,l,c,u,h,m,p,f=vt.ajaxSetup({},e),_=f.context||f,y=f.context&&(_.nodeType||_.jquery)?vt(_):vt.event,d=vt.Deferred(),v=vt.Callbacks("once memory"),g=f.statusCode||{},x={},b={},C="canceled",S={readyState:0,getResponseHeader:function(t){var e;if(u){if(!a)for(a={};e=ke.exec(s);)a[e[1].toLowerCase()]=e[2];e=a[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return u?s:null},setRequestHeader:function(t,e){return null==u&&(t=b[t.toLowerCase()]=b[t.toLowerCase()]||t,x[t]=e),this},overrideMimeType:function(t){return null==u&&(f.mimeType=t),this},statusCode:function(t){var e;if(t)if(u)S.always(t[S.status]);else for(e in t)g[e]=[g[e],t[e]];return this},abort:function(t){var e=t||C;return o&&o.abort(e),n(0,e),this}};if(d.promise(S),f.url=((t||f.url||Ce.href)+"").replace(/^\/\//,Ce.protocol+"//"),f.type=e.method||e.type||f.method||f.type,f.dataTypes=(f.dataType||"*").toLowerCase().match(It)||[""],null==f.crossDomain){c=st.createElement("a");try{c.href=f.url,c.href=c.href,f.crossDomain=Ve.protocol+"//"+Ve.host!=c.protocol+"//"+c.host}catch(t){f.crossDomain=!0}}if(f.data&&f.processData&&"string"!=typeof f.data&&(f.data=vt.param(f.data,f.traditional)),et(Pe,f,e,S),u)return S;h=vt.event&&f.global,h&&0==vt.active++&&vt.event.trigger("ajaxStart"),f.type=f.type.toUpperCase(),f.hasContent=!Ie.test(f.type),r=f.url.replace(/#.*$/,""),f.hasContent?f.data&&f.processData&&0===(f.contentType||"").indexOf("application/x-www-form-urlencoded")&&(f.data=f.data.replace(/%20/g,"+")):(p=f.url.slice(r.length),f.data&&(r+=(we.test(r)?"&":"?")+f.data,delete f.data),!1===f.cache&&(r=r.replace(/([?&])_=[^&]*/,"$1"),p=(we.test(r)?"&":"?")+"_="+Se+++p),f.url=r+p),f.ifModified&&(vt.lastModified[r]&&S.setRequestHeader("If-Modified-Since",vt.lastModified[r]),vt.etag[r]&&S.setRequestHeader("If-None-Match",vt.etag[r])),(f.data&&f.hasContent&&!1!==f.contentType||e.contentType)&&S.setRequestHeader("Content-Type",f.contentType),S.setRequestHeader("Accept",f.dataTypes[0]&&f.accepts[f.dataTypes[0]]?f.accepts[f.dataTypes[0]]+("*"!==f.dataTypes[0]?", "+Ee+"; q=0.01":""):f.accepts["*"]);for(m in f.headers)S.setRequestHeader(m,f.headers[m]);if(f.beforeSend&&(!1===f.beforeSend.call(_,S,f)||u))return S.abort();if(C="abort",v.add(f.complete),S.done(f.success),S.fail(f.error),o=et(Te,f,e,S)){if(S.readyState=1,h&&y.trigger("ajaxSend",[S,f]),u)return S;f.async&&f.timeout>0&&(l=i.setTimeout(function(){S.abort("timeout")},f.timeout));try{u=!1,o.send(x,n)}catch(t){if(u)throw t;n(-1,t)}}else n(-1,"No Transport");return S},getJSON:function(t,e,i){return vt.get(t,e,i,"json")},getScript:function(t,e){return vt.get(t,void 0,e,"script")}}),vt.each(["get","post"],function(t,e){vt[e]=function(t,i,n,o){return vt.isFunction(i)&&(o=o||n,n=i,i=void 0),vt.ajax(vt.extend({url:t,type:e,dataType:o,data:i,success:n},vt.isPlainObject(t)&&t))}}),vt._evalUrl=function(t){return vt.ajax({url:t,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,throws:!0})},vt.fn.extend({wrapAll:function(t){var e;return this[0]&&(vt.isFunction(t)&&(t=t.call(this[0])),e=vt(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t}).append(this)),this},wrapInner:function(t){return vt.isFunction(t)?this.each(function(e){vt(this).wrapInner(t.call(this,e))}):this.each(function(){var e=vt(this),i=e.contents();i.length?i.wrapAll(t):e.append(t)})},wrap:function(t){var e=vt.isFunction(t);return this.each(function(i){vt(this).wrapAll(e?t.call(this,i):t)})},unwrap:function(t){return this.parent(t).not("body").each(function(){vt(this).replaceWith(this.childNodes)}),this}}),vt.expr.pseudos.hidden=function(t){return!vt.expr.pseudos.visible(t)},vt.expr.pseudos.visible=function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)},vt.ajaxSettings.xhr=function(){try{return new i.XMLHttpRequest}catch(t){}};var Le={0:200,1223:204},Re=vt.ajaxSettings.xhr();dt.cors=!!Re&&"withCredentials"in Re,dt.ajax=Re=!!Re,vt.ajaxTransport(function(t){var e,n;if(dt.cors||Re&&!t.crossDomain)return{send:function(o,r){var s,a=t.xhr();if(a.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(s in t.xhrFields)a[s]=t.xhrFields[s];t.mimeType&&a.overrideMimeType&&a.overrideMimeType(t.mimeType),t.crossDomain||o["X-Requested-With"]||(o["X-Requested-With"]="XMLHttpRequest");for(s in o)a.setRequestHeader(s,o[s]);e=function(t){return function(){e&&(e=n=a.onload=a.onerror=a.onabort=a.onreadystatechange=null,"abort"===t?a.abort():"error"===t?"number"!=typeof a.status?r(0,"error"):r(a.status,a.statusText):r(Le[a.status]||a.status,a.statusText,"text"!==(a.responseType||"text")||"string"!=typeof a.responseText?{binary:a.response}:{text:a.responseText},a.getAllResponseHeaders()))}},a.onload=e(),n=a.onerror=e("error"),void 0!==a.onabort?a.onabort=n:a.onreadystatechange=function(){4===a.readyState&&i.setTimeout(function(){e&&n()})},e=e("abort");try{a.send(t.hasContent&&t.data||null)}catch(t){if(e)throw t}},abort:function(){e&&e()}}}),vt.ajaxPrefilter(function(t){t.crossDomain&&(t.contents.script=!1)}),vt.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return vt.globalEval(t),t}}}),vt.ajaxPrefilter("script",function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")}),vt.ajaxTransport("script",function(t){if(t.crossDomain){var e,i;return{send:function(n,o){e=vt("<script>").prop({charset:t.scriptCharset,src:t.url}).on("load error",i=function(t){e.remove(),i=null,t&&o("error"===t.type?404:200,t.type)}),st.head.appendChild(e[0])},abort:function(){i&&i()}}}});var Ne=[],Fe=/(=)\?(?=&|$)|\?\?/;vt.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=Ne.pop()||vt.expando+"_"+Se++;return this[t]=!0,t}}),vt.ajaxPrefilter("json jsonp",function(t,e,n){var o,r,s,a=!1!==t.jsonp&&(Fe.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Fe.test(t.data)&&"data");if(a||"jsonp"===t.dataTypes[0])return o=t.jsonpCallback=vt.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,a?t[a]=t[a].replace(Fe,"$1"+o):!1!==t.jsonp&&(t.url+=(we.test(t.url)?"&":"?")+t.jsonp+"="+o),t.converters["script json"]=function(){return s||vt.error(o+" was not called"),s[0]},t.dataTypes[0]="json",r=i[o],i[o]=function(){s=arguments},n.always(function(){void 0===r?vt(i).removeProp(o):i[o]=r,t[o]&&(t.jsonpCallback=e.jsonpCallback,Ne.push(o)),s&&vt.isFunction(r)&&r(s[0]),s=r=void 0}),"script"}),dt.createHTMLDocument=function(){var t=st.implementation.createHTMLDocument("").body;return t.innerHTML="<form></form><form></form>",2===t.childNodes.length}(),vt.parseHTML=function(t,e,i){if("string"!=typeof t)return[];"boolean"==typeof e&&(i=e,e=!1);var n,o,r;return e||(dt.createHTMLDocument?(e=st.implementation.createHTMLDocument(""),n=e.createElement("base"),n.href=st.location.href,e.head.appendChild(n)):e=st),o=wt.exec(t),r=!i&&[],o?[e.createElement(o[1])]:(o=w([t],e,r),r&&r.length&&vt(r).remove(),vt.merge([],o.childNodes))},vt.fn.load=function(t,e,i){var n,o,r,s=this,a=t.indexOf(" ");return a>-1&&(n=X(t.slice(a)),t=t.slice(0,a)),vt.isFunction(e)?(i=e,e=void 0):e&&"object"==typeof e&&(o="POST"),s.length>0&&vt.ajax({url:t,type:o||"GET",dataType:"html",data:e}).done(function(t){r=arguments,s.html(n?vt("<div>").append(vt.parseHTML(t)).find(n):t)}).always(i&&function(t,e){s.each(function(){i.apply(this,r||[t.responseText,e,t])})}),this},vt.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){vt.fn[e]=function(t){return this.on(e,t)}}),vt.expr.pseudos.animated=function(t){return vt.grep(vt.timers,function(e){return t===e.elem}).length},vt.offset={setOffset:function(t,e,i){var n,o,r,s,a,l,c,u=vt.css(t,"position"),h=vt(t),m={};"static"===u&&(t.style.position="relative"),a=h.offset(),r=vt.css(t,"top"),l=vt.css(t,"left"),c=("absolute"===u||"fixed"===u)&&(r+l).indexOf("auto")>-1,c?(n=h.position(),s=n.top,o=n.left):(s=parseFloat(r)||0,o=parseFloat(l)||0),vt.isFunction(e)&&(e=e.call(t,i,vt.extend({},a))),null!=e.top&&(m.top=e.top-a.top+s),null!=e.left&&(m.left=e.left-a.left+o),"using"in e?e.using.call(t,m):h.css(m)}},vt.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){vt.offset.setOffset(this,t,e)});var e,i,n,o,r=this[0];if(r)return r.getClientRects().length?(n=r.getBoundingClientRect(),e=r.ownerDocument,i=e.documentElement,o=e.defaultView,{top:n.top+o.pageYOffset-i.clientTop,left:n.left+o.pageXOffset-i.clientLeft}):{top:0,left:0}},position:function(){if(this[0]){var t,e,i=this[0],n={top:0,left:0};return"fixed"===vt.css(i,"position")?e=i.getBoundingClientRect():(t=this.offsetParent(),e=this.offset(),l(t[0],"html")||(n=t.offset()),n={top:n.top+vt.css(t[0],"borderTopWidth",!0),left:n.left+vt.css(t[0],"borderLeftWidth",!0)}),{top:e.top-n.top-vt.css(i,"marginTop",!0),left:e.left-n.left-vt.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent;t&&"static"===vt.css(t,"position");)t=t.offsetParent;return t||Yt})}}),vt.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,e){var i="pageYOffset"===e;vt.fn[t]=function(n){return Et(this,function(t,n,o){var r;if(vt.isWindow(t)?r=t:9===t.nodeType&&(r=t.defaultView),void 0===o)return r?r[e]:t[n];r?r.scrollTo(i?r.pageXOffset:o,i?o:r.pageYOffset):t[n]=o},t,n,arguments.length)}}),vt.each(["top","left"],function(t,e){vt.cssHooks[e]=N(dt.pixelPosition,function(t,i){if(i)return i=R(t,e),re.test(i)?vt(t).position()[e]+"px":i})}),vt.each({Height:"height",Width:"width"},function(t,e){vt.each({padding:"inner"+t,content:e,"":"outer"+t},function(i,n){vt.fn[n]=function(o,r){var s=arguments.length&&(i||"boolean"!=typeof o),a=i||(!0===o||!0===r?"margin":"border");return Et(this,function(e,i,o){var r;return vt.isWindow(e)?0===n.indexOf("outer")?e["inner"+t]:e.document.documentElement["client"+t]:9===e.nodeType?(r=e.documentElement,Math.max(e.body["scroll"+t],r["scroll"+t],e.body["offset"+t],r["offset"+t],r["client"+t])):void 0===o?vt.css(e,i,a):vt.style(e,i,o,a)},e,s?o:void 0,s)}})}),vt.fn.extend({bind:function(t,e,i){return this.on(t,null,e,i)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,i,n){return this.on(e,t,i,n)},undelegate:function(t,e,i){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",i)}}),vt.holdReady=function(t){t?vt.readyWait++:vt.ready(!0)},vt.isArray=Array.isArray,vt.parseJSON=JSON.parse,vt.nodeName=l,n=[],void 0!==(o=function(){return vt}.apply(e,n))&&(t.exports=o);var Oe=i.jQuery,Ge=i.$;return vt.noConflict=function(t){return i.$===vt&&(i.$=Ge),t&&i.jQuery===vt&&(i.jQuery=Oe),vt},r||(i.jQuery=i.$=vt),vt})},function(t,e,i){var n,o;(function(){function i(t){function e(e,i,n,o,r,s){for(;r>=0&&r<s;r+=t){var a=o?o[r]:r;n=i(n,e[a],a,e)}return n}return function(i,n,o,r){n=S(n,r,4);var s=!I(i)&&C.keys(i),a=(s||i).length,l=t>0?0:a-1;return arguments.length<3&&(o=i[s?s[l]:l],l+=t),e(i,n,o,s,l,a)}}function r(t){return function(e,i,n){i=w(i,n);for(var o=B(e),r=t>0?0:o-1;r>=0&&r<o;r+=t)if(i(e[r],r,e))return r;return-1}}function s(t,e,i){return function(n,o,r){var s=0,a=B(n);if("number"==typeof r)t>0?s=r>=0?r:Math.max(r+a,s):a=r>=0?Math.min(r+1,a):r+a+1;else if(i&&r&&a)return r=i(n,o),n[r]===o?r:-1;if(o!==o)return r=e(f.call(n,s,a),C.isNaN),r>=0?r+s:-1;for(r=t>0?s:a-1;r>=0&&r<a;r+=t)if(n[r]===o)return r;return-1}}function a(t,e){var i=L.length,n=t.constructor,o=C.isFunction(n)&&n.prototype||h,r="constructor";for(C.has(t,r)&&!C.contains(e,r)&&e.push(r);i--;)(r=L[i])in t&&t[r]!==o[r]&&!C.contains(e,r)&&e.push(r)}var l=this,c=l._,u=Array.prototype,h=Object.prototype,m=Function.prototype,p=u.push,f=u.slice,_=h.toString,y=h.hasOwnProperty,d=Array.isArray,v=Object.keys,g=m.bind,x=Object.create,b=function(){},C=function(t){return t instanceof C?t:this instanceof C?void(this._wrapped=t):new C(t)};void 0!==t&&t.exports&&(e=t.exports=C),e._=C,C.VERSION="1.8.3";var S=function(t,e,i){if(void 0===e)return t;switch(null==i?3:i){case 1:return function(i){return t.call(e,i)};case 2:return function(i,n){return t.call(e,i,n)};case 3:return function(i,n,o){return t.call(e,i,n,o)};case 4:return function(i,n,o,r){return t.call(e,i,n,o,r)}}return function(){return t.apply(e,arguments)}},w=function(t,e,i){return null==t?C.identity:C.isFunction(t)?S(t,e,i):C.isObject(t)?C.matcher(t):C.property(t)};C.iteratee=function(t,e){return w(t,e,1/0)};var A=function(t,e){return function(i){var n=arguments.length;if(n<2||null==i)return i;for(var o=1;o<n;o++)for(var r=arguments[o],s=t(r),a=s.length,l=0;l<a;l++){var c=s[l];e&&void 0!==i[c]||(i[c]=r[c])}return i}},D=function(t){if(!C.isObject(t))return{};if(x)return x(t);b.prototype=t;var e=new b;return b.prototype=null,e},M=function(t){return function(e){return null==e?void 0:e[t]}},k=Math.pow(2,53)-1,B=M("length"),I=function(t){var e=B(t);return"number"==typeof e&&e>=0&&e<=k};C.each=C.forEach=function(t,e,i){e=S(e,i);var n,o;if(I(t))for(n=0,o=t.length;n<o;n++)e(t[n],n,t);else{var r=C.keys(t);for(n=0,o=r.length;n<o;n++)e(t[r[n]],r[n],t)}return t},C.map=C.collect=function(t,e,i){e=w(e,i);for(var n=!I(t)&&C.keys(t),o=(n||t).length,r=Array(o),s=0;s<o;s++){var a=n?n[s]:s;r[s]=e(t[a],a,t)}return r},C.reduce=C.foldl=C.inject=i(1),C.reduceRight=C.foldr=i(-1),C.find=C.detect=function(t,e,i){var n;if(void 0!==(n=I(t)?C.findIndex(t,e,i):C.findKey(t,e,i))&&-1!==n)return t[n]},C.filter=C.select=function(t,e,i){var n=[];return e=w(e,i),C.each(t,function(t,i,o){e(t,i,o)&&n.push(t)}),n},C.reject=function(t,e,i){return C.filter(t,C.negate(w(e)),i)},C.every=C.all=function(t,e,i){e=w(e,i);for(var n=!I(t)&&C.keys(t),o=(n||t).length,r=0;r<o;r++){var s=n?n[r]:r;if(!e(t[s],s,t))return!1}return!0},C.some=C.any=function(t,e,i){e=w(e,i);for(var n=!I(t)&&C.keys(t),o=(n||t).length,r=0;r<o;r++){var s=n?n[r]:r;if(e(t[s],s,t))return!0}return!1},C.contains=C.includes=C.include=function(t,e,i,n){return I(t)||(t=C.values(t)),("number"!=typeof i||n)&&(i=0),C.indexOf(t,e,i)>=0},C.invoke=function(t,e){var i=f.call(arguments,2),n=C.isFunction(e);return C.map(t,function(t){var o=n?e:t[e];return null==o?o:o.apply(t,i)})},C.pluck=function(t,e){return C.map(t,C.property(e))},C.where=function(t,e){return C.filter(t,C.matcher(e))},C.findWhere=function(t,e){return C.find(t,C.matcher(e))},C.max=function(t,e,i){var n,o,r=-1/0,s=-1/0;if(null==e&&null!=t){t=I(t)?t:C.values(t);for(var a=0,l=t.length;a<l;a++)(n=t[a])>r&&(r=n)}else e=w(e,i),C.each(t,function(t,i,n){((o=e(t,i,n))>s||o===-1/0&&r===-1/0)&&(r=t,s=o)});return r},C.min=function(t,e,i){var n,o,r=1/0,s=1/0;if(null==e&&null!=t){t=I(t)?t:C.values(t);for(var a=0,l=t.length;a<l;a++)(n=t[a])<r&&(r=n)}else e=w(e,i),C.each(t,function(t,i,n){((o=e(t,i,n))<s||o===1/0&&r===1/0)&&(r=t,s=o)});return r},C.shuffle=function(t){for(var e,i=I(t)?t:C.values(t),n=i.length,o=Array(n),r=0;r<n;r++)e=C.random(0,r),e!==r&&(o[r]=o[e]),o[e]=i[r];return o},C.sample=function(t,e,i){return null==e||i?(I(t)||(t=C.values(t)),t[C.random(t.length-1)]):C.shuffle(t).slice(0,Math.max(0,e))},C.sortBy=function(t,e,i){return e=w(e,i),C.pluck(C.map(t,function(t,i,n){return{value:t,index:i,criteria:e(t,i,n)}}).sort(function(t,e){var i=t.criteria,n=e.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(i<n||void 0===n)return-1}return t.index-e.index}),"value")};var P=function(t){return function(e,i,n){var o={};return i=w(i,n),C.each(e,function(n,r){var s=i(n,r,e);t(o,n,s)}),o}};C.groupBy=P(function(t,e,i){C.has(t,i)?t[i].push(e):t[i]=[e]}),C.indexBy=P(function(t,e,i){t[i]=e}),C.countBy=P(function(t,e,i){C.has(t,i)?t[i]++:t[i]=1}),C.toArray=function(t){return t?C.isArray(t)?f.call(t):I(t)?C.map(t,C.identity):C.values(t):[]},C.size=function(t){return null==t?0:I(t)?t.length:C.keys(t).length},C.partition=function(t,e,i){e=w(e,i);var n=[],o=[];return C.each(t,function(t,i,r){(e(t,i,r)?n:o).push(t)}),[n,o]},C.first=C.head=C.take=function(t,e,i){if(null!=t)return null==e||i?t[0]:C.initial(t,t.length-e)},C.initial=function(t,e,i){return f.call(t,0,Math.max(0,t.length-(null==e||i?1:e)))},C.last=function(t,e,i){if(null!=t)return null==e||i?t[t.length-1]:C.rest(t,Math.max(0,t.length-e))},C.rest=C.tail=C.drop=function(t,e,i){return f.call(t,null==e||i?1:e)},C.compact=function(t){return C.filter(t,C.identity)};var T=function(t,e,i,n){for(var o=[],r=0,s=n||0,a=B(t);s<a;s++){var l=t[s];if(I(l)&&(C.isArray(l)||C.isArguments(l))){e||(l=T(l,e,i));var c=0,u=l.length;for(o.length+=u;c<u;)o[r++]=l[c++]}else i||(o[r++]=l)}return o};C.flatten=function(t,e){return T(t,e,!1)},C.without=function(t){return C.difference(t,f.call(arguments,1))},C.uniq=C.unique=function(t,e,i,n){C.isBoolean(e)||(n=i,i=e,e=!1),null!=i&&(i=w(i,n));for(var o=[],r=[],s=0,a=B(t);s<a;s++){var l=t[s],c=i?i(l,s,t):l;e?(s&&r===c||o.push(l),r=c):i?C.contains(r,c)||(r.push(c),o.push(l)):C.contains(o,l)||o.push(l)}return o},C.union=function(){return C.uniq(T(arguments,!0,!0))},C.intersection=function(t){for(var e=[],i=arguments.length,n=0,o=B(t);n<o;n++){var r=t[n];if(!C.contains(e,r)){for(var s=1;s<i&&C.contains(arguments[s],r);s++);s===i&&e.push(r)}}return e},C.difference=function(t){var e=T(arguments,!0,!0,1);return C.filter(t,function(t){return!C.contains(e,t)})},C.zip=function(){return C.unzip(arguments)},C.unzip=function(t){for(var e=t&&C.max(t,B).length||0,i=Array(e),n=0;n<e;n++)i[n]=C.pluck(t,n);return i},C.object=function(t,e){for(var i={},n=0,o=B(t);n<o;n++)e?i[t[n]]=e[n]:i[t[n][0]]=t[n][1];return i},C.findIndex=r(1),C.findLastIndex=r(-1),C.sortedIndex=function(t,e,i,n){i=w(i,n,1);for(var o=i(e),r=0,s=B(t);r<s;){var a=Math.floor((r+s)/2);i(t[a])<o?r=a+1:s=a}return r},C.indexOf=s(1,C.findIndex,C.sortedIndex),C.lastIndexOf=s(-1,C.findLastIndex),C.range=function(t,e,i){null==e&&(e=t||0,t=0),i=i||1;for(var n=Math.max(Math.ceil((e-t)/i),0),o=Array(n),r=0;r<n;r++,t+=i)o[r]=t;return o};var E=function(t,e,i,n,o){if(!(n instanceof e))return t.apply(i,o);var r=D(t.prototype),s=t.apply(r,o);return C.isObject(s)?s:r};C.bind=function(t,e){if(g&&t.bind===g)return g.apply(t,f.call(arguments,1));if(!C.isFunction(t))throw new TypeError("Bind must be called on a function");var i=f.call(arguments,2),n=function(){return E(t,n,e,this,i.concat(f.call(arguments)))};return n},C.partial=function(t){var e=f.call(arguments,1),i=function(){for(var n=0,o=e.length,r=Array(o),s=0;s<o;s++)r[s]=e[s]===C?arguments[n++]:e[s];for(;n<arguments.length;)r.push(arguments[n++]);return E(t,i,this,this,r)};return i},C.bindAll=function(t){var e,i,n=arguments.length;if(n<=1)throw new Error("bindAll must be passed function names");for(e=1;e<n;e++)i=arguments[e],t[i]=C.bind(t[i],t);return t},C.memoize=function(t,e){var i=function(n){var o=i.cache,r=""+(e?e.apply(this,arguments):n);return C.has(o,r)||(o[r]=t.apply(this,arguments)),o[r]};return i.cache={},i},C.delay=function(t,e){var i=f.call(arguments,2);return setTimeout(function(){return t.apply(null,i)},e)},C.defer=C.partial(C.delay,C,1),C.throttle=function(t,e,i){var n,o,r,s=null,a=0;i||(i={});var l=function(){a=!1===i.leading?0:C.now(),s=null,r=t.apply(n,o),s||(n=o=null)};return function(){var c=C.now();a||!1!==i.leading||(a=c);var u=e-(c-a);return n=this,o=arguments,u<=0||u>e?(s&&(clearTimeout(s),s=null),a=c,r=t.apply(n,o),s||(n=o=null)):s||!1===i.trailing||(s=setTimeout(l,u)),r}},C.debounce=function(t,e,i){var n,o,r,s,a,l=function(){var c=C.now()-s;c<e&&c>=0?n=setTimeout(l,e-c):(n=null,i||(a=t.apply(r,o),n||(r=o=null)))};return function(){r=this,o=arguments,s=C.now();var c=i&&!n;return n||(n=setTimeout(l,e)),c&&(a=t.apply(r,o),r=o=null),a}},C.wrap=function(t,e){return C.partial(e,t)},C.negate=function(t){return function(){return!t.apply(this,arguments)}},C.compose=function(){var t=arguments,e=t.length-1;return function(){for(var i=e,n=t[e].apply(this,arguments);i--;)n=t[i].call(this,n);return n}},C.after=function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},C.before=function(t,e){var i;return function(){return--t>0&&(i=e.apply(this,arguments)),t<=1&&(e=null),i}},C.once=C.partial(C.before,2);var V=!{toString:null}.propertyIsEnumerable("toString"),L=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];C.keys=function(t){if(!C.isObject(t))return[];if(v)return v(t);var e=[];for(var i in t)C.has(t,i)&&e.push(i);return V&&a(t,e),e},C.allKeys=function(t){if(!C.isObject(t))return[];var e=[];for(var i in t)e.push(i);return V&&a(t,e),e},C.values=function(t){for(var e=C.keys(t),i=e.length,n=Array(i),o=0;o<i;o++)n[o]=t[e[o]];return n},C.mapObject=function(t,e,i){e=w(e,i);for(var n,o=C.keys(t),r=o.length,s={},a=0;a<r;a++)n=o[a],s[n]=e(t[n],n,t);return s},C.pairs=function(t){for(var e=C.keys(t),i=e.length,n=Array(i),o=0;o<i;o++)n[o]=[e[o],t[e[o]]];return n},C.invert=function(t){for(var e={},i=C.keys(t),n=0,o=i.length;n<o;n++)e[t[i[n]]]=i[n];return e},C.functions=C.methods=function(t){var e=[];for(var i in t)C.isFunction(t[i])&&e.push(i);return e.sort()},C.extend=A(C.allKeys),C.extendOwn=C.assign=A(C.keys),C.findKey=function(t,e,i){e=w(e,i);for(var n,o=C.keys(t),r=0,s=o.length;r<s;r++)if(n=o[r],e(t[n],n,t))return n},C.pick=function(t,e,i){var n,o,r={},s=t;if(null==s)return r;C.isFunction(e)?(o=C.allKeys(s),n=S(e,i)):(o=T(arguments,!1,!1,1),n=function(t,e,i){return e in i},s=Object(s));for(var a=0,l=o.length;a<l;a++){var c=o[a],u=s[c];n(u,c,s)&&(r[c]=u)}return r},C.omit=function(t,e,i){if(C.isFunction(e))e=C.negate(e);else{var n=C.map(T(arguments,!1,!1,1),String);e=function(t,e){return!C.contains(n,e)}}return C.pick(t,e,i)},C.defaults=A(C.allKeys,!0),C.create=function(t,e){var i=D(t);return e&&C.extendOwn(i,e),i},C.clone=function(t){return C.isObject(t)?C.isArray(t)?t.slice():C.extend({},t):t},C.tap=function(t,e){return e(t),t},C.isMatch=function(t,e){var i=C.keys(e),n=i.length;if(null==t)return!n;for(var o=Object(t),r=0;r<n;r++){var s=i[r];if(e[s]!==o[s]||!(s in o))return!1}return!0};var R=function(t,e,i,n){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof C&&(t=t._wrapped),e instanceof C&&(e=e._wrapped);var o=_.call(t);if(o!==_.call(e))return!1;switch(o){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!=+t?+e!=+e:0==+t?1/+t==1/e:+t==+e;case"[object Date]":case"[object Boolean]":return+t==+e}var r="[object Array]"===o;if(!r){if("object"!=typeof t||"object"!=typeof e)return!1;var s=t.constructor,a=e.constructor;if(s!==a&&!(C.isFunction(s)&&s instanceof s&&C.isFunction(a)&&a instanceof a)&&"constructor"in t&&"constructor"in e)return!1}i=i||[],n=n||[];for(var l=i.length;l--;)if(i[l]===t)return n[l]===e;if(i.push(t),n.push(e),r){if((l=t.length)!==e.length)return!1;for(;l--;)if(!R(t[l],e[l],i,n))return!1}else{var c,u=C.keys(t);if(l=u.length,C.keys(e).length!==l)return!1;for(;l--;)if(c=u[l],!C.has(e,c)||!R(t[c],e[c],i,n))return!1}return i.pop(),n.pop(),!0};C.isEqual=function(t,e){return R(t,e)},C.isEmpty=function(t){return null==t||(I(t)&&(C.isArray(t)||C.isString(t)||C.isArguments(t))?0===t.length:0===C.keys(t).length)},C.isElement=function(t){return!(!t||1!==t.nodeType)},C.isArray=d||function(t){return"[object Array]"===_.call(t)},C.isObject=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},C.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(t){C["is"+t]=function(e){return _.call(e)==="[object "+t+"]"}}),C.isArguments(arguments)||(C.isArguments=function(t){return C.has(t,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(C.isFunction=function(t){return"function"==typeof t||!1}),C.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},C.isNaN=function(t){return C.isNumber(t)&&t!==+t},C.isBoolean=function(t){return!0===t||!1===t||"[object Boolean]"===_.call(t)},C.isNull=function(t){return null===t},C.isUndefined=function(t){return void 0===t},C.has=function(t,e){return null!=t&&y.call(t,e)},C.noConflict=function(){return l._=c,this},C.identity=function(t){return t},C.constant=function(t){return function(){return t}},C.noop=function(){},C.property=M,C.propertyOf=function(t){return null==t?function(){}:function(e){return t[e]}},C.matcher=C.matches=function(t){return t=C.extendOwn({},t),function(e){return C.isMatch(e,t)}},C.times=function(t,e,i){var n=Array(Math.max(0,t));e=S(e,i,1);for(var o=0;o<t;o++)n[o]=e(o);return n},C.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},C.now=Date.now||function(){return(new Date).getTime()};var N={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},F=C.invert(N),O=function(t){var e=function(e){return t[e]},i="(?:"+C.keys(t).join("|")+")",n=RegExp(i),o=RegExp(i,"g");return function(t){return t=null==t?"":""+t,n.test(t)?t.replace(o,e):t}};C.escape=O(N),C.unescape=O(F),C.result=function(t,e,i){var n=null==t?void 0:t[e];return void 0===n&&(n=i),C.isFunction(n)?n.call(t):n};var G=0;C.uniqueId=function(t){var e=++G+"";return t?t+e:e},C.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var J={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},j=function(t){return"\\"+J[t]};C.template=function(t,e,i){!e&&i&&(e=i),e=C.defaults({},e,C.templateSettings);var n=RegExp([(e.escape||/(.)^/).source,(e.interpolate||/(.)^/).source,(e.evaluate||/(.)^/).source].join("|")+"|$","g"),o=0,r="__p+='";t.replace(n,function(e,i,n,s,a){return r+=t.slice(o,a).replace(/\\|'|\r|\n|\u2028|\u2029/g,j),o=a+e.length,i?r+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'":n?r+="'+\n((__t=("+n+"))==null?'':__t)+\n'":s&&(r+="';\n"+s+"\n__p+='"),e}),r+="';\n",e.variable||(r="with(obj||{}){\n"+r+"}\n"),r="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+r+"return __p;\n";try{var s=new Function(e.variable||"obj","_",r)}catch(t){throw t.source=r,t}var a=function(t){return s.call(this,t,C)},l=e.variable||"obj";return a.source="function("+l+"){\n"+r+"}",a},C.chain=function(t){var e=C(t);return e._chain=!0,e};var z=function(t,e){return t._chain?C(e).chain():e};C.mixin=function(t){C.each(C.functions(t),function(e){var i=C[e]=t[e];C.prototype[e]=function(){var t=[this._wrapped];return p.apply(t,arguments),z(this,i.apply(C,t))}})},C.mixin(C),C.each(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=u[t];C.prototype[t]=function(){var i=this._wrapped;return e.apply(i,arguments),"shift"!==t&&"splice"!==t||0!==i.length||delete i[0],z(this,i)}}),C.each(["concat","join","slice"],function(t){var e=u[t];C.prototype[t]=function(){return z(this,e.apply(this._wrapped,arguments))}}),C.prototype.value=function(){return this._wrapped},C.prototype.valueOf=C.prototype.toJSON=C.prototype.value,C.prototype.toString=function(){return""+this._wrapped},n=[],void 0!==(o=function(){return C}.apply(e,n))&&(t.exports=o)}).call(this)},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i.d(e,"IMG_BG_BAYOU",function(){return n}),i.d(e,"IMG_BG_PL_DIED",function(){return o}),i.d(e,"IMG_SPR_PLAYER_TEST",function(){return r}),i.d(e,"IMG_SPR_PLAYER_ZERO",function(){return s}),i.d(e,"IMG_SPR_NPC_SLIME",function(){return a}),i.d(e,"ICON_CROSSED_SWORDS",function(){return l}),i.d(e,"ICON_CHECKED_SHIELD",function(){return c});var n="/images/typewar/backgrounds/Fighting-Game-Background-GIFs-2.gif",o="/images/typewar/backgrounds/battle_over_lose.jpg",r="/images/typewar/sprites/player_test.png",s="/images/typewar/sprites/player_zero.png",a="/images/typewar/sprites/b_npc_slime.png",l="/typewar/icons/crossed-swords.svg",c="/typewar/icons/checked-shield.svg"},function(t,e){Crafty.c("BattleParticles",{init:function(){this._triggerParticles=!1,this._particleBuffer=[]},battleParticles:function(){return this},getParticleBuffer:function(){return this._particleBuffer},setParticleBuffer:function(t){this._particleBuffer=t},needTriggerParticles:function(){return this._triggerParticles},triggerParticles:function(){this._triggerParticles=!0}})},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o={blunt:0,slashing:0,piercing:0,fire:0,earth:0,water:0,air:0,light:0,dark:0,poison:0,life:0,death:0},r=function t(e){if(n(this,t),!opts.attacker)throw"Attempting to initialize AttackObject without an attacker";if(!opts.target)throw"Attempting to initialize AttackObject without a defender";this.properties=opts.properties||o,this.target=opts.target,this.attacker=opts.attacker,this.text_fragment=opts.text_fragment};e.default=r},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});i(13);Crafty.c("BattleNPCProjectile",{positionFunction:null,speed:1,init:function(){this.requires("2D, DOM")},battleNPCProjectile:function(t,e){return this.positionFunction=t,this.speed=e||this.speed,this}})},function(t,e,i){"use strict";function n(t,e){return{x:-1*e*t,y:0}}Object.defineProperty(e,"__esModule",{value:!0});var o=i(24),r=i(5);i.d(e,"SlimeStandardAttack",function(){return s}),i.d(e,"SlimeGlobAttack",function(){return a}),i.d(e,"SlimeScatterAttack",function(){return l});var s={effects:[{klass:o.SpawnTextProjectile,positionFunction:n,speed:.03,textOptions:{minLength:7,maxLength:13},effects:[{klass:o.Damage,properties:{blunt:3,slashing:0,piercing:0,fire:0,earth:0,water:0,air:0,light:0,dark:0,poison:0,life:0,death:0}},{klass:o.TriggerAnimation,animation:r.ANIM_HIT},{klass:o.ScreenShake}]},{klass:o.TriggerAnimation,target:"self",animation:r.ANIM_LIGHT_ATTACK},{klass:o.SetCooldown,target:"self",cooldownLength:3400}],cost:0,name:"slime standard attack",startupDelay:1e3},a={effects:[{klass:o.SpawnTextProjectilePhysics,textOptions:{minLength:5,maxLength:8},box2d:{bodyType:"dynamic",density:.1,friction:2,restitution:.2},effects:[{klass:o.Damage,properties:{blunt:3,slashing:0,piercing:0,fire:0,earth:0,water:0,air:0,light:0,dark:0,poison:2,life:0,death:0}},{klass:o.TriggerAnimation,animation:r.ANIM_HIT},{klass:o.ScreenShake}]},{klass:o.TriggerAnimation,target:"self",animation:r.ANIM_HEAVY_ATTACK},{klass:o.SetCooldown,target:"self",cooldownLength:3e3}],cost:0,name:"glob",startupDelay:2e3},l={effects:[{klass:o.SpawnScatterTextProjectilePhysics,count:25,textOptions:{randomString:!0,minLength:1,maxLength:1},box2d:{bodyType:"dynamic",density:.1,friction:2,restitution:.32},effects:[{klass:o.Damage,properties:{blunt:2,slashing:0,piercing:0,fire:0,earth:0,water:0,air:0,light:0,dark:0,poison:0,life:0,death:0}},{klass:o.TriggerAnimation,animation:r.ANIM_HIT}]},{klass:o.TriggerAnimation,target:"self",animation:r.ANIM_HEAVY_ATTACK},{klass:o.SetCooldown,target:"self",cooldownLength:1e4}],cost:0,name:"glob",startupDelay:6e3}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i.d(e,"CMD_CHANGE_STANCE",function(){return n}),i.d(e,"COMMANDS",function(){return o});var n="change stance",o={tab:n}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i.d(e,"SND_TYPEWRITER",function(){return n}),i.d(e,"SND_SWORD_SWIPE",function(){return o});var n=["/audios/typewar/typewriter-key-1.mp3","/audios/typewar/typewriter-key-1.wav","/audios/typewar/typewriter-key-1.ogg"],o=["/audios/typewar/59999__qubodup__sword-or-bullet-swish-swosh-12.mp3","/audios/typewar/59999__qubodup__sword-or-bullet-swish-swosh-12.wav","/audios/typewar/59999__qubodup__sword-or-bullet-swish-swosh-12.ogg"]},function(t,e,i){"use strict";var n={};!function(t,e){function i(){}t.inherit=function(t,e){var n=t;i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=n},t.generateCallback=function(t,e){return function(){e.apply(t,arguments)}},t.NVector=function(t){void 0===t&&(t=0);for(var e=new Array(t||0),i=0;i<t;++i)e[i]=0;return e},t.is=function(t,e){return null!==t&&(e instanceof Function&&t instanceof e||!(void 0==t.constructor.__implements||!t.constructor.__implements[e]))},t.parseUInt=function(t){return Math.abs(parseInt(t))}}(n);var o=Array,r=n.NVector;void 0===n&&(n={}),void 0===n.Collision&&(n.Collision={}),void 0===n.Collision.Shapes&&(n.Collision.Shapes={}),void 0===n.Common&&(n.Common={}),void 0===n.Common.Math&&(n.Common.Math={}),void 0===n.Dynamics&&(n.Dynamics={}),void 0===n.Dynamics.Contacts&&(n.Dynamics.Contacts={}),void 0===n.Dynamics.Controllers&&(n.Dynamics.Controllers={}),void 0===n.Dynamics.Joints&&(n.Dynamics.Joints={}),function(){function t(){t.b2AABB.apply(this,arguments)}function e(){e.b2Bound.apply(this,arguments)}function i(){i.b2BoundValues.apply(this,arguments),this.constructor===i&&this.b2BoundValues.apply(this,arguments)}function o(){o.b2Collision.apply(this,arguments)}function r(){r.b2ContactID.apply(this,arguments),this.constructor===r&&this.b2ContactID.apply(this,arguments)}function s(){s.b2ContactPoint.apply(this,arguments)}function a(){a.b2Distance.apply(this,arguments)}function l(){l.b2DistanceInput.apply(this,arguments)}function c(){c.b2DistanceOutput.apply(this,arguments)}function u(){u.b2DistanceProxy.apply(this,arguments)}function h(){h.b2DynamicTree.apply(this,arguments),this.constructor===h&&this.b2DynamicTree.apply(this,arguments)}function m(){m.b2DynamicTreeBroadPhase.apply(this,arguments)}function p(){p.b2DynamicTreeNode.apply(this,arguments)}function f(){f.b2DynamicTreePair.apply(this,arguments)}function _(){_.b2Manifold.apply(this,arguments),this.constructor===_&&this.b2Manifold.apply(this,arguments)}function y(){y.b2ManifoldPoint.apply(this,arguments),this.constructor===y&&this.b2ManifoldPoint.apply(this,arguments)}function d(){d.b2Point.apply(this,arguments)}function v(){v.b2RayCastInput.apply(this,arguments),this.constructor===v&&this.b2RayCastInput.apply(this,arguments)}function g(){g.b2RayCastOutput.apply(this,arguments)}function x(){x.b2Segment.apply(this,arguments)}function b(){b.b2SeparationFunction.apply(this,arguments)}function C(){C.b2Simplex.apply(this,arguments),this.constructor===C&&this.b2Simplex.apply(this,arguments)}function S(){S.b2SimplexCache.apply(this,arguments)}function w(){w.b2SimplexVertex.apply(this,arguments)}function A(){A.b2TimeOfImpact.apply(this,arguments)}function D(){D.b2TOIInput.apply(this,arguments)}function M(){M.b2WorldManifold.apply(this,arguments),this.constructor===M&&this.b2WorldManifold.apply(this,arguments)}function k(){k.ClipVertex.apply(this,arguments)}function B(){B.Features.apply(this,arguments)}function I(){I.b2CircleShape.apply(this,arguments),this.constructor===I&&this.b2CircleShape.apply(this,arguments)}function P(){P.b2EdgeChainDef.apply(this,arguments),this.constructor===P&&this.b2EdgeChainDef.apply(this,arguments)}function T(){T.b2EdgeShape.apply(this,arguments),this.constructor===T&&this.b2EdgeShape.apply(this,arguments)}function E(){E.b2MassData.apply(this,arguments)}function V(){V.b2PolygonShape.apply(this,arguments),this.constructor===V&&this.b2PolygonShape.apply(this,arguments)}function L(){L.b2Shape.apply(this,arguments),this.constructor===L&&this.b2Shape.apply(this,arguments)}function R(){R.b2Color.apply(this,arguments),this.constructor===R&&this.b2Color.apply(this,arguments)}function N(){N.b2Settings.apply(this,arguments)}function F(){F.b2Mat22.apply(this,arguments),this.constructor===F&&this.b2Mat22.apply(this,arguments)}function O(){O.b2Mat33.apply(this,arguments),this.constructor===O&&this.b2Mat33.apply(this,arguments)}function G(){G.b2Math.apply(this,arguments)}function J(){J.b2Sweep.apply(this,arguments)}function j(){j.b2Transform.apply(this,arguments),this.constructor===j&&this.b2Transform.apply(this,arguments)}function z(){z.b2Vec2.apply(this,arguments),this.constructor===z&&this.b2Vec2.apply(this,arguments)}function H(){H.b2Vec3.apply(this,arguments),this.constructor===H&&this.b2Vec3.apply(this,arguments)}function q(){q.b2Body.apply(this,arguments),this.constructor===q&&this.b2Body.apply(this,arguments)}function U(){U.b2BodyDef.apply(this,arguments),this.constructor===U&&this.b2BodyDef.apply(this,arguments)}function W(){W.b2ContactFilter.apply(this,arguments)}function $(){$.b2ContactImpulse.apply(this,arguments)}function K(){K.b2ContactListener.apply(this,arguments)}function Y(){Y.b2ContactManager.apply(this,arguments),this.constructor===Y&&this.b2ContactManager.apply(this,arguments)}function X(){X.b2DebugDraw.apply(this,arguments),this.constructor===X&&this.b2DebugDraw.apply(this,arguments)}function Z(){Z.b2DestructionListener.apply(this,arguments)}function Q(){Q.b2FilterData.apply(this,arguments)}function tt(){tt.b2Fixture.apply(this,arguments),this.constructor===tt&&this.b2Fixture.apply(this,arguments)}function et(){et.b2FixtureDef.apply(this,arguments),this.constructor===et&&this.b2FixtureDef.apply(this,arguments)}function it(){it.b2Island.apply(this,arguments),this.constructor===it&&this.b2Island.apply(this,arguments)}function nt(){nt.b2TimeStep.apply(this,arguments)}function ot(){ot.b2World.apply(this,arguments),this.constructor===ot&&this.b2World.apply(this,arguments)}function rt(){rt.b2CircleContact.apply(this,arguments)}function st(){st.b2Contact.apply(this,arguments),this.constructor===st&&this.b2Contact.apply(this,arguments)}function at(){at.b2ContactConstraint.apply(this,arguments),this.constructor===at&&this.b2ContactConstraint.apply(this,arguments)}function lt(){lt.b2ContactConstraintPoint.apply(this,arguments)}function ct(){ct.b2ContactEdge.apply(this,arguments)}function ut(){ut.b2ContactFactory.apply(this,arguments),this.constructor===ut&&this.b2ContactFactory.apply(this,arguments)}function ht(){ht.b2ContactRegister.apply(this,arguments)}function mt(){mt.b2ContactResult.apply(this,arguments)}function pt(){pt.b2ContactSolver.apply(this,arguments),this.constructor===pt&&this.b2ContactSolver.apply(this,arguments)}function ft(){ft.b2EdgeAndCircleContact.apply(this,arguments)}function _t(){_t.b2NullContact.apply(this,arguments),this.constructor===_t&&this.b2NullContact.apply(this,arguments)}function yt(){yt.b2PolyAndCircleContact.apply(this,arguments)}function dt(){dt.b2PolyAndEdgeContact.apply(this,arguments)}function vt(){vt.b2PolygonContact.apply(this,arguments)}function gt(){gt.b2PositionSolverManifold.apply(this,arguments),this.constructor===gt&&this.b2PositionSolverManifold.apply(this,arguments)}function xt(){xt.b2BuoyancyController.apply(this,arguments)}function bt(){bt.b2ConstantAccelController.apply(this,arguments)}function Ct(){Ct.b2ConstantForceController.apply(this,arguments)}function St(){St.b2Controller.apply(this,arguments)}function wt(){wt.b2ControllerEdge.apply(this,arguments)}function At(){At.b2GravityController.apply(this,arguments)}function Dt(){Dt.b2TensorDampingController.apply(this,arguments)}function Mt(){Mt.b2DistanceJoint.apply(this,arguments),this.constructor===Mt&&this.b2DistanceJoint.apply(this,arguments)}function kt(){kt.b2DistanceJointDef.apply(this,arguments),this.constructor===kt&&this.b2DistanceJointDef.apply(this,arguments)}function Bt(){Bt.b2FrictionJoint.apply(this,arguments),this.constructor===Bt&&this.b2FrictionJoint.apply(this,arguments)}function It(){It.b2FrictionJointDef.apply(this,arguments),this.constructor===It&&this.b2FrictionJointDef.apply(this,arguments)}function Pt(){Pt.b2GearJoint.apply(this,arguments),this.constructor===Pt&&this.b2GearJoint.apply(this,arguments)}function Tt(){Tt.b2GearJointDef.apply(this,arguments),this.constructor===Tt&&this.b2GearJointDef.apply(this,arguments)}function Et(){Et.b2Jacobian.apply(this,arguments)}function Vt(){Vt.b2Joint.apply(this,arguments),this.constructor===Vt&&this.b2Joint.apply(this,arguments)}function Lt(){Lt.b2JointDef.apply(this,arguments),this.constructor===Lt&&this.b2JointDef.apply(this,arguments)}function Rt(){Rt.b2JointEdge.apply(this,arguments)}function Nt(){Nt.b2LineJoint.apply(this,arguments),this.constructor===Nt&&this.b2LineJoint.apply(this,arguments)}function Ft(){Ft.b2LineJointDef.apply(this,arguments),this.constructor===Ft&&this.b2LineJointDef.apply(this,arguments)}function Ot(){Ot.b2MouseJoint.apply(this,arguments),this.constructor===Ot&&this.b2MouseJoint.apply(this,arguments)}function Gt(){Gt.b2MouseJointDef.apply(this,arguments),this.constructor===Gt&&this.b2MouseJointDef.apply(this,arguments)}function Jt(){Jt.b2PrismaticJoint.apply(this,arguments),this.constructor===Jt&&this.b2PrismaticJoint.apply(this,arguments)}function jt(){jt.b2PrismaticJointDef.apply(this,arguments),this.constructor===jt&&this.b2PrismaticJointDef.apply(this,arguments)}function zt(){zt.b2PulleyJoint.apply(this,arguments),this.constructor===zt&&this.b2PulleyJoint.apply(this,arguments)}function Ht(){Ht.b2PulleyJointDef.apply(this,arguments),this.constructor===Ht&&this.b2PulleyJointDef.apply(this,arguments)}function qt(){qt.b2RevoluteJoint.apply(this,arguments),this.constructor===qt&&this.b2RevoluteJoint.apply(this,arguments)}function Ut(){Ut.b2RevoluteJointDef.apply(this,arguments),this.constructor===Ut&&this.b2RevoluteJointDef.apply(this,arguments)}function Wt(){Wt.b2WeldJoint.apply(this,arguments),this.constructor===Wt&&this.b2WeldJoint.apply(this,arguments)}function $t(){$t.b2WeldJointDef.apply(this,arguments),this.constructor===$t&&this.b2WeldJointDef.apply(this,arguments)}n.Collision.IBroadPhase="Box2D.Collision.IBroadPhase",n.Collision.b2AABB=t,n.Collision.b2Bound=e,n.Collision.b2BoundValues=i,n.Collision.b2Collision=o,n.Collision.b2ContactID=r,n.Collision.b2ContactPoint=s,n.Collision.b2Distance=a,n.Collision.b2DistanceInput=l,n.Collision.b2DistanceOutput=c,n.Collision.b2DistanceProxy=u,n.Collision.b2DynamicTree=h,n.Collision.b2DynamicTreeBroadPhase=m,n.Collision.b2DynamicTreeNode=p,n.Collision.b2DynamicTreePair=f,n.Collision.b2Manifold=_,n.Collision.b2ManifoldPoint=y,n.Collision.b2Point=d,n.Collision.b2RayCastInput=v,n.Collision.b2RayCastOutput=g,n.Collision.b2Segment=x,n.Collision.b2SeparationFunction=b,n.Collision.b2Simplex=C,n.Collision.b2SimplexCache=S,n.Collision.b2SimplexVertex=w,n.Collision.b2TimeOfImpact=A,n.Collision.b2TOIInput=D,n.Collision.b2WorldManifold=M,n.Collision.ClipVertex=k,n.Collision.Features=B,n.Collision.Shapes.b2CircleShape=I,n.Collision.Shapes.b2EdgeChainDef=P,n.Collision.Shapes.b2EdgeShape=T,n.Collision.Shapes.b2MassData=E,n.Collision.Shapes.b2PolygonShape=V,n.Collision.Shapes.b2Shape=L,n.Common.b2internal="Box2D.Common.b2internal",n.Common.b2Color=R,n.Common.b2Settings=N,n.Common.Math.b2Mat22=F,n.Common.Math.b2Mat33=O,n.Common.Math.b2Math=G,n.Common.Math.b2Sweep=J,n.Common.Math.b2Transform=j,n.Common.Math.b2Vec2=z,n.Common.Math.b2Vec3=H,n.Dynamics.b2Body=q,n.Dynamics.b2BodyDef=U,n.Dynamics.b2ContactFilter=W,n.Dynamics.b2ContactImpulse=$,n.Dynamics.b2ContactListener=K,n.Dynamics.b2ContactManager=Y,n.Dynamics.b2DebugDraw=X,n.Dynamics.b2DestructionListener=Z,n.Dynamics.b2FilterData=Q,n.Dynamics.b2Fixture=tt,n.Dynamics.b2FixtureDef=et,n.Dynamics.b2Island=it,n.Dynamics.b2TimeStep=nt,n.Dynamics.b2World=ot,n.Dynamics.Contacts.b2CircleContact=rt,n.Dynamics.Contacts.b2Contact=st,n.Dynamics.Contacts.b2ContactConstraint=at,n.Dynamics.Contacts.b2ContactConstraintPoint=lt,n.Dynamics.Contacts.b2ContactEdge=ct,n.Dynamics.Contacts.b2ContactFactory=ut,n.Dynamics.Contacts.b2ContactRegister=ht,n.Dynamics.Contacts.b2ContactResult=mt,n.Dynamics.Contacts.b2ContactSolver=pt,n.Dynamics.Contacts.b2EdgeAndCircleContact=ft,n.Dynamics.Contacts.b2NullContact=_t,n.Dynamics.Contacts.b2PolyAndCircleContact=yt,n.Dynamics.Contacts.b2PolyAndEdgeContact=dt,n.Dynamics.Contacts.b2PolygonContact=vt,n.Dynamics.Contacts.b2PositionSolverManifold=gt,n.Dynamics.Controllers.b2BuoyancyController=xt,n.Dynamics.Controllers.b2ConstantAccelController=bt,n.Dynamics.Controllers.b2ConstantForceController=Ct,n.Dynamics.Controllers.b2Controller=St,n.Dynamics.Controllers.b2ControllerEdge=wt,n.Dynamics.Controllers.b2GravityController=At,n.Dynamics.Controllers.b2TensorDampingController=Dt,n.Dynamics.Joints.b2DistanceJoint=Mt,n.Dynamics.Joints.b2DistanceJointDef=kt,n.Dynamics.Joints.b2FrictionJoint=Bt,n.Dynamics.Joints.b2FrictionJointDef=It,n.Dynamics.Joints.b2GearJoint=Pt,n.Dynamics.Joints.b2GearJointDef=Tt,n.Dynamics.Joints.b2Jacobian=Et,n.Dynamics.Joints.b2Joint=Vt,n.Dynamics.Joints.b2JointDef=Lt,n.Dynamics.Joints.b2JointEdge=Rt,n.Dynamics.Joints.b2LineJoint=Nt,n.Dynamics.Joints.b2LineJointDef=Ft,n.Dynamics.Joints.b2MouseJoint=Ot,n.Dynamics.Joints.b2MouseJointDef=Gt,n.Dynamics.Joints.b2PrismaticJoint=Jt,n.Dynamics.Joints.b2PrismaticJointDef=jt,n.Dynamics.Joints.b2PulleyJoint=zt,n.Dynamics.Joints.b2PulleyJointDef=Ht,n.Dynamics.Joints.b2RevoluteJoint=qt,n.Dynamics.Joints.b2RevoluteJointDef=Ut,n.Dynamics.Joints.b2WeldJoint=Wt,n.Dynamics.Joints.b2WeldJointDef=$t}(),n.postDefs=[],function(){var t=n.Collision.Shapes.b2CircleShape,e=(n.Collision.Shapes.b2EdgeChainDef,n.Collision.Shapes.b2EdgeShape,n.Collision.Shapes.b2MassData,n.Collision.Shapes.b2PolygonShape),i=n.Collision.Shapes.b2Shape,s=(n.Common.b2Color,n.Common.b2internal,n.Common.b2Settings),a=(n.Common.Math.b2Mat22,n.Common.Math.b2Mat33,n.Common.Math.b2Math),l=n.Common.Math.b2Sweep,c=n.Common.Math.b2Transform,u=n.Common.Math.b2Vec2,h=(n.Common.Math.b2Vec3,n.Collision.b2AABB),m=n.Collision.b2Bound,p=n.Collision.b2BoundValues,f=n.Collision.b2Collision,_=n.Collision.b2ContactID,y=n.Collision.b2ContactPoint,d=n.Collision.b2Distance,v=n.Collision.b2DistanceInput,g=n.Collision.b2DistanceOutput,x=n.Collision.b2DistanceProxy,b=n.Collision.b2DynamicTree,C=n.Collision.b2DynamicTreeBroadPhase,S=n.Collision.b2DynamicTreeNode,w=n.Collision.b2DynamicTreePair,A=n.Collision.b2Manifold,D=n.Collision.b2ManifoldPoint,M=n.Collision.b2Point,k=n.Collision.b2RayCastInput,B=n.Collision.b2RayCastOutput,I=n.Collision.b2Segment,P=n.Collision.b2SeparationFunction,T=n.Collision.b2Simplex,E=n.Collision.b2SimplexCache,V=n.Collision.b2SimplexVertex,L=n.Collision.b2TimeOfImpact,R=n.Collision.b2TOIInput,N=n.Collision.b2WorldManifold,F=n.Collision.ClipVertex,O=n.Collision.Features,G=n.Collision.IBroadPhase;h.b2AABB=function(){this.lowerBound=new u,this.upperBound=new u},h.prototype.IsValid=function(){var t=this.upperBound.x-this.lowerBound.x,e=this.upperBound.y-this.lowerBound.y,i=t>=0&&e>=0;return i=i&&this.lowerBound.IsValid()&&this.upperBound.IsValid()},h.prototype.GetCenter=function(){return new u((this.lowerBound.x+this.upperBound.x)/2,(this.lowerBound.y+this.upperBound.y)/2)},h.prototype.GetExtents=function(){return new u((this.upperBound.x-this.lowerBound.x)/2,(this.upperBound.y-this.lowerBound.y)/2)},h.prototype.Contains=function(t){var e=!0;return e=e&&this.lowerBound.x<=t.lowerBound.x,e=e&&this.lowerBound.y<=t.lowerBound.y,e=e&&t.upperBound.x<=this.upperBound.x,e=e&&t.upperBound.y<=this.upperBound.y},h.prototype.RayCast=function(t,e){var i=-Number.MAX_VALUE,n=Number.MAX_VALUE,o=e.p1.x,r=e.p1.y,s=e.p2.x-e.p1.x,a=e.p2.y-e.p1.y,l=Math.abs(s),c=Math.abs(a),u=t.normal,h=0,m=0,p=0,f=0,_=0;if(l<Number.MIN_VALUE){if(o<this.lowerBound.x||this.upperBound.x<o)return!1}else if(h=1/s,m=(this.lowerBound.x-o)*h,p=(this.upperBound.x-o)*h,_=-1,m>p&&(f=m,m=p,p=f,_=1),m>i&&(u.x=_,u.y=0,i=m),n=Math.min(n,p),i>n)return!1;if(c<Number.MIN_VALUE){if(r<this.lowerBound.y||this.upperBound.y<r)return!1}else if(h=1/a,m=(this.lowerBound.y-r)*h,p=(this.upperBound.y-r)*h,_=-1,m>p&&(f=m,m=p,p=f,_=1),m>i&&(u.y=_,u.x=0,i=m),n=Math.min(n,p),i>n)return!1;return t.fraction=i,!0},h.prototype.TestOverlap=function(t){var e=t.lowerBound.x-this.upperBound.x,i=t.lowerBound.y-this.upperBound.y,n=this.lowerBound.x-t.upperBound.x,o=this.lowerBound.y-t.upperBound.y;return!(e>0||i>0)&&!(n>0||o>0)},h.Combine=function(t,e){var i=new h;return i.Combine(t,e),i},h.prototype.Combine=function(t,e){this.lowerBound.x=Math.min(t.lowerBound.x,e.lowerBound.x),this.lowerBound.y=Math.min(t.lowerBound.y,e.lowerBound.y),this.upperBound.x=Math.max(t.upperBound.x,e.upperBound.x),this.upperBound.y=Math.max(t.upperBound.y,e.upperBound.y)},m.b2Bound=function(){},m.prototype.IsLower=function(){return 0==(1&this.value)},m.prototype.IsUpper=function(){return 1==(1&this.value)},m.prototype.Swap=function(t){var e=this.value,i=this.proxy,n=this.stabbingCount;this.value=t.value,this.proxy=t.proxy,this.stabbingCount=t.stabbingCount,t.value=e,t.proxy=i,t.stabbingCount=n},p.b2BoundValues=function(){},p.prototype.b2BoundValues=function(){this.lowerValues=new r,this.lowerValues[0]=0,this.lowerValues[1]=0,this.upperValues=new r,this.upperValues[0]=0,this.upperValues[1]=0},f.b2Collision=function(){},f.ClipSegmentToLine=function(t,e,i,n){void 0===n&&(n=0);var o,r=0;o=e[0];var s=o.v;o=e[1];var a=o.v,l=i.x*s.x+i.y*s.y-n,c=i.x*a.x+i.y*a.y-n;if(l<=0&&t[r++].Set(e[0]),c<=0&&t[r++].Set(e[1]),l*c<0){var u=l/(l-c);o=t[r];var h=o.v;h.x=s.x+u*(a.x-s.x),h.y=s.y+u*(a.y-s.y),o=t[r];var m;l>0?(m=e[0],o.id=m.id):(m=e[1],o.id=m.id),++r}return r},f.EdgeSeparation=function(t,e,i,n,o){void 0===i&&(i=0);var r,s,a=(parseInt(t.m_vertexCount),t.m_vertices),l=t.m_normals,c=parseInt(n.m_vertexCount),u=n.m_vertices;r=e.R,s=l[i];var h=r.col1.x*s.x+r.col2.x*s.y,m=r.col1.y*s.x+r.col2.y*s.y;r=o.R;for(var p=r.col1.x*h+r.col1.y*m,f=r.col2.x*h+r.col2.y*m,_=0,y=Number.MAX_VALUE,d=0;d<c;++d){s=u[d];var v=s.x*p+s.y*f;v<y&&(y=v,_=d)}s=a[i],r=e.R;var g=e.position.x+(r.col1.x*s.x+r.col2.x*s.y),x=e.position.y+(r.col1.y*s.x+r.col2.y*s.y);s=u[_],r=o.R;var b=o.position.x+(r.col1.x*s.x+r.col2.x*s.y),C=o.position.y+(r.col1.y*s.x+r.col2.y*s.y);return b-=g,C-=x,b*h+C*m},f.FindMaxSeparation=function(t,e,i,n,o){var r,s,a=parseInt(e.m_vertexCount),l=e.m_normals;s=o.R,r=n.m_centroid;var c=o.position.x+(s.col1.x*r.x+s.col2.x*r.y),u=o.position.y+(s.col1.y*r.x+s.col2.y*r.y);s=i.R,r=e.m_centroid,c-=i.position.x+(s.col1.x*r.x+s.col2.x*r.y),u-=i.position.y+(s.col1.y*r.x+s.col2.y*r.y);for(var h=c*i.R.col1.x+u*i.R.col1.y,m=c*i.R.col2.x+u*i.R.col2.y,p=0,_=-Number.MAX_VALUE,y=0;y<a;++y){r=l[y];var d=r.x*h+r.y*m;d>_&&(_=d,p=y)}var v=f.EdgeSeparation(e,i,p,n,o),g=parseInt(p-1>=0?p-1:a-1),x=f.EdgeSeparation(e,i,g,n,o),b=parseInt(p+1<a?p+1:0),C=f.EdgeSeparation(e,i,b,n,o),S=0,w=0,A=0;if(x>v&&x>C)A=-1,S=g,w=x;else{if(!(C>v))return t[0]=p,v;A=1,S=b,w=C}for(;;){if(p=-1==A?S-1>=0?S-1:a-1:S+1<a?S+1:0,!((v=f.EdgeSeparation(e,i,p,n,o))>w))break;S=p,w=v}return t[0]=S,w},f.FindIncidentEdge=function(t,e,i,n,o,r){void 0===n&&(n=0);var s,a,l=(parseInt(e.m_vertexCount),e.m_normals),c=parseInt(o.m_vertexCount),u=o.m_vertices,h=o.m_normals;s=i.R,a=l[n];var m=s.col1.x*a.x+s.col2.x*a.y,p=s.col1.y*a.x+s.col2.y*a.y;s=r.R;var f=s.col1.x*m+s.col1.y*p;p=s.col2.x*m+s.col2.y*p,m=f;for(var _=0,y=Number.MAX_VALUE,d=0;d<c;++d){a=h[d];var v=m*a.x+p*a.y;v<y&&(y=v,_=d)}var g,x=parseInt(_),b=parseInt(x+1<c?x+1:0);g=t[0],a=u[x],s=r.R,g.v.x=r.position.x+(s.col1.x*a.x+s.col2.x*a.y),g.v.y=r.position.y+(s.col1.y*a.x+s.col2.y*a.y),g.id.features.referenceEdge=n,g.id.features.incidentEdge=x,g.id.features.incidentVertex=0,g=t[1],a=u[b],s=r.R,g.v.x=r.position.x+(s.col1.x*a.x+s.col2.x*a.y),g.v.y=r.position.y+(s.col1.y*a.x+s.col2.y*a.y),g.id.features.referenceEdge=n,g.id.features.incidentEdge=b,g.id.features.incidentVertex=1},f.MakeClipPointVector=function(){var t=new o(2);return t[0]=new F,t[1]=new F,t},f.CollidePolygons=function(t,e,i,n,o){var r;t.m_pointCount=0;var a=e.m_radius+n.m_radius,l=0;f.s_edgeAO[0]=l;var c=f.FindMaxSeparation(f.s_edgeAO,e,i,n,o);if(l=f.s_edgeAO[0],!(c>a)){var u=0;f.s_edgeBO[0]=u;var h=f.FindMaxSeparation(f.s_edgeBO,n,o,e,i);if(u=f.s_edgeBO[0],!(h>a)){var m,p,_,y,d,v=0,g=0;h>.98*c+.001?(m=n,p=e,_=o,y=i,v=u,t.m_type=A.e_faceB,g=1):(m=e,p=n,_=i,y=o,v=l,t.m_type=A.e_faceA,g=0);var x=f.s_incidentEdge;f.FindIncidentEdge(x,m,_,v,p,y);var b,C=parseInt(m.m_vertexCount),S=m.m_vertices,w=S[v];b=v+1<C?S[parseInt(v+1)]:S[0];var D=f.s_localTangent;D.Set(b.x-w.x,b.y-w.y),D.Normalize();var M=f.s_localNormal;M.x=D.y,M.y=-D.x;var k=f.s_planePoint;k.Set(.5*(w.x+b.x),.5*(w.y+b.y));var B=f.s_tangent;d=_.R,B.x=d.col1.x*D.x+d.col2.x*D.y,B.y=d.col1.y*D.x+d.col2.y*D.y;var I=f.s_tangent2;I.x=-B.x,I.y=-B.y;var P=f.s_normal;P.x=B.y,P.y=-B.x;var T=f.s_v11,E=f.s_v12;T.x=_.position.x+(d.col1.x*w.x+d.col2.x*w.y),T.y=_.position.y+(d.col1.y*w.x+d.col2.y*w.y),E.x=_.position.x+(d.col1.x*b.x+d.col2.x*b.y),E.y=_.position.y+(d.col1.y*b.x+d.col2.y*b.y);var V=P.x*T.x+P.y*T.y,L=-B.x*T.x-B.y*T.y+a,R=B.x*E.x+B.y*E.y+a,N=f.s_clipPoints1,F=f.s_clipPoints2;if(!(f.ClipSegmentToLine(N,x,I,L)<2||f.ClipSegmentToLine(F,N,B,R)<2)){t.m_localPlaneNormal.SetV(M),t.m_localPoint.SetV(k);for(var O=0,G=0;G<s.b2_maxManifoldPoints;++G){r=F[G];if(P.x*r.v.x+P.y*r.v.y-V<=a){var J=t.m_points[O];d=y.R;var j=r.v.x-y.position.x,z=r.v.y-y.position.y;J.m_localPoint.x=j*d.col1.x+z*d.col1.y,J.m_localPoint.y=j*d.col2.x+z*d.col2.y,J.m_id.Set(r.id),J.m_id.features.flip=g,++O}}t.m_pointCount=O}}}},f.CollideCircles=function(t,e,i,n,o){t.m_pointCount=0;var r,s;r=i.R,s=e.m_p;var a=i.position.x+(r.col1.x*s.x+r.col2.x*s.y),l=i.position.y+(r.col1.y*s.x+r.col2.y*s.y);r=o.R,s=n.m_p;var c=o.position.x+(r.col1.x*s.x+r.col2.x*s.y),u=o.position.y+(r.col1.y*s.x+r.col2.y*s.y),h=c-a,m=u-l,p=h*h+m*m,f=e.m_radius+n.m_radius;p>f*f||(t.m_type=A.e_circles,t.m_localPoint.SetV(e.m_p),t.m_localPlaneNormal.SetZero(),t.m_pointCount=1,t.m_points[0].m_localPoint.SetV(n.m_p),t.m_points[0].m_id.key=0)},f.CollidePolygonAndCircle=function(t,e,i,n,o){t.m_pointCount=0;var r,s,a=0,l=0;s=o.R,r=n.m_p;var c=o.position.x+(s.col1.x*r.x+s.col2.x*r.y),u=o.position.y+(s.col1.y*r.x+s.col2.y*r.y);a=c-i.position.x,l=u-i.position.y,s=i.R;for(var h=a*s.col1.x+l*s.col1.y,m=a*s.col2.x+l*s.col2.y,p=0,f=-Number.MAX_VALUE,_=e.m_radius+n.m_radius,y=parseInt(e.m_vertexCount),d=e.m_vertices,v=e.m_normals,g=0;g<y;++g){r=d[g],a=h-r.x,l=m-r.y,r=v[g];var x=r.x*a+r.y*l;if(x>_)return;x>f&&(f=x,p=g)}var b=parseInt(p),C=parseInt(b+1<y?b+1:0),S=d[b],w=d[C];if(f<Number.MIN_VALUE)return t.m_pointCount=1,t.m_type=A.e_faceA,t.m_localPlaneNormal.SetV(v[p]),t.m_localPoint.x=.5*(S.x+w.x),t.m_localPoint.y=.5*(S.y+w.y),t.m_points[0].m_localPoint.SetV(n.m_p),void(t.m_points[0].m_id.key=0);var D=(h-S.x)*(w.x-S.x)+(m-S.y)*(w.y-S.y),M=(h-w.x)*(S.x-w.x)+(m-w.y)*(S.y-w.y);if(D<=0){if((h-S.x)*(h-S.x)+(m-S.y)*(m-S.y)>_*_)return;t.m_pointCount=1,t.m_type=A.e_faceA,t.m_localPlaneNormal.x=h-S.x,t.m_localPlaneNormal.y=m-S.y,t.m_localPlaneNormal.Normalize(),t.m_localPoint.SetV(S),t.m_points[0].m_localPoint.SetV(n.m_p),t.m_points[0].m_id.key=0}else if(M<=0){if((h-w.x)*(h-w.x)+(m-w.y)*(m-w.y)>_*_)return;t.m_pointCount=1,t.m_type=A.e_faceA,t.m_localPlaneNormal.x=h-w.x,t.m_localPlaneNormal.y=m-w.y,t.m_localPlaneNormal.Normalize(),t.m_localPoint.SetV(w),t.m_points[0].m_localPoint.SetV(n.m_p),t.m_points[0].m_id.key=0}else{var k=.5*(S.x+w.x),B=.5*(S.y+w.y);if((f=(h-k)*v[b].x+(m-B)*v[b].y)>_)return;t.m_pointCount=1,t.m_type=A.e_faceA,t.m_localPlaneNormal.x=v[b].x,t.m_localPlaneNormal.y=v[b].y,t.m_localPlaneNormal.Normalize(),t.m_localPoint.Set(k,B),t.m_points[0].m_localPoint.SetV(n.m_p),t.m_points[0].m_id.key=0}},f.TestOverlap=function(t,e){var i=e.lowerBound,n=t.upperBound,o=i.x-n.x,r=i.y-n.y;i=t.lowerBound,n=e.upperBound;var s=i.x-n.x,a=i.y-n.y;return!(o>0||r>0)&&!(s>0||a>0)},n.postDefs.push(function(){n.Collision.b2Collision.s_incidentEdge=f.MakeClipPointVector(),n.Collision.b2Collision.s_clipPoints1=f.MakeClipPointVector(),n.Collision.b2Collision.s_clipPoints2=f.MakeClipPointVector(),n.Collision.b2Collision.s_edgeAO=new r(1),n.Collision.b2Collision.s_edgeBO=new r(1),n.Collision.b2Collision.s_localTangent=new u,n.Collision.b2Collision.s_localNormal=new u,n.Collision.b2Collision.s_planePoint=new u,n.Collision.b2Collision.s_normal=new u,n.Collision.b2Collision.s_tangent=new u,n.Collision.b2Collision.s_tangent2=new u,n.Collision.b2Collision.s_v11=new u,n.Collision.b2Collision.s_v12=new u,n.Collision.b2Collision.b2CollidePolyTempVec=new u,n.Collision.b2Collision.b2_nullFeature=255}),_.b2ContactID=function(){this.features=new O},_.prototype.b2ContactID=function(){this.features._m_id=this},_.prototype.Set=function(t){this.key=t._key},_.prototype.Copy=function(){var t=new _;return t.key=this.key,t},Object.defineProperty(_.prototype,"key",{enumerable:!1,configurable:!0,get:function(){return this._key}}),Object.defineProperty(_.prototype,"key",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._key=t,this.features._referenceEdge=255&this._key,this.features._incidentEdge=(65280&this._key)>>8&255,this.features._incidentVertex=(16711680&this._key)>>16&255,this.features._flip=(4278190080&this._key)>>24&255}}),y.b2ContactPoint=function(){this.position=new u,this.velocity=new u,this.normal=new u,this.id=new _},d.b2Distance=function(){},d.Distance=function(t,e,i){++d.b2_gjkCalls;var n=i.proxyA,o=i.proxyB,r=i.transformA,l=i.transformB,c=d.s_simplex;c.ReadCache(e,n,r,o,l);for(var h,m=c.m_vertices,p=d.s_saveA,f=d.s_saveB,_=0,y=c.GetClosestPoint(),v=y.LengthSquared(),g=v,x=0,b=0;b<20;){for(_=c.m_count,x=0;x<_;x++)p[x]=m[x].indexA,f[x]=m[x].indexB;switch(c.m_count){case 1:break;case 2:c.Solve2();break;case 3:c.Solve3();break;default:s.b2Assert(!1)}if(3==c.m_count)break;h=c.GetClosestPoint(),g=h.LengthSquared(),v=g;var C=c.GetSearchDirection();if(C.LengthSquared()<Number.MIN_VALUE*Number.MIN_VALUE)break;var S=m[c.m_count];S.indexA=n.GetSupport(a.MulTMV(r.R,C.GetNegative())),S.wA=a.MulX(r,n.GetVertex(S.indexA)),S.indexB=o.GetSupport(a.MulTMV(l.R,C)),S.wB=a.MulX(l,o.GetVertex(S.indexB)),S.w=a.SubtractVV(S.wB,S.wA),++b,++d.b2_gjkIters;var w=!1;for(x=0;x<_;x++)if(S.indexA==p[x]&&S.indexB==f[x]){w=!0;break}if(w)break;++c.m_count}if(d.b2_gjkMaxIters=a.Max(d.b2_gjkMaxIters,b),c.GetWitnessPoints(t.pointA,t.pointB),t.distance=a.SubtractVV(t.pointA,t.pointB).Length(),t.iterations=b,c.WriteCache(e),i.useRadii){var A=n.m_radius,D=o.m_radius;if(t.distance>A+D&&t.distance>Number.MIN_VALUE){t.distance-=A+D;var M=a.SubtractVV(t.pointB,t.pointA);M.Normalize(),t.pointA.x+=A*M.x,t.pointA.y+=A*M.y,t.pointB.x-=D*M.x,t.pointB.y-=D*M.y}else h=new u,h.x=.5*(t.pointA.x+t.pointB.x),h.y=.5*(t.pointA.y+t.pointB.y),t.pointA.x=t.pointB.x=h.x,t.pointA.y=t.pointB.y=h.y,t.distance=0}},n.postDefs.push(function(){n.Collision.b2Distance.s_simplex=new T,n.Collision.b2Distance.s_saveA=new r(3),n.Collision.b2Distance.s_saveB=new r(3)}),v.b2DistanceInput=function(){},g.b2DistanceOutput=function(){this.pointA=new u,this.pointB=new u},x.b2DistanceProxy=function(){},x.prototype.Set=function(n){switch(n.GetType()){case i.e_circleShape:var r=n instanceof t?n:null;this.m_vertices=new o(1,!0),this.m_vertices[0]=r.m_p,this.m_count=1,this.m_radius=r.m_radius;break;case i.e_polygonShape:var a=n instanceof e?n:null;this.m_vertices=a.m_vertices,this.m_count=a.m_vertexCount,this.m_radius=a.m_radius;break;default:s.b2Assert(!1)}},x.prototype.GetSupport=function(t){for(var e=0,i=this.m_vertices[0].x*t.x+this.m_vertices[0].y*t.y,n=1;n<this.m_count;++n){var o=this.m_vertices[n].x*t.x+this.m_vertices[n].y*t.y;o>i&&(e=n,i=o)}return e},x.prototype.GetSupportVertex=function(t){for(var e=0,i=this.m_vertices[0].x*t.x+this.m_vertices[0].y*t.y,n=1;n<this.m_count;++n){var o=this.m_vertices[n].x*t.x+this.m_vertices[n].y*t.y;o>i&&(e=n,i=o)}return this.m_vertices[e]},x.prototype.GetVertexCount=function(){return this.m_count},x.prototype.GetVertex=function(t){return void 0===t&&(t=0),s.b2Assert(0<=t&&t<this.m_count),this.m_vertices[t]},b.b2DynamicTree=function(){},b.prototype.b2DynamicTree=function(){this.m_root=null,this.m_freeList=null,this.m_path=0,this.m_insertionCount=0},b.prototype.CreateProxy=function(t,e){var i=this.AllocateNode(),n=s.b2_aabbExtension,o=s.b2_aabbExtension;return i.aabb.lowerBound.x=t.lowerBound.x-n,i.aabb.lowerBound.y=t.lowerBound.y-o,i.aabb.upperBound.x=t.upperBound.x+n,i.aabb.upperBound.y=t.upperBound.y+o,i.userData=e,this.InsertLeaf(i),i},b.prototype.DestroyProxy=function(t){this.RemoveLeaf(t),this.FreeNode(t)},b.prototype.MoveProxy=function(t,e,i){if(s.b2Assert(t.IsLeaf()),t.aabb.Contains(e))return!1;this.RemoveLeaf(t);var n=s.b2_aabbExtension+s.b2_aabbMultiplier*(i.x>0?i.x:-i.x),o=s.b2_aabbExtension+s.b2_aabbMultiplier*(i.y>0?i.y:-i.y);return t.aabb.lowerBound.x=e.lowerBound.x-n,t.aabb.lowerBound.y=e.lowerBound.y-o,t.aabb.upperBound.x=e.upperBound.x+n,t.aabb.upperBound.y=e.upperBound.y+o,this.InsertLeaf(t),!0},b.prototype.Rebalance=function(t){if(void 0===t&&(t=0),null!=this.m_root)for(var e=0;e<t;e++){for(var i=this.m_root,n=0;0==i.IsLeaf();)i=this.m_path>>n&1?i.child2:i.child1,n=n+1&31;++this.m_path,this.RemoveLeaf(i),this.InsertLeaf(i)}},b.prototype.GetFatAABB=function(t){return t.aabb},b.prototype.GetUserData=function(t){return t.userData},b.prototype.Query=function(t,e){if(null!=this.m_root){var i=new o,n=0;for(i[n++]=this.m_root;n>0;){var r=i[--n];if(r.aabb.TestOverlap(e))if(r.IsLeaf()){var s=t(r);if(!s)return}else i[n++]=r.child1,i[n++]=r.child2}}},b.prototype.RayCast=function(t,e){if(null!=this.m_root){var i=e.p1,n=e.p2,r=a.SubtractVV(i,n);r.Normalize();var s=a.CrossFV(1,r),l=a.AbsV(s),c=e.maxFraction,u=new h,m=0,p=0;m=i.x+c*(n.x-i.x),p=i.y+c*(n.y-i.y),u.lowerBound.x=Math.min(i.x,m),u.lowerBound.y=Math.min(i.y,p),u.upperBound.x=Math.max(i.x,m),u.upperBound.y=Math.max(i.y,p);var f=new o,_=0;for(f[_++]=this.m_root;_>0;){var y=f[--_];if(0!=y.aabb.TestOverlap(u)){var d=y.aabb.GetCenter(),v=y.aabb.GetExtents();if(!(Math.abs(s.x*(i.x-d.x)+s.y*(i.y-d.y))-l.x*v.x-l.y*v.y>0))if(y.IsLeaf()){var g=new k;if(g.p1=e.p1,g.p2=e.p2,g.maxFraction=e.maxFraction,0==(c=t(g,y)))return;c>0&&(m=i.x+c*(n.x-i.x),p=i.y+c*(n.y-i.y),u.lowerBound.x=Math.min(i.x,m),u.lowerBound.y=Math.min(i.y,p),u.upperBound.x=Math.max(i.x,m),u.upperBound.y=Math.max(i.y,p))}else f[_++]=y.child1,f[_++]=y.child2}}}},b.prototype.AllocateNode=function(){if(this.m_freeList){var t=this.m_freeList;return this.m_freeList=t.parent,t.parent=null,t.child1=null,t.child2=null,t}return new S},b.prototype.FreeNode=function(t){t.parent=this.m_freeList,this.m_freeList=t},b.prototype.InsertLeaf=function(t){if(++this.m_insertionCount,null==this.m_root)return this.m_root=t,void(this.m_root.parent=null);var e=t.aabb.GetCenter(),i=this.m_root;if(0==i.IsLeaf())do{var n=i.child1,o=i.child2,r=Math.abs((n.aabb.lowerBound.x+n.aabb.upperBound.x)/2-e.x)+Math.abs((n.aabb.lowerBound.y+n.aabb.upperBound.y)/2-e.y),s=Math.abs((o.aabb.lowerBound.x+o.aabb.upperBound.x)/2-e.x)+Math.abs((o.aabb.lowerBound.y+o.aabb.upperBound.y)/2-e.y);i=r<s?n:o}while(0==i.IsLeaf());var a=i.parent,l=this.AllocateNode();if(l.parent=a,l.userData=null,l.aabb.Combine(t.aabb,i.aabb),a){i.parent.child1==i?a.child1=l:a.child2=l,l.child1=i,l.child2=t,i.parent=l,t.parent=l;do{if(a.aabb.Contains(l.aabb))break;a.aabb.Combine(a.child1.aabb,a.child2.aabb),l=a,a=a.parent}while(a)}else l.child1=i,l.child2=t,i.parent=l,t.parent=l,this.m_root=l},b.prototype.RemoveLeaf=function(t){if(t==this.m_root)return void(this.m_root=null);var e,i=t.parent,n=i.parent;if(e=i.child1==t?i.child2:i.child1,n)for(n.child1==i?n.child1=e:n.child2=e,e.parent=n,this.FreeNode(i);n;){var o=n.aabb;if(n.aabb=h.Combine(n.child1.aabb,n.child2.aabb),o.Contains(n.aabb))break;n=n.parent}else this.m_root=e,e.parent=null,this.FreeNode(i)},C.b2DynamicTreeBroadPhase=function(){this.m_tree=new b,this.m_moveBuffer=new o,this.m_pairBuffer=new o,this.m_pairCount=0},C.prototype.CreateProxy=function(t,e){var i=this.m_tree.CreateProxy(t,e);return++this.m_proxyCount,this.BufferMove(i),i},C.prototype.DestroyProxy=function(t){this.UnBufferMove(t),--this.m_proxyCount,this.m_tree.DestroyProxy(t)},C.prototype.MoveProxy=function(t,e,i){this.m_tree.MoveProxy(t,e,i)&&this.BufferMove(t)},C.prototype.TestOverlap=function(t,e){var i=this.m_tree.GetFatAABB(t),n=this.m_tree.GetFatAABB(e);return i.TestOverlap(n)},C.prototype.GetUserData=function(t){return this.m_tree.GetUserData(t)},C.prototype.GetFatAABB=function(t){return this.m_tree.GetFatAABB(t)},C.prototype.GetProxyCount=function(){return this.m_proxyCount},C.prototype.UpdatePairs=function(t){function e(t){if(t==n)return!0;i.m_pairCount==i.m_pairBuffer.length&&(i.m_pairBuffer[i.m_pairCount]=new w);var e=i.m_pairBuffer[i.m_pairCount];return e.proxyA=t<n?t:n,e.proxyB=t>=n?t:n,++i.m_pairCount,!0}var i=this;i.m_pairCount=0;var n,o=0;for(o=0;o<i.m_moveBuffer.length;++o){n=i.m_moveBuffer[o];var r=i.m_tree.GetFatAABB(n);i.m_tree.Query(e,r)}i.m_moveBuffer.length=0;for(var o=0;o<i.m_pairCount;){var s=i.m_pairBuffer[o],a=i.m_tree.GetUserData(s.proxyA),l=i.m_tree.GetUserData(s.proxyB);for(t(a,l),++o;o<i.m_pairCount;){var c=i.m_pairBuffer[o];if(c.proxyA!=s.proxyA||c.proxyB!=s.proxyB)break;++o}}},C.prototype.Query=function(t,e){this.m_tree.Query(t,e)},C.prototype.RayCast=function(t,e){this.m_tree.RayCast(t,e)},C.prototype.Validate=function(){},C.prototype.Rebalance=function(t){void 0===t&&(t=0),this.m_tree.Rebalance(t)},C.prototype.BufferMove=function(t){this.m_moveBuffer[this.m_moveBuffer.length]=t},C.prototype.UnBufferMove=function(t){var e=parseInt(this.m_moveBuffer.indexOf(t));this.m_moveBuffer.splice(e,1)},C.prototype.ComparePairs=function(t,e){return 0},C.__implements={},C.__implements[G]=!0,S.b2DynamicTreeNode=function(){this.aabb=new h},S.prototype.IsLeaf=function(){return null==this.child1},w.b2DynamicTreePair=function(){},A.b2Manifold=function(){this.m_pointCount=0},A.prototype.b2Manifold=function(){this.m_points=new o(s.b2_maxManifoldPoints);for(var t=0;t<s.b2_maxManifoldPoints;t++)this.m_points[t]=new D;this.m_localPlaneNormal=new u,this.m_localPoint=new u},A.prototype.Reset=function(){for(var t=0;t<s.b2_maxManifoldPoints;t++)(this.m_points[t]instanceof D?this.m_points[t]:null).Reset();this.m_localPlaneNormal.SetZero(),this.m_localPoint.SetZero(),this.m_type=0,this.m_pointCount=0},A.prototype.Set=function(t){this.m_pointCount=t.m_pointCount;for(var e=0;e<s.b2_maxManifoldPoints;e++)(this.m_points[e]instanceof D?this.m_points[e]:null).Set(t.m_points[e]);this.m_localPlaneNormal.SetV(t.m_localPlaneNormal),this.m_localPoint.SetV(t.m_localPoint),this.m_type=t.m_type},A.prototype.Copy=function(){var t=new A;return t.Set(this),t},n.postDefs.push(function(){n.Collision.b2Manifold.e_circles=1,n.Collision.b2Manifold.e_faceA=2,n.Collision.b2Manifold.e_faceB=4}),D.b2ManifoldPoint=function(){this.m_localPoint=new u,this.m_id=new _},D.prototype.b2ManifoldPoint=function(){this.Reset()},D.prototype.Reset=function(){this.m_localPoint.SetZero(),this.m_normalImpulse=0,this.m_tangentImpulse=0,this.m_id.key=0},D.prototype.Set=function(t){this.m_localPoint.SetV(t.m_localPoint),this.m_normalImpulse=t.m_normalImpulse,this.m_tangentImpulse=t.m_tangentImpulse,this.m_id.Set(t.m_id)},M.b2Point=function(){this.p=new u},M.prototype.Support=function(t,e,i){return void 0===e&&(e=0),void 0===i&&(i=0),this.p},M.prototype.GetFirstVertex=function(t){return this.p},k.b2RayCastInput=function(){this.p1=new u,this.p2=new u},k.prototype.b2RayCastInput=function(t,e,i){void 0===t&&(t=null),void 0===e&&(e=null),void 0===i&&(i=1),t&&this.p1.SetV(t),e&&this.p2.SetV(e),this.maxFraction=i},B.b2RayCastOutput=function(){this.normal=new u},I.b2Segment=function(){this.p1=new u,this.p2=new u},I.prototype.TestSegment=function(t,e,i,n){void 0===n&&(n=0);var o=i.p1,r=i.p2.x-o.x,s=i.p2.y-o.y,a=this.p2.x-this.p1.x,l=this.p2.y-this.p1.y,c=l,u=-a,h=100*Number.MIN_VALUE,m=-(r*c+s*u);if(m>h){var p=o.x-this.p1.x,f=o.y-this.p1.y,_=p*c+f*u;if(0<=_&&_<=n*m){var y=-r*f+s*p;if(-h*m<=y&&y<=m*(1+h)){_/=m;var d=Math.sqrt(c*c+u*u);return c/=d,u/=d,t[0]=_,e.Set(c,u),!0}}}return!1},I.prototype.Extend=function(t){this.ExtendForward(t),this.ExtendBackward(t)},I.prototype.ExtendForward=function(t){var e=this.p2.x-this.p1.x,i=this.p2.y-this.p1.y,n=Math.min(e>0?(t.upperBound.x-this.p1.x)/e:e<0?(t.lowerBound.x-this.p1.x)/e:Number.POSITIVE_INFINITY,i>0?(t.upperBound.y-this.p1.y)/i:i<0?(t.lowerBound.y-this.p1.y)/i:Number.POSITIVE_INFINITY);this.p2.x=this.p1.x+e*n,this.p2.y=this.p1.y+i*n},I.prototype.ExtendBackward=function(t){var e=-this.p2.x+this.p1.x,i=-this.p2.y+this.p1.y,n=Math.min(e>0?(t.upperBound.x-this.p2.x)/e:e<0?(t.lowerBound.x-this.p2.x)/e:Number.POSITIVE_INFINITY,i>0?(t.upperBound.y-this.p2.y)/i:i<0?(t.lowerBound.y-this.p2.y)/i:Number.POSITIVE_INFINITY);this.p1.x=this.p2.x+e*n,this.p1.y=this.p2.y+i*n},P.b2SeparationFunction=function(){this.m_localPoint=new u,this.m_axis=new u},P.prototype.Initialize=function(t,e,i,n,o){this.m_proxyA=e,this.m_proxyB=n;var r=parseInt(t.count);s.b2Assert(0<r&&r<3);var l,c,h,m,p,f,_,y,d=0,v=0,g=0,x=0,b=0,C=0,S=0;if(1==r)this.m_type=P.e_points,l=this.m_proxyA.GetVertex(t.indexA[0]),m=this.m_proxyB.GetVertex(t.indexB[0]),y=l,_=i.R,d=i.position.x+(_.col1.x*y.x+_.col2.x*y.y),v=i.position.y+(_.col1.y*y.x+_.col2.y*y.y),y=m,_=o.R,g=o.position.x+(_.col1.x*y.x+_.col2.x*y.y),x=o.position.y+(_.col1.y*y.x+_.col2.y*y.y),this.m_axis.x=g-d,this.m_axis.y=x-v,this.m_axis.Normalize();else if(t.indexB[0]==t.indexB[1])this.m_type=P.e_faceA,c=this.m_proxyA.GetVertex(t.indexA[0]),h=this.m_proxyA.GetVertex(t.indexA[1]),m=this.m_proxyB.GetVertex(t.indexB[0]),this.m_localPoint.x=.5*(c.x+h.x),this.m_localPoint.y=.5*(c.y+h.y),this.m_axis=a.CrossVF(a.SubtractVV(h,c),1),this.m_axis.Normalize(),y=this.m_axis,_=i.R,b=_.col1.x*y.x+_.col2.x*y.y,C=_.col1.y*y.x+_.col2.y*y.y,y=this.m_localPoint,_=i.R,d=i.position.x+(_.col1.x*y.x+_.col2.x*y.y),v=i.position.y+(_.col1.y*y.x+_.col2.y*y.y),y=m,_=o.R,g=o.position.x+(_.col1.x*y.x+_.col2.x*y.y),x=o.position.y+(_.col1.y*y.x+_.col2.y*y.y),(S=(g-d)*b+(x-v)*C)<0&&this.m_axis.NegativeSelf();else if(t.indexA[0]==t.indexA[0])this.m_type=P.e_faceB,p=this.m_proxyB.GetVertex(t.indexB[0]),f=this.m_proxyB.GetVertex(t.indexB[1]),l=this.m_proxyA.GetVertex(t.indexA[0]),this.m_localPoint.x=.5*(p.x+f.x),this.m_localPoint.y=.5*(p.y+f.y),this.m_axis=a.CrossVF(a.SubtractVV(f,p),1),this.m_axis.Normalize(),y=this.m_axis,_=o.R,b=_.col1.x*y.x+_.col2.x*y.y,C=_.col1.y*y.x+_.col2.y*y.y,y=this.m_localPoint,_=o.R,g=o.position.x+(_.col1.x*y.x+_.col2.x*y.y),x=o.position.y+(_.col1.y*y.x+_.col2.y*y.y),y=l,_=i.R,d=i.position.x+(_.col1.x*y.x+_.col2.x*y.y),v=i.position.y+(_.col1.y*y.x+_.col2.y*y.y),(S=(d-g)*b+(v-x)*C)<0&&this.m_axis.NegativeSelf();else{c=this.m_proxyA.GetVertex(t.indexA[0]),h=this.m_proxyA.GetVertex(t.indexA[1]),p=this.m_proxyB.GetVertex(t.indexB[0]),f=this.m_proxyB.GetVertex(t.indexB[1]);var w=(a.MulX(i,l),a.MulMV(i.R,a.SubtractVV(h,c))),A=(a.MulX(o,m),a.MulMV(o.R,a.SubtractVV(f,p))),D=w.x*w.x+w.y*w.y,M=A.x*A.x+A.y*A.y,k=a.SubtractVV(A,w),B=w.x*k.x+w.y*k.y,I=A.x*k.x+A.y*k.y,T=w.x*A.x+w.y*A.y,E=D*M-T*T;S=0,0!=E&&(S=a.Clamp((T*I-B*M)/E,0,1));var V=(T*S+I)/M;V<0&&(V=0,S=a.Clamp((T-B)/D,0,1)),l=new u,l.x=c.x+S*(h.x-c.x),l.y=c.y+S*(h.y-c.y),m=new u,m.x=p.x+S*(f.x-p.x),m.y=p.y+S*(f.y-p.y),0==S||1==S?(this.m_type=P.e_faceB,this.m_axis=a.CrossVF(a.SubtractVV(f,p),1),this.m_axis.Normalize(),this.m_localPoint=m,y=this.m_axis,_=o.R,b=_.col1.x*y.x+_.col2.x*y.y,C=_.col1.y*y.x+_.col2.y*y.y,y=this.m_localPoint,_=o.R,g=o.position.x+(_.col1.x*y.x+_.col2.x*y.y),x=o.position.y+(_.col1.y*y.x+_.col2.y*y.y),y=l,_=i.R,d=i.position.x+(_.col1.x*y.x+_.col2.x*y.y),v=i.position.y+(_.col1.y*y.x+_.col2.y*y.y),(d-g)*b+(v-x)*C,S<0&&this.m_axis.NegativeSelf()):(this.m_type=P.e_faceA,this.m_axis=a.CrossVF(a.SubtractVV(h,c),1),this.m_localPoint=l,y=this.m_axis,_=i.R,b=_.col1.x*y.x+_.col2.x*y.y,C=_.col1.y*y.x+_.col2.y*y.y,y=this.m_localPoint,_=i.R,d=i.position.x+(_.col1.x*y.x+_.col2.x*y.y),v=i.position.y+(_.col1.y*y.x+_.col2.y*y.y),y=m,_=o.R,g=o.position.x+(_.col1.x*y.x+_.col2.x*y.y),x=o.position.y+(_.col1.y*y.x+_.col2.y*y.y),(g-d)*b+(x-v)*C,S<0&&this.m_axis.NegativeSelf())}},P.prototype.Evaluate=function(t,e){var i,n,o,r,l,c,u;switch(this.m_type){case P.e_points:return i=a.MulTMV(t.R,this.m_axis),n=a.MulTMV(e.R,this.m_axis.GetNegative()),o=this.m_proxyA.GetSupportVertex(i),r=this.m_proxyB.GetSupportVertex(n),l=a.MulX(t,o),c=a.MulX(e,r),(c.x-l.x)*this.m_axis.x+(c.y-l.y)*this.m_axis.y;case P.e_faceA:return u=a.MulMV(t.R,this.m_axis),l=a.MulX(t,this.m_localPoint),n=a.MulTMV(e.R,u.GetNegative()),r=this.m_proxyB.GetSupportVertex(n),c=a.MulX(e,r),(c.x-l.x)*u.x+(c.y-l.y)*u.y;case P.e_faceB:return u=a.MulMV(e.R,this.m_axis),c=a.MulX(e,this.m_localPoint),i=a.MulTMV(t.R,u.GetNegative()),o=this.m_proxyA.GetSupportVertex(i),l=a.MulX(t,o),(l.x-c.x)*u.x+(l.y-c.y)*u.y;default:return s.b2Assert(!1),0}},n.postDefs.push(function(){n.Collision.b2SeparationFunction.e_points=1,n.Collision.b2SeparationFunction.e_faceA=2,n.Collision.b2SeparationFunction.e_faceB=4}),T.b2Simplex=function(){this.m_v1=new V,this.m_v2=new V,this.m_v3=new V,this.m_vertices=new o(3)},T.prototype.b2Simplex=function(){this.m_vertices[0]=this.m_v1,this.m_vertices[1]=this.m_v2,this.m_vertices[2]=this.m_v3},T.prototype.ReadCache=function(t,e,i,n,o){s.b2Assert(0<=t.count&&t.count<=3);var r,l;this.m_count=t.count;for(var c=this.m_vertices,u=0;u<this.m_count;u++){var h=c[u];h.indexA=t.indexA[u],h.indexB=t.indexB[u],r=e.GetVertex(h.indexA),l=n.GetVertex(h.indexB),h.wA=a.MulX(i,r),h.wB=a.MulX(o,l),h.w=a.SubtractVV(h.wB,h.wA),h.a=0}if(this.m_count>1){var m=t.metric,p=this.GetMetric();(p<.5*m||2*m<p||p<Number.MIN_VALUE)&&(this.m_count=0)}0==this.m_count&&(h=c[0],h.indexA=0,h.indexB=0,r=e.GetVertex(0),l=n.GetVertex(0),h.wA=a.MulX(i,r),h.wB=a.MulX(o,l),h.w=a.SubtractVV(h.wB,h.wA),this.m_count=1)},T.prototype.WriteCache=function(t){t.metric=this.GetMetric(),t.count=n.parseUInt(this.m_count);for(var e=this.m_vertices,i=0;i<this.m_count;i++)t.indexA[i]=n.parseUInt(e[i].indexA),t.indexB[i]=n.parseUInt(e[i].indexB)},T.prototype.GetSearchDirection=function(){switch(this.m_count){case 1:return this.m_v1.w.GetNegative();case 2:var t=a.SubtractVV(this.m_v2.w,this.m_v1.w);return a.CrossVV(t,this.m_v1.w.GetNegative())>0?a.CrossFV(1,t):a.CrossVF(t,1);default:return s.b2Assert(!1),new u}},T.prototype.GetClosestPoint=function(){switch(this.m_count){case 0:return s.b2Assert(!1),new u;case 1:return this.m_v1.w;case 2:return new u(this.m_v1.a*this.m_v1.w.x+this.m_v2.a*this.m_v2.w.x,this.m_v1.a*this.m_v1.w.y+this.m_v2.a*this.m_v2.w.y);default:return s.b2Assert(!1),new u}},T.prototype.GetWitnessPoints=function(t,e){switch(this.m_count){case 0:s.b2Assert(!1);break;case 1:t.SetV(this.m_v1.wA),e.SetV(this.m_v1.wB);break;case 2:t.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x,t.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y,e.x=this.m_v1.a*this.m_v1.wB.x+this.m_v2.a*this.m_v2.wB.x,e.y=this.m_v1.a*this.m_v1.wB.y+this.m_v2.a*this.m_v2.wB.y;break;case 3:e.x=t.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x+this.m_v3.a*this.m_v3.wA.x,e.y=t.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y+this.m_v3.a*this.m_v3.wA.y;break;default:s.b2Assert(!1)}},T.prototype.GetMetric=function(){switch(this.m_count){case 0:return s.b2Assert(!1),0;case 1:return 0;case 2:return a.SubtractVV(this.m_v1.w,this.m_v2.w).Length();case 3:return a.CrossVV(a.SubtractVV(this.m_v2.w,this.m_v1.w),a.SubtractVV(this.m_v3.w,this.m_v1.w));default:return s.b2Assert(!1),0}},T.prototype.Solve2=function(){var t=this.m_v1.w,e=this.m_v2.w,i=a.SubtractVV(e,t),n=-(t.x*i.x+t.y*i.y);if(n<=0)return this.m_v1.a=1,void(this.m_count=1);var o=e.x*i.x+e.y*i.y;if(o<=0)return this.m_v2.a=1,this.m_count=1,void this.m_v1.Set(this.m_v2);var r=1/(o+n);this.m_v1.a=o*r,this.m_v2.a=n*r,this.m_count=2},T.prototype.Solve3=function(){var t=this.m_v1.w,e=this.m_v2.w,i=this.m_v3.w,n=a.SubtractVV(e,t),o=a.Dot(t,n),r=a.Dot(e,n),s=r,l=-o,c=a.SubtractVV(i,t),u=a.Dot(t,c),h=a.Dot(i,c),m=h,p=-u,f=a.SubtractVV(i,e),_=a.Dot(e,f),y=a.Dot(i,f),d=y,v=-_,g=a.CrossVV(n,c),x=g*a.CrossVV(e,i),b=g*a.CrossVV(i,t),C=g*a.CrossVV(t,e);if(l<=0&&p<=0)return this.m_v1.a=1,void(this.m_count=1);if(s>0&&l>0&&C<=0){var S=1/(s+l);return this.m_v1.a=s*S,this.m_v2.a=l*S,void(this.m_count=2)}if(m>0&&p>0&&b<=0){var w=1/(m+p);return this.m_v1.a=m*w,this.m_v3.a=p*w,this.m_count=2,void this.m_v2.Set(this.m_v3)}if(s<=0&&v<=0)return this.m_v2.a=1,this.m_count=1,void this.m_v1.Set(this.m_v2);if(m<=0&&d<=0)return this.m_v3.a=1,this.m_count=1,void this.m_v1.Set(this.m_v3);if(d>0&&v>0&&x<=0){var A=1/(d+v);return this.m_v2.a=d*A,this.m_v3.a=v*A,this.m_count=2,void this.m_v1.Set(this.m_v3)}var D=1/(x+b+C);this.m_v1.a=x*D,this.m_v2.a=b*D,this.m_v3.a=C*D,this.m_count=3},E.b2SimplexCache=function(){this.indexA=new r(3),this.indexB=new r(3)},V.b2SimplexVertex=function(){},V.prototype.Set=function(t){this.wA.SetV(t.wA),this.wB.SetV(t.wB),this.w.SetV(t.w),this.a=t.a,this.indexA=t.indexA,this.indexB=t.indexB},L.b2TimeOfImpact=function(){},L.TimeOfImpact=function(t){++L.b2_toiCalls;var e=t.proxyA,i=t.proxyB,n=t.sweepA,o=t.sweepB;s.b2Assert(n.t0==o.t0),s.b2Assert(1-n.t0>Number.MIN_VALUE);var r=e.m_radius+i.m_radius,l=t.tolerance,c=0,u=0,h=0;for(L.s_cache.count=0,L.s_distanceInput.useRadii=!1;;){if(n.GetTransform(L.s_xfA,c),o.GetTransform(L.s_xfB,c),L.s_distanceInput.proxyA=e,L.s_distanceInput.proxyB=i,L.s_distanceInput.transformA=L.s_xfA,L.s_distanceInput.transformB=L.s_xfB,d.Distance(L.s_distanceOutput,L.s_cache,L.s_distanceInput),L.s_distanceOutput.distance<=0){c=1;break}L.s_fcn.Initialize(L.s_cache,e,L.s_xfA,i,L.s_xfB);var m=L.s_fcn.Evaluate(L.s_xfA,L.s_xfB);if(m<=0){c=1;break}if(0==u&&(h=m>r?a.Max(r-l,.75*r):a.Max(m-l,.02*r)),m-h<.5*l){if(0==u){c=1;break}break}var p=c,f=c,_=1,y=m;n.GetTransform(L.s_xfA,_),o.GetTransform(L.s_xfB,_);var v=L.s_fcn.Evaluate(L.s_xfA,L.s_xfB);if(v>=h){c=1;break}for(var g=0;;){var x=0;x=1&g?f+(h-y)*(_-f)/(v-y):.5*(f+_),n.GetTransform(L.s_xfA,x),o.GetTransform(L.s_xfB,x);var b=L.s_fcn.Evaluate(L.s_xfA,L.s_xfB);if(a.Abs(b-h)<.025*l){p=x;break}if(b>h?(f=x,y=b):(_=x,v=b),++g,++L.b2_toiRootIters,50==g)break}if(L.b2_toiMaxRootIters=a.Max(L.b2_toiMaxRootIters,g),p<(1+100*Number.MIN_VALUE)*c)break;if(c=p,u++,++L.b2_toiIters,1e3==u)break}return L.b2_toiMaxIters=a.Max(L.b2_toiMaxIters,u),c},n.postDefs.push(function(){n.Collision.b2TimeOfImpact.b2_toiCalls=0,n.Collision.b2TimeOfImpact.b2_toiIters=0,n.Collision.b2TimeOfImpact.b2_toiMaxIters=0,n.Collision.b2TimeOfImpact.b2_toiRootIters=0,n.Collision.b2TimeOfImpact.b2_toiMaxRootIters=0,n.Collision.b2TimeOfImpact.s_cache=new E,n.Collision.b2TimeOfImpact.s_distanceInput=new v,n.Collision.b2TimeOfImpact.s_xfA=new c,n.Collision.b2TimeOfImpact.s_xfB=new c,n.Collision.b2TimeOfImpact.s_fcn=new P,n.Collision.b2TimeOfImpact.s_distanceOutput=new g}),R.b2TOIInput=function(){this.proxyA=new x,this.proxyB=new x,this.sweepA=new l,this.sweepB=new l},N.b2WorldManifold=function(){this.m_normal=new u},N.prototype.b2WorldManifold=function(){this.m_points=new o(s.b2_maxManifoldPoints);for(var t=0;t<s.b2_maxManifoldPoints;t++)this.m_points[t]=new u},N.prototype.Initialize=function(t,e,i,n,o){if(void 0===i&&(i=0),void 0===o&&(o=0),0!=t.m_pointCount){var r,s,a=0,l=0,c=0,u=0,h=0,m=0,p=0;switch(t.m_type){case A.e_circles:s=e.R,r=t.m_localPoint;var f=e.position.x+s.col1.x*r.x+s.col2.x*r.y,_=e.position.y+s.col1.y*r.x+s.col2.y*r.y;s=n.R,r=t.m_points[0].m_localPoint;var y=n.position.x+s.col1.x*r.x+s.col2.x*r.y,d=n.position.y+s.col1.y*r.x+s.col2.y*r.y,v=y-f,g=d-_,x=v*v+g*g;if(x>Number.MIN_VALUE*Number.MIN_VALUE){var b=Math.sqrt(x);this.m_normal.x=v/b,this.m_normal.y=g/b}else this.m_normal.x=1,this.m_normal.y=0;var C=f+i*this.m_normal.x,S=_+i*this.m_normal.y,w=y-o*this.m_normal.x,D=d-o*this.m_normal.y;this.m_points[0].x=.5*(C+w),this.m_points[0].y=.5*(S+D);break;case A.e_faceA:for(s=e.R,r=t.m_localPlaneNormal,l=s.col1.x*r.x+s.col2.x*r.y,c=s.col1.y*r.x+s.col2.y*r.y,s=e.R,r=t.m_localPoint,u=e.position.x+s.col1.x*r.x+s.col2.x*r.y,h=e.position.y+s.col1.y*r.x+s.col2.y*r.y,this.m_normal.x=l,this.m_normal.y=c,a=0;a<t.m_pointCount;a++)s=n.R,r=t.m_points[a].m_localPoint,m=n.position.x+s.col1.x*r.x+s.col2.x*r.y,p=n.position.y+s.col1.y*r.x+s.col2.y*r.y,this.m_points[a].x=m+.5*(i-(m-u)*l-(p-h)*c-o)*l,this.m_points[a].y=p+.5*(i-(m-u)*l-(p-h)*c-o)*c;break;case A.e_faceB:for(s=n.R,r=t.m_localPlaneNormal,l=s.col1.x*r.x+s.col2.x*r.y,c=s.col1.y*r.x+s.col2.y*r.y,s=n.R,r=t.m_localPoint,u=n.position.x+s.col1.x*r.x+s.col2.x*r.y,h=n.position.y+s.col1.y*r.x+s.col2.y*r.y,this.m_normal.x=-l,this.m_normal.y=-c,a=0;a<t.m_pointCount;a++)s=e.R,r=t.m_points[a].m_localPoint,m=e.position.x+s.col1.x*r.x+s.col2.x*r.y,p=e.position.y+s.col1.y*r.x+s.col2.y*r.y,this.m_points[a].x=m+.5*(o-(m-u)*l-(p-h)*c-i)*l,this.m_points[a].y=p+.5*(o-(m-u)*l-(p-h)*c-i)*c}}},F.ClipVertex=function(){this.v=new u,this.id=new _},F.prototype.Set=function(t){this.v.SetV(t.v),this.id.Set(t.id)},O.Features=function(){},Object.defineProperty(O.prototype,"referenceEdge",{enumerable:!1,configurable:!0,get:function(){return this._referenceEdge}}),Object.defineProperty(O.prototype,"referenceEdge",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._referenceEdge=t,this._m_id._key=4294967040&this._m_id._key|255&this._referenceEdge}}),Object.defineProperty(O.prototype,"incidentEdge",{enumerable:!1,configurable:!0,get:function(){return this._incidentEdge}}),Object.defineProperty(O.prototype,"incidentEdge",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._incidentEdge=t,this._m_id._key=4294902015&this._m_id._key|this._incidentEdge<<8&65280}}),Object.defineProperty(O.prototype,"incidentVertex",{enumerable:!1,configurable:!0,get:function(){return this._incidentVertex}}),Object.defineProperty(O.prototype,"incidentVertex",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._incidentVertex=t,this._m_id._key=4278255615&this._m_id._key|this._incidentVertex<<16&16711680}}),Object.defineProperty(O.prototype,"flip",{enumerable:!1,configurable:!0,get:function(){return this._flip}}),Object.defineProperty(O.prototype,"flip",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._flip=t,this._m_id._key=16777215&this._m_id._key|this._flip<<24&4278190080}})}(),function(){var t=(n.Common.b2Color,n.Common.b2internal,n.Common.b2Settings),e=n.Collision.Shapes.b2CircleShape,i=n.Collision.Shapes.b2EdgeChainDef,s=n.Collision.Shapes.b2EdgeShape,a=n.Collision.Shapes.b2MassData,l=n.Collision.Shapes.b2PolygonShape,c=n.Collision.Shapes.b2Shape,u=n.Common.Math.b2Mat22,h=(n.Common.Math.b2Mat33,n.Common.Math.b2Math),m=(n.Common.Math.b2Sweep,n.Common.Math.b2Transform),p=n.Common.Math.b2Vec2,f=(n.Common.Math.b2Vec3,n.Dynamics.b2Body,n.Dynamics.b2BodyDef,n.Dynamics.b2ContactFilter,n.Dynamics.b2ContactImpulse,n.Dynamics.b2ContactListener,n.Dynamics.b2ContactManager,n.Dynamics.b2DebugDraw,n.Dynamics.b2DestructionListener,n.Dynamics.b2FilterData,n.Dynamics.b2Fixture,n.Dynamics.b2FixtureDef,n.Dynamics.b2Island,n.Dynamics.b2TimeStep,n.Dynamics.b2World,n.Collision.b2AABB,n.Collision.b2Bound,n.Collision.b2BoundValues,n.Collision.b2Collision,n.Collision.b2ContactID,n.Collision.b2ContactPoint,n.Collision.b2Distance),_=n.Collision.b2DistanceInput,y=n.Collision.b2DistanceOutput,d=n.Collision.b2DistanceProxy,v=(n.Collision.b2DynamicTree,n.Collision.b2DynamicTreeBroadPhase,n.Collision.b2DynamicTreeNode,n.Collision.b2DynamicTreePair,n.Collision.b2Manifold,n.Collision.b2ManifoldPoint,n.Collision.b2Point,n.Collision.b2RayCastInput,n.Collision.b2RayCastOutput,n.Collision.b2Segment,n.Collision.b2SeparationFunction,n.Collision.b2Simplex,n.Collision.b2SimplexCache);n.Collision.b2SimplexVertex,n.Collision.b2TimeOfImpact,n.Collision.b2TOIInput,n.Collision.b2WorldManifold,n.Collision.ClipVertex,n.Collision.Features,n.Collision.IBroadPhase;n.inherit(e,n.Collision.Shapes.b2Shape),e.prototype.__super=n.Collision.Shapes.b2Shape.prototype,e.b2CircleShape=function(){n.Collision.Shapes.b2Shape.b2Shape.apply(this,arguments),this.m_p=new p},e.prototype.Copy=function(){var t=new e;return t.Set(this),t},e.prototype.Set=function(t){if(this.__super.Set.call(this,t),n.is(t,e)){var i=t instanceof e?t:null;this.m_p.SetV(i.m_p)}},e.prototype.TestPoint=function(t,e){var i=t.R,n=t.position.x+(i.col1.x*this.m_p.x+i.col2.x*this.m_p.y),o=t.position.y+(i.col1.y*this.m_p.x+i.col2.y*this.m_p.y);return n=e.x-n,o=e.y-o,n*n+o*o<=this.m_radius*this.m_radius},e.prototype.RayCast=function(t,e,i){var n=i.R,o=i.position.x+(n.col1.x*this.m_p.x+n.col2.x*this.m_p.y),r=i.position.y+(n.col1.y*this.m_p.x+n.col2.y*this.m_p.y),s=e.p1.x-o,a=e.p1.y-r,l=s*s+a*a-this.m_radius*this.m_radius,c=e.p2.x-e.p1.x,u=e.p2.y-e.p1.y,h=s*c+a*u,m=c*c+u*u,p=h*h-m*l;if(p<0||m<Number.MIN_VALUE)return!1;var f=-(h+Math.sqrt(p));return 0<=f&&f<=e.maxFraction*m&&(f/=m,t.fraction=f,t.normal.x=s+f*c,t.normal.y=a+f*u,t.normal.Normalize(),!0)},e.prototype.ComputeAABB=function(t,e){var i=e.R,n=e.position.x+(i.col1.x*this.m_p.x+i.col2.x*this.m_p.y),o=e.position.y+(i.col1.y*this.m_p.x+i.col2.y*this.m_p.y);t.lowerBound.Set(n-this.m_radius,o-this.m_radius),t.upperBound.Set(n+this.m_radius,o+this.m_radius)},e.prototype.ComputeMass=function(e,i){void 0===i&&(i=0),e.mass=i*t.b2_pi*this.m_radius*this.m_radius,e.center.SetV(this.m_p),e.I=e.mass*(.5*this.m_radius*this.m_radius+(this.m_p.x*this.m_p.x+this.m_p.y*this.m_p.y))},e.prototype.ComputeSubmergedArea=function(t,e,i,n){void 0===e&&(e=0);var o=h.MulX(i,this.m_p),r=-(h.Dot(t,o)-e);if(r<-this.m_radius+Number.MIN_VALUE)return 0;if(r>this.m_radius)return n.SetV(o),Math.PI*this.m_radius*this.m_radius;var s=this.m_radius*this.m_radius,a=r*r,l=s*(Math.asin(r/this.m_radius)+Math.PI/2)+r*Math.sqrt(s-a),c=-2/3*Math.pow(s-a,1.5)/l;return n.x=o.x+t.x*c,n.y=o.y+t.y*c,l},e.prototype.GetLocalPosition=function(){return this.m_p},e.prototype.SetLocalPosition=function(t){this.m_p.SetV(t)},e.prototype.GetRadius=function(){return this.m_radius},e.prototype.SetRadius=function(t){void 0===t&&(t=0),this.m_radius=t},e.prototype.b2CircleShape=function(t){void 0===t&&(t=0),this.__super.b2Shape.call(this),this.m_type=c.e_circleShape,this.m_radius=t},i.b2EdgeChainDef=function(){},i.prototype.b2EdgeChainDef=function(){this.vertexCount=0,this.isALoop=!0,this.vertices=[]},n.inherit(s,n.Collision.Shapes.b2Shape),s.prototype.__super=n.Collision.Shapes.b2Shape.prototype,s.b2EdgeShape=function(){n.Collision.Shapes.b2Shape.b2Shape.apply(this,arguments),this.s_supportVec=new p,this.m_v1=new p,this.m_v2=new p,this.m_coreV1=new p,this.m_coreV2=new p,this.m_normal=new p,this.m_direction=new p,this.m_cornerDir1=new p,this.m_cornerDir2=new p},s.prototype.TestPoint=function(t,e){return!1},s.prototype.RayCast=function(t,e,i){var n,o=e.p2.x-e.p1.x,r=e.p2.y-e.p1.y;n=i.R;var s=i.position.x+(n.col1.x*this.m_v1.x+n.col2.x*this.m_v1.y),a=i.position.y+(n.col1.y*this.m_v1.x+n.col2.y*this.m_v1.y),l=i.position.y+(n.col1.y*this.m_v2.x+n.col2.y*this.m_v2.y)-a,c=-(i.position.x+(n.col1.x*this.m_v2.x+n.col2.x*this.m_v2.y)-s),u=100*Number.MIN_VALUE,h=-(o*l+r*c);if(h>u){var m=e.p1.x-s,p=e.p1.y-a,f=m*l+p*c;if(0<=f&&f<=e.maxFraction*h){var _=-o*p+r*m;if(-u*h<=_&&_<=h*(1+u)){f/=h,t.fraction=f;var y=Math.sqrt(l*l+c*c);return t.normal.x=l/y,t.normal.y=c/y,!0}}}return!1},s.prototype.ComputeAABB=function(t,e){var i=e.R,n=e.position.x+(i.col1.x*this.m_v1.x+i.col2.x*this.m_v1.y),o=e.position.y+(i.col1.y*this.m_v1.x+i.col2.y*this.m_v1.y),r=e.position.x+(i.col1.x*this.m_v2.x+i.col2.x*this.m_v2.y),s=e.position.y+(i.col1.y*this.m_v2.x+i.col2.y*this.m_v2.y);n<r?(t.lowerBound.x=n,t.upperBound.x=r):(t.lowerBound.x=r,t.upperBound.x=n),o<s?(t.lowerBound.y=o,t.upperBound.y=s):(t.lowerBound.y=s,t.upperBound.y=o)},s.prototype.ComputeMass=function(t,e){void 0===e&&(e=0),t.mass=0,t.center.SetV(this.m_v1),t.I=0},s.prototype.ComputeSubmergedArea=function(t,e,i,n){void 0===e&&(e=0);var o=new p(t.x*e,t.y*e),r=h.MulX(i,this.m_v1),s=h.MulX(i,this.m_v2),a=h.Dot(t,r)-e,l=h.Dot(t,s)-e;if(a>0){if(l>0)return 0;r.x=-l/(a-l)*r.x+a/(a-l)*s.x,r.y=-l/(a-l)*r.y+a/(a-l)*s.y}else l>0&&(s.x=-l/(a-l)*r.x+a/(a-l)*s.x,s.y=-l/(a-l)*r.y+a/(a-l)*s.y);return n.x=(o.x+r.x+s.x)/3,n.y=(o.y+r.y+s.y)/3,.5*((r.x-o.x)*(s.y-o.y)-(r.y-o.y)*(s.x-o.x))},s.prototype.GetLength=function(){return this.m_length},s.prototype.GetVertex1=function(){return this.m_v1},s.prototype.GetVertex2=function(){return this.m_v2},s.prototype.GetCoreVertex1=function(){return this.m_coreV1},s.prototype.GetCoreVertex2=function(){return this.m_coreV2},s.prototype.GetNormalVector=function(){return this.m_normal},s.prototype.GetDirectionVector=function(){return this.m_direction},s.prototype.GetCorner1Vector=function(){return this.m_cornerDir1},s.prototype.GetCorner2Vector=function(){return this.m_cornerDir2},s.prototype.Corner1IsConvex=function(){return this.m_cornerConvex1},s.prototype.Corner2IsConvex=function(){return this.m_cornerConvex2},s.prototype.GetFirstVertex=function(t){var e=t.R;return new p(t.position.x+(e.col1.x*this.m_coreV1.x+e.col2.x*this.m_coreV1.y),t.position.y+(e.col1.y*this.m_coreV1.x+e.col2.y*this.m_coreV1.y))},s.prototype.GetNextEdge=function(){return this.m_nextEdge},s.prototype.GetPrevEdge=function(){return this.m_prevEdge},s.prototype.Support=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0);var n=t.R,o=t.position.x+(n.col1.x*this.m_coreV1.x+n.col2.x*this.m_coreV1.y),r=t.position.y+(n.col1.y*this.m_coreV1.x+n.col2.y*this.m_coreV1.y),s=t.position.x+(n.col1.x*this.m_coreV2.x+n.col2.x*this.m_coreV2.y),a=t.position.y+(n.col1.y*this.m_coreV2.x+n.col2.y*this.m_coreV2.y);return o*e+r*i>s*e+a*i?(this.s_supportVec.x=o,this.s_supportVec.y=r):(this.s_supportVec.x=s,this.s_supportVec.y=a),this.s_supportVec},s.prototype.b2EdgeShape=function(e,i){this.__super.b2Shape.call(this),this.m_type=c.e_edgeShape,this.m_prevEdge=null,this.m_nextEdge=null,this.m_v1=e,this.m_v2=i,this.m_direction.Set(this.m_v2.x-this.m_v1.x,this.m_v2.y-this.m_v1.y),this.m_length=this.m_direction.Normalize(),this.m_normal.Set(this.m_direction.y,-this.m_direction.x),this.m_coreV1.Set(-t.b2_toiSlop*(this.m_normal.x-this.m_direction.x)+this.m_v1.x,-t.b2_toiSlop*(this.m_normal.y-this.m_direction.y)+this.m_v1.y),this.m_coreV2.Set(-t.b2_toiSlop*(this.m_normal.x+this.m_direction.x)+this.m_v2.x,-t.b2_toiSlop*(this.m_normal.y+this.m_direction.y)+this.m_v2.y),this.m_cornerDir1=this.m_normal,this.m_cornerDir2.Set(-this.m_normal.x,-this.m_normal.y)},s.prototype.SetPrevEdge=function(t,e,i,n){this.m_prevEdge=t,this.m_coreV1=e,this.m_cornerDir1=i,this.m_cornerConvex1=n},s.prototype.SetNextEdge=function(t,e,i,n){this.m_nextEdge=t,this.m_coreV2=e,this.m_cornerDir2=i,this.m_cornerConvex2=n},a.b2MassData=function(){this.mass=0,this.center=new p(0,0),this.I=0},n.inherit(l,n.Collision.Shapes.b2Shape),l.prototype.__super=n.Collision.Shapes.b2Shape.prototype,l.b2PolygonShape=function(){n.Collision.Shapes.b2Shape.b2Shape.apply(this,arguments)},l.prototype.Copy=function(){var t=new l;return t.Set(this),t},l.prototype.Set=function(t){if(this.__super.Set.call(this,t),n.is(t,l)){var e=t instanceof l?t:null;this.m_centroid.SetV(e.m_centroid),this.m_vertexCount=e.m_vertexCount,this.Reserve(this.m_vertexCount);for(var i=0;i<this.m_vertexCount;i++)this.m_vertices[i].SetV(e.m_vertices[i]),this.m_normals[i].SetV(e.m_normals[i])}},l.prototype.SetAsArray=function(t,e){void 0===e&&(e=0);var i,n=new o,r=0;for(r=0;r<t.length;++r)i=t[r],n.push(i);this.SetAsVector(n,e)},l.AsArray=function(t,e){void 0===e&&(e=0);var i=new l;return i.SetAsArray(t,e),i},l.prototype.SetAsVector=function(e,i){void 0===i&&(i=0),0==i&&(i=e.length),t.b2Assert(2<=i),this.m_vertexCount=i,this.Reserve(i);var n=0;for(n=0;n<this.m_vertexCount;n++)this.m_vertices[n].SetV(e[n]);for(n=0;n<this.m_vertexCount;++n){var o=parseInt(n),r=parseInt(n+1<this.m_vertexCount?n+1:0),s=h.SubtractVV(this.m_vertices[r],this.m_vertices[o]);t.b2Assert(s.LengthSquared()>Number.MIN_VALUE),this.m_normals[n].SetV(h.CrossVF(s,1)),this.m_normals[n].Normalize()}this.m_centroid=l.ComputeCentroid(this.m_vertices,this.m_vertexCount)},l.AsVector=function(t,e){void 0===e&&(e=0);var i=new l;return i.SetAsVector(t,e),i},l.prototype.SetAsBox=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.m_vertexCount=4,this.Reserve(4),this.m_vertices[0].Set(-t,-e),this.m_vertices[1].Set(t,-e),this.m_vertices[2].Set(t,e),this.m_vertices[3].Set(-t,e),this.m_normals[0].Set(0,-1),this.m_normals[1].Set(1,0),this.m_normals[2].Set(0,1),this.m_normals[3].Set(-1,0),this.m_centroid.SetZero()},l.AsBox=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var i=new l;return i.SetAsBox(t,e),i},l.prototype.SetAsOrientedBox=function(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=null),void 0===n&&(n=0),this.m_vertexCount=4,this.Reserve(4),this.m_vertices[0].Set(-t,-e),this.m_vertices[1].Set(t,-e),this.m_vertices[2].Set(t,e),this.m_vertices[3].Set(-t,e),this.m_normals[0].Set(0,-1),this.m_normals[1].Set(1,0),this.m_normals[2].Set(0,1),this.m_normals[3].Set(-1,0),this.m_centroid=i;var o=new m;o.position=i,o.R.Set(n);for(var r=0;r<this.m_vertexCount;++r)this.m_vertices[r]=h.MulX(o,this.m_vertices[r]),this.m_normals[r]=h.MulMV(o.R,this.m_normals[r])},l.AsOrientedBox=function(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=null),void 0===n&&(n=0);var o=new l;return o.SetAsOrientedBox(t,e,i,n),o},l.prototype.SetAsEdge=function(t,e){this.m_vertexCount=2,this.Reserve(2),this.m_vertices[0].SetV(t),this.m_vertices[1].SetV(e),this.m_centroid.x=.5*(t.x+e.x),this.m_centroid.y=.5*(t.y+e.y),this.m_normals[0]=h.CrossVF(h.SubtractVV(e,t),1),this.m_normals[0].Normalize(),this.m_normals[1].x=-this.m_normals[0].x,this.m_normals[1].y=-this.m_normals[0].y},l.AsEdge=function(t,e){var i=new l;return i.SetAsEdge(t,e),i},l.prototype.TestPoint=function(t,e){for(var i,n=t.R,o=e.x-t.position.x,r=e.y-t.position.y,s=o*n.col1.x+r*n.col1.y,a=o*n.col2.x+r*n.col2.y,l=0;l<this.m_vertexCount;++l){i=this.m_vertices[l],o=s-i.x,r=a-i.y,i=this.m_normals[l];if(i.x*o+i.y*r>0)return!1}return!0},l.prototype.RayCast=function(t,e,i){var n,o,r=0,s=e.maxFraction,a=0,l=0;a=e.p1.x-i.position.x,l=e.p1.y-i.position.y,n=i.R;var c=a*n.col1.x+l*n.col1.y,u=a*n.col2.x+l*n.col2.y;a=e.p2.x-i.position.x,l=e.p2.y-i.position.y,n=i.R;for(var h=a*n.col1.x+l*n.col1.y,m=a*n.col2.x+l*n.col2.y,p=h-c,f=m-u,_=parseInt(-1),y=0;y<this.m_vertexCount;++y){o=this.m_vertices[y],a=o.x-c,l=o.y-u,o=this.m_normals[y];var d=o.x*a+o.y*l,v=o.x*p+o.y*f;if(0==v){if(d<0)return!1}else v<0&&d<r*v?(r=d/v,_=y):v>0&&d<s*v&&(s=d/v);if(s<r-Number.MIN_VALUE)return!1}return _>=0&&(t.fraction=r,n=i.R,o=this.m_normals[_],t.normal.x=n.col1.x*o.x+n.col2.x*o.y,t.normal.y=n.col1.y*o.x+n.col2.y*o.y,!0)},l.prototype.ComputeAABB=function(t,e){for(var i=e.R,n=this.m_vertices[0],o=e.position.x+(i.col1.x*n.x+i.col2.x*n.y),r=e.position.y+(i.col1.y*n.x+i.col2.y*n.y),s=o,a=r,l=1;l<this.m_vertexCount;++l){n=this.m_vertices[l];var c=e.position.x+(i.col1.x*n.x+i.col2.x*n.y),u=e.position.y+(i.col1.y*n.x+i.col2.y*n.y);o=o<c?o:c,r=r<u?r:u,s=s>c?s:c,a=a>u?a:u}t.lowerBound.x=o-this.m_radius,t.lowerBound.y=r-this.m_radius,t.upperBound.x=s+this.m_radius,t.upperBound.y=a+this.m_radius},l.prototype.ComputeMass=function(t,e){if(void 0===e&&(e=0),2==this.m_vertexCount)return t.center.x=.5*(this.m_vertices[0].x+this.m_vertices[1].x),t.center.y=.5*(this.m_vertices[0].y+this.m_vertices[1].y),t.mass=0,void(t.I=0);for(var i=0,n=0,o=0,r=0,s=0;s<this.m_vertexCount;++s){var a=this.m_vertices[s],l=s+1<this.m_vertexCount?this.m_vertices[parseInt(s+1)]:this.m_vertices[0],c=a.x-0,u=a.y-0,h=l.x-0,m=l.y-0,p=c*m-u*h,f=.5*p;o+=f,i+=f*(1/3)*(0+a.x+l.x),n+=f*(1/3)*(0+a.y+l.y);var _=c,y=u,d=h,v=m;r+=p*(1/3*(.25*(_*_+d*_+d*d)+(0*_+0*d))+0+(1/3*(.25*(y*y+v*y+v*v)+(0*y+0*v))+0))}t.mass=e*o,i*=1/o,n*=1/o,t.center.Set(i,n),t.I=e*r},l.prototype.ComputeSubmergedArea=function(t,e,i,n){void 0===e&&(e=0);var o=h.MulTMV(i.R,t),s=e-h.Dot(t,i.position),l=new r,c=0,u=parseInt(-1),m=parseInt(-1),f=!1,_=0;for(_=0;_<this.m_vertexCount;++_){l[_]=h.Dot(o,this.m_vertices[_])-s;var y=l[_]<-Number.MIN_VALUE;_>0&&(y?f||(u=_-1,c++):f&&(m=_-1,c++)),f=y}switch(c){case 0:if(f){var d=new a;return this.ComputeMass(d,1),n.SetV(h.MulX(i,d.center)),d.mass}return 0;case 1:-1==u?u=this.m_vertexCount-1:m=this.m_vertexCount-1}var v,g=parseInt((u+1)%this.m_vertexCount),x=parseInt((m+1)%this.m_vertexCount),b=(0-l[u])/(l[g]-l[u]),C=(0-l[m])/(l[x]-l[m]),S=new p(this.m_vertices[u].x*(1-b)+this.m_vertices[g].x*b,this.m_vertices[u].y*(1-b)+this.m_vertices[g].y*b),w=new p(this.m_vertices[m].x*(1-C)+this.m_vertices[x].x*C,this.m_vertices[m].y*(1-C)+this.m_vertices[x].y*C),A=0,D=new p,M=this.m_vertices[g];for(_=g;_!=x;){_=(_+1)%this.m_vertexCount,v=_==x?w:this.m_vertices[_];var k=.5*((M.x-S.x)*(v.y-S.y)-(M.y-S.y)*(v.x-S.x));A+=k,D.x+=k*(S.x+M.x+v.x)/3,D.y+=k*(S.y+M.y+v.y)/3,M=v}return D.Multiply(1/A),n.SetV(h.MulX(i,D)),A},l.prototype.GetVertexCount=function(){return this.m_vertexCount},l.prototype.GetVertices=function(){return this.m_vertices},l.prototype.GetNormals=function(){return this.m_normals},l.prototype.GetSupport=function(t){for(var e=0,i=this.m_vertices[0].x*t.x+this.m_vertices[0].y*t.y,n=1;n<this.m_vertexCount;++n){var o=this.m_vertices[n].x*t.x+this.m_vertices[n].y*t.y;o>i&&(e=n,i=o)}return e},l.prototype.GetSupportVertex=function(t){for(var e=0,i=this.m_vertices[0].x*t.x+this.m_vertices[0].y*t.y,n=1;n<this.m_vertexCount;++n){var o=this.m_vertices[n].x*t.x+this.m_vertices[n].y*t.y;o>i&&(e=n,i=o)}return this.m_vertices[e]},l.prototype.Validate=function(){return!1},l.prototype.b2PolygonShape=function(){this.__super.b2Shape.call(this),this.m_type=c.e_polygonShape,this.m_centroid=new p,this.m_vertices=new o,this.m_normals=new o},l.prototype.Reserve=function(t){void 0===t&&(t=0);for(var e=parseInt(this.m_vertices.length);e<t;e++)this.m_vertices[e]=new p,this.m_normals[e]=new p},l.ComputeCentroid=function(t,e){void 0===e&&(e=0);for(var i=new p,n=0,o=0;o<e;++o){var r=t[o],s=o+1<e?t[parseInt(o+1)]:t[0],a=r.x-0,l=r.y-0,c=s.x-0,u=s.y-0,h=a*u-l*c,m=.5*h;n+=m,i.x+=m*(1/3)*(0+r.x+s.x),i.y+=m*(1/3)*(0+r.y+s.y)}return i.x*=1/n,i.y*=1/n,i},l.ComputeOBB=function(t,e,i){void 0===i&&(i=0);var n=0,r=new o(i+1);for(n=0;n<i;++n)r[n]=e[n];r[i]=r[0];var s=Number.MAX_VALUE;for(n=1;n<=i;++n){var a=r[parseInt(n-1)],l=r[n].x-a.x,c=r[n].y-a.y,u=Math.sqrt(l*l+c*c);l/=u,c/=u;for(var h=-c,m=l,p=Number.MAX_VALUE,f=Number.MAX_VALUE,_=-Number.MAX_VALUE,y=-Number.MAX_VALUE,d=0;d<i;++d){var v=r[d].x-a.x,g=r[d].y-a.y,x=l*v+c*g,b=h*v+m*g;x<p&&(p=x),b<f&&(f=b),x>_&&(_=x),b>y&&(y=b)}var C=(_-p)*(y-f);if(C<.95*s){s=C,t.R.col1.x=l,t.R.col1.y=c,t.R.col2.x=h,t.R.col2.y=m;var S=.5*(p+_),w=.5*(f+y),A=t.R;t.center.x=a.x+(A.col1.x*S+A.col2.x*w),t.center.y=a.y+(A.col1.y*S+A.col2.y*w),t.extents.x=.5*(_-p),t.extents.y=.5*(y-f)}}},n.postDefs.push(function(){n.Collision.Shapes.b2PolygonShape.s_mat=new u}),c.b2Shape=function(){},c.prototype.Copy=function(){return null},c.prototype.Set=function(t){this.m_radius=t.m_radius},c.prototype.GetType=function(){return this.m_type},c.prototype.TestPoint=function(t,e){return!1},c.prototype.RayCast=function(t,e,i){return!1},c.prototype.ComputeAABB=function(t,e){},c.prototype.ComputeMass=function(t,e){void 0===e&&(e=0)},c.prototype.ComputeSubmergedArea=function(t,e,i,n){return void 0===e&&(e=0),0},c.TestOverlap=function(t,e,i,n){var o=new _;o.proxyA=new d,o.proxyA.Set(t),o.proxyB=new d,o.proxyB.Set(i),o.transformA=e,o.transformB=n,o.useRadii=!0;var r=new v;r.count=0;var s=new y;return f.Distance(s,r,o),s.distance<10*Number.MIN_VALUE},c.prototype.b2Shape=function(){this.m_type=c.e_unknownShape,this.m_radius=t.b2_linearSlop},n.postDefs.push(function(){n.Collision.Shapes.b2Shape.e_unknownShape=parseInt(-1),n.Collision.Shapes.b2Shape.e_circleShape=0,n.Collision.Shapes.b2Shape.e_polygonShape=1,n.Collision.Shapes.b2Shape.e_edgeShape=2,n.Collision.Shapes.b2Shape.e_shapeTypeCount=3,n.Collision.Shapes.b2Shape.e_hitCollide=1,n.Collision.Shapes.b2Shape.e_missCollide=0,n.Collision.Shapes.b2Shape.e_startsInsideCollide=parseInt(-1)})}(),function(){var t=n.Common.b2Color,e=(n.Common.b2internal,n.Common.b2Settings),i=(n.Common.Math.b2Mat22,n.Common.Math.b2Mat33,n.Common.Math.b2Math);n.Common.Math.b2Sweep,n.Common.Math.b2Transform,n.Common.Math.b2Vec2,n.Common.Math.b2Vec3;t.b2Color=function(){this._r=0,this._g=0,this._b=0},t.prototype.b2Color=function(t,e,o){void 0===t&&(t=0),void 0===e&&(e=0),void 0===o&&(o=0),this._r=n.parseUInt(255*i.Clamp(t,0,1)),this._g=n.parseUInt(255*i.Clamp(e,0,1)),this._b=n.parseUInt(255*i.Clamp(o,0,1))},t.prototype.Set=function(t,e,o){void 0===t&&(t=0),void 0===e&&(e=0),void 0===o&&(o=0),this._r=n.parseUInt(255*i.Clamp(t,0,1)),this._g=n.parseUInt(255*i.Clamp(e,0,1)),this._b=n.parseUInt(255*i.Clamp(o,0,1))},Object.defineProperty(t.prototype,"r",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._r=n.parseUInt(255*i.Clamp(t,0,1))}}),Object.defineProperty(t.prototype,"g",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._g=n.parseUInt(255*i.Clamp(t,0,1))}}),Object.defineProperty(t.prototype,"b",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._b=n.parseUInt(255*i.Clamp(t,0,1))}}),Object.defineProperty(t.prototype,"color",{enumerable:!1,configurable:!0,get:function(){return this._r<<16|this._g<<8|this._b}}),e.b2Settings=function(){},e.b2MixFriction=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),Math.sqrt(t*e)},e.b2MixRestitution=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),t>e?t:e},e.b2Assert=function(t){if(!t)throw"Assertion Failed"},n.postDefs.push(function(){n.Common.b2Settings.VERSION="2.1alpha",n.Common.b2Settings.USHRT_MAX=65535,n.Common.b2Settings.b2_pi=Math.PI,n.Common.b2Settings.b2_maxManifoldPoints=2,n.Common.b2Settings.b2_aabbExtension=.1,n.Common.b2Settings.b2_aabbMultiplier=2,n.Common.b2Settings.b2_polygonRadius=2*e.b2_linearSlop,n.Common.b2Settings.b2_linearSlop=.005,n.Common.b2Settings.b2_angularSlop=2/180*e.b2_pi,n.Common.b2Settings.b2_toiSlop=8*e.b2_linearSlop,n.Common.b2Settings.b2_maxTOIContactsPerIsland=32,n.Common.b2Settings.b2_maxTOIJointsPerIsland=32,n.Common.b2Settings.b2_velocityThreshold=1,n.Common.b2Settings.b2_maxLinearCorrection=.2,n.Common.b2Settings.b2_maxAngularCorrection=8/180*e.b2_pi,n.Common.b2Settings.b2_maxTranslation=2,n.Common.b2Settings.b2_maxTranslationSquared=e.b2_maxTranslation*e.b2_maxTranslation,n.Common.b2Settings.b2_maxRotation=.5*e.b2_pi,n.Common.b2Settings.b2_maxRotationSquared=e.b2_maxRotation*e.b2_maxRotation,n.Common.b2Settings.b2_contactBaumgarte=.2,n.Common.b2Settings.b2_timeToSleep=.5,n.Common.b2Settings.b2_linearSleepTolerance=.01,n.Common.b2Settings.b2_angularSleepTolerance=2/180*e.b2_pi})}(),function(){var t=(n.Collision.b2AABB,n.Common.b2Color,n.Common.b2internal,n.Common.b2Settings,n.Common.Math.b2Mat22),e=n.Common.Math.b2Mat33,i=n.Common.Math.b2Math,o=n.Common.Math.b2Sweep,r=n.Common.Math.b2Transform,s=n.Common.Math.b2Vec2,a=n.Common.Math.b2Vec3;t.b2Mat22=function(){this.col1=new s,this.col2=new s},t.prototype.b2Mat22=function(){this.SetIdentity()},t.FromAngle=function(e){void 0===e&&(e=0);var i=new t;return i.Set(e),i},t.FromVV=function(e,i){var n=new t;return n.SetVV(e,i),n},t.prototype.Set=function(t){void 0===t&&(t=0);var e=Math.cos(t),i=Math.sin(t);this.col1.x=e,this.col2.x=-i,this.col1.y=i,this.col2.y=e},t.prototype.SetVV=function(t,e){this.col1.SetV(t),this.col2.SetV(e)},t.prototype.Copy=function(){var e=new t;return e.SetM(this),e},t.prototype.SetM=function(t){this.col1.SetV(t.col1),this.col2.SetV(t.col2)},t.prototype.AddM=function(t){this.col1.x+=t.col1.x,this.col1.y+=t.col1.y,this.col2.x+=t.col2.x,this.col2.y+=t.col2.y},t.prototype.SetIdentity=function(){this.col1.x=1,this.col2.x=0,this.col1.y=0,this.col2.y=1},t.prototype.SetZero=function(){this.col1.x=0,this.col2.x=0,this.col1.y=0,this.col2.y=0},t.prototype.GetAngle=function(){return Math.atan2(this.col1.y,this.col1.x)},t.prototype.GetInverse=function(t){var e=this.col1.x,i=this.col2.x,n=this.col1.y,o=this.col2.y,r=e*o-i*n;return 0!=r&&(r=1/r),t.col1.x=r*o,t.col2.x=-r*i,t.col1.y=-r*n,t.col2.y=r*e,t},t.prototype.Solve=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0);var n=this.col1.x,o=this.col2.x,r=this.col1.y,s=this.col2.y,a=n*s-o*r;return 0!=a&&(a=1/a),t.x=a*(s*e-o*i),t.y=a*(n*i-r*e),t},t.prototype.Abs=function(){this.col1.Abs(),this.col2.Abs()},e.b2Mat33=function(){this.col1=new a,this.col2=new a,this.col3=new a},e.prototype.b2Mat33=function(t,e,i){void 0===t&&(t=null),void 0===e&&(e=null),void 0===i&&(i=null),t||e||i?(this.col1.SetV(t),this.col2.SetV(e),this.col3.SetV(i)):(this.col1.SetZero(),this.col2.SetZero(),this.col3.SetZero())},e.prototype.SetVVV=function(t,e,i){this.col1.SetV(t),this.col2.SetV(e),this.col3.SetV(i)},e.prototype.Copy=function(){return new e(this.col1,this.col2,this.col3)},e.prototype.SetM=function(t){this.col1.SetV(t.col1),this.col2.SetV(t.col2),this.col3.SetV(t.col3)},e.prototype.AddM=function(t){this.col1.x+=t.col1.x,this.col1.y+=t.col1.y,this.col1.z+=t.col1.z,this.col2.x+=t.col2.x,this.col2.y+=t.col2.y,this.col2.z+=t.col2.z,this.col3.x+=t.col3.x,this.col3.y+=t.col3.y,this.col3.z+=t.col3.z},e.prototype.SetIdentity=function(){this.col1.x=1,this.col2.x=0,this.col3.x=0,this.col1.y=0,this.col2.y=1,this.col3.y=0,this.col1.z=0,this.col2.z=0,this.col3.z=1},e.prototype.SetZero=function(){this.col1.x=0,this.col2.x=0,this.col3.x=0,this.col1.y=0,this.col2.y=0,this.col3.y=0,this.col1.z=0,this.col2.z=0,this.col3.z=0},e.prototype.Solve22=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0);var n=this.col1.x,o=this.col2.x,r=this.col1.y,s=this.col2.y,a=n*s-o*r;return 0!=a&&(a=1/a),t.x=a*(s*e-o*i),t.y=a*(n*i-r*e),t},e.prototype.Solve33=function(t,e,i,n){void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0);var o=this.col1.x,r=this.col1.y,s=this.col1.z,a=this.col2.x,l=this.col2.y,c=this.col2.z,u=this.col3.x,h=this.col3.y,m=this.col3.z,p=o*(l*m-c*h)+r*(c*u-a*m)+s*(a*h-l*u);return 0!=p&&(p=1/p),t.x=p*(e*(l*m-c*h)+i*(c*u-a*m)+n*(a*h-l*u)),t.y=p*(o*(i*m-n*h)+r*(n*u-e*m)+s*(e*h-i*u)),t.z=p*(o*(l*n-c*i)+r*(c*e-a*n)+s*(a*i-l*e)),t},i.b2Math=function(){},i.IsValid=function(t){return void 0===t&&(t=0),isFinite(t)},i.Dot=function(t,e){return t.x*e.x+t.y*e.y},i.CrossVV=function(t,e){return t.x*e.y-t.y*e.x},i.CrossVF=function(t,e){return void 0===e&&(e=0),new s(e*t.y,-e*t.x)},i.CrossFV=function(t,e){return void 0===t&&(t=0),new s(-t*e.y,t*e.x)},i.MulMV=function(t,e){return new s(t.col1.x*e.x+t.col2.x*e.y,t.col1.y*e.x+t.col2.y*e.y)},i.MulTMV=function(t,e){return new s(i.Dot(e,t.col1),i.Dot(e,t.col2))},i.MulX=function(t,e){var n=i.MulMV(t.R,e);return n.x+=t.position.x,n.y+=t.position.y,n},i.MulXT=function(t,e){var n=i.SubtractVV(e,t.position),o=n.x*t.R.col1.x+n.y*t.R.col1.y;return n.y=n.x*t.R.col2.x+n.y*t.R.col2.y,n.x=o,n},i.AddVV=function(t,e){return new s(t.x+e.x,t.y+e.y)},i.SubtractVV=function(t,e){return new s(t.x-e.x,t.y-e.y)},i.Distance=function(t,e){var i=t.x-e.x,n=t.y-e.y;return Math.sqrt(i*i+n*n)},i.DistanceSquared=function(t,e){var i=t.x-e.x,n=t.y-e.y;return i*i+n*n},i.MulFV=function(t,e){return void 0===t&&(t=0),new s(t*e.x,t*e.y)},i.AddMM=function(e,n){return t.FromVV(i.AddVV(e.col1,n.col1),i.AddVV(e.col2,n.col2))},i.MulMM=function(e,n){return t.FromVV(i.MulMV(e,n.col1),i.MulMV(e,n.col2))},i.MulTMM=function(e,n){var o=new s(i.Dot(e.col1,n.col1),i.Dot(e.col2,n.col1)),r=new s(i.Dot(e.col1,n.col2),i.Dot(e.col2,n.col2));return t.FromVV(o,r)},i.Abs=function(t){return void 0===t&&(t=0),t>0?t:-t},i.AbsV=function(t){return new s(i.Abs(t.x),i.Abs(t.y))},i.AbsM=function(e){return t.FromVV(i.AbsV(e.col1),i.AbsV(e.col2))},i.Min=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),t<e?t:e},i.MinV=function(t,e){return new s(i.Min(t.x,e.x),i.Min(t.y,e.y))},i.Max=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),t>e?t:e},i.MaxV=function(t,e){return new s(i.Max(t.x,e.x),i.Max(t.y,e.y))},i.Clamp=function(t,e,i){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),t<e?e:t>i?i:t},i.ClampV=function(t,e,n){return i.MaxV(e,i.MinV(t,n))},i.Swap=function(t,e){var i=t[0];t[0]=e[0],e[0]=i},i.Random=function(){return 2*Math.random()-1},i.RandomRange=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var i=Math.random();return i=(e-t)*i+t},i.NextPowerOfTwo=function(t){return void 0===t&&(t=0),t|=t>>1&2147483647,t|=t>>2&1073741823,t|=t>>4&268435455,t|=t>>8&16777215,(t|=t>>16&65535)+1},i.IsPowerOfTwo=function(t){return void 0===t&&(t=0),t>0&&0==(t&t-1)},n.postDefs.push(function(){n.Common.Math.b2Math.b2Vec2_zero=new s(0,0),n.Common.Math.b2Math.b2Mat22_identity=t.FromVV(new s(1,0),new s(0,1)),n.Common.Math.b2Math.b2Transform_identity=new r(i.b2Vec2_zero,i.b2Mat22_identity)}),o.b2Sweep=function(){this.localCenter=new s,this.c0=new s,this.c=new s},o.prototype.Set=function(t){this.localCenter.SetV(t.localCenter),this.c0.SetV(t.c0),this.c.SetV(t.c),this.a0=t.a0,this.a=t.a,this.t0=t.t0},o.prototype.Copy=function(){var t=new o;return t.localCenter.SetV(this.localCenter),t.c0.SetV(this.c0),t.c.SetV(this.c),t.a0=this.a0,t.a=this.a,t.t0=this.t0,t},o.prototype.GetTransform=function(t,e){void 0===e&&(e=0),t.position.x=(1-e)*this.c0.x+e*this.c.x,t.position.y=(1-e)*this.c0.y+e*this.c.y;var i=(1-e)*this.a0+e*this.a;t.R.Set(i);var n=t.R;t.position.x-=n.col1.x*this.localCenter.x+n.col2.x*this.localCenter.y,t.position.y-=n.col1.y*this.localCenter.x+n.col2.y*this.localCenter.y},o.prototype.Advance=function(t){if(void 0===t&&(t=0),this.t0<t&&1-this.t0>Number.MIN_VALUE){var e=(t-this.t0)/(1-this.t0);this.c0.x=(1-e)*this.c0.x+e*this.c.x,this.c0.y=(1-e)*this.c0.y+e*this.c.y,this.a0=(1-e)*this.a0+e*this.a,this.t0=t}},r.b2Transform=function(){this.position=new s,this.R=new t},r.prototype.b2Transform=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),t&&(this.position.SetV(t),this.R.SetM(e))},r.prototype.Initialize=function(t,e){this.position.SetV(t),this.R.SetM(e)},r.prototype.SetIdentity=function(){this.position.SetZero(),this.R.SetIdentity()},r.prototype.Set=function(t){this.position.SetV(t.position),this.R.SetM(t.R)},r.prototype.GetAngle=function(){return Math.atan2(this.R.col1.y,this.R.col1.x)},s.b2Vec2=function(){},s.prototype.b2Vec2=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e},s.prototype.SetZero=function(){this.x=0,this.y=0},s.prototype.Set=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e},s.prototype.SetV=function(t){this.x=t.x,this.y=t.y},s.prototype.GetNegative=function(){return new s(-this.x,-this.y)},s.prototype.NegativeSelf=function(){this.x=-this.x,this.y=-this.y},s.Make=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),new s(t,e)},s.prototype.Copy=function(){return new s(this.x,this.y)},s.prototype.Add=function(t){this.x+=t.x,this.y+=t.y},s.prototype.Subtract=function(t){this.x-=t.x,this.y-=t.y},s.prototype.Multiply=function(t){void 0===t&&(t=0),this.x*=t,this.y*=t},s.prototype.MulM=function(t){var e=this.x;this.x=t.col1.x*e+t.col2.x*this.y,this.y=t.col1.y*e+t.col2.y*this.y},s.prototype.MulTM=function(t){var e=i.Dot(this,t.col1);this.y=i.Dot(this,t.col2),this.x=e},s.prototype.CrossVF=function(t){void 0===t&&(t=0);var e=this.x;this.x=t*this.y,this.y=-t*e},s.prototype.CrossFV=function(t){void 0===t&&(t=0);var e=this.x;this.x=-t*this.y,this.y=t*e},s.prototype.MinV=function(t){this.x=this.x<t.x?this.x:t.x,this.y=this.y<t.y?this.y:t.y},s.prototype.MaxV=function(t){this.x=this.x>t.x?this.x:t.x,this.y=this.y>t.y?this.y:t.y},s.prototype.Abs=function(){this.x<0&&(this.x=-this.x),this.y<0&&(this.y=-this.y)},s.prototype.Length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},s.prototype.LengthSquared=function(){return this.x*this.x+this.y*this.y},s.prototype.Normalize=function(){var t=Math.sqrt(this.x*this.x+this.y*this.y);if(t<Number.MIN_VALUE)return 0;var e=1/t;return this.x*=e,this.y*=e,t},s.prototype.IsValid=function(){return i.IsValid(this.x)&&i.IsValid(this.y)},a.b2Vec3=function(){},a.prototype.b2Vec3=function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.x=t,this.y=e,this.z=i},a.prototype.SetZero=function(){this.x=this.y=this.z=0},a.prototype.Set=function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.x=t,this.y=e,this.z=i},a.prototype.SetV=function(t){this.x=t.x,this.y=t.y,this.z=t.z},a.prototype.GetNegative=function(){return new a(-this.x,-this.y,-this.z)},a.prototype.NegativeSelf=function(){this.x=-this.x,this.y=-this.y,this.z=-this.z},a.prototype.Copy=function(){return new a(this.x,this.y,this.z)},a.prototype.Add=function(t){this.x+=t.x,this.y+=t.y,this.z+=t.z},a.prototype.Subtract=function(t){this.x-=t.x,this.y-=t.y,this.z-=t.z},a.prototype.Multiply=function(t){void 0===t&&(t=0),this.x*=t,this.y*=t,this.z*=t}}(),function(){var t=(n.Dynamics.Controllers.b2ControllerEdge,n.Common.Math.b2Mat22,n.Common.Math.b2Mat33,n.Common.Math.b2Math),e=n.Common.Math.b2Sweep,i=n.Common.Math.b2Transform,s=n.Common.Math.b2Vec2,a=(n.Common.Math.b2Vec3,n.Common.b2Color),l=(n.Common.b2internal,n.Common.b2Settings),c=n.Collision.b2AABB,u=(n.Collision.b2Bound,n.Collision.b2BoundValues,n.Collision.b2Collision,n.Collision.b2ContactID,n.Collision.b2ContactPoint),h=(n.Collision.b2Distance,n.Collision.b2DistanceInput,n.Collision.b2DistanceOutput,n.Collision.b2DistanceProxy,n.Collision.b2DynamicTree,n.Collision.b2DynamicTreeBroadPhase),m=(n.Collision.b2DynamicTreeNode,n.Collision.b2DynamicTreePair,n.Collision.b2Manifold,n.Collision.b2ManifoldPoint,n.Collision.b2Point,n.Collision.b2RayCastInput),p=n.Collision.b2RayCastOutput,f=(n.Collision.b2Segment,n.Collision.b2SeparationFunction,n.Collision.b2Simplex,n.Collision.b2SimplexCache,n.Collision.b2SimplexVertex,n.Collision.b2TimeOfImpact,n.Collision.b2TOIInput,n.Collision.b2WorldManifold,n.Collision.ClipVertex,n.Collision.Features,n.Collision.IBroadPhase,n.Collision.Shapes.b2CircleShape),_=(n.Collision.Shapes.b2EdgeChainDef,n.Collision.Shapes.b2EdgeShape),y=n.Collision.Shapes.b2MassData,d=n.Collision.Shapes.b2PolygonShape,v=n.Collision.Shapes.b2Shape,g=n.Dynamics.b2Body,x=n.Dynamics.b2BodyDef,b=n.Dynamics.b2ContactFilter,C=n.Dynamics.b2ContactImpulse,S=n.Dynamics.b2ContactListener,w=n.Dynamics.b2ContactManager,A=n.Dynamics.b2DebugDraw,D=n.Dynamics.b2DestructionListener,M=n.Dynamics.b2FilterData,k=n.Dynamics.b2Fixture,B=n.Dynamics.b2FixtureDef,I=n.Dynamics.b2Island,P=n.Dynamics.b2TimeStep,T=n.Dynamics.b2World,E=(n.Dynamics.Contacts.b2CircleContact,n.Dynamics.Contacts.b2Contact),V=(n.Dynamics.Contacts.b2ContactConstraint,n.Dynamics.Contacts.b2ContactConstraintPoint,n.Dynamics.Contacts.b2ContactEdge,n.Dynamics.Contacts.b2ContactFactory),L=(n.Dynamics.Contacts.b2ContactRegister,n.Dynamics.Contacts.b2ContactResult,n.Dynamics.Contacts.b2ContactSolver),R=(n.Dynamics.Contacts.b2EdgeAndCircleContact,n.Dynamics.Contacts.b2NullContact,n.Dynamics.Contacts.b2PolyAndCircleContact,n.Dynamics.Contacts.b2PolyAndEdgeContact,n.Dynamics.Contacts.b2PolygonContact,n.Dynamics.Contacts.b2PositionSolverManifold,n.Dynamics.Controllers.b2Controller,n.Dynamics.Joints.b2DistanceJoint,n.Dynamics.Joints.b2DistanceJointDef,n.Dynamics.Joints.b2FrictionJoint,n.Dynamics.Joints.b2FrictionJointDef,n.Dynamics.Joints.b2GearJoint,n.Dynamics.Joints.b2GearJointDef,n.Dynamics.Joints.b2Jacobian,n.Dynamics.Joints.b2Joint),N=(n.Dynamics.Joints.b2JointDef,n.Dynamics.Joints.b2JointEdge,n.Dynamics.Joints.b2LineJoint,n.Dynamics.Joints.b2LineJointDef,n.Dynamics.Joints.b2MouseJoint,n.Dynamics.Joints.b2MouseJointDef,n.Dynamics.Joints.b2PrismaticJoint,n.Dynamics.Joints.b2PrismaticJointDef,n.Dynamics.Joints.b2PulleyJoint);n.Dynamics.Joints.b2PulleyJointDef,n.Dynamics.Joints.b2RevoluteJoint,n.Dynamics.Joints.b2RevoluteJointDef,n.Dynamics.Joints.b2WeldJoint,n.Dynamics.Joints.b2WeldJointDef;g.b2Body=function(){this.m_xf=new i,this.m_sweep=new e,this.m_linearVelocity=new s,this.m_force=new s},g.prototype.connectEdges=function(e,i,n){void 0===n&&(n=0);var o=Math.atan2(i.GetDirectionVector().y,i.GetDirectionVector().x),r=Math.tan(.5*(o-n)),s=t.MulFV(r,i.GetDirectionVector());s=t.SubtractVV(s,i.GetNormalVector()),s=t.MulFV(l.b2_toiSlop,s),s=t.AddVV(s,i.GetVertex1());var a=t.AddVV(e.GetDirectionVector(),i.GetDirectionVector());a.Normalize();var c=t.Dot(e.GetDirectionVector(),i.GetNormalVector())>0;return e.SetNextEdge(i,s,a,c),i.SetPrevEdge(e,s,a,c),o},g.prototype.CreateFixture=function(t){if(1==this.m_world.IsLocked())return null;var e=new k;if(e.Create(this,this.m_xf,t),this.m_flags&g.e_activeFlag){var i=this.m_world.m_contactManager.m_broadPhase;e.CreateProxy(i,this.m_xf)}return e.m_next=this.m_fixtureList,this.m_fixtureList=e,++this.m_fixtureCount,e.m_body=this,e.m_density>0&&this.ResetMassData(),this.m_world.m_flags|=T.e_newFixture,e},g.prototype.CreateFixture2=function(t,e){void 0===e&&(e=0);var i=new B;return i.shape=t,i.density=e,this.CreateFixture(i)},g.prototype.DestroyFixture=function(t){if(1!=this.m_world.IsLocked()){for(var e=this.m_fixtureList,i=null;null!=e;){if(e==t){i?i.m_next=t.m_next:this.m_fixtureList=t.m_next,!0;break}i=e,e=e.m_next}for(var n=this.m_contactList;n;){var o=n.contact;n=n.next;var r=o.GetFixtureA(),s=o.GetFixtureB();t!=r&&t!=s||this.m_world.m_contactManager.Destroy(o)}if(this.m_flags&g.e_activeFlag){var a=this.m_world.m_contactManager.m_broadPhase;t.DestroyProxy(a)}t.Destroy(),t.m_body=null,t.m_next=null,--this.m_fixtureCount,this.ResetMassData()}},g.prototype.SetPositionAndAngle=function(t,e){void 0===e&&(e=0);var i;if(1!=this.m_world.IsLocked()){this.m_xf.R.Set(e),this.m_xf.position.SetV(t);var n=this.m_xf.R,o=this.m_sweep.localCenter;this.m_sweep.c.x=n.col1.x*o.x+n.col2.x*o.y,this.m_sweep.c.y=n.col1.y*o.x+n.col2.y*o.y,this.m_sweep.c.x+=this.m_xf.position.x,this.m_sweep.c.y+=this.m_xf.position.y,this.m_sweep.c0.SetV(this.m_sweep.c),this.m_sweep.a0=this.m_sweep.a=e;var r=this.m_world.m_contactManager.m_broadPhase;for(i=this.m_fixtureList;i;i=i.m_next)i.Synchronize(r,this.m_xf,this.m_xf);this.m_world.m_contactManager.FindNewContacts()}},g.prototype.SetTransform=function(t){this.SetPositionAndAngle(t.position,t.GetAngle())},g.prototype.GetTransform=function(){return this.m_xf},g.prototype.GetPosition=function(){return this.m_xf.position},g.prototype.SetPosition=function(t){this.SetPositionAndAngle(t,this.GetAngle())},g.prototype.GetAngle=function(){return this.m_sweep.a},g.prototype.SetAngle=function(t){void 0===t&&(t=0),this.SetPositionAndAngle(this.GetPosition(),t)},g.prototype.GetWorldCenter=function(){return this.m_sweep.c},g.prototype.GetLocalCenter=function(){return this.m_sweep.localCenter},g.prototype.SetLinearVelocity=function(t){this.m_type!=g.b2_staticBody&&this.m_linearVelocity.SetV(t)},g.prototype.GetLinearVelocity=function(){return this.m_linearVelocity},g.prototype.SetAngularVelocity=function(t){void 0===t&&(t=0),this.m_type!=g.b2_staticBody&&(this.m_angularVelocity=t)},g.prototype.GetAngularVelocity=function(){return this.m_angularVelocity},g.prototype.GetDefinition=function(){var t=new x;return t.type=this.GetType(),t.allowSleep=(this.m_flags&g.e_allowSleepFlag)==g.e_allowSleepFlag,t.angle=this.GetAngle(),t.angularDamping=this.m_angularDamping,t.angularVelocity=this.m_angularVelocity,t.fixedRotation=(this.m_flags&g.e_fixedRotationFlag)==g.e_fixedRotationFlag,t.bullet=(this.m_flags&g.e_bulletFlag)==g.e_bulletFlag,t.awake=(this.m_flags&g.e_awakeFlag)==g.e_awakeFlag,t.linearDamping=this.m_linearDamping,t.linearVelocity.SetV(this.GetLinearVelocity()),t.position=this.GetPosition(),t.userData=this.GetUserData(),t},g.prototype.ApplyForce=function(t,e){this.m_type==g.b2_dynamicBody&&(0==this.IsAwake()&&this.SetAwake(!0),this.m_force.x+=t.x,this.m_force.y+=t.y,this.m_torque+=(e.x-this.m_sweep.c.x)*t.y-(e.y-this.m_sweep.c.y)*t.x)},g.prototype.ApplyTorque=function(t){void 0===t&&(t=0),this.m_type==g.b2_dynamicBody&&(0==this.IsAwake()&&this.SetAwake(!0),this.m_torque+=t)},g.prototype.ApplyImpulse=function(t,e){this.m_type==g.b2_dynamicBody&&(0==this.IsAwake()&&this.SetAwake(!0),this.m_linearVelocity.x+=this.m_invMass*t.x,this.m_linearVelocity.y+=this.m_invMass*t.y,this.m_angularVelocity+=this.m_invI*((e.x-this.m_sweep.c.x)*t.y-(e.y-this.m_sweep.c.y)*t.x))},g.prototype.Split=function(e){for(var i,n=this.GetLinearVelocity().Copy(),o=this.GetAngularVelocity(),r=this.GetWorldCenter(),s=this,a=this.m_world.CreateBody(this.GetDefinition()),l=s.m_fixtureList;l;)if(e(l)){var c=l.m_next;i?i.m_next=c:s.m_fixtureList=c,s.m_fixtureCount--,l.m_next=a.m_fixtureList,a.m_fixtureList=l,a.m_fixtureCount++,l.m_body=a,l=c}else i=l,l=l.m_next;s.ResetMassData(),a.ResetMassData();var u=s.GetWorldCenter(),h=a.GetWorldCenter(),m=t.AddVV(n,t.CrossFV(o,t.SubtractVV(u,r))),p=t.AddVV(n,t.CrossFV(o,t.SubtractVV(h,r)));return s.SetLinearVelocity(m),a.SetLinearVelocity(p),s.SetAngularVelocity(o),a.SetAngularVelocity(o),s.SynchronizeFixtures(),a.SynchronizeFixtures(),a},g.prototype.Merge=function(t){var e;for(e=t.m_fixtureList;e;){var i=e.m_next;t.m_fixtureCount--,e.m_next=this.m_fixtureList,this.m_fixtureList=e,this.m_fixtureCount++,e.m_body=o,e=i}n.m_fixtureCount=0;var n=this,o=t;n.GetWorldCenter(),o.GetWorldCenter(),n.GetLinearVelocity().Copy(),o.GetLinearVelocity().Copy(),n.GetAngularVelocity(),o.GetAngularVelocity();n.ResetMassData(),this.SynchronizeFixtures()},g.prototype.GetMass=function(){return this.m_mass},g.prototype.GetInertia=function(){return this.m_I},g.prototype.GetMassData=function(t){t.mass=this.m_mass,t.I=this.m_I,t.center.SetV(this.m_sweep.localCenter)},g.prototype.SetMassData=function(e){if(l.b2Assert(0==this.m_world.IsLocked()),1!=this.m_world.IsLocked()&&this.m_type==g.b2_dynamicBody){this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_mass=e.mass,this.m_mass<=0&&(this.m_mass=1),this.m_invMass=1/this.m_mass,e.I>0&&0==(this.m_flags&g.e_fixedRotationFlag)&&(this.m_I=e.I-this.m_mass*(e.center.x*e.center.x+e.center.y*e.center.y),this.m_invI=1/this.m_I);var i=this.m_sweep.c.Copy();this.m_sweep.localCenter.SetV(e.center),this.m_sweep.c0.SetV(t.MulX(this.m_xf,this.m_sweep.localCenter)),this.m_sweep.c.SetV(this.m_sweep.c0),this.m_linearVelocity.x+=this.m_angularVelocity*-(this.m_sweep.c.y-i.y),this.m_linearVelocity.y+=this.m_angularVelocity*+(this.m_sweep.c.x-i.x)}},g.prototype.ResetMassData=function(){if(this.m_mass=0,this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_sweep.localCenter.SetZero(),this.m_type!=g.b2_staticBody&&this.m_type!=g.b2_kinematicBody){for(var e=s.Make(0,0),i=this.m_fixtureList;i;i=i.m_next)if(0!=i.m_density){var n=i.GetMassData();this.m_mass+=n.mass,e.x+=n.center.x*n.mass,e.y+=n.center.y*n.mass,this.m_I+=n.I}this.m_mass>0?(this.m_invMass=1/this.m_mass,e.x*=this.m_invMass,e.y*=this.m_invMass):(this.m_mass=1,this.m_invMass=1),this.m_I>0&&0==(this.m_flags&g.e_fixedRotationFlag)?(this.m_I-=this.m_mass*(e.x*e.x+e.y*e.y),this.m_I*=this.m_inertiaScale,l.b2Assert(this.m_I>0),this.m_invI=1/this.m_I):(this.m_I=0,this.m_invI=0);var o=this.m_sweep.c.Copy();this.m_sweep.localCenter.SetV(e),this.m_sweep.c0.SetV(t.MulX(this.m_xf,this.m_sweep.localCenter)),this.m_sweep.c.SetV(this.m_sweep.c0),this.m_linearVelocity.x+=this.m_angularVelocity*-(this.m_sweep.c.y-o.y),this.m_linearVelocity.y+=this.m_angularVelocity*+(this.m_sweep.c.x-o.x)}},g.prototype.GetWorldPoint=function(t){var e=this.m_xf.R,i=new s(e.col1.x*t.x+e.col2.x*t.y,e.col1.y*t.x+e.col2.y*t.y);return i.x+=this.m_xf.position.x,i.y+=this.m_xf.position.y,i},g.prototype.GetWorldVector=function(e){return t.MulMV(this.m_xf.R,e)},g.prototype.GetLocalPoint=function(e){return t.MulXT(this.m_xf,e)},g.prototype.GetLocalVector=function(e){return t.MulTMV(this.m_xf.R,e)},g.prototype.GetLinearVelocityFromWorldPoint=function(t){return new s(this.m_linearVelocity.x-this.m_angularVelocity*(t.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(t.x-this.m_sweep.c.x))},g.prototype.GetLinearVelocityFromLocalPoint=function(t){var e=this.m_xf.R,i=new s(e.col1.x*t.x+e.col2.x*t.y,e.col1.y*t.x+e.col2.y*t.y);return i.x+=this.m_xf.position.x,i.y+=this.m_xf.position.y,new s(this.m_linearVelocity.x-this.m_angularVelocity*(i.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(i.x-this.m_sweep.c.x))},g.prototype.GetLinearDamping=function(){return this.m_linearDamping},g.prototype.SetLinearDamping=function(t){void 0===t&&(t=0),this.m_linearDamping=t},g.prototype.GetAngularDamping=function(){return this.m_angularDamping},g.prototype.SetAngularDamping=function(t){void 0===t&&(t=0),this.m_angularDamping=t},g.prototype.SetType=function(t){if(void 0===t&&(t=0),this.m_type!=t){this.m_type=t,this.ResetMassData(),this.m_type==g.b2_staticBody&&(this.m_linearVelocity.SetZero(),this.m_angularVelocity=0),this.SetAwake(!0),this.m_force.SetZero(),this.m_torque=0;for(var e=this.m_contactList;e;e=e.next)e.contact.FlagForFiltering()}},g.prototype.GetType=function(){return this.m_type},g.prototype.SetBullet=function(t){t?this.m_flags|=g.e_bulletFlag:this.m_flags&=~g.e_bulletFlag},g.prototype.IsBullet=function(){return(this.m_flags&g.e_bulletFlag)==g.e_bulletFlag},g.prototype.SetSleepingAllowed=function(t){t?this.m_flags|=g.e_allowSleepFlag:(this.m_flags&=~g.e_allowSleepFlag,this.SetAwake(!0))},g.prototype.SetAwake=function(t){t?(this.m_flags|=g.e_awakeFlag,this.m_sleepTime=0):(this.m_flags&=~g.e_awakeFlag,this.m_sleepTime=0,this.m_linearVelocity.SetZero(),this.m_angularVelocity=0,this.m_force.SetZero(),this.m_torque=0)},g.prototype.IsAwake=function(){return(this.m_flags&g.e_awakeFlag)==g.e_awakeFlag},g.prototype.SetFixedRotation=function(t){t?this.m_flags|=g.e_fixedRotationFlag:this.m_flags&=~g.e_fixedRotationFlag,this.ResetMassData()},g.prototype.IsFixedRotation=function(){return(this.m_flags&g.e_fixedRotationFlag)==g.e_fixedRotationFlag},g.prototype.SetActive=function(t){if(t!=this.IsActive()){var e,i;if(t)for(this.m_flags|=g.e_activeFlag,e=this.m_world.m_contactManager.m_broadPhase,i=this.m_fixtureList;i;i=i.m_next)i.CreateProxy(e,this.m_xf);else{for(this.m_flags&=~g.e_activeFlag,e=this.m_world.m_contactManager.m_broadPhase,i=this.m_fixtureList;i;i=i.m_next)i.DestroyProxy(e);for(var n=this.m_contactList;n;){var o=n;n=n.next,this.m_world.m_contactManager.Destroy(o.contact)}this.m_contactList=null}}},g.prototype.IsActive=function(){return(this.m_flags&g.e_activeFlag)==g.e_activeFlag},g.prototype.IsSleepingAllowed=function(){return(this.m_flags&g.e_allowSleepFlag)==g.e_allowSleepFlag},g.prototype.GetFixtureList=function(){return this.m_fixtureList},g.prototype.GetJointList=function(){return this.m_jointList},g.prototype.GetControllerList=function(){return this.m_controllerList},g.prototype.GetContactList=function(){return this.m_contactList},g.prototype.GetNext=function(){return this.m_next},g.prototype.GetUserData=function(){return this.m_userData},g.prototype.SetUserData=function(t){this.m_userData=t},g.prototype.GetWorld=function(){return this.m_world},g.prototype.b2Body=function(t,e){this.m_flags=0,t.bullet&&(this.m_flags|=g.e_bulletFlag),t.fixedRotation&&(this.m_flags|=g.e_fixedRotationFlag),t.allowSleep&&(this.m_flags|=g.e_allowSleepFlag),t.awake&&(this.m_flags|=g.e_awakeFlag),t.active&&(this.m_flags|=g.e_activeFlag),this.m_world=e,this.m_xf.position.SetV(t.position),this.m_xf.R.Set(t.angle),this.m_sweep.localCenter.SetZero(),this.m_sweep.t0=1,this.m_sweep.a0=this.m_sweep.a=t.angle;var i=this.m_xf.R,n=this.m_sweep.localCenter;this.m_sweep.c.x=i.col1.x*n.x+i.col2.x*n.y,this.m_sweep.c.y=i.col1.y*n.x+i.col2.y*n.y,this.m_sweep.c.x+=this.m_xf.position.x,this.m_sweep.c.y+=this.m_xf.position.y,this.m_sweep.c0.SetV(this.m_sweep.c),this.m_jointList=null,this.m_controllerList=null,this.m_contactList=null,this.m_controllerCount=0,this.m_prev=null,this.m_next=null,this.m_linearVelocity.SetV(t.linearVelocity),this.m_angularVelocity=t.angularVelocity,this.m_linearDamping=t.linearDamping,this.m_angularDamping=t.angularDamping,this.m_force.Set(0,0),this.m_torque=0,this.m_sleepTime=0,this.m_type=t.type,this.m_type==g.b2_dynamicBody?(this.m_mass=1,this.m_invMass=1):(this.m_mass=0,this.m_invMass=0),this.m_I=0,this.m_invI=0,this.m_inertiaScale=t.inertiaScale,this.m_userData=t.userData,this.m_fixtureList=null,this.m_fixtureCount=0},g.prototype.SynchronizeFixtures=function(){var t=g.s_xf1;t.R.Set(this.m_sweep.a0);var e=t.R,i=this.m_sweep.localCenter;t.position.x=this.m_sweep.c0.x-(e.col1.x*i.x+e.col2.x*i.y),t.position.y=this.m_sweep.c0.y-(e.col1.y*i.x+e.col2.y*i.y);var n,o=this.m_world.m_contactManager.m_broadPhase;for(n=this.m_fixtureList;n;n=n.m_next)n.Synchronize(o,t,this.m_xf)},g.prototype.SynchronizeTransform=function(){this.m_xf.R.Set(this.m_sweep.a);var t=this.m_xf.R,e=this.m_sweep.localCenter;this.m_xf.position.x=this.m_sweep.c.x-(t.col1.x*e.x+t.col2.x*e.y),this.m_xf.position.y=this.m_sweep.c.y-(t.col1.y*e.x+t.col2.y*e.y)},g.prototype.ShouldCollide=function(t){if(this.m_type!=g.b2_dynamicBody&&t.m_type!=g.b2_dynamicBody)return!1;for(var e=this.m_jointList;e;e=e.next)if(e.other==t&&0==e.joint.m_collideConnected)return!1;return!0},g.prototype.Advance=function(t){void 0===t&&(t=0),this.m_sweep.Advance(t),this.m_sweep.c.SetV(this.m_sweep.c0),this.m_sweep.a=this.m_sweep.a0,this.SynchronizeTransform()},n.postDefs.push(function(){n.Dynamics.b2Body.s_xf1=new i,n.Dynamics.b2Body.e_islandFlag=1,n.Dynamics.b2Body.e_awakeFlag=2,n.Dynamics.b2Body.e_allowSleepFlag=4,n.Dynamics.b2Body.e_bulletFlag=8,n.Dynamics.b2Body.e_fixedRotationFlag=16,n.Dynamics.b2Body.e_activeFlag=32,n.Dynamics.b2Body.b2_staticBody=0,n.Dynamics.b2Body.b2_kinematicBody=1,n.Dynamics.b2Body.b2_dynamicBody=2}),x.b2BodyDef=function(){this.position=new s,this.linearVelocity=new s},x.prototype.b2BodyDef=function(){this.userData=null,this.position.Set(0,0),this.angle=0,this.linearVelocity.Set(0,0),this.angularVelocity=0,this.linearDamping=0,this.angularDamping=0,this.allowSleep=!0,this.awake=!0,this.fixedRotation=!1,this.bullet=!1,this.type=g.b2_staticBody,this.active=!0,this.inertiaScale=1},b.b2ContactFilter=function(){},b.prototype.ShouldCollide=function(t,e){var i=t.GetFilterData(),n=e.GetFilterData();return i.groupIndex==n.groupIndex&&0!=i.groupIndex?i.groupIndex>0:0!=(i.maskBits&n.categoryBits)&&0!=(i.categoryBits&n.maskBits)},b.prototype.RayCollide=function(t,e){return!t||this.ShouldCollide(t instanceof k?t:null,e)},n.postDefs.push(function(){n.Dynamics.b2ContactFilter.b2_defaultFilter=new b}),C.b2ContactImpulse=function(){this.normalImpulses=new r(l.b2_maxManifoldPoints),this.tangentImpulses=new r(l.b2_maxManifoldPoints)},S.b2ContactListener=function(){},S.prototype.BeginContact=function(t){},S.prototype.EndContact=function(t){},S.prototype.PreSolve=function(t,e){},S.prototype.PostSolve=function(t,e){},n.postDefs.push(function(){n.Dynamics.b2ContactListener.b2_defaultListener=new S}),w.b2ContactManager=function(){},w.prototype.b2ContactManager=function(){this.m_world=null,this.m_contactCount=0,this.m_contactFilter=b.b2_defaultFilter,this.m_contactListener=S.b2_defaultListener,this.m_contactFactory=new V(this.m_allocator),this.m_broadPhase=new h},w.prototype.AddPair=function(t,e){var i=t instanceof k?t:null,n=e instanceof k?e:null,o=i.GetBody(),r=n.GetBody();if(o!=r){for(var s=r.GetContactList();s;){if(s.other==o){var a=s.contact.GetFixtureA(),l=s.contact.GetFixtureB();if(a==i&&l==n)return;if(a==n&&l==i)return}s=s.next}if(0!=r.ShouldCollide(o)&&0!=this.m_contactFilter.ShouldCollide(i,n)){var c=this.m_contactFactory.Create(i,n);i=c.GetFixtureA(),n=c.GetFixtureB(),o=i.m_body,r=n.m_body,c.m_prev=null,c.m_next=this.m_world.m_contactList,null!=this.m_world.m_contactList&&(this.m_world.m_contactList.m_prev=c),this.m_world.m_contactList=c,c.m_nodeA.contact=c,c.m_nodeA.other=r,c.m_nodeA.prev=null,c.m_nodeA.next=o.m_contactList,null!=o.m_contactList&&(o.m_contactList.prev=c.m_nodeA),o.m_contactList=c.m_nodeA,c.m_nodeB.contact=c,c.m_nodeB.other=o,c.m_nodeB.prev=null,c.m_nodeB.next=r.m_contactList,null!=r.m_contactList&&(r.m_contactList.prev=c.m_nodeB),r.m_contactList=c.m_nodeB,++this.m_world.m_contactCount}}},w.prototype.FindNewContacts=function(){this.m_broadPhase.UpdatePairs(n.generateCallback(this,this.AddPair))},w.prototype.Destroy=function(t){var e=t.GetFixtureA(),i=t.GetFixtureB(),n=e.GetBody(),o=i.GetBody();t.IsTouching()&&this.m_contactListener.EndContact(t),t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_world.m_contactList&&(this.m_world.m_contactList=t.m_next),t.m_nodeA.prev&&(t.m_nodeA.prev.next=t.m_nodeA.next),t.m_nodeA.next&&(t.m_nodeA.next.prev=t.m_nodeA.prev),t.m_nodeA==n.m_contactList&&(n.m_contactList=t.m_nodeA.next),t.m_nodeB.prev&&(t.m_nodeB.prev.next=t.m_nodeB.next),t.m_nodeB.next&&(t.m_nodeB.next.prev=t.m_nodeB.prev),t.m_nodeB==o.m_contactList&&(o.m_contactList=t.m_nodeB.next),this.m_contactFactory.Destroy(t),--this.m_contactCount},w.prototype.Collide=function(){for(var t=this.m_world.m_contactList;t;){var e=t.GetFixtureA(),i=t.GetFixtureB(),n=e.GetBody(),o=i.GetBody();if(0!=n.IsAwake()||0!=o.IsAwake()){if(t.m_flags&E.e_filterFlag){if(0==o.ShouldCollide(n)){var r=t;t=r.GetNext(),this.Destroy(r);continue}if(0==this.m_contactFilter.ShouldCollide(e,i)){r=t,t=r.GetNext(),this.Destroy(r);continue}t.m_flags&=~E.e_filterFlag}var s=e.m_proxy,a=i.m_proxy;0!=this.m_broadPhase.TestOverlap(s,a)?(t.Update(this.m_contactListener),t=t.GetNext()):(r=t,t=r.GetNext(),this.Destroy(r))}else t=t.GetNext()}},n.postDefs.push(function(){n.Dynamics.b2ContactManager.s_evalCP=new u}),A.b2DebugDraw=function(){},A.prototype.b2DebugDraw=function(){},A.prototype.SetFlags=function(t){void 0===t&&(t=0)},A.prototype.GetFlags=function(){},A.prototype.AppendFlags=function(t){void 0===t&&(t=0)},A.prototype.ClearFlags=function(t){void 0===t&&(t=0)},A.prototype.SetSprite=function(t){},A.prototype.GetSprite=function(){},A.prototype.SetDrawScale=function(t){void 0===t&&(t=0)},A.prototype.GetDrawScale=function(){},A.prototype.SetLineThickness=function(t){void 0===t&&(t=0)},A.prototype.GetLineThickness=function(){},A.prototype.SetAlpha=function(t){void 0===t&&(t=0)},A.prototype.GetAlpha=function(){},A.prototype.SetFillAlpha=function(t){void 0===t&&(t=0)},A.prototype.GetFillAlpha=function(){},A.prototype.SetXFormScale=function(t){void 0===t&&(t=0)},A.prototype.GetXFormScale=function(){},A.prototype.DrawPolygon=function(t,e,i){void 0===e&&(e=0)},A.prototype.DrawSolidPolygon=function(t,e,i){void 0===e&&(e=0)},A.prototype.DrawCircle=function(t,e,i){void 0===e&&(e=0)},A.prototype.DrawSolidCircle=function(t,e,i,n){void 0===e&&(e=0)},A.prototype.DrawSegment=function(t,e,i){},A.prototype.DrawTransform=function(t){},n.postDefs.push(function(){n.Dynamics.b2DebugDraw.e_shapeBit=1,n.Dynamics.b2DebugDraw.e_jointBit=2,n.Dynamics.b2DebugDraw.e_aabbBit=4,n.Dynamics.b2DebugDraw.e_pairBit=8,n.Dynamics.b2DebugDraw.e_centerOfMassBit=16,n.Dynamics.b2DebugDraw.e_controllerBit=32}),D.b2DestructionListener=function(){},D.prototype.SayGoodbyeJoint=function(t){},D.prototype.SayGoodbyeFixture=function(t){},M.b2FilterData=function(){this.categoryBits=1,this.maskBits=65535,this.groupIndex=0},M.prototype.Copy=function(){var t=new M;return t.categoryBits=this.categoryBits,t.maskBits=this.maskBits,t.groupIndex=this.groupIndex,t},k.b2Fixture=function(){this.m_filter=new M},k.prototype.GetType=function(){return this.m_shape.GetType()},k.prototype.GetShape=function(){return this.m_shape},k.prototype.SetSensor=function(t){if(this.m_isSensor!=t&&(this.m_isSensor=t,null!=this.m_body))for(var e=this.m_body.GetContactList();e;){var i=e.contact,n=i.GetFixtureA(),o=i.GetFixtureB();n!=this&&o!=this||i.SetSensor(n.IsSensor()||o.IsSensor()),e=e.next}},k.prototype.IsSensor=function(){return this.m_isSensor},k.prototype.SetFilterData=function(t){if(this.m_filter=t.Copy(),!this.m_body)for(var e=this.m_body.GetContactList();e;){var i=e.contact,n=i.GetFixtureA(),o=i.GetFixtureB();n!=this&&o!=this||i.FlagForFiltering(),e=e.next}},k.prototype.GetFilterData=function(){return this.m_filter.Copy()},k.prototype.GetBody=function(){return this.m_body},k.prototype.GetNext=function(){return this.m_next},k.prototype.GetUserData=function(){return this.m_userData},k.prototype.SetUserData=function(t){this.m_userData=t},k.prototype.TestPoint=function(t){return this.m_shape.TestPoint(this.m_body.GetTransform(),t)},k.prototype.RayCast=function(t,e){return this.m_shape.RayCast(t,e,this.m_body.GetTransform())},k.prototype.GetMassData=function(t){return void 0===t&&(t=null),null==t&&(t=new y),this.m_shape.ComputeMass(t,this.m_density),t},k.prototype.SetDensity=function(t){void 0===t&&(t=0),this.m_density=t},k.prototype.GetDensity=function(){return this.m_density},k.prototype.GetFriction=function(){return this.m_friction},k.prototype.SetFriction=function(t){void 0===t&&(t=0),this.m_friction=t},k.prototype.GetRestitution=function(){return this.m_restitution},k.prototype.SetRestitution=function(t){void 0===t&&(t=0),this.m_restitution=t},k.prototype.GetAABB=function(){return this.m_aabb},k.prototype.b2Fixture=function(){this.m_aabb=new c,this.m_userData=null,this.m_body=null,this.m_next=null,this.m_shape=null,this.m_density=0,this.m_friction=0,this.m_restitution=0},k.prototype.Create=function(t,e,i){this.m_userData=i.userData,this.m_friction=i.friction,this.m_restitution=i.restitution,this.m_body=t,this.m_next=null,this.m_filter=i.filter.Copy(),this.m_isSensor=i.isSensor,this.m_shape=i.shape.Copy(),this.m_density=i.density},k.prototype.Destroy=function(){this.m_shape=null},k.prototype.CreateProxy=function(t,e){this.m_shape.ComputeAABB(this.m_aabb,e),this.m_proxy=t.CreateProxy(this.m_aabb,this)},k.prototype.DestroyProxy=function(t){null!=this.m_proxy&&(t.DestroyProxy(this.m_proxy),this.m_proxy=null)},k.prototype.Synchronize=function(e,i,n){if(this.m_proxy){var o=new c,r=new c;this.m_shape.ComputeAABB(o,i),this.m_shape.ComputeAABB(r,n),this.m_aabb.Combine(o,r);var s=t.SubtractVV(n.position,i.position);e.MoveProxy(this.m_proxy,this.m_aabb,s)}},B.b2FixtureDef=function(){this.filter=new M},B.prototype.b2FixtureDef=function(){this.shape=null,this.userData=null,this.friction=.2,this.restitution=0,this.density=0,this.filter.categoryBits=1,this.filter.maskBits=65535,this.filter.groupIndex=0,this.isSensor=!1},I.b2Island=function(){},I.prototype.b2Island=function(){this.m_bodies=new o,this.m_contacts=new o,this.m_joints=new o},I.prototype.Initialize=function(t,e,i,n,o,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0);var s=0;for(this.m_bodyCapacity=t,this.m_contactCapacity=e,this.m_jointCapacity=i,this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0,this.m_allocator=n,this.m_listener=o,this.m_contactSolver=r,s=this.m_bodies.length;s<t;s++)this.m_bodies[s]=null;for(s=this.m_contacts.length;s<e;s++)this.m_contacts[s]=null;for(s=this.m_joints.length;s<i;s++)this.m_joints[s]=null},I.prototype.Clear=function(){this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0},I.prototype.Solve=function(e,i,n){var o,r,s=0,a=0;for(s=0;s<this.m_bodyCount;++s)o=this.m_bodies[s],o.GetType()==g.b2_dynamicBody&&(o.m_linearVelocity.x+=e.dt*(i.x+o.m_invMass*o.m_force.x),o.m_linearVelocity.y+=e.dt*(i.y+o.m_invMass*o.m_force.y),o.m_angularVelocity+=e.dt*o.m_invI*o.m_torque,o.m_linearVelocity.Multiply(t.Clamp(1-e.dt*o.m_linearDamping,0,1)),o.m_angularVelocity*=t.Clamp(1-e.dt*o.m_angularDamping,0,1));this.m_contactSolver.Initialize(e,this.m_contacts,this.m_contactCount,this.m_allocator);var c=this.m_contactSolver;for(c.InitVelocityConstraints(e),s=0;s<this.m_jointCount;++s)r=this.m_joints[s],r.InitVelocityConstraints(e);for(s=0;s<e.velocityIterations;++s){for(a=0;a<this.m_jointCount;++a)r=this.m_joints[a],r.SolveVelocityConstraints(e);c.SolveVelocityConstraints()}for(s=0;s<this.m_jointCount;++s)r=this.m_joints[s],r.FinalizeVelocityConstraints();for(c.FinalizeVelocityConstraints(),s=0;s<this.m_bodyCount;++s)if(o=this.m_bodies[s],o.GetType()!=g.b2_staticBody){var u=e.dt*o.m_linearVelocity.x,h=e.dt*o.m_linearVelocity.y;u*u+h*h>l.b2_maxTranslationSquared&&(o.m_linearVelocity.Normalize(),o.m_linearVelocity.x*=l.b2_maxTranslation*e.inv_dt,o.m_linearVelocity.y*=l.b2_maxTranslation*e.inv_dt);var m=e.dt*o.m_angularVelocity;m*m>l.b2_maxRotationSquared&&(o.m_angularVelocity<0?o.m_angularVelocity=-l.b2_maxRotation*e.inv_dt:o.m_angularVelocity=l.b2_maxRotation*e.inv_dt),o.m_sweep.c0.SetV(o.m_sweep.c),o.m_sweep.a0=o.m_sweep.a,o.m_sweep.c.x+=e.dt*o.m_linearVelocity.x,o.m_sweep.c.y+=e.dt*o.m_linearVelocity.y,o.m_sweep.a+=e.dt*o.m_angularVelocity,o.SynchronizeTransform()}for(s=0;s<e.positionIterations;++s){var p=c.SolvePositionConstraints(l.b2_contactBaumgarte),f=!0;for(a=0;a<this.m_jointCount;++a){r=this.m_joints[a];var _=r.SolvePositionConstraints(l.b2_contactBaumgarte);f=f&&_}if(p&&f)break}if(this.Report(c.m_constraints),n){var y=Number.MAX_VALUE,d=l.b2_linearSleepTolerance*l.b2_linearSleepTolerance,v=l.b2_angularSleepTolerance*l.b2_angularSleepTolerance;for(s=0;s<this.m_bodyCount;++s)o=this.m_bodies[s],o.GetType()!=g.b2_staticBody&&(0==(o.m_flags&g.e_allowSleepFlag)&&(o.m_sleepTime=0,y=0),0==(o.m_flags&g.e_allowSleepFlag)||o.m_angularVelocity*o.m_angularVelocity>v||t.Dot(o.m_linearVelocity,o.m_linearVelocity)>d?(o.m_sleepTime=0,y=0):(o.m_sleepTime+=e.dt,y=t.Min(y,o.m_sleepTime)));if(y>=l.b2_timeToSleep)for(s=0;s<this.m_bodyCount;++s)o=this.m_bodies[s],o.SetAwake(!1)}},I.prototype.SolveTOI=function(t){var e=0,i=0;this.m_contactSolver.Initialize(t,this.m_contacts,this.m_contactCount,this.m_allocator);var n=this.m_contactSolver;for(e=0;e<this.m_jointCount;++e)this.m_joints[e].InitVelocityConstraints(t);for(e=0;e<t.velocityIterations;++e)for(n.SolveVelocityConstraints(),i=0;i<this.m_jointCount;++i)this.m_joints[i].SolveVelocityConstraints(t);for(e=0;e<this.m_bodyCount;++e){var o=this.m_bodies[e];if(o.GetType()!=g.b2_staticBody){var r=t.dt*o.m_linearVelocity.x,s=t.dt*o.m_linearVelocity.y;r*r+s*s>l.b2_maxTranslationSquared&&(o.m_linearVelocity.Normalize(),o.m_linearVelocity.x*=l.b2_maxTranslation*t.inv_dt,o.m_linearVelocity.y*=l.b2_maxTranslation*t.inv_dt);var a=t.dt*o.m_angularVelocity;a*a>l.b2_maxRotationSquared&&(o.m_angularVelocity<0?o.m_angularVelocity=-l.b2_maxRotation*t.inv_dt:o.m_angularVelocity=l.b2_maxRotation*t.inv_dt),o.m_sweep.c0.SetV(o.m_sweep.c),o.m_sweep.a0=o.m_sweep.a,o.m_sweep.c.x+=t.dt*o.m_linearVelocity.x,o.m_sweep.c.y+=t.dt*o.m_linearVelocity.y,o.m_sweep.a+=t.dt*o.m_angularVelocity,o.SynchronizeTransform()}}for(e=0;e<t.positionIterations;++e){var c=n.SolvePositionConstraints(.75),u=!0;for(i=0;i<this.m_jointCount;++i){var h=this.m_joints[i].SolvePositionConstraints(l.b2_contactBaumgarte);u=u&&h}if(c&&u)break}this.Report(n.m_constraints)},I.prototype.Report=function(t){if(null!=this.m_listener)for(var e=0;e<this.m_contactCount;++e){for(var i=this.m_contacts[e],n=t[e],o=0;o<n.pointCount;++o)I.s_impulse.normalImpulses[o]=n.points[o].normalImpulse,I.s_impulse.tangentImpulses[o]=n.points[o].tangentImpulse;this.m_listener.PostSolve(i,I.s_impulse)}},I.prototype.AddBody=function(t){t.m_islandIndex=this.m_bodyCount,this.m_bodies[this.m_bodyCount++]=t},I.prototype.AddContact=function(t){this.m_contacts[this.m_contactCount++]=t},I.prototype.AddJoint=function(t){this.m_joints[this.m_jointCount++]=t},n.postDefs.push(function(){n.Dynamics.b2Island.s_impulse=new C}),P.b2TimeStep=function(){},P.prototype.Set=function(t){this.dt=t.dt,this.inv_dt=t.inv_dt,this.positionIterations=t.positionIterations,this.velocityIterations=t.velocityIterations,this.warmStarting=t.warmStarting},T.b2World=function(){this.s_stack=new o,this.m_contactManager=new w,this.m_contactSolver=new L,this.m_island=new I},T.prototype.b2World=function(t,e){this.m_destructionListener=null,this.m_debugDraw=null,this.m_bodyList=null,this.m_contactList=null,this.m_jointList=null,this.m_controllerList=null,this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0,this.m_controllerCount=0,T.m_warmStarting=!0,T.m_continuousPhysics=!0,this.m_allowSleep=e,this.m_gravity=t,this.m_inv_dt0=0,this.m_contactManager.m_world=this;var i=new x;this.m_groundBody=this.CreateBody(i)},T.prototype.SetDestructionListener=function(t){this.m_destructionListener=t},T.prototype.SetContactFilter=function(t){this.m_contactManager.m_contactFilter=t},T.prototype.SetContactListener=function(t){this.m_contactManager.m_contactListener=t},T.prototype.SetDebugDraw=function(t){this.m_debugDraw=t},T.prototype.SetBroadPhase=function(t){var e=this.m_contactManager.m_broadPhase;this.m_contactManager.m_broadPhase=t;for(var i=this.m_bodyList;i;i=i.m_next)for(var n=i.m_fixtureList;n;n=n.m_next)n.m_proxy=t.CreateProxy(e.GetFatAABB(n.m_proxy),n)},T.prototype.Validate=function(){this.m_contactManager.m_broadPhase.Validate()},T.prototype.GetProxyCount=function(){return this.m_contactManager.m_broadPhase.GetProxyCount()},T.prototype.CreateBody=function(t){if(1==this.IsLocked())return null;var e=new g(t,this);return e.m_prev=null,e.m_next=this.m_bodyList,this.m_bodyList&&(this.m_bodyList.m_prev=e),this.m_bodyList=e,++this.m_bodyCount,e},T.prototype.DestroyBody=function(t){if(1!=this.IsLocked()){for(var e=t.m_jointList;e;){var i=e;e=e.next,this.m_destructionListener&&this.m_destructionListener.SayGoodbyeJoint(i.joint),this.DestroyJoint(i.joint)}for(var n=t.m_controllerList;n;){var o=n;n=n.nextController,o.controller.RemoveBody(t)}for(var r=t.m_contactList;r;){var s=r;r=r.next,this.m_contactManager.Destroy(s.contact)}t.m_contactList=null;for(var a=t.m_fixtureList;a;){var l=a;a=a.m_next,this.m_destructionListener&&this.m_destructionListener.SayGoodbyeFixture(l),l.DestroyProxy(this.m_contactManager.m_broadPhase),l.Destroy()}t.m_fixtureList=null,t.m_fixtureCount=0,t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_bodyList&&(this.m_bodyList=t.m_next),--this.m_bodyCount}},T.prototype.CreateJoint=function(t){var e=R.Create(t,null);e.m_prev=null,e.m_next=this.m_jointList,this.m_jointList&&(this.m_jointList.m_prev=e),this.m_jointList=e,++this.m_jointCount,e.m_edgeA.joint=e,e.m_edgeA.other=e.m_bodyB,e.m_edgeA.prev=null,e.m_edgeA.next=e.m_bodyA.m_jointList,e.m_bodyA.m_jointList&&(e.m_bodyA.m_jointList.prev=e.m_edgeA),e.m_bodyA.m_jointList=e.m_edgeA,e.m_edgeB.joint=e,e.m_edgeB.other=e.m_bodyA,e.m_edgeB.prev=null,e.m_edgeB.next=e.m_bodyB.m_jointList,e.m_bodyB.m_jointList&&(e.m_bodyB.m_jointList.prev=e.m_edgeB),e.m_bodyB.m_jointList=e.m_edgeB;var i=t.bodyA,n=t.bodyB;if(0==t.collideConnected)for(var o=n.GetContactList();o;)o.other==i&&o.contact.FlagForFiltering(),o=o.next;return e},T.prototype.DestroyJoint=function(t){var e=t.m_collideConnected;t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_jointList&&(this.m_jointList=t.m_next);var i=t.m_bodyA,n=t.m_bodyB;if(i.SetAwake(!0),n.SetAwake(!0),t.m_edgeA.prev&&(t.m_edgeA.prev.next=t.m_edgeA.next),t.m_edgeA.next&&(t.m_edgeA.next.prev=t.m_edgeA.prev),t.m_edgeA==i.m_jointList&&(i.m_jointList=t.m_edgeA.next),t.m_edgeA.prev=null,t.m_edgeA.next=null,t.m_edgeB.prev&&(t.m_edgeB.prev.next=t.m_edgeB.next),t.m_edgeB.next&&(t.m_edgeB.next.prev=t.m_edgeB.prev),t.m_edgeB==n.m_jointList&&(n.m_jointList=t.m_edgeB.next),t.m_edgeB.prev=null,t.m_edgeB.next=null,R.Destroy(t,null),--this.m_jointCount,0==e)for(var o=n.GetContactList();o;)o.other==i&&o.contact.FlagForFiltering(),o=o.next},T.prototype.AddController=function(t){return t.m_next=this.m_controllerList,t.m_prev=null,this.m_controllerList=t,t.m_world=this,this.m_controllerCount++,t},T.prototype.RemoveController=function(t){t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),this.m_controllerList==t&&(this.m_controllerList=t.m_next),this.m_controllerCount--},T.prototype.CreateController=function(t){if(t.m_world!=this)throw new Error("Controller can only be a member of one world");return t.m_next=this.m_controllerList,t.m_prev=null,this.m_controllerList&&(this.m_controllerList.m_prev=t),this.m_controllerList=t,++this.m_controllerCount,t.m_world=this,t},T.prototype.DestroyController=function(t){t.Clear(),t.m_next&&(t.m_next.m_prev=t.m_prev),t.m_prev&&(t.m_prev.m_next=t.m_next),t==this.m_controllerList&&(this.m_controllerList=t.m_next),--this.m_controllerCount},T.prototype.SetWarmStarting=function(t){T.m_warmStarting=t},T.prototype.SetContinuousPhysics=function(t){T.m_continuousPhysics=t},T.prototype.GetBodyCount=function(){return this.m_bodyCount},T.prototype.GetJointCount=function(){return this.m_jointCount},T.prototype.GetContactCount=function(){return this.m_contactCount},T.prototype.SetGravity=function(t){this.m_gravity=t},T.prototype.GetGravity=function(){return this.m_gravity},T.prototype.GetGroundBody=function(){return this.m_groundBody},T.prototype.Step=function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.m_flags&T.e_newFixture&&(this.m_contactManager.FindNewContacts(),this.m_flags&=~T.e_newFixture),this.m_flags|=T.e_locked;var n=T.s_timestep2;n.dt=t,n.velocityIterations=e,n.positionIterations=i,n.inv_dt=t>0?1/t:0,n.dtRatio=this.m_inv_dt0*t,n.warmStarting=T.m_warmStarting,this.m_contactManager.Collide(),n.dt>0&&this.Solve(n),T.m_continuousPhysics&&n.dt>0&&this.SolveTOI(n),n.dt>0&&(this.m_inv_dt0=n.inv_dt),this.m_flags&=~T.e_locked},T.prototype.ClearForces=function(){for(var t=this.m_bodyList;t;t=t.m_next)t.m_force.SetZero(),t.m_torque=0},T.prototype.DrawDebugData=function(){if(null!=this.m_debugDraw){this.m_debugDraw.m_sprite.graphics.clear();var t,e,i,n,o,r,l=this.m_debugDraw.GetFlags(),u=(new s,new s,new s,new c,new c,[new s,new s,new s,new s]),h=new a(0,0,0);if(l&A.e_shapeBit)for(t=this.m_bodyList;t;t=t.m_next)for(r=t.m_xf,e=t.GetFixtureList();e;e=e.m_next)i=e.GetShape(),0==t.IsActive()?(h.Set(.5,.5,.3),this.DrawShape(i,r,h)):t.GetType()==g.b2_staticBody?(h.Set(.5,.9,.5),this.DrawShape(i,r,h)):t.GetType()==g.b2_kinematicBody?(h.Set(.5,.5,.9),this.DrawShape(i,r,h)):0==t.IsAwake()?(h.Set(.6,.6,.6),this.DrawShape(i,r,h)):(h.Set(.9,.7,.7),this.DrawShape(i,r,h));if(l&A.e_jointBit)for(n=this.m_jointList;n;n=n.m_next)this.DrawJoint(n);if(l&A.e_controllerBit)for(var m=this.m_controllerList;m;m=m.m_next)m.Draw(this.m_debugDraw);if(l&A.e_pairBit){h.Set(.3,.9,.9);for(var p=this.m_contactManager.m_contactList;p;p=p.GetNext()){var f=p.GetFixtureA(),_=p.GetFixtureB(),y=f.GetAABB().GetCenter(),d=_.GetAABB().GetCenter();this.m_debugDraw.DrawSegment(y,d,h)}}if(l&A.e_aabbBit)for(o=this.m_contactManager.m_broadPhase,u=[new s,new s,new s,new s],t=this.m_bodyList;t;t=t.GetNext())if(0!=t.IsActive())for(e=t.GetFixtureList();e;e=e.GetNext()){var v=o.GetFatAABB(e.m_proxy);u[0].Set(v.lowerBound.x,v.lowerBound.y),u[1].Set(v.upperBound.x,v.lowerBound.y),u[2].Set(v.upperBound.x,v.upperBound.y),u[3].Set(v.lowerBound.x,v.upperBound.y),this.m_debugDraw.DrawPolygon(u,4,h)}if(l&A.e_centerOfMassBit)for(t=this.m_bodyList;t;t=t.m_next)r=T.s_xf,r.R=t.m_xf.R,r.position=t.GetWorldCenter(),this.m_debugDraw.DrawTransform(r)}},T.prototype.QueryAABB=function(t,e){function i(e){return t(o.GetUserData(e))}var n=this,o=n.m_contactManager.m_broadPhase;o.Query(i,e)},T.prototype.QueryShape=function(t,e,n){function o(i){var o=s.GetUserData(i)instanceof k?s.GetUserData(i):null;return!v.TestOverlap(e,n,o.GetShape(),o.GetBody().GetTransform())||t(o)}var r=this;void 0===n&&(n=null),null==n&&(n=new i,n.SetIdentity());var s=r.m_contactManager.m_broadPhase,a=new c;e.ComputeAABB(a,n),s.Query(o,a)},T.prototype.QueryPoint=function(t,e){function i(i){var n=o.GetUserData(i)instanceof k?o.GetUserData(i):null;return!n.TestPoint(e)||t(n)}var n=this,o=n.m_contactManager.m_broadPhase,r=new c;r.lowerBound.Set(e.x-l.b2_linearSlop,e.y-l.b2_linearSlop),r.upperBound.Set(e.x+l.b2_linearSlop,e.y+l.b2_linearSlop),o.Query(i,r)},T.prototype.RayCast=function(t,e,i){function n(n,o){var l=r.GetUserData(o),c=l instanceof k?l:null;if(c.RayCast(a,n)){var u=a.fraction,h=new s((1-u)*e.x+u*i.x,(1-u)*e.y+u*i.y);return t(c,h,a.normal,u)}return n.maxFraction}var o=this,r=o.m_contactManager.m_broadPhase,a=new p,l=new m(e,i);r.RayCast(n,l)},T.prototype.RayCastOne=function(t,e){function i(t,e,i,o){return void 0===o&&(o=0),n=t,o}var n,o=this;return o.RayCast(i,t,e),n},T.prototype.RayCastAll=function(t,e){function i(t,e,i,n){return void 0===n&&(n=0),r[r.length]=t,1}var n=this,r=new o;return n.RayCast(i,t,e),r},T.prototype.GetBodyList=function(){return this.m_bodyList},T.prototype.GetJointList=function(){return this.m_jointList},T.prototype.GetContactList=function(){return this.m_contactList},T.prototype.IsLocked=function(){return(this.m_flags&T.e_locked)>0},T.prototype.Solve=function(t){for(var e,i=this.m_controllerList;i;i=i.m_next)i.Step(t);var n=this.m_island;for(n.Initialize(this.m_bodyCount,this.m_contactCount,this.m_jointCount,null,this.m_contactManager.m_contactListener,this.m_contactSolver),e=this.m_bodyList;e;e=e.m_next)e.m_flags&=~g.e_islandFlag;for(var o=this.m_contactList;o;o=o.m_next)o.m_flags&=~E.e_islandFlag;for(var r=this.m_jointList;r;r=r.m_next)r.m_islandFlag=!1;for(var s=(parseInt(this.m_bodyCount),this.s_stack),a=this.m_bodyList;a;a=a.m_next)if(!(a.m_flags&g.e_islandFlag)&&0!=a.IsAwake()&&0!=a.IsActive()&&a.GetType()!=g.b2_staticBody){n.Clear();var l=0;for(s[l++]=a,a.m_flags|=g.e_islandFlag;l>0;)if(e=s[--l],n.AddBody(e),0==e.IsAwake()&&e.SetAwake(!0),e.GetType()!=g.b2_staticBody){for(var c,u=e.m_contactList;u;u=u.next)u.contact.m_flags&E.e_islandFlag||1!=u.contact.IsSensor()&&0!=u.contact.IsEnabled()&&0!=u.contact.IsTouching()&&(n.AddContact(u.contact),u.contact.m_flags|=E.e_islandFlag,c=u.other,c.m_flags&g.e_islandFlag||(s[l++]=c,c.m_flags|=g.e_islandFlag));for(var h=e.m_jointList;h;h=h.next)1!=h.joint.m_islandFlag&&(c=h.other,0!=c.IsActive()&&(n.AddJoint(h.joint),h.joint.m_islandFlag=!0,c.m_flags&g.e_islandFlag||(s[l++]=c,c.m_flags|=g.e_islandFlag)))}n.Solve(t,this.m_gravity,this.m_allowSleep);for(var m=0;m<n.m_bodyCount;++m)e=n.m_bodies[m],e.GetType()==g.b2_staticBody&&(e.m_flags&=~g.e_islandFlag)}for(m=0;m<s.length&&s[m];++m)s[m]=null;for(e=this.m_bodyList;e;e=e.m_next)0!=e.IsAwake()&&0!=e.IsActive()&&e.GetType()!=g.b2_staticBody&&e.SynchronizeFixtures();this.m_contactManager.FindNewContacts()},T.prototype.SolveTOI=function(t){var e,i,n,o,r,s,a,c=this.m_island;c.Initialize(this.m_bodyCount,l.b2_maxTOIContactsPerIsland,l.b2_maxTOIJointsPerIsland,null,this.m_contactManager.m_contactListener,this.m_contactSolver);var u=T.s_queue;for(e=this.m_bodyList;e;e=e.m_next)e.m_flags&=~g.e_islandFlag,e.m_sweep.t0=0;var h;for(h=this.m_contactList;h;h=h.m_next)h.m_flags&=~(E.e_toiFlag|E.e_islandFlag);for(a=this.m_jointList;a;a=a.m_next)a.m_islandFlag=!1;for(;;){var m=null,p=1;for(h=this.m_contactList;h;h=h.m_next)if(1!=h.IsSensor()&&0!=h.IsEnabled()&&0!=h.IsContinuous()){var f=1;if(h.m_flags&E.e_toiFlag)f=h.m_toi;else{if(i=h.m_fixtureA,n=h.m_fixtureB,o=i.m_body,r=n.m_body,!(o.GetType()==g.b2_dynamicBody&&0!=o.IsAwake()||r.GetType()==g.b2_dynamicBody&&0!=r.IsAwake()))continue;var _=o.m_sweep.t0;o.m_sweep.t0<r.m_sweep.t0?(_=r.m_sweep.t0,o.m_sweep.Advance(_)):r.m_sweep.t0<o.m_sweep.t0&&(_=o.m_sweep.t0,r.m_sweep.Advance(_)),f=h.ComputeTOI(o.m_sweep,r.m_sweep),l.b2Assert(0<=f&&f<=1),f>0&&f<1&&(f=(1-f)*_+f)>1&&(f=1),h.m_toi=f,h.m_flags|=E.e_toiFlag}Number.MIN_VALUE<f&&f<p&&(m=h,p=f)}if(null==m||1-100*Number.MIN_VALUE<p)break;if(i=m.m_fixtureA,n=m.m_fixtureB,o=i.m_body,r=n.m_body,T.s_backupA.Set(o.m_sweep),T.s_backupB.Set(r.m_sweep),o.Advance(p),r.Advance(p),m.Update(this.m_contactManager.m_contactListener),m.m_flags&=~E.e_toiFlag,1!=m.IsSensor()&&0!=m.IsEnabled()){if(0!=m.IsTouching()){var y=o;y.GetType()!=g.b2_dynamicBody&&(y=r),c.Clear();var d=0,v=0;for(u[d+v++]=y,y.m_flags|=g.e_islandFlag;v>0;)if(e=u[d++],--v,c.AddBody(e),0==e.IsAwake()&&e.SetAwake(!0),e.GetType()==g.b2_dynamicBody){for(s=e.m_contactList;s&&c.m_contactCount!=c.m_contactCapacity;s=s.next)if(!(s.contact.m_flags&E.e_islandFlag)&&1!=s.contact.IsSensor()&&0!=s.contact.IsEnabled()&&0!=s.contact.IsTouching()){c.AddContact(s.contact),s.contact.m_flags|=E.e_islandFlag;var x=s.other;x.m_flags&g.e_islandFlag||(x.GetType()!=g.b2_staticBody&&(x.Advance(p),x.SetAwake(!0)),u[d+v]=x,++v,x.m_flags|=g.e_islandFlag)}for(var b=e.m_jointList;b;b=b.next)c.m_jointCount!=c.m_jointCapacity&&1!=b.joint.m_islandFlag&&(x=b.other,0!=x.IsActive()&&(c.AddJoint(b.joint),b.joint.m_islandFlag=!0,x.m_flags&g.e_islandFlag||(x.GetType()!=g.b2_staticBody&&(x.Advance(p),x.SetAwake(!0)),u[d+v]=x,++v,x.m_flags|=g.e_islandFlag)))}var C=T.s_timestep;C.warmStarting=!1,C.dt=(1-p)*t.dt,C.inv_dt=1/C.dt,C.dtRatio=0,C.velocityIterations=t.velocityIterations,C.positionIterations=t.positionIterations,c.SolveTOI(C);var S=0;for(S=0;S<c.m_bodyCount;++S)if(e=c.m_bodies[S],e.m_flags&=~g.e_islandFlag,0!=e.IsAwake()&&e.GetType()==g.b2_dynamicBody)for(e.SynchronizeFixtures(),s=e.m_contactList;s;s=s.next)s.contact.m_flags&=~E.e_toiFlag;for(S=0;S<c.m_contactCount;++S)h=c.m_contacts[S],h.m_flags&=~(E.e_toiFlag|E.e_islandFlag);for(S=0;S<c.m_jointCount;++S)a=c.m_joints[S],a.m_islandFlag=!1;this.m_contactManager.FindNewContacts()}}else o.m_sweep.Set(T.s_backupA),r.m_sweep.Set(T.s_backupB),o.SynchronizeTransform(),r.SynchronizeTransform()}},T.prototype.DrawJoint=function(t){var e=t.GetBodyA(),i=t.GetBodyB(),n=e.m_xf,o=i.m_xf,r=n.position,s=o.position,a=t.GetAnchorA(),l=t.GetAnchorB(),c=T.s_jointColor;switch(t.m_type){case R.e_distanceJoint:this.m_debugDraw.DrawSegment(a,l,c);break;case R.e_pulleyJoint:var u=t instanceof N?t:null,h=u.GetGroundAnchorA(),m=u.GetGroundAnchorB();this.m_debugDraw.DrawSegment(h,a,c),this.m_debugDraw.DrawSegment(m,l,c),this.m_debugDraw.DrawSegment(h,m,c);break;case R.e_mouseJoint:this.m_debugDraw.DrawSegment(a,l,c);break;default:e!=this.m_groundBody&&this.m_debugDraw.DrawSegment(r,a,c),this.m_debugDraw.DrawSegment(a,l,c),i!=this.m_groundBody&&this.m_debugDraw.DrawSegment(s,l,c)}},T.prototype.DrawShape=function(e,i,n){switch(e.m_type){case v.e_circleShape:var r=e instanceof f?e:null,s=t.MulX(i,r.m_p),a=r.m_radius,l=i.R.col1;this.m_debugDraw.DrawSolidCircle(s,a,l,n);break;case v.e_polygonShape:var c=0,u=e instanceof d?e:null,h=parseInt(u.GetVertexCount()),m=u.GetVertices(),p=new o(h);for(c=0;c<h;++c)p[c]=t.MulX(i,m[c]);this.m_debugDraw.DrawSolidPolygon(p,h,n);break;case v.e_edgeShape:var y=e instanceof _?e:null;this.m_debugDraw.DrawSegment(t.MulX(i,y.GetVertex1()),t.MulX(i,y.GetVertex2()),n)}},n.postDefs.push(function(){n.Dynamics.b2World.s_timestep2=new P,n.Dynamics.b2World.s_xf=new i,n.Dynamics.b2World.s_backupA=new e,n.Dynamics.b2World.s_backupB=new e,n.Dynamics.b2World.s_timestep=new P,n.Dynamics.b2World.s_queue=new o,n.Dynamics.b2World.s_jointColor=new a(.5,.8,.8),n.Dynamics.b2World.e_newFixture=1,n.Dynamics.b2World.e_locked=2})}(),function(){var t=n.Collision.Shapes.b2CircleShape,e=(n.Collision.Shapes.b2EdgeChainDef,n.Collision.Shapes.b2EdgeShape),i=(n.Collision.Shapes.b2MassData,n.Collision.Shapes.b2PolygonShape),s=n.Collision.Shapes.b2Shape,a=n.Dynamics.Contacts.b2CircleContact,l=n.Dynamics.Contacts.b2Contact,c=n.Dynamics.Contacts.b2ContactConstraint,u=n.Dynamics.Contacts.b2ContactConstraintPoint,h=n.Dynamics.Contacts.b2ContactEdge,m=n.Dynamics.Contacts.b2ContactFactory,p=n.Dynamics.Contacts.b2ContactRegister,f=n.Dynamics.Contacts.b2ContactResult,_=n.Dynamics.Contacts.b2ContactSolver,y=n.Dynamics.Contacts.b2EdgeAndCircleContact,d=n.Dynamics.Contacts.b2NullContact,v=n.Dynamics.Contacts.b2PolyAndCircleContact,g=n.Dynamics.Contacts.b2PolyAndEdgeContact,x=n.Dynamics.Contacts.b2PolygonContact,b=n.Dynamics.Contacts.b2PositionSolverManifold,C=n.Dynamics.b2Body,S=(n.Dynamics.b2BodyDef,n.Dynamics.b2ContactFilter,n.Dynamics.b2ContactImpulse,n.Dynamics.b2ContactListener,n.Dynamics.b2ContactManager,n.Dynamics.b2DebugDraw,n.Dynamics.b2DestructionListener,n.Dynamics.b2FilterData,n.Dynamics.b2Fixture,n.Dynamics.b2FixtureDef,n.Dynamics.b2Island,n.Dynamics.b2TimeStep),w=(n.Dynamics.b2World,n.Common.b2Color,n.Common.b2internal,n.Common.b2Settings),A=n.Common.Math.b2Mat22,D=(n.Common.Math.b2Mat33,n.Common.Math.b2Math),M=(n.Common.Math.b2Sweep,n.Common.Math.b2Transform,n.Common.Math.b2Vec2),k=(n.Common.Math.b2Vec3,n.Collision.b2AABB,n.Collision.b2Bound,n.Collision.b2BoundValues,n.Collision.b2Collision),B=n.Collision.b2ContactID,I=(n.Collision.b2ContactPoint,n.Collision.b2Distance,n.Collision.b2DistanceInput,n.Collision.b2DistanceOutput,n.Collision.b2DistanceProxy,n.Collision.b2DynamicTree,n.Collision.b2DynamicTreeBroadPhase,n.Collision.b2DynamicTreeNode,n.Collision.b2DynamicTreePair,n.Collision.b2Manifold),P=(n.Collision.b2ManifoldPoint,n.Collision.b2Point,n.Collision.b2RayCastInput,n.Collision.b2RayCastOutput,n.Collision.b2Segment,n.Collision.b2SeparationFunction,n.Collision.b2Simplex,n.Collision.b2SimplexCache,n.Collision.b2SimplexVertex,n.Collision.b2TimeOfImpact),T=n.Collision.b2TOIInput,E=n.Collision.b2WorldManifold;n.Collision.ClipVertex,n.Collision.Features,n.Collision.IBroadPhase;n.inherit(a,n.Dynamics.Contacts.b2Contact),a.prototype.__super=n.Dynamics.Contacts.b2Contact.prototype,a.b2CircleContact=function(){n.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)},a.Create=function(t){return new a},a.Destroy=function(t,e){},a.prototype.Reset=function(t,e){this.__super.Reset.call(this,t,e)},a.prototype.Evaluate=function(){var e=this.m_fixtureA.GetBody(),i=this.m_fixtureB.GetBody();k.CollideCircles(this.m_manifold,this.m_fixtureA.GetShape()instanceof t?this.m_fixtureA.GetShape():null,e.m_xf,this.m_fixtureB.GetShape()instanceof t?this.m_fixtureB.GetShape():null,i.m_xf)},l.b2Contact=function(){this.m_nodeA=new h,this.m_nodeB=new h,this.m_manifold=new I,this.m_oldManifold=new I},l.prototype.GetManifold=function(){return this.m_manifold},l.prototype.GetWorldManifold=function(t){var e=this.m_fixtureA.GetBody(),i=this.m_fixtureB.GetBody(),n=this.m_fixtureA.GetShape(),o=this.m_fixtureB.GetShape();t.Initialize(this.m_manifold,e.GetTransform(),n.m_radius,i.GetTransform(),o.m_radius)},l.prototype.IsTouching=function(){return(this.m_flags&l.e_touchingFlag)==l.e_touchingFlag},l.prototype.IsContinuous=function(){return(this.m_flags&l.e_continuousFlag)==l.e_continuousFlag},l.prototype.SetSensor=function(t){t?this.m_flags|=l.e_sensorFlag:this.m_flags&=~l.e_sensorFlag},l.prototype.IsSensor=function(){return(this.m_flags&l.e_sensorFlag)==l.e_sensorFlag},l.prototype.SetEnabled=function(t){t?this.m_flags|=l.e_enabledFlag:this.m_flags&=~l.e_enabledFlag},l.prototype.IsEnabled=function(){return(this.m_flags&l.e_enabledFlag)==l.e_enabledFlag},l.prototype.GetNext=function(){return this.m_next},l.prototype.GetFixtureA=function(){return this.m_fixtureA},l.prototype.GetFixtureB=function(){return this.m_fixtureB},l.prototype.FlagForFiltering=function(){this.m_flags|=l.e_filterFlag},l.prototype.b2Contact=function(){},l.prototype.Reset=function(t,e){if(void 0===t&&(t=null),void 0===e&&(e=null),this.m_flags=l.e_enabledFlag,!t||!e)return this.m_fixtureA=null,void(this.m_fixtureB=null);(t.IsSensor()||e.IsSensor())&&(this.m_flags|=l.e_sensorFlag);var i=t.GetBody(),n=e.GetBody();(i.GetType()!=C.b2_dynamicBody||i.IsBullet()||n.GetType()!=C.b2_dynamicBody||n.IsBullet())&&(this.m_flags|=l.e_continuousFlag),this.m_fixtureA=t,this.m_fixtureB=e,this.m_manifold.m_pointCount=0,this.m_prev=null,this.m_next=null,this.m_nodeA.contact=null,this.m_nodeA.prev=null,this.m_nodeA.next=null,this.m_nodeA.other=null,this.m_nodeB.contact=null,this.m_nodeB.prev=null,this.m_nodeB.next=null,this.m_nodeB.other=null},l.prototype.Update=function(t){var e=this.m_oldManifold;this.m_oldManifold=this.m_manifold,this.m_manifold=e,this.m_flags|=l.e_enabledFlag;var i=!1,n=(this.m_flags&l.e_touchingFlag)==l.e_touchingFlag,o=this.m_fixtureA.m_body,r=this.m_fixtureB.m_body,a=this.m_fixtureA.m_aabb.TestOverlap(this.m_fixtureB.m_aabb);if(this.m_flags&l.e_sensorFlag){if(a){var c=this.m_fixtureA.GetShape(),u=this.m_fixtureB.GetShape(),h=o.GetTransform(),m=r.GetTransform();i=s.TestOverlap(c,h,u,m)}this.m_manifold.m_pointCount=0}else{if(o.GetType()!=C.b2_dynamicBody||o.IsBullet()||r.GetType()!=C.b2_dynamicBody||r.IsBullet()?this.m_flags|=l.e_continuousFlag:this.m_flags&=~l.e_continuousFlag,a){this.Evaluate(),i=this.m_manifold.m_pointCount>0;for(var p=0;p<this.m_manifold.m_pointCount;++p){var f=this.m_manifold.m_points[p];f.m_normalImpulse=0,f.m_tangentImpulse=0;for(var _=f.m_id,y=0;y<this.m_oldManifold.m_pointCount;++y){var d=this.m_oldManifold.m_points[y];if(d.m_id.key==_.key){f.m_normalImpulse=d.m_normalImpulse,f.m_tangentImpulse=d.m_tangentImpulse;break}}}}else this.m_manifold.m_pointCount=0;i!=n&&(o.SetAwake(!0),r.SetAwake(!0))}i?this.m_flags|=l.e_touchingFlag:this.m_flags&=~l.e_touchingFlag,0==n&&1==i&&t.BeginContact(this),1==n&&0==i&&t.EndContact(this),0==(this.m_flags&l.e_sensorFlag)&&t.PreSolve(this,this.m_oldManifold)},l.prototype.Evaluate=function(){},l.prototype.ComputeTOI=function(t,e){return l.s_input.proxyA.Set(this.m_fixtureA.GetShape()),l.s_input.proxyB.Set(this.m_fixtureB.GetShape()),l.s_input.sweepA=t,l.s_input.sweepB=e,l.s_input.tolerance=w.b2_linearSlop,P.TimeOfImpact(l.s_input)},n.postDefs.push(function(){n.Dynamics.Contacts.b2Contact.e_sensorFlag=1,n.Dynamics.Contacts.b2Contact.e_continuousFlag=2,n.Dynamics.Contacts.b2Contact.e_islandFlag=4,n.Dynamics.Contacts.b2Contact.e_toiFlag=8,n.Dynamics.Contacts.b2Contact.e_touchingFlag=16,n.Dynamics.Contacts.b2Contact.e_enabledFlag=32,n.Dynamics.Contacts.b2Contact.e_filterFlag=64,n.Dynamics.Contacts.b2Contact.s_input=new T}),c.b2ContactConstraint=function(){this.localPlaneNormal=new M,this.localPoint=new M,this.normal=new M,this.normalMass=new A,this.K=new A},c.prototype.b2ContactConstraint=function(){this.points=new o(w.b2_maxManifoldPoints);for(var t=0;t<w.b2_maxManifoldPoints;t++)this.points[t]=new u},u.b2ContactConstraintPoint=function(){this.localPoint=new M,this.rA=new M,this.rB=new M},h.b2ContactEdge=function(){},m.b2ContactFactory=function(){},m.prototype.b2ContactFactory=function(t){this.m_allocator=t,this.InitializeRegisters()},m.prototype.AddType=function(t,e,i,n){void 0===i&&(i=0),void 0===n&&(n=0),this.m_registers[i][n].createFcn=t,this.m_registers[i][n].destroyFcn=e,this.m_registers[i][n].primary=!0,i!=n&&(this.m_registers[n][i].createFcn=t,this.m_registers[n][i].destroyFcn=e,this.m_registers[n][i].primary=!1)},m.prototype.InitializeRegisters=function(){this.m_registers=new o(s.e_shapeTypeCount);for(var t=0;t<s.e_shapeTypeCount;t++){this.m_registers[t]=new o(s.e_shapeTypeCount);for(var e=0;e<s.e_shapeTypeCount;e++)this.m_registers[t][e]=new p}this.AddType(a.Create,a.Destroy,s.e_circleShape,s.e_circleShape),this.AddType(v.Create,v.Destroy,s.e_polygonShape,s.e_circleShape),this.AddType(x.Create,x.Destroy,s.e_polygonShape,s.e_polygonShape),this.AddType(y.Create,y.Destroy,s.e_edgeShape,s.e_circleShape),this.AddType(g.Create,g.Destroy,s.e_polygonShape,s.e_edgeShape)},m.prototype.Create=function(t,e){var i,n=parseInt(t.GetType()),o=parseInt(e.GetType()),r=this.m_registers[n][o];if(r.pool)return i=r.pool,r.pool=i.m_next,r.poolCount--,i.Reset(t,e),i;var s=r.createFcn;return null!=s?r.primary?(i=s(this.m_allocator),i.Reset(t,e),i):(i=s(this.m_allocator),i.Reset(e,t),i):null},m.prototype.Destroy=function(t){t.m_manifold.m_pointCount>0&&(t.m_fixtureA.m_body.SetAwake(!0),t.m_fixtureB.m_body.SetAwake(!0));var e=parseInt(t.m_fixtureA.GetType()),i=parseInt(t.m_fixtureB.GetType()),n=this.m_registers[e][i];n.poolCount++,t.m_next=n.pool,n.pool=t,(0,n.destroyFcn)(t,this.m_allocator)},p.b2ContactRegister=function(){},f.b2ContactResult=function(){this.position=new M,this.normal=new M,this.id=new B},_.b2ContactSolver=function(){this.m_step=new S,this.m_constraints=new o},_.prototype.b2ContactSolver=function(){},_.prototype.Initialize=function(t,e,i,n){void 0===i&&(i=0);var o;this.m_step.Set(t),this.m_allocator=n;var r=0;for(this.m_constraintCount=i;this.m_constraints.length<this.m_constraintCount;)this.m_constraints[this.m_constraints.length]=new c;for(r=0;r<i;++r){o=e[r];var s=o.m_fixtureA,a=o.m_fixtureB,l=s.m_shape,u=a.m_shape,h=l.m_radius,m=u.m_radius,p=s.m_body,f=a.m_body,y=o.GetManifold(),d=w.b2MixFriction(s.GetFriction(),a.GetFriction()),v=w.b2MixRestitution(s.GetRestitution(),a.GetRestitution()),g=p.m_linearVelocity.x,x=p.m_linearVelocity.y,b=f.m_linearVelocity.x,C=f.m_linearVelocity.y,S=p.m_angularVelocity,A=f.m_angularVelocity;w.b2Assert(y.m_pointCount>0),_.s_worldManifold.Initialize(y,p.m_xf,h,f.m_xf,m);var D=_.s_worldManifold.m_normal.x,M=_.s_worldManifold.m_normal.y,k=this.m_constraints[r];k.bodyA=p,k.bodyB=f,k.manifold=y,k.normal.x=D,k.normal.y=M,k.pointCount=y.m_pointCount,k.friction=d,k.restitution=v,k.localPlaneNormal.x=y.m_localPlaneNormal.x,k.localPlaneNormal.y=y.m_localPlaneNormal.y,k.localPoint.x=y.m_localPoint.x,k.localPoint.y=y.m_localPoint.y,k.radius=h+m,k.type=y.m_type;for(var B=0;B<k.pointCount;++B){var I=y.m_points[B],P=k.points[B];P.normalImpulse=I.m_normalImpulse,P.tangentImpulse=I.m_tangentImpulse,P.localPoint.SetV(I.m_localPoint);var T=P.rA.x=_.s_worldManifold.m_points[B].x-p.m_sweep.c.x,E=P.rA.y=_.s_worldManifold.m_points[B].y-p.m_sweep.c.y,V=P.rB.x=_.s_worldManifold.m_points[B].x-f.m_sweep.c.x,L=P.rB.y=_.s_worldManifold.m_points[B].y-f.m_sweep.c.y,R=T*M-E*D,N=V*M-L*D;R*=R,N*=N;var F=p.m_invMass+f.m_invMass+p.m_invI*R+f.m_invI*N;P.normalMass=1/F;var O=p.m_mass*p.m_invMass+f.m_mass*f.m_invMass;O+=p.m_mass*p.m_invI*R+f.m_mass*f.m_invI*N,P.equalizedMass=1/O;var G=M,J=-D,j=T*J-E*G,z=V*J-L*G;j*=j,z*=z;var H=p.m_invMass+f.m_invMass+p.m_invI*j+f.m_invI*z;P.tangentMass=1/H,P.velocityBias=0;var q=b+-A*L-g- -S*E,U=C+A*V-x-S*T,W=k.normal.x*q+k.normal.y*U;W<-w.b2_velocityThreshold&&(P.velocityBias+=-k.restitution*W)}if(2==k.pointCount){var $=k.points[0],K=k.points[1],Y=p.m_invMass,X=p.m_invI,Z=f.m_invMass,Q=f.m_invI,tt=$.rA.x*M-$.rA.y*D,et=$.rB.x*M-$.rB.y*D,it=K.rA.x*M-K.rA.y*D,nt=K.rB.x*M-K.rB.y*D,ot=Y+Z+X*tt*tt+Q*et*et,rt=Y+Z+X*it*it+Q*nt*nt,st=Y+Z+X*tt*it+Q*et*nt;ot*ot<100*(ot*rt-st*st)?(k.K.col1.Set(ot,st),k.K.col2.Set(st,rt),k.K.GetInverse(k.normalMass)):k.pointCount=1}}},_.prototype.InitVelocityConstraints=function(t){for(var e=0;e<this.m_constraintCount;++e){var i=this.m_constraints[e],n=i.bodyA,o=i.bodyB,r=n.m_invMass,s=n.m_invI,a=o.m_invMass,l=o.m_invI,c=i.normal.x,u=i.normal.y,h=u,m=-c,p=0,f=0;if(t.warmStarting)for(f=i.pointCount,p=0;p<f;++p){var _=i.points[p];_.normalImpulse*=t.dtRatio,_.tangentImpulse*=t.dtRatio;var y=_.normalImpulse*c+_.tangentImpulse*h,d=_.normalImpulse*u+_.tangentImpulse*m;n.m_angularVelocity-=s*(_.rA.x*d-_.rA.y*y),n.m_linearVelocity.x-=r*y,n.m_linearVelocity.y-=r*d,o.m_angularVelocity+=l*(_.rB.x*d-_.rB.y*y),o.m_linearVelocity.x+=a*y,o.m_linearVelocity.y+=a*d}else for(f=i.pointCount,p=0;p<f;++p){var v=i.points[p];v.normalImpulse=0,v.tangentImpulse=0}}},_.prototype.SolveVelocityConstraints=function(){for(var t,e,i=0,n=0,o=0,r=0,s=0,a=0,l=0,c=0,u=0,h=0,m=0,p=0,f=0,_=0,y=0,d=0,v=0;v<this.m_constraintCount;++v){var g=this.m_constraints[v],x=g.bodyA,b=g.bodyB,C=x.m_angularVelocity,S=b.m_angularVelocity,w=x.m_linearVelocity,A=b.m_linearVelocity,M=x.m_invMass,k=x.m_invI,B=b.m_invMass,I=b.m_invI,P=g.normal.x,T=g.normal.y,E=T,V=-P,L=g.friction;for(i=0;i<g.pointCount;i++)t=g.points[i],n=A.x-S*t.rB.y-w.x+C*t.rA.y,o=A.y+S*t.rB.x-w.y-C*t.rA.x,s=n*E+o*V,a=t.tangentMass*-s,l=L*t.normalImpulse,c=D.Clamp(t.tangentImpulse+a,-l,l),a=c-t.tangentImpulse,u=a*E,h=a*V,w.x-=M*u,w.y-=M*h,C-=k*(t.rA.x*h-t.rA.y*u),A.x+=B*u,A.y+=B*h,S+=I*(t.rB.x*h-t.rB.y*u),t.tangentImpulse=c;parseInt(g.pointCount);if(1==g.pointCount)t=g.points[0],n=A.x+-S*t.rB.y-w.x- -C*t.rA.y,o=A.y+S*t.rB.x-w.y-C*t.rA.x,r=n*P+o*T,a=-t.normalMass*(r-t.velocityBias),c=t.normalImpulse+a,c=c>0?c:0,a=c-t.normalImpulse,u=a*P,h=a*T,w.x-=M*u,w.y-=M*h,C-=k*(t.rA.x*h-t.rA.y*u),A.x+=B*u,A.y+=B*h,S+=I*(t.rB.x*h-t.rB.y*u),t.normalImpulse=c;else{var R=g.points[0],N=g.points[1],F=R.normalImpulse,O=N.normalImpulse,G=A.x-S*R.rB.y-w.x+C*R.rA.y,J=A.y+S*R.rB.x-w.y-C*R.rA.x,j=A.x-S*N.rB.y-w.x+C*N.rA.y,z=A.y+S*N.rB.x-w.y-C*N.rA.x,H=G*P+J*T,q=j*P+z*T,U=H-R.velocityBias,W=q-N.velocityBias;e=g.K,U-=e.col1.x*F+e.col2.x*O,W-=e.col1.y*F+e.col2.y*O;for(;;){e=g.normalMass;var $=-(e.col1.x*U+e.col2.x*W),K=-(e.col1.y*U+e.col2.y*W);if($>=0&&K>=0){m=$-F,p=K-O,f=m*P,_=m*T,y=p*P,d=p*T,w.x-=M*(f+y),w.y-=M*(_+d),C-=k*(R.rA.x*_-R.rA.y*f+N.rA.x*d-N.rA.y*y),A.x+=B*(f+y),A.y+=B*(_+d),S+=I*(R.rB.x*_-R.rB.y*f+N.rB.x*d-N.rB.y*y),R.normalImpulse=$,N.normalImpulse=K;break}if($=-R.normalMass*U,K=0,H=0,q=g.K.col1.y*$+W,$>=0&&q>=0){m=$-F,p=K-O,f=m*P,_=m*T,y=p*P,d=p*T,w.x-=M*(f+y),w.y-=M*(_+d),C-=k*(R.rA.x*_-R.rA.y*f+N.rA.x*d-N.rA.y*y),A.x+=B*(f+y),A.y+=B*(_+d),S+=I*(R.rB.x*_-R.rB.y*f+N.rB.x*d-N.rB.y*y),R.normalImpulse=$,N.normalImpulse=K;break}if($=0,K=-N.normalMass*W,H=g.K.col2.x*K+U,q=0,K>=0&&H>=0){m=$-F,p=K-O,f=m*P,_=m*T,y=p*P,d=p*T,w.x-=M*(f+y),w.y-=M*(_+d),C-=k*(R.rA.x*_-R.rA.y*f+N.rA.x*d-N.rA.y*y),A.x+=B*(f+y),A.y+=B*(_+d),S+=I*(R.rB.x*_-R.rB.y*f+N.rB.x*d-N.rB.y*y),R.normalImpulse=$,N.normalImpulse=K;break}if($=0,K=0,H=U,q=W,H>=0&&q>=0){m=$-F,p=K-O,f=m*P,_=m*T,y=p*P,d=p*T,w.x-=M*(f+y),w.y-=M*(_+d),C-=k*(R.rA.x*_-R.rA.y*f+N.rA.x*d-N.rA.y*y),A.x+=B*(f+y),A.y+=B*(_+d),S+=I*(R.rB.x*_-R.rB.y*f+N.rB.x*d-N.rB.y*y),R.normalImpulse=$,N.normalImpulse=K;break}break}}x.m_angularVelocity=C,b.m_angularVelocity=S}},_.prototype.FinalizeVelocityConstraints=function(){for(var t=0;t<this.m_constraintCount;++t)for(var e=this.m_constraints[t],i=e.manifold,n=0;n<e.pointCount;++n){var o=i.m_points[n],r=e.points[n];o.m_normalImpulse=r.normalImpulse,o.m_tangentImpulse=r.tangentImpulse}},_.prototype.SolvePositionConstraints=function(t){void 0===t&&(t=0);for(var e=0,i=0;i<this.m_constraintCount;i++){var n=this.m_constraints[i],o=n.bodyA,r=n.bodyB,s=o.m_mass*o.m_invMass,a=o.m_mass*o.m_invI,l=r.m_mass*r.m_invMass,c=r.m_mass*r.m_invI;_.s_psm.Initialize(n);for(var u=_.s_psm.m_normal,h=0;h<n.pointCount;h++){var m=n.points[h],p=_.s_psm.m_points[h],f=_.s_psm.m_separations[h],y=p.x-o.m_sweep.c.x,d=p.y-o.m_sweep.c.y,v=p.x-r.m_sweep.c.x,g=p.y-r.m_sweep.c.y;e=e<f?e:f;var x=D.Clamp(t*(f+w.b2_linearSlop),-w.b2_maxLinearCorrection,0),b=-m.equalizedMass*x,C=b*u.x,S=b*u.y;o.m_sweep.c.x-=s*C,o.m_sweep.c.y-=s*S,o.m_sweep.a-=a*(y*S-d*C),o.SynchronizeTransform(),r.m_sweep.c.x+=l*C,r.m_sweep.c.y+=l*S,r.m_sweep.a+=c*(v*S-g*C),r.SynchronizeTransform()}}return e>-1.5*w.b2_linearSlop},n.postDefs.push(function(){n.Dynamics.Contacts.b2ContactSolver.s_worldManifold=new E,n.Dynamics.Contacts.b2ContactSolver.s_psm=new b}),n.inherit(y,n.Dynamics.Contacts.b2Contact),y.prototype.__super=n.Dynamics.Contacts.b2Contact.prototype,y.b2EdgeAndCircleContact=function(){n.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)},y.Create=function(t){return new y},y.Destroy=function(t,e){},y.prototype.Reset=function(t,e){this.__super.Reset.call(this,t,e)},y.prototype.Evaluate=function(){var i=this.m_fixtureA.GetBody(),n=this.m_fixtureB.GetBody();this.b2CollideEdgeAndCircle(this.m_manifold,this.m_fixtureA.GetShape()instanceof e?this.m_fixtureA.GetShape():null,i.m_xf,this.m_fixtureB.GetShape()instanceof t?this.m_fixtureB.GetShape():null,n.m_xf)},y.prototype.b2CollideEdgeAndCircle=function(t,e,i,n,o){},n.inherit(d,n.Dynamics.Contacts.b2Contact),d.prototype.__super=n.Dynamics.Contacts.b2Contact.prototype,d.b2NullContact=function(){n.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)},d.prototype.b2NullContact=function(){this.__super.b2Contact.call(this)},d.prototype.Evaluate=function(){},n.inherit(v,n.Dynamics.Contacts.b2Contact),v.prototype.__super=n.Dynamics.Contacts.b2Contact.prototype,v.b2PolyAndCircleContact=function(){n.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)},v.Create=function(t){return new v},v.Destroy=function(t,e){},v.prototype.Reset=function(t,e){this.__super.Reset.call(this,t,e),w.b2Assert(t.GetType()==s.e_polygonShape),w.b2Assert(e.GetType()==s.e_circleShape)},v.prototype.Evaluate=function(){var e=this.m_fixtureA.m_body,n=this.m_fixtureB.m_body;k.CollidePolygonAndCircle(this.m_manifold,this.m_fixtureA.GetShape()instanceof i?this.m_fixtureA.GetShape():null,e.m_xf,this.m_fixtureB.GetShape()instanceof t?this.m_fixtureB.GetShape():null,n.m_xf)},n.inherit(g,n.Dynamics.Contacts.b2Contact),g.prototype.__super=n.Dynamics.Contacts.b2Contact.prototype,g.b2PolyAndEdgeContact=function(){n.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)},g.Create=function(t){return new g},g.Destroy=function(t,e){},g.prototype.Reset=function(t,e){this.__super.Reset.call(this,t,e),w.b2Assert(t.GetType()==s.e_polygonShape),w.b2Assert(e.GetType()==s.e_edgeShape)},g.prototype.Evaluate=function(){var t=this.m_fixtureA.GetBody(),n=this.m_fixtureB.GetBody();this.b2CollidePolyAndEdge(this.m_manifold,this.m_fixtureA.GetShape()instanceof i?this.m_fixtureA.GetShape():null,t.m_xf,this.m_fixtureB.GetShape()instanceof e?this.m_fixtureB.GetShape():null,n.m_xf)},g.prototype.b2CollidePolyAndEdge=function(t,e,i,n,o){},n.inherit(x,n.Dynamics.Contacts.b2Contact),x.prototype.__super=n.Dynamics.Contacts.b2Contact.prototype,x.b2PolygonContact=function(){n.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)},x.Create=function(t){return new x},x.Destroy=function(t,e){},x.prototype.Reset=function(t,e){this.__super.Reset.call(this,t,e)},x.prototype.Evaluate=function(){var t=this.m_fixtureA.GetBody(),e=this.m_fixtureB.GetBody();k.CollidePolygons(this.m_manifold,this.m_fixtureA.GetShape()instanceof i?this.m_fixtureA.GetShape():null,t.m_xf,this.m_fixtureB.GetShape()instanceof i?this.m_fixtureB.GetShape():null,e.m_xf)},b.b2PositionSolverManifold=function(){},b.prototype.b2PositionSolverManifold=function(){this.m_normal=new M,this.m_separations=new r(w.b2_maxManifoldPoints),this.m_points=new o(w.b2_maxManifoldPoints);for(var t=0;t<w.b2_maxManifoldPoints;t++)this.m_points[t]=new M},b.prototype.Initialize=function(t){w.b2Assert(t.pointCount>0);var e,i,n=0,o=0,r=0,s=0,a=0;switch(t.type){case I.e_circles:e=t.bodyA.m_xf.R,i=t.localPoint;var l=t.bodyA.m_xf.position.x+(e.col1.x*i.x+e.col2.x*i.y),c=t.bodyA.m_xf.position.y+(e.col1.y*i.x+e.col2.y*i.y);e=t.bodyB.m_xf.R,i=t.points[0].localPoint;var u=t.bodyB.m_xf.position.x+(e.col1.x*i.x+e.col2.x*i.y),h=t.bodyB.m_xf.position.y+(e.col1.y*i.x+e.col2.y*i.y),m=u-l,p=h-c,f=m*m+p*p;if(f>Number.MIN_VALUE*Number.MIN_VALUE){var _=Math.sqrt(f);this.m_normal.x=m/_,this.m_normal.y=p/_}else this.m_normal.x=1,this.m_normal.y=0;this.m_points[0].x=.5*(l+u),this.m_points[0].y=.5*(c+h),this.m_separations[0]=m*this.m_normal.x+p*this.m_normal.y-t.radius;break;case I.e_faceA:for(e=t.bodyA.m_xf.R,i=t.localPlaneNormal,this.m_normal.x=e.col1.x*i.x+e.col2.x*i.y,this.m_normal.y=e.col1.y*i.x+e.col2.y*i.y,e=t.bodyA.m_xf.R,i=t.localPoint,s=t.bodyA.m_xf.position.x+(e.col1.x*i.x+e.col2.x*i.y),a=t.bodyA.m_xf.position.y+(e.col1.y*i.x+e.col2.y*i.y),e=t.bodyB.m_xf.R,n=0;n<t.pointCount;++n)i=t.points[n].localPoint,o=t.bodyB.m_xf.position.x+(e.col1.x*i.x+e.col2.x*i.y),r=t.bodyB.m_xf.position.y+(e.col1.y*i.x+e.col2.y*i.y),this.m_separations[n]=(o-s)*this.m_normal.x+(r-a)*this.m_normal.y-t.radius,this.m_points[n].x=o,this.m_points[n].y=r;break;case I.e_faceB:for(e=t.bodyB.m_xf.R,i=t.localPlaneNormal,this.m_normal.x=e.col1.x*i.x+e.col2.x*i.y,this.m_normal.y=e.col1.y*i.x+e.col2.y*i.y,e=t.bodyB.m_xf.R,i=t.localPoint,s=t.bodyB.m_xf.position.x+(e.col1.x*i.x+e.col2.x*i.y),a=t.bodyB.m_xf.position.y+(e.col1.y*i.x+e.col2.y*i.y),e=t.bodyA.m_xf.R,n=0;n<t.pointCount;++n)i=t.points[n].localPoint,o=t.bodyA.m_xf.position.x+(e.col1.x*i.x+e.col2.x*i.y),r=t.bodyA.m_xf.position.y+(e.col1.y*i.x+e.col2.y*i.y),this.m_separations[n]=(o-s)*this.m_normal.x+(r-a)*this.m_normal.y-t.radius,this.m_points[n].Set(o,r);this.m_normal.x*=-1,this.m_normal.y*=-1}},n.postDefs.push(function(){n.Dynamics.Contacts.b2PositionSolverManifold.circlePointA=new M,n.Dynamics.Contacts.b2PositionSolverManifold.circlePointB=new M})}(),function(){var t=(n.Dynamics.b2Body,n.Dynamics.b2BodyDef,n.Dynamics.b2ContactFilter,n.Dynamics.b2ContactImpulse,n.Dynamics.b2ContactListener,n.Dynamics.b2ContactManager,n.Dynamics.b2DebugDraw,n.Dynamics.b2DestructionListener,n.Dynamics.b2FilterData,n.Dynamics.b2Fixture,n.Dynamics.b2FixtureDef,n.Dynamics.b2Island,n.Dynamics.b2TimeStep,n.Dynamics.b2World,n.Common.Math.b2Mat22),e=(n.Common.Math.b2Mat33,n.Common.Math.b2Math),i=(n.Common.Math.b2Sweep,n.Common.Math.b2Transform,n.Common.Math.b2Vec2),o=(n.Common.Math.b2Vec3,n.Common.b2Color),r=(n.Common.b2internal,n.Common.b2Settings,n.Collision.Shapes.b2CircleShape,n.Collision.Shapes.b2EdgeChainDef,n.Collision.Shapes.b2EdgeShape,n.Collision.Shapes.b2MassData,n.Collision.Shapes.b2PolygonShape,n.Collision.Shapes.b2Shape,n.Dynamics.Controllers.b2BuoyancyController),s=n.Dynamics.Controllers.b2ConstantAccelController,a=n.Dynamics.Controllers.b2ConstantForceController,l=n.Dynamics.Controllers.b2Controller,c=n.Dynamics.Controllers.b2ControllerEdge,u=n.Dynamics.Controllers.b2GravityController,h=n.Dynamics.Controllers.b2TensorDampingController;n.inherit(r,n.Dynamics.Controllers.b2Controller),r.prototype.__super=n.Dynamics.Controllers.b2Controller.prototype,r.b2BuoyancyController=function(){n.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments),this.normal=new i(0,-1),this.offset=0,this.density=0,this.velocity=new i(0,0),this.linearDrag=2,this.angularDrag=1,this.useDensity=!1,this.useWorldGravity=!0,this.gravity=null},r.prototype.Step=function(t){if(this.m_bodyList){this.useWorldGravity&&(this.gravity=this.GetWorld().GetGravity().Copy());for(var e=this.m_bodyList;e;e=e.nextBody){var n=e.body;if(0!=n.IsAwake()){for(var o=new i,r=new i,s=0,a=0,l=n.GetFixtureList();l;l=l.GetNext()){var c=new i,u=l.GetShape().ComputeSubmergedArea(this.normal,this.offset,n.GetTransform(),c);s+=u,o.x+=u*c.x,o.y+=u*c.y;var h=0;h=(this.useDensity,1),a+=u*h,r.x+=u*c.x*h,r.y+=u*c.y*h}if(o.x/=s,o.y/=s,r.x/=a,r.y/=a,!(s<Number.MIN_VALUE)){var m=this.gravity.GetNegative();m.Multiply(this.density*s),n.ApplyForce(m,r);var p=n.GetLinearVelocityFromWorldPoint(o);p.Subtract(this.velocity),p.Multiply(-this.linearDrag*s),n.ApplyForce(p,o),n.ApplyTorque(-n.GetInertia()/n.GetMass()*s*n.GetAngularVelocity()*this.angularDrag)}}}}},r.prototype.Draw=function(t){var e=1e3,n=new i,r=new i;n.x=this.normal.x*this.offset+this.normal.y*e,n.y=this.normal.y*this.offset-this.normal.x*e,r.x=this.normal.x*this.offset-this.normal.y*e,r.y=this.normal.y*this.offset+this.normal.x*e;var s=new o(0,0,1);t.DrawSegment(n,r,s)},n.inherit(s,n.Dynamics.Controllers.b2Controller),s.prototype.__super=n.Dynamics.Controllers.b2Controller.prototype,s.b2ConstantAccelController=function(){n.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments),this.A=new i(0,0)},s.prototype.Step=function(t){for(var e=new i(this.A.x*t.dt,this.A.y*t.dt),n=this.m_bodyList;n;n=n.nextBody){var o=n.body;o.IsAwake()&&o.SetLinearVelocity(new i(o.GetLinearVelocity().x+e.x,o.GetLinearVelocity().y+e.y))}},n.inherit(a,n.Dynamics.Controllers.b2Controller),a.prototype.__super=n.Dynamics.Controllers.b2Controller.prototype,a.b2ConstantForceController=function(){n.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments),this.F=new i(0,0)},a.prototype.Step=function(t){for(var e=this.m_bodyList;e;e=e.nextBody){var i=e.body;i.IsAwake()&&i.ApplyForce(this.F,i.GetWorldCenter())}},l.b2Controller=function(){},l.prototype.Step=function(t){},l.prototype.Draw=function(t){},l.prototype.AddBody=function(t){var e=new c;e.controller=this,e.body=t,e.nextBody=this.m_bodyList,e.prevBody=null,this.m_bodyList=e,e.nextBody&&(e.nextBody.prevBody=e),this.m_bodyCount++,e.nextController=t.m_controllerList,e.prevController=null,t.m_controllerList=e,e.nextController&&(e.nextController.prevController=e),t.m_controllerCount++},l.prototype.RemoveBody=function(t){for(var e=t.m_controllerList;e&&e.controller!=this;)e=e.nextController;e.prevBody&&(e.prevBody.nextBody=e.nextBody),e.nextBody&&(e.nextBody.prevBody=e.prevBody),e.nextController&&(e.nextController.prevController=e.prevController),e.prevController&&(e.prevController.nextController=e.nextController),this.m_bodyList==e&&(this.m_bodyList=e.nextBody),t.m_controllerList==e&&(t.m_controllerList=e.nextController),t.m_controllerCount--,this.m_bodyCount--},l.prototype.Clear=function(){for(;this.m_bodyList;)this.RemoveBody(this.m_bodyList.body)},l.prototype.GetNext=function(){return this.m_next},l.prototype.GetWorld=function(){return this.m_world},l.prototype.GetBodyList=function(){return this.m_bodyList},c.b2ControllerEdge=function(){},n.inherit(u,n.Dynamics.Controllers.b2Controller),u.prototype.__super=n.Dynamics.Controllers.b2Controller.prototype,u.b2GravityController=function(){n.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments),this.G=1,this.invSqr=!0},u.prototype.Step=function(t){var e=null,n=null,o=null,r=0,s=null,a=null,l=null,c=0,u=0,h=0,m=null;if(this.invSqr)for(e=this.m_bodyList;e;e=e.nextBody)for(n=e.body,o=n.GetWorldCenter(),r=n.GetMass(),s=this.m_bodyList;s!=e;s=s.nextBody)a=s.body,l=a.GetWorldCenter(),c=l.x-o.x,u=l.y-o.y,(h=c*c+u*u)<Number.MIN_VALUE||(m=new i(c,u),m.Multiply(this.G/h/Math.sqrt(h)*r*a.GetMass()),n.IsAwake()&&n.ApplyForce(m,o),m.Multiply(-1),a.IsAwake()&&a.ApplyForce(m,l));else for(e=this.m_bodyList;e;e=e.nextBody)for(n=e.body,o=n.GetWorldCenter(),r=n.GetMass(),s=this.m_bodyList;s!=e;s=s.nextBody)a=s.body,l=a.GetWorldCenter(),c=l.x-o.x,u=l.y-o.y,(h=c*c+u*u)<Number.MIN_VALUE||(m=new i(c,u),m.Multiply(this.G/h*r*a.GetMass()),n.IsAwake()&&n.ApplyForce(m,o),m.Multiply(-1),a.IsAwake()&&a.ApplyForce(m,l))},n.inherit(h,n.Dynamics.Controllers.b2Controller),h.prototype.__super=n.Dynamics.Controllers.b2Controller.prototype,h.b2TensorDampingController=function(){n.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments),this.T=new t,this.maxTimestep=0},h.prototype.SetAxisAligned=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.T.col1.x=-t,this.T.col1.y=0,this.T.col2.x=0,this.T.col2.y=-e,this.maxTimestep=t>0||e>0?1/Math.max(t,e):0},h.prototype.Step=function(t){var n=t.dt;if(!(n<=Number.MIN_VALUE)){n>this.maxTimestep&&this.maxTimestep>0&&(n=this.maxTimestep);for(var o=this.m_bodyList;o;o=o.nextBody){var r=o.body;if(r.IsAwake()){var s=r.GetWorldVector(e.MulMV(this.T,r.GetLocalVector(r.GetLinearVelocity())));r.SetLinearVelocity(new i(r.GetLinearVelocity().x+s.x*n,r.GetLinearVelocity().y+s.y*n))}}}}}(),function(){var t=(n.Common.b2Color,n.Common.b2internal,n.Common.b2Settings),e=n.Common.Math.b2Mat22,i=n.Common.Math.b2Mat33,o=n.Common.Math.b2Math,r=(n.Common.Math.b2Sweep,n.Common.Math.b2Transform,n.Common.Math.b2Vec2),s=n.Common.Math.b2Vec3,a=n.Dynamics.Joints.b2DistanceJoint,l=n.Dynamics.Joints.b2DistanceJointDef,c=n.Dynamics.Joints.b2FrictionJoint,u=n.Dynamics.Joints.b2FrictionJointDef,h=n.Dynamics.Joints.b2GearJoint,m=n.Dynamics.Joints.b2GearJointDef,p=n.Dynamics.Joints.b2Jacobian,f=n.Dynamics.Joints.b2Joint,_=n.Dynamics.Joints.b2JointDef,y=n.Dynamics.Joints.b2JointEdge,d=n.Dynamics.Joints.b2LineJoint,v=n.Dynamics.Joints.b2LineJointDef,g=n.Dynamics.Joints.b2MouseJoint,x=n.Dynamics.Joints.b2MouseJointDef,b=n.Dynamics.Joints.b2PrismaticJoint,C=n.Dynamics.Joints.b2PrismaticJointDef,S=n.Dynamics.Joints.b2PulleyJoint,w=n.Dynamics.Joints.b2PulleyJointDef,A=n.Dynamics.Joints.b2RevoluteJoint,D=n.Dynamics.Joints.b2RevoluteJointDef,M=n.Dynamics.Joints.b2WeldJoint,k=n.Dynamics.Joints.b2WeldJointDef;n.Dynamics.b2Body,n.Dynamics.b2BodyDef,n.Dynamics.b2ContactFilter,n.Dynamics.b2ContactImpulse,n.Dynamics.b2ContactListener,n.Dynamics.b2ContactManager,n.Dynamics.b2DebugDraw,n.Dynamics.b2DestructionListener,n.Dynamics.b2FilterData,n.Dynamics.b2Fixture,n.Dynamics.b2FixtureDef,n.Dynamics.b2Island,n.Dynamics.b2TimeStep,n.Dynamics.b2World;n.inherit(a,n.Dynamics.Joints.b2Joint),a.prototype.__super=n.Dynamics.Joints.b2Joint.prototype,a.b2DistanceJoint=function(){n.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_localAnchor1=new r,this.m_localAnchor2=new r,this.m_u=new r},a.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},a.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},a.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new r(t*this.m_impulse*this.m_u.x,t*this.m_impulse*this.m_u.y)},a.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),0},a.prototype.GetLength=function(){return this.m_length},a.prototype.SetLength=function(t){void 0===t&&(t=0),this.m_length=t},a.prototype.GetFrequency=function(){return this.m_frequencyHz},a.prototype.SetFrequency=function(t){void 0===t&&(t=0),this.m_frequencyHz=t},a.prototype.GetDampingRatio=function(){return this.m_dampingRatio},a.prototype.SetDampingRatio=function(t){void 0===t&&(t=0),this.m_dampingRatio=t},a.prototype.b2DistanceJoint=function(t){this.__super.b2Joint.call(this,t);this.m_localAnchor1.SetV(t.localAnchorA),this.m_localAnchor2.SetV(t.localAnchorB),this.m_length=t.length,this.m_frequencyHz=t.frequencyHz,this.m_dampingRatio=t.dampingRatio,this.m_impulse=0,this.m_gamma=0,this.m_bias=0},a.prototype.InitVelocityConstraints=function(e){var i,n=0,o=this.m_bodyA,r=this.m_bodyB;i=o.m_xf.R;var s=this.m_localAnchor1.x-o.m_sweep.localCenter.x,a=this.m_localAnchor1.y-o.m_sweep.localCenter.y;n=i.col1.x*s+i.col2.x*a,a=i.col1.y*s+i.col2.y*a,s=n,i=r.m_xf.R;var l=this.m_localAnchor2.x-r.m_sweep.localCenter.x,c=this.m_localAnchor2.y-r.m_sweep.localCenter.y;n=i.col1.x*l+i.col2.x*c,c=i.col1.y*l+i.col2.y*c,l=n,this.m_u.x=r.m_sweep.c.x+l-o.m_sweep.c.x-s,this.m_u.y=r.m_sweep.c.y+c-o.m_sweep.c.y-a;var u=Math.sqrt(this.m_u.x*this.m_u.x+this.m_u.y*this.m_u.y);u>t.b2_linearSlop?this.m_u.Multiply(1/u):this.m_u.SetZero();var h=s*this.m_u.y-a*this.m_u.x,m=l*this.m_u.y-c*this.m_u.x,p=o.m_invMass+o.m_invI*h*h+r.m_invMass+r.m_invI*m*m;if(this.m_mass=0!=p?1/p:0,this.m_frequencyHz>0){var f=u-this.m_length,_=2*Math.PI*this.m_frequencyHz,y=2*this.m_mass*this.m_dampingRatio*_,d=this.m_mass*_*_;this.m_gamma=e.dt*(y+e.dt*d),this.m_gamma=0!=this.m_gamma?1/this.m_gamma:0,this.m_bias=f*e.dt*d*this.m_gamma,this.m_mass=p+this.m_gamma,this.m_mass=0!=this.m_mass?1/this.m_mass:0}if(e.warmStarting){this.m_impulse*=e.dtRatio;var v=this.m_impulse*this.m_u.x,g=this.m_impulse*this.m_u.y;o.m_linearVelocity.x-=o.m_invMass*v,o.m_linearVelocity.y-=o.m_invMass*g,o.m_angularVelocity-=o.m_invI*(s*g-a*v),r.m_linearVelocity.x+=r.m_invMass*v,r.m_linearVelocity.y+=r.m_invMass*g,r.m_angularVelocity+=r.m_invI*(l*g-c*v)}else this.m_impulse=0},a.prototype.SolveVelocityConstraints=function(t){var e,i=this.m_bodyA,n=this.m_bodyB;e=i.m_xf.R;var o=this.m_localAnchor1.x-i.m_sweep.localCenter.x,r=this.m_localAnchor1.y-i.m_sweep.localCenter.y,s=e.col1.x*o+e.col2.x*r;r=e.col1.y*o+e.col2.y*r,o=s,e=n.m_xf.R;var a=this.m_localAnchor2.x-n.m_sweep.localCenter.x,l=this.m_localAnchor2.y-n.m_sweep.localCenter.y;s=e.col1.x*a+e.col2.x*l,l=e.col1.y*a+e.col2.y*l,a=s;var c=i.m_linearVelocity.x+-i.m_angularVelocity*r,u=i.m_linearVelocity.y+i.m_angularVelocity*o,h=n.m_linearVelocity.x+-n.m_angularVelocity*l,m=n.m_linearVelocity.y+n.m_angularVelocity*a,p=this.m_u.x*(h-c)+this.m_u.y*(m-u),f=-this.m_mass*(p+this.m_bias+this.m_gamma*this.m_impulse);this.m_impulse+=f;var _=f*this.m_u.x,y=f*this.m_u.y;i.m_linearVelocity.x-=i.m_invMass*_,i.m_linearVelocity.y-=i.m_invMass*y,i.m_angularVelocity-=i.m_invI*(o*y-r*_),n.m_linearVelocity.x+=n.m_invMass*_,n.m_linearVelocity.y+=n.m_invMass*y,n.m_angularVelocity+=n.m_invI*(a*y-l*_)},a.prototype.SolvePositionConstraints=function(e){void 0===e&&(e=0);var i;if(this.m_frequencyHz>0)return!0;var n=this.m_bodyA,r=this.m_bodyB;i=n.m_xf.R;var s=this.m_localAnchor1.x-n.m_sweep.localCenter.x,a=this.m_localAnchor1.y-n.m_sweep.localCenter.y,l=i.col1.x*s+i.col2.x*a;a=i.col1.y*s+i.col2.y*a,s=l,i=r.m_xf.R;var c=this.m_localAnchor2.x-r.m_sweep.localCenter.x,u=this.m_localAnchor2.y-r.m_sweep.localCenter.y;l=i.col1.x*c+i.col2.x*u,u=i.col1.y*c+i.col2.y*u,c=l;var h=r.m_sweep.c.x+c-n.m_sweep.c.x-s,m=r.m_sweep.c.y+u-n.m_sweep.c.y-a,p=Math.sqrt(h*h+m*m);h/=p,m/=p;var f=p-this.m_length;f=o.Clamp(f,-t.b2_maxLinearCorrection,t.b2_maxLinearCorrection);var _=-this.m_mass*f;this.m_u.Set(h,m);var y=_*this.m_u.x,d=_*this.m_u.y;return n.m_sweep.c.x-=n.m_invMass*y,n.m_sweep.c.y-=n.m_invMass*d,n.m_sweep.a-=n.m_invI*(s*d-a*y),r.m_sweep.c.x+=r.m_invMass*y,r.m_sweep.c.y+=r.m_invMass*d,r.m_sweep.a+=r.m_invI*(c*d-u*y),n.SynchronizeTransform(),r.SynchronizeTransform(),o.Abs(f)<t.b2_linearSlop},n.inherit(l,n.Dynamics.Joints.b2JointDef),l.prototype.__super=n.Dynamics.Joints.b2JointDef.prototype,l.b2DistanceJointDef=function(){n.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.localAnchorA=new r,this.localAnchorB=new r},l.prototype.b2DistanceJointDef=function(){this.__super.b2JointDef.call(this),this.type=f.e_distanceJoint,this.length=1,this.frequencyHz=0,this.dampingRatio=0},l.prototype.Initialize=function(t,e,i,n){this.bodyA=t,this.bodyB=e,this.localAnchorA.SetV(this.bodyA.GetLocalPoint(i)),this.localAnchorB.SetV(this.bodyB.GetLocalPoint(n));var o=n.x-i.x,r=n.y-i.y;this.length=Math.sqrt(o*o+r*r),this.frequencyHz=0,this.dampingRatio=0},n.inherit(c,n.Dynamics.Joints.b2Joint),c.prototype.__super=n.Dynamics.Joints.b2Joint.prototype,c.b2FrictionJoint=function(){n.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_localAnchorA=new r,this.m_localAnchorB=new r,this.m_linearMass=new e,this.m_linearImpulse=new r},c.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA)},c.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB)},c.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new r(t*this.m_linearImpulse.x,t*this.m_linearImpulse.y)},c.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),t*this.m_angularImpulse},c.prototype.SetMaxForce=function(t){void 0===t&&(t=0),this.m_maxForce=t},c.prototype.GetMaxForce=function(){return this.m_maxForce},c.prototype.SetMaxTorque=function(t){void 0===t&&(t=0),this.m_maxTorque=t},c.prototype.GetMaxTorque=function(){return this.m_maxTorque},c.prototype.b2FrictionJoint=function(t){this.__super.b2Joint.call(this,t),this.m_localAnchorA.SetV(t.localAnchorA),this.m_localAnchorB.SetV(t.localAnchorB),this.m_linearMass.SetZero(),this.m_angularMass=0,this.m_linearImpulse.SetZero(),this.m_angularImpulse=0,this.m_maxForce=t.maxForce,this.m_maxTorque=t.maxTorque},c.prototype.InitVelocityConstraints=function(t){var i,n=0,o=this.m_bodyA,r=this.m_bodyB;i=o.m_xf.R;var s=this.m_localAnchorA.x-o.m_sweep.localCenter.x,a=this.m_localAnchorA.y-o.m_sweep.localCenter.y;n=i.col1.x*s+i.col2.x*a,a=i.col1.y*s+i.col2.y*a,s=n,i=r.m_xf.R;var l=this.m_localAnchorB.x-r.m_sweep.localCenter.x,c=this.m_localAnchorB.y-r.m_sweep.localCenter.y;n=i.col1.x*l+i.col2.x*c,c=i.col1.y*l+i.col2.y*c,l=n;var u=o.m_invMass,h=r.m_invMass,m=o.m_invI,p=r.m_invI,f=new e;if(f.col1.x=u+h,f.col2.x=0,f.col1.y=0,f.col2.y=u+h,f.col1.x+=m*a*a,f.col2.x+=-m*s*a,f.col1.y+=-m*s*a,f.col2.y+=m*s*s,f.col1.x+=p*c*c,f.col2.x+=-p*l*c,f.col1.y+=-p*l*c,f.col2.y+=p*l*l,f.GetInverse(this.m_linearMass),this.m_angularMass=m+p,this.m_angularMass>0&&(this.m_angularMass=1/this.m_angularMass),t.warmStarting){this.m_linearImpulse.x*=t.dtRatio,this.m_linearImpulse.y*=t.dtRatio,this.m_angularImpulse*=t.dtRatio;var _=this.m_linearImpulse;o.m_linearVelocity.x-=u*_.x,o.m_linearVelocity.y-=u*_.y,o.m_angularVelocity-=m*(s*_.y-a*_.x+this.m_angularImpulse),r.m_linearVelocity.x+=h*_.x,r.m_linearVelocity.y+=h*_.y,r.m_angularVelocity+=p*(l*_.y-c*_.x+this.m_angularImpulse)}else this.m_linearImpulse.SetZero(),this.m_angularImpulse=0},c.prototype.SolveVelocityConstraints=function(t){var e,i=0,n=this.m_bodyA,s=this.m_bodyB,a=n.m_linearVelocity,l=n.m_angularVelocity,c=s.m_linearVelocity,u=s.m_angularVelocity,h=n.m_invMass,m=s.m_invMass,p=n.m_invI,f=s.m_invI;e=n.m_xf.R;var _=this.m_localAnchorA.x-n.m_sweep.localCenter.x,y=this.m_localAnchorA.y-n.m_sweep.localCenter.y;i=e.col1.x*_+e.col2.x*y,y=e.col1.y*_+e.col2.y*y,_=i,e=s.m_xf.R;var d=this.m_localAnchorB.x-s.m_sweep.localCenter.x,v=this.m_localAnchorB.y-s.m_sweep.localCenter.y;i=e.col1.x*d+e.col2.x*v,v=e.col1.y*d+e.col2.y*v,d=i;var g=0,x=u-l,b=-this.m_angularMass*x,C=this.m_angularImpulse;g=t.dt*this.m_maxTorque,this.m_angularImpulse=o.Clamp(this.m_angularImpulse+b,-g,g),b=this.m_angularImpulse-C,l-=p*b,u+=f*b;var S=c.x-u*v-a.x+l*y,w=c.y+u*d-a.y-l*_,A=o.MulMV(this.m_linearMass,new r(-S,-w)),D=this.m_linearImpulse.Copy();this.m_linearImpulse.Add(A),g=t.dt*this.m_maxForce,this.m_linearImpulse.LengthSquared()>g*g&&(this.m_linearImpulse.Normalize(),this.m_linearImpulse.Multiply(g)),A=o.SubtractVV(this.m_linearImpulse,D),a.x-=h*A.x,a.y-=h*A.y,l-=p*(_*A.y-y*A.x),c.x+=m*A.x,c.y+=m*A.y,u+=f*(d*A.y-v*A.x),n.m_angularVelocity=l,s.m_angularVelocity=u},c.prototype.SolvePositionConstraints=function(t){return void 0===t&&(t=0),!0},n.inherit(u,n.Dynamics.Joints.b2JointDef),u.prototype.__super=n.Dynamics.Joints.b2JointDef.prototype,u.b2FrictionJointDef=function(){n.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.localAnchorA=new r,this.localAnchorB=new r},u.prototype.b2FrictionJointDef=function(){this.__super.b2JointDef.call(this),this.type=f.e_frictionJoint,this.maxForce=0,this.maxTorque=0},u.prototype.Initialize=function(t,e,i){this.bodyA=t,this.bodyB=e,this.localAnchorA.SetV(this.bodyA.GetLocalPoint(i)),this.localAnchorB.SetV(this.bodyB.GetLocalPoint(i))},n.inherit(h,n.Dynamics.Joints.b2Joint),h.prototype.__super=n.Dynamics.Joints.b2Joint.prototype,h.b2GearJoint=function(){n.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_groundAnchor1=new r,this.m_groundAnchor2=new r,this.m_localAnchor1=new r,this.m_localAnchor2=new r,this.m_J=new p},h.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},h.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},h.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new r(t*this.m_impulse*this.m_J.linearB.x,t*this.m_impulse*this.m_J.linearB.y)},h.prototype.GetReactionTorque=function(t){void 0===t&&(t=0);var e=this.m_bodyB.m_xf.R,i=this.m_localAnchor1.x-this.m_bodyB.m_sweep.localCenter.x,n=this.m_localAnchor1.y-this.m_bodyB.m_sweep.localCenter.y,o=e.col1.x*i+e.col2.x*n;n=e.col1.y*i+e.col2.y*n,i=o;var r=this.m_impulse*this.m_J.linearB.x,s=this.m_impulse*this.m_J.linearB.y;return t*(this.m_impulse*this.m_J.angularB-i*s+n*r)},h.prototype.GetRatio=function(){return this.m_ratio},h.prototype.SetRatio=function(t){void 0===t&&(t=0),this.m_ratio=t},h.prototype.b2GearJoint=function(t){this.__super.b2Joint.call(this,t);var e=parseInt(t.joint1.m_type),i=parseInt(t.joint2.m_type);this.m_revolute1=null,this.m_prismatic1=null,this.m_revolute2=null,this.m_prismatic2=null;var n=0,o=0;this.m_ground1=t.joint1.GetBodyA(),this.m_bodyA=t.joint1.GetBodyB(),e==f.e_revoluteJoint?(this.m_revolute1=t.joint1 instanceof A?t.joint1:null,this.m_groundAnchor1.SetV(this.m_revolute1.m_localAnchor1),this.m_localAnchor1.SetV(this.m_revolute1.m_localAnchor2),n=this.m_revolute1.GetJointAngle()):(this.m_prismatic1=t.joint1 instanceof b?t.joint1:null,this.m_groundAnchor1.SetV(this.m_prismatic1.m_localAnchor1),this.m_localAnchor1.SetV(this.m_prismatic1.m_localAnchor2),n=this.m_prismatic1.GetJointTranslation()),this.m_ground2=t.joint2.GetBodyA(),this.m_bodyB=t.joint2.GetBodyB(),i==f.e_revoluteJoint?(this.m_revolute2=t.joint2 instanceof A?t.joint2:null,this.m_groundAnchor2.SetV(this.m_revolute2.m_localAnchor1),this.m_localAnchor2.SetV(this.m_revolute2.m_localAnchor2),o=this.m_revolute2.GetJointAngle()):(this.m_prismatic2=t.joint2 instanceof b?t.joint2:null,this.m_groundAnchor2.SetV(this.m_prismatic2.m_localAnchor1),this.m_localAnchor2.SetV(this.m_prismatic2.m_localAnchor2),o=this.m_prismatic2.GetJointTranslation()),this.m_ratio=t.ratio,this.m_constant=n+this.m_ratio*o,this.m_impulse=0},h.prototype.InitVelocityConstraints=function(t){var e,i,n=this.m_ground1,o=this.m_ground2,r=this.m_bodyA,s=this.m_bodyB,a=0,l=0,c=0,u=0,h=0,m=0,p=0;this.m_J.SetZero(),this.m_revolute1?(this.m_J.angularA=-1,p+=r.m_invI):(e=n.m_xf.R,i=this.m_prismatic1.m_localXAxis1,a=e.col1.x*i.x+e.col2.x*i.y,l=e.col1.y*i.x+e.col2.y*i.y,e=r.m_xf.R,c=this.m_localAnchor1.x-r.m_sweep.localCenter.x,u=this.m_localAnchor1.y-r.m_sweep.localCenter.y,m=e.col1.x*c+e.col2.x*u,u=e.col1.y*c+e.col2.y*u,c=m,h=c*l-u*a,this.m_J.linearA.Set(-a,-l),this.m_J.angularA=-h,p+=r.m_invMass+r.m_invI*h*h),this.m_revolute2?(this.m_J.angularB=-this.m_ratio,p+=this.m_ratio*this.m_ratio*s.m_invI):(e=o.m_xf.R,i=this.m_prismatic2.m_localXAxis1,a=e.col1.x*i.x+e.col2.x*i.y,l=e.col1.y*i.x+e.col2.y*i.y,e=s.m_xf.R,c=this.m_localAnchor2.x-s.m_sweep.localCenter.x,u=this.m_localAnchor2.y-s.m_sweep.localCenter.y,m=e.col1.x*c+e.col2.x*u,u=e.col1.y*c+e.col2.y*u,c=m,h=c*l-u*a,this.m_J.linearB.Set(-this.m_ratio*a,-this.m_ratio*l),this.m_J.angularB=-this.m_ratio*h,p+=this.m_ratio*this.m_ratio*(s.m_invMass+s.m_invI*h*h)),this.m_mass=p>0?1/p:0,t.warmStarting?(r.m_linearVelocity.x+=r.m_invMass*this.m_impulse*this.m_J.linearA.x,r.m_linearVelocity.y+=r.m_invMass*this.m_impulse*this.m_J.linearA.y,r.m_angularVelocity+=r.m_invI*this.m_impulse*this.m_J.angularA,s.m_linearVelocity.x+=s.m_invMass*this.m_impulse*this.m_J.linearB.x,s.m_linearVelocity.y+=s.m_invMass*this.m_impulse*this.m_J.linearB.y,s.m_angularVelocity+=s.m_invI*this.m_impulse*this.m_J.angularB):this.m_impulse=0},h.prototype.SolveVelocityConstraints=function(t){var e=this.m_bodyA,i=this.m_bodyB,n=this.m_J.Compute(e.m_linearVelocity,e.m_angularVelocity,i.m_linearVelocity,i.m_angularVelocity),o=-this.m_mass*n;this.m_impulse+=o,e.m_linearVelocity.x+=e.m_invMass*o*this.m_J.linearA.x,e.m_linearVelocity.y+=e.m_invMass*o*this.m_J.linearA.y,e.m_angularVelocity+=e.m_invI*o*this.m_J.angularA,i.m_linearVelocity.x+=i.m_invMass*o*this.m_J.linearB.x,i.m_linearVelocity.y+=i.m_invMass*o*this.m_J.linearB.y,i.m_angularVelocity+=i.m_invI*o*this.m_J.angularB},h.prototype.SolvePositionConstraints=function(e){void 0===e&&(e=0);var i=this.m_bodyA,n=this.m_bodyB,o=0,r=0;o=this.m_revolute1?this.m_revolute1.GetJointAngle():this.m_prismatic1.GetJointTranslation(),r=this.m_revolute2?this.m_revolute2.GetJointAngle():this.m_prismatic2.GetJointTranslation();var s=this.m_constant-(o+this.m_ratio*r),a=-this.m_mass*s;return i.m_sweep.c.x+=i.m_invMass*a*this.m_J.linearA.x,i.m_sweep.c.y+=i.m_invMass*a*this.m_J.linearA.y,i.m_sweep.a+=i.m_invI*a*this.m_J.angularA,n.m_sweep.c.x+=n.m_invMass*a*this.m_J.linearB.x,n.m_sweep.c.y+=n.m_invMass*a*this.m_J.linearB.y,n.m_sweep.a+=n.m_invI*a*this.m_J.angularB,i.SynchronizeTransform(),n.SynchronizeTransform(),0<t.b2_linearSlop},n.inherit(m,n.Dynamics.Joints.b2JointDef),m.prototype.__super=n.Dynamics.Joints.b2JointDef.prototype,m.b2GearJointDef=function(){n.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments)},m.prototype.b2GearJointDef=function(){this.__super.b2JointDef.call(this),this.type=f.e_gearJoint,this.joint1=null,this.joint2=null,this.ratio=1},p.b2Jacobian=function(){this.linearA=new r,this.linearB=new r},p.prototype.SetZero=function(){this.linearA.SetZero(),this.angularA=0,this.linearB.SetZero(),this.angularB=0},p.prototype.Set=function(t,e,i,n){void 0===e&&(e=0),void 0===n&&(n=0),this.linearA.SetV(t),this.angularA=e,this.linearB.SetV(i),this.angularB=n},p.prototype.Compute=function(t,e,i,n){return void 0===e&&(e=0),void 0===n&&(n=0),this.linearA.x*t.x+this.linearA.y*t.y+this.angularA*e+(this.linearB.x*i.x+this.linearB.y*i.y)+this.angularB*n},f.b2Joint=function(){this.m_edgeA=new y,this.m_edgeB=new y,this.m_localCenterA=new r,this.m_localCenterB=new r},f.prototype.GetType=function(){return this.m_type},f.prototype.GetAnchorA=function(){return null},f.prototype.GetAnchorB=function(){return null},f.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),null},f.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),0},f.prototype.GetBodyA=function(){return this.m_bodyA},f.prototype.GetBodyB=function(){return this.m_bodyB},f.prototype.GetNext=function(){return this.m_next},f.prototype.GetUserData=function(){return this.m_userData},f.prototype.SetUserData=function(t){this.m_userData=t},f.prototype.IsActive=function(){return this.m_bodyA.IsActive()&&this.m_bodyB.IsActive()},f.Create=function(t,e){var i=null;switch(t.type){case f.e_distanceJoint:i=new a(t instanceof l?t:null);break;case f.e_mouseJoint:i=new g(t instanceof x?t:null);break;case f.e_prismaticJoint:i=new b(t instanceof C?t:null);break;case f.e_revoluteJoint:i=new A(t instanceof D?t:null);break;case f.e_pulleyJoint:i=new S(t instanceof w?t:null);break;case f.e_gearJoint:i=new h(t instanceof m?t:null);break;case f.e_lineJoint:i=new d(t instanceof v?t:null);break;case f.e_weldJoint:i=new M(t instanceof k?t:null);break;case f.e_frictionJoint:i=new c(t instanceof u?t:null)}return i},f.Destroy=function(t,e){},f.prototype.b2Joint=function(e){t.b2Assert(e.bodyA!=e.bodyB),this.m_type=e.type,this.m_prev=null,this.m_next=null,this.m_bodyA=e.bodyA,this.m_bodyB=e.bodyB,this.m_collideConnected=e.collideConnected,this.m_islandFlag=!1,this.m_userData=e.userData},f.prototype.InitVelocityConstraints=function(t){},f.prototype.SolveVelocityConstraints=function(t){},f.prototype.FinalizeVelocityConstraints=function(){},f.prototype.SolvePositionConstraints=function(t){return void 0===t&&(t=0),!1},n.postDefs.push(function(){n.Dynamics.Joints.b2Joint.e_unknownJoint=0,n.Dynamics.Joints.b2Joint.e_revoluteJoint=1,n.Dynamics.Joints.b2Joint.e_prismaticJoint=2,n.Dynamics.Joints.b2Joint.e_distanceJoint=3,n.Dynamics.Joints.b2Joint.e_pulleyJoint=4,n.Dynamics.Joints.b2Joint.e_mouseJoint=5,n.Dynamics.Joints.b2Joint.e_gearJoint=6,n.Dynamics.Joints.b2Joint.e_lineJoint=7,n.Dynamics.Joints.b2Joint.e_weldJoint=8,n.Dynamics.Joints.b2Joint.e_frictionJoint=9,n.Dynamics.Joints.b2Joint.e_inactiveLimit=0,n.Dynamics.Joints.b2Joint.e_atLowerLimit=1,n.Dynamics.Joints.b2Joint.e_atUpperLimit=2,n.Dynamics.Joints.b2Joint.e_equalLimits=3}),_.b2JointDef=function(){},_.prototype.b2JointDef=function(){this.type=f.e_unknownJoint,this.userData=null,this.bodyA=null,this.bodyB=null,this.collideConnected=!1},y.b2JointEdge=function(){},n.inherit(d,n.Dynamics.Joints.b2Joint),d.prototype.__super=n.Dynamics.Joints.b2Joint.prototype,d.b2LineJoint=function(){n.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_localAnchor1=new r,this.m_localAnchor2=new r,this.m_localXAxis1=new r,this.m_localYAxis1=new r,this.m_axis=new r,this.m_perp=new r,this.m_K=new e,this.m_impulse=new r},d.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},d.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},d.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new r(t*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.x),t*(this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.y))},d.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),t*this.m_impulse.y},d.prototype.GetJointTranslation=function(){var t=this.m_bodyA,e=this.m_bodyB,i=t.GetWorldPoint(this.m_localAnchor1),n=e.GetWorldPoint(this.m_localAnchor2),o=n.x-i.x,r=n.y-i.y,s=t.GetWorldVector(this.m_localXAxis1);return s.x*o+s.y*r},d.prototype.GetJointSpeed=function(){var t,e=this.m_bodyA,i=this.m_bodyB;t=e.m_xf.R;var n=this.m_localAnchor1.x-e.m_sweep.localCenter.x,o=this.m_localAnchor1.y-e.m_sweep.localCenter.y,r=t.col1.x*n+t.col2.x*o;o=t.col1.y*n+t.col2.y*o,n=r,t=i.m_xf.R;var s=this.m_localAnchor2.x-i.m_sweep.localCenter.x,a=this.m_localAnchor2.y-i.m_sweep.localCenter.y;r=t.col1.x*s+t.col2.x*a,a=t.col1.y*s+t.col2.y*a,s=r;var l=e.m_sweep.c.x+n,c=e.m_sweep.c.y+o,u=i.m_sweep.c.x+s,h=i.m_sweep.c.y+a,m=u-l,p=h-c,f=e.GetWorldVector(this.m_localXAxis1),_=e.m_linearVelocity,y=i.m_linearVelocity,d=e.m_angularVelocity,v=i.m_angularVelocity;return m*(-d*f.y)+p*(d*f.x)+(f.x*(y.x+-v*a-_.x- -d*o)+f.y*(y.y+v*s-_.y-d*n))},d.prototype.IsLimitEnabled=function(){return this.m_enableLimit},d.prototype.EnableLimit=function(t){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableLimit=t},d.prototype.GetLowerLimit=function(){return this.m_lowerTranslation},d.prototype.GetUpperLimit=function(){return this.m_upperTranslation},d.prototype.SetLimits=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_lowerTranslation=t,this.m_upperTranslation=e},d.prototype.IsMotorEnabled=function(){return this.m_enableMotor},d.prototype.EnableMotor=function(t){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor=t},d.prototype.SetMotorSpeed=function(t){void 0===t&&(t=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=t},d.prototype.GetMotorSpeed=function(){return this.m_motorSpeed},d.prototype.SetMaxMotorForce=function(t){void 0===t&&(t=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_maxMotorForce=t},d.prototype.GetMaxMotorForce=function(){return this.m_maxMotorForce},d.prototype.GetMotorForce=function(){return this.m_motorImpulse},d.prototype.b2LineJoint=function(t){this.__super.b2Joint.call(this,t);this.m_localAnchor1.SetV(t.localAnchorA),this.m_localAnchor2.SetV(t.localAnchorB),this.m_localXAxis1.SetV(t.localAxisA),this.m_localYAxis1.x=-this.m_localXAxis1.y,this.m_localYAxis1.y=this.m_localXAxis1.x,this.m_impulse.SetZero(),this.m_motorMass=0,this.m_motorImpulse=0,this.m_lowerTranslation=t.lowerTranslation,this.m_upperTranslation=t.upperTranslation,this.m_maxMotorForce=t.maxMotorForce,this.m_motorSpeed=t.motorSpeed,this.m_enableLimit=t.enableLimit,this.m_enableMotor=t.enableMotor,this.m_limitState=f.e_inactiveLimit,this.m_axis.SetZero(),this.m_perp.SetZero()},d.prototype.InitVelocityConstraints=function(e){var i,n=this.m_bodyA,r=this.m_bodyB,s=0;this.m_localCenterA.SetV(n.GetLocalCenter()),this.m_localCenterB.SetV(r.GetLocalCenter());var a=n.GetTransform();r.GetTransform();i=n.m_xf.R;var l=this.m_localAnchor1.x-this.m_localCenterA.x,c=this.m_localAnchor1.y-this.m_localCenterA.y;s=i.col1.x*l+i.col2.x*c,c=i.col1.y*l+i.col2.y*c,l=s,i=r.m_xf.R;var u=this.m_localAnchor2.x-this.m_localCenterB.x,h=this.m_localAnchor2.y-this.m_localCenterB.y;s=i.col1.x*u+i.col2.x*h,h=i.col1.y*u+i.col2.y*h,u=s;var m=r.m_sweep.c.x+u-n.m_sweep.c.x-l,p=r.m_sweep.c.y+h-n.m_sweep.c.y-c;this.m_invMassA=n.m_invMass,this.m_invMassB=r.m_invMass,this.m_invIA=n.m_invI,this.m_invIB=r.m_invI,this.m_axis.SetV(o.MulMV(a.R,this.m_localXAxis1)),this.m_a1=(m+l)*this.m_axis.y-(p+c)*this.m_axis.x,this.m_a2=u*this.m_axis.y-h*this.m_axis.x,this.m_motorMass=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_a1*this.m_a1+this.m_invIB*this.m_a2*this.m_a2,this.m_motorMass=this.m_motorMass>Number.MIN_VALUE?1/this.m_motorMass:0,this.m_perp.SetV(o.MulMV(a.R,this.m_localYAxis1)),this.m_s1=(m+l)*this.m_perp.y-(p+c)*this.m_perp.x,this.m_s2=u*this.m_perp.y-h*this.m_perp.x;var _=this.m_invMassA,y=this.m_invMassB,d=this.m_invIA,v=this.m_invIB;if(this.m_K.col1.x=_+y+d*this.m_s1*this.m_s1+v*this.m_s2*this.m_s2,this.m_K.col1.y=d*this.m_s1*this.m_a1+v*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=_+y+d*this.m_a1*this.m_a1+v*this.m_a2*this.m_a2,this.m_enableLimit){var g=this.m_axis.x*m+this.m_axis.y*p;o.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*t.b2_linearSlop?this.m_limitState=f.e_equalLimits:g<=this.m_lowerTranslation?this.m_limitState!=f.e_atLowerLimit&&(this.m_limitState=f.e_atLowerLimit,this.m_impulse.y=0):g>=this.m_upperTranslation?this.m_limitState!=f.e_atUpperLimit&&(this.m_limitState=f.e_atUpperLimit,this.m_impulse.y=0):(this.m_limitState=f.e_inactiveLimit,this.m_impulse.y=0)}else this.m_limitState=f.e_inactiveLimit;if(0==this.m_enableMotor&&(this.m_motorImpulse=0),e.warmStarting){this.m_impulse.x*=e.dtRatio,this.m_impulse.y*=e.dtRatio,this.m_motorImpulse*=e.dtRatio;var x=this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.x,b=this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.y,C=this.m_impulse.x*this.m_s1+(this.m_motorImpulse+this.m_impulse.y)*this.m_a1,S=this.m_impulse.x*this.m_s2+(this.m_motorImpulse+this.m_impulse.y)*this.m_a2;n.m_linearVelocity.x-=this.m_invMassA*x,n.m_linearVelocity.y-=this.m_invMassA*b,n.m_angularVelocity-=this.m_invIA*C,r.m_linearVelocity.x+=this.m_invMassB*x,r.m_linearVelocity.y+=this.m_invMassB*b,r.m_angularVelocity+=this.m_invIB*S}else this.m_impulse.SetZero(),this.m_motorImpulse=0},d.prototype.SolveVelocityConstraints=function(t){var e=this.m_bodyA,i=this.m_bodyB,n=e.m_linearVelocity,s=e.m_angularVelocity,a=i.m_linearVelocity,l=i.m_angularVelocity,c=0,u=0,h=0,m=0;if(this.m_enableMotor&&this.m_limitState!=f.e_equalLimits){var p=this.m_axis.x*(a.x-n.x)+this.m_axis.y*(a.y-n.y)+this.m_a2*l-this.m_a1*s,_=this.m_motorMass*(this.m_motorSpeed-p),y=this.m_motorImpulse,d=t.dt*this.m_maxMotorForce;this.m_motorImpulse=o.Clamp(this.m_motorImpulse+_,-d,d),_=this.m_motorImpulse-y,c=_*this.m_axis.x,u=_*this.m_axis.y,h=_*this.m_a1,m=_*this.m_a2,n.x-=this.m_invMassA*c,n.y-=this.m_invMassA*u,s-=this.m_invIA*h,a.x+=this.m_invMassB*c,a.y+=this.m_invMassB*u,l+=this.m_invIB*m}var v=this.m_perp.x*(a.x-n.x)+this.m_perp.y*(a.y-n.y)+this.m_s2*l-this.m_s1*s;if(this.m_enableLimit&&this.m_limitState!=f.e_inactiveLimit){var g=this.m_axis.x*(a.x-n.x)+this.m_axis.y*(a.y-n.y)+this.m_a2*l-this.m_a1*s,x=this.m_impulse.Copy(),b=this.m_K.Solve(new r,-v,-g);this.m_impulse.Add(b),this.m_limitState==f.e_atLowerLimit?this.m_impulse.y=o.Max(this.m_impulse.y,0):this.m_limitState==f.e_atUpperLimit&&(this.m_impulse.y=o.Min(this.m_impulse.y,0));var C=-v-(this.m_impulse.y-x.y)*this.m_K.col2.x,S=0;S=0!=this.m_K.col1.x?C/this.m_K.col1.x+x.x:x.x,this.m_impulse.x=S,b.x=this.m_impulse.x-x.x,b.y=this.m_impulse.y-x.y,c=b.x*this.m_perp.x+b.y*this.m_axis.x,u=b.x*this.m_perp.y+b.y*this.m_axis.y,h=b.x*this.m_s1+b.y*this.m_a1,m=b.x*this.m_s2+b.y*this.m_a2,n.x-=this.m_invMassA*c,n.y-=this.m_invMassA*u,s-=this.m_invIA*h,a.x+=this.m_invMassB*c,a.y+=this.m_invMassB*u,l+=this.m_invIB*m}else{var w=0;w=0!=this.m_K.col1.x?-v/this.m_K.col1.x:0,this.m_impulse.x+=w,c=w*this.m_perp.x,u=w*this.m_perp.y,h=w*this.m_s1,m=w*this.m_s2,n.x-=this.m_invMassA*c,n.y-=this.m_invMassA*u,s-=this.m_invIA*h,a.x+=this.m_invMassB*c,a.y+=this.m_invMassB*u,l+=this.m_invIB*m}e.m_linearVelocity.SetV(n),e.m_angularVelocity=s,i.m_linearVelocity.SetV(a),i.m_angularVelocity=l},d.prototype.SolvePositionConstraints=function(i){void 0===i&&(i=0);var n,s=this.m_bodyA,a=this.m_bodyB,l=s.m_sweep.c,c=s.m_sweep.a,u=a.m_sweep.c,h=a.m_sweep.a,m=0,p=0,f=0,_=0,y=0,d=0,v=0,g=!1,x=0,b=e.FromAngle(c),C=e.FromAngle(h);n=b;var S=this.m_localAnchor1.x-this.m_localCenterA.x,w=this.m_localAnchor1.y-this.m_localCenterA.y;m=n.col1.x*S+n.col2.x*w,w=n.col1.y*S+n.col2.y*w,S=m,n=C;var A=this.m_localAnchor2.x-this.m_localCenterB.x,D=this.m_localAnchor2.y-this.m_localCenterB.y;m=n.col1.x*A+n.col2.x*D,D=n.col1.y*A+n.col2.y*D,A=m;var M=u.x+A-l.x-S,k=u.y+D-l.y-w;if(this.m_enableLimit){this.m_axis=o.MulMV(b,this.m_localXAxis1),this.m_a1=(M+S)*this.m_axis.y-(k+w)*this.m_axis.x,this.m_a2=A*this.m_axis.y-D*this.m_axis.x;var B=this.m_axis.x*M+this.m_axis.y*k;o.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*t.b2_linearSlop?(x=o.Clamp(B,-t.b2_maxLinearCorrection,t.b2_maxLinearCorrection),d=o.Abs(B),g=!0):B<=this.m_lowerTranslation?(x=o.Clamp(B-this.m_lowerTranslation+t.b2_linearSlop,-t.b2_maxLinearCorrection,0),d=this.m_lowerTranslation-B,g=!0):B>=this.m_upperTranslation&&(x=o.Clamp(B-this.m_upperTranslation+t.b2_linearSlop,0,t.b2_maxLinearCorrection),d=B-this.m_upperTranslation,g=!0)}this.m_perp=o.MulMV(b,this.m_localYAxis1),this.m_s1=(M+S)*this.m_perp.y-(k+w)*this.m_perp.x,this.m_s2=A*this.m_perp.y-D*this.m_perp.x;var I=new r,P=this.m_perp.x*M+this.m_perp.y*k;if(d=o.Max(d,o.Abs(P)),v=0,g)p=this.m_invMassA,f=this.m_invMassB,_=this.m_invIA,y=this.m_invIB,this.m_K.col1.x=p+f+_*this.m_s1*this.m_s1+y*this.m_s2*this.m_s2,this.m_K.col1.y=_*this.m_s1*this.m_a1+y*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=p+f+_*this.m_a1*this.m_a1+y*this.m_a2*this.m_a2,this.m_K.Solve(I,-P,-x);else{p=this.m_invMassA,f=this.m_invMassB,_=this.m_invIA,y=this.m_invIB;var T=p+f+_*this.m_s1*this.m_s1+y*this.m_s2*this.m_s2,E=0;E=0!=T?-P/T:0,I.x=E,I.y=0}var V=I.x*this.m_perp.x+I.y*this.m_axis.x,L=I.x*this.m_perp.y+I.y*this.m_axis.y,R=I.x*this.m_s1+I.y*this.m_a1,N=I.x*this.m_s2+I.y*this.m_a2;return l.x-=this.m_invMassA*V,l.y-=this.m_invMassA*L,c-=this.m_invIA*R,u.x+=this.m_invMassB*V,u.y+=this.m_invMassB*L,h+=this.m_invIB*N,s.m_sweep.a=c,a.m_sweep.a=h,s.SynchronizeTransform(),a.SynchronizeTransform(),d<=t.b2_linearSlop&&v<=t.b2_angularSlop},n.inherit(v,n.Dynamics.Joints.b2JointDef),v.prototype.__super=n.Dynamics.Joints.b2JointDef.prototype,v.b2LineJointDef=function(){n.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.localAnchorA=new r,this.localAnchorB=new r,this.localAxisA=new r},v.prototype.b2LineJointDef=function(){this.__super.b2JointDef.call(this),this.type=f.e_lineJoint,this.localAxisA.Set(1,0),this.enableLimit=!1,this.lowerTranslation=0,this.upperTranslation=0,this.enableMotor=!1,this.maxMotorForce=0,this.motorSpeed=0},v.prototype.Initialize=function(t,e,i,n){this.bodyA=t,this.bodyB=e,this.localAnchorA=this.bodyA.GetLocalPoint(i),this.localAnchorB=this.bodyB.GetLocalPoint(i),this.localAxisA=this.bodyA.GetLocalVector(n)},n.inherit(g,n.Dynamics.Joints.b2Joint),g.prototype.__super=n.Dynamics.Joints.b2Joint.prototype,g.b2MouseJoint=function(){n.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.K=new e,this.K1=new e,this.K2=new e,this.m_localAnchor=new r,this.m_target=new r,this.m_impulse=new r,this.m_mass=new e,this.m_C=new r},g.prototype.GetAnchorA=function(){return this.m_target},g.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor)},g.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new r(t*this.m_impulse.x,t*this.m_impulse.y)},g.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),0},g.prototype.GetTarget=function(){return this.m_target},g.prototype.SetTarget=function(t){0==this.m_bodyB.IsAwake()&&this.m_bodyB.SetAwake(!0),this.m_target=t},g.prototype.GetMaxForce=function(){return this.m_maxForce},g.prototype.SetMaxForce=function(t){void 0===t&&(t=0),this.m_maxForce=t},g.prototype.GetFrequency=function(){return this.m_frequencyHz},g.prototype.SetFrequency=function(t){void 0===t&&(t=0),this.m_frequencyHz=t},g.prototype.GetDampingRatio=function(){return this.m_dampingRatio},g.prototype.SetDampingRatio=function(t){void 0===t&&(t=0),this.m_dampingRatio=t},g.prototype.b2MouseJoint=function(t){this.__super.b2Joint.call(this,t),this.m_target.SetV(t.target);var e=this.m_target.x-this.m_bodyB.m_xf.position.x,i=this.m_target.y-this.m_bodyB.m_xf.position.y,n=this.m_bodyB.m_xf.R;this.m_localAnchor.x=e*n.col1.x+i*n.col1.y,this.m_localAnchor.y=e*n.col2.x+i*n.col2.y,this.m_maxForce=t.maxForce,this.m_impulse.SetZero(),this.m_frequencyHz=t.frequencyHz,this.m_dampingRatio=t.dampingRatio,this.m_beta=0,this.m_gamma=0},g.prototype.InitVelocityConstraints=function(t){var e=this.m_bodyB,i=e.GetMass(),n=2*Math.PI*this.m_frequencyHz,o=2*i*this.m_dampingRatio*n,r=i*n*n;this.m_gamma=t.dt*(o+t.dt*r),this.m_gamma=0!=this.m_gamma?1/this.m_gamma:0,this.m_beta=t.dt*r*this.m_gamma;var s;s=e.m_xf.R;var a=this.m_localAnchor.x-e.m_sweep.localCenter.x,l=this.m_localAnchor.y-e.m_sweep.localCenter.y,c=s.col1.x*a+s.col2.x*l;l=s.col1.y*a+s.col2.y*l,a=c;var u=e.m_invMass,h=e.m_invI;this.K1.col1.x=u,this.K1.col2.x=0,this.K1.col1.y=0,this.K1.col2.y=u,this.K2.col1.x=h*l*l,this.K2.col2.x=-h*a*l,this.K2.col1.y=-h*a*l,this.K2.col2.y=h*a*a,this.K.SetM(this.K1),this.K.AddM(this.K2),this.K.col1.x+=this.m_gamma,this.K.col2.y+=this.m_gamma,this.K.GetInverse(this.m_mass),this.m_C.x=e.m_sweep.c.x+a-this.m_target.x,this.m_C.y=e.m_sweep.c.y+l-this.m_target.y,e.m_angularVelocity*=.98,this.m_impulse.x*=t.dtRatio,this.m_impulse.y*=t.dtRatio,e.m_linearVelocity.x+=u*this.m_impulse.x,e.m_linearVelocity.y+=u*this.m_impulse.y,e.m_angularVelocity+=h*(a*this.m_impulse.y-l*this.m_impulse.x)},g.prototype.SolveVelocityConstraints=function(t){var e,i=this.m_bodyB,n=0,o=0;e=i.m_xf.R;var r=this.m_localAnchor.x-i.m_sweep.localCenter.x,s=this.m_localAnchor.y-i.m_sweep.localCenter.y;n=e.col1.x*r+e.col2.x*s,s=e.col1.y*r+e.col2.y*s,r=n;var a=i.m_linearVelocity.x+-i.m_angularVelocity*s,l=i.m_linearVelocity.y+i.m_angularVelocity*r;e=this.m_mass,n=a+this.m_beta*this.m_C.x+this.m_gamma*this.m_impulse.x,o=l+this.m_beta*this.m_C.y+this.m_gamma*this.m_impulse.y;var c=-(e.col1.x*n+e.col2.x*o),u=-(e.col1.y*n+e.col2.y*o),h=this.m_impulse.x,m=this.m_impulse.y;this.m_impulse.x+=c,this.m_impulse.y+=u;var p=t.dt*this.m_maxForce;this.m_impulse.LengthSquared()>p*p&&this.m_impulse.Multiply(p/this.m_impulse.Length()),c=this.m_impulse.x-h,u=this.m_impulse.y-m,i.m_linearVelocity.x+=i.m_invMass*c,i.m_linearVelocity.y+=i.m_invMass*u,i.m_angularVelocity+=i.m_invI*(r*u-s*c)},g.prototype.SolvePositionConstraints=function(t){return void 0===t&&(t=0),!0},n.inherit(x,n.Dynamics.Joints.b2JointDef),x.prototype.__super=n.Dynamics.Joints.b2JointDef.prototype,x.b2MouseJointDef=function(){n.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.target=new r},x.prototype.b2MouseJointDef=function(){this.__super.b2JointDef.call(this),this.type=f.e_mouseJoint,this.maxForce=0,this.frequencyHz=5,this.dampingRatio=.7},n.inherit(b,n.Dynamics.Joints.b2Joint),b.prototype.__super=n.Dynamics.Joints.b2Joint.prototype,b.b2PrismaticJoint=function(){n.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_localAnchor1=new r,this.m_localAnchor2=new r,this.m_localXAxis1=new r,this.m_localYAxis1=new r,this.m_axis=new r,this.m_perp=new r,this.m_K=new i,this.m_impulse=new s},b.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},b.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},b.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new r(t*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.x),t*(this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.y))},b.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),t*this.m_impulse.y},b.prototype.GetJointTranslation=function(){var t=this.m_bodyA,e=this.m_bodyB,i=t.GetWorldPoint(this.m_localAnchor1),n=e.GetWorldPoint(this.m_localAnchor2),o=n.x-i.x,r=n.y-i.y,s=t.GetWorldVector(this.m_localXAxis1);return s.x*o+s.y*r},b.prototype.GetJointSpeed=function(){var t,e=this.m_bodyA,i=this.m_bodyB;t=e.m_xf.R;var n=this.m_localAnchor1.x-e.m_sweep.localCenter.x,o=this.m_localAnchor1.y-e.m_sweep.localCenter.y,r=t.col1.x*n+t.col2.x*o;o=t.col1.y*n+t.col2.y*o,n=r,t=i.m_xf.R;var s=this.m_localAnchor2.x-i.m_sweep.localCenter.x,a=this.m_localAnchor2.y-i.m_sweep.localCenter.y;r=t.col1.x*s+t.col2.x*a,a=t.col1.y*s+t.col2.y*a,s=r;var l=e.m_sweep.c.x+n,c=e.m_sweep.c.y+o,u=i.m_sweep.c.x+s,h=i.m_sweep.c.y+a,m=u-l,p=h-c,f=e.GetWorldVector(this.m_localXAxis1),_=e.m_linearVelocity,y=i.m_linearVelocity,d=e.m_angularVelocity,v=i.m_angularVelocity;return m*(-d*f.y)+p*(d*f.x)+(f.x*(y.x+-v*a-_.x- -d*o)+f.y*(y.y+v*s-_.y-d*n))},b.prototype.IsLimitEnabled=function(){return this.m_enableLimit},b.prototype.EnableLimit=function(t){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableLimit=t},b.prototype.GetLowerLimit=function(){return this.m_lowerTranslation},b.prototype.GetUpperLimit=function(){return this.m_upperTranslation},b.prototype.SetLimits=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_lowerTranslation=t,this.m_upperTranslation=e},b.prototype.IsMotorEnabled=function(){return this.m_enableMotor},b.prototype.EnableMotor=function(t){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor=t},b.prototype.SetMotorSpeed=function(t){void 0===t&&(t=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=t},b.prototype.GetMotorSpeed=function(){return this.m_motorSpeed},b.prototype.SetMaxMotorForce=function(t){void 0===t&&(t=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_maxMotorForce=t},b.prototype.GetMotorForce=function(){return this.m_motorImpulse},b.prototype.b2PrismaticJoint=function(t){this.__super.b2Joint.call(this,t);this.m_localAnchor1.SetV(t.localAnchorA),this.m_localAnchor2.SetV(t.localAnchorB),this.m_localXAxis1.SetV(t.localAxisA),this.m_localYAxis1.x=-this.m_localXAxis1.y,this.m_localYAxis1.y=this.m_localXAxis1.x,this.m_refAngle=t.referenceAngle,this.m_impulse.SetZero(),this.m_motorMass=0,this.m_motorImpulse=0,this.m_lowerTranslation=t.lowerTranslation,this.m_upperTranslation=t.upperTranslation,this.m_maxMotorForce=t.maxMotorForce,this.m_motorSpeed=t.motorSpeed,this.m_enableLimit=t.enableLimit,this.m_enableMotor=t.enableMotor,this.m_limitState=f.e_inactiveLimit,this.m_axis.SetZero(),this.m_perp.SetZero()},b.prototype.InitVelocityConstraints=function(e){var i,n=this.m_bodyA,r=this.m_bodyB,s=0;this.m_localCenterA.SetV(n.GetLocalCenter()),this.m_localCenterB.SetV(r.GetLocalCenter());var a=n.GetTransform();r.GetTransform();i=n.m_xf.R;var l=this.m_localAnchor1.x-this.m_localCenterA.x,c=this.m_localAnchor1.y-this.m_localCenterA.y;s=i.col1.x*l+i.col2.x*c,c=i.col1.y*l+i.col2.y*c,l=s,i=r.m_xf.R;var u=this.m_localAnchor2.x-this.m_localCenterB.x,h=this.m_localAnchor2.y-this.m_localCenterB.y;s=i.col1.x*u+i.col2.x*h,h=i.col1.y*u+i.col2.y*h,u=s;var m=r.m_sweep.c.x+u-n.m_sweep.c.x-l,p=r.m_sweep.c.y+h-n.m_sweep.c.y-c;this.m_invMassA=n.m_invMass,this.m_invMassB=r.m_invMass,this.m_invIA=n.m_invI,this.m_invIB=r.m_invI,this.m_axis.SetV(o.MulMV(a.R,this.m_localXAxis1)),this.m_a1=(m+l)*this.m_axis.y-(p+c)*this.m_axis.x,this.m_a2=u*this.m_axis.y-h*this.m_axis.x,this.m_motorMass=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_a1*this.m_a1+this.m_invIB*this.m_a2*this.m_a2,this.m_motorMass>Number.MIN_VALUE&&(this.m_motorMass=1/this.m_motorMass),this.m_perp.SetV(o.MulMV(a.R,this.m_localYAxis1)),this.m_s1=(m+l)*this.m_perp.y-(p+c)*this.m_perp.x,this.m_s2=u*this.m_perp.y-h*this.m_perp.x;var _=this.m_invMassA,y=this.m_invMassB,d=this.m_invIA,v=this.m_invIB;if(this.m_K.col1.x=_+y+d*this.m_s1*this.m_s1+v*this.m_s2*this.m_s2,this.m_K.col1.y=d*this.m_s1+v*this.m_s2,this.m_K.col1.z=d*this.m_s1*this.m_a1+v*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=d+v,this.m_K.col2.z=d*this.m_a1+v*this.m_a2,this.m_K.col3.x=this.m_K.col1.z,this.m_K.col3.y=this.m_K.col2.z,this.m_K.col3.z=_+y+d*this.m_a1*this.m_a1+v*this.m_a2*this.m_a2,this.m_enableLimit){var g=this.m_axis.x*m+this.m_axis.y*p;o.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*t.b2_linearSlop?this.m_limitState=f.e_equalLimits:g<=this.m_lowerTranslation?this.m_limitState!=f.e_atLowerLimit&&(this.m_limitState=f.e_atLowerLimit,this.m_impulse.z=0):g>=this.m_upperTranslation?this.m_limitState!=f.e_atUpperLimit&&(this.m_limitState=f.e_atUpperLimit,this.m_impulse.z=0):(this.m_limitState=f.e_inactiveLimit,this.m_impulse.z=0)}else this.m_limitState=f.e_inactiveLimit;if(0==this.m_enableMotor&&(this.m_motorImpulse=0),e.warmStarting){this.m_impulse.x*=e.dtRatio,this.m_impulse.y*=e.dtRatio,this.m_motorImpulse*=e.dtRatio;var x=this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.x,b=this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.y,C=this.m_impulse.x*this.m_s1+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a1,S=this.m_impulse.x*this.m_s2+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a2;n.m_linearVelocity.x-=this.m_invMassA*x,n.m_linearVelocity.y-=this.m_invMassA*b,n.m_angularVelocity-=this.m_invIA*C,r.m_linearVelocity.x+=this.m_invMassB*x,r.m_linearVelocity.y+=this.m_invMassB*b,r.m_angularVelocity+=this.m_invIB*S}else this.m_impulse.SetZero(),this.m_motorImpulse=0},b.prototype.SolveVelocityConstraints=function(t){var e=this.m_bodyA,i=this.m_bodyB,n=e.m_linearVelocity,a=e.m_angularVelocity,l=i.m_linearVelocity,c=i.m_angularVelocity,u=0,h=0,m=0,p=0;if(this.m_enableMotor&&this.m_limitState!=f.e_equalLimits){var _=this.m_axis.x*(l.x-n.x)+this.m_axis.y*(l.y-n.y)+this.m_a2*c-this.m_a1*a,y=this.m_motorMass*(this.m_motorSpeed-_),d=this.m_motorImpulse,v=t.dt*this.m_maxMotorForce;this.m_motorImpulse=o.Clamp(this.m_motorImpulse+y,-v,v),y=this.m_motorImpulse-d,u=y*this.m_axis.x,h=y*this.m_axis.y,m=y*this.m_a1,p=y*this.m_a2,n.x-=this.m_invMassA*u,n.y-=this.m_invMassA*h,a-=this.m_invIA*m,l.x+=this.m_invMassB*u,l.y+=this.m_invMassB*h,c+=this.m_invIB*p}var g=this.m_perp.x*(l.x-n.x)+this.m_perp.y*(l.y-n.y)+this.m_s2*c-this.m_s1*a,x=c-a;if(this.m_enableLimit&&this.m_limitState!=f.e_inactiveLimit){var b=this.m_axis.x*(l.x-n.x)+this.m_axis.y*(l.y-n.y)+this.m_a2*c-this.m_a1*a,C=this.m_impulse.Copy(),S=this.m_K.Solve33(new s,-g,-x,-b);this.m_impulse.Add(S),this.m_limitState==f.e_atLowerLimit?this.m_impulse.z=o.Max(this.m_impulse.z,0):this.m_limitState==f.e_atUpperLimit&&(this.m_impulse.z=o.Min(this.m_impulse.z,0));var w=-g-(this.m_impulse.z-C.z)*this.m_K.col3.x,A=-x-(this.m_impulse.z-C.z)*this.m_K.col3.y,D=this.m_K.Solve22(new r,w,A);D.x+=C.x,D.y+=C.y,this.m_impulse.x=D.x,this.m_impulse.y=D.y,S.x=this.m_impulse.x-C.x,S.y=this.m_impulse.y-C.y,S.z=this.m_impulse.z-C.z,u=S.x*this.m_perp.x+S.z*this.m_axis.x,h=S.x*this.m_perp.y+S.z*this.m_axis.y,m=S.x*this.m_s1+S.y+S.z*this.m_a1,p=S.x*this.m_s2+S.y+S.z*this.m_a2,n.x-=this.m_invMassA*u,n.y-=this.m_invMassA*h,a-=this.m_invIA*m,l.x+=this.m_invMassB*u,l.y+=this.m_invMassB*h,c+=this.m_invIB*p}else{var M=this.m_K.Solve22(new r,-g,-x);this.m_impulse.x+=M.x,this.m_impulse.y+=M.y,u=M.x*this.m_perp.x,h=M.x*this.m_perp.y,m=M.x*this.m_s1+M.y,p=M.x*this.m_s2+M.y,n.x-=this.m_invMassA*u,n.y-=this.m_invMassA*h,a-=this.m_invIA*m,l.x+=this.m_invMassB*u,l.y+=this.m_invMassB*h,c+=this.m_invIB*p}e.m_linearVelocity.SetV(n),e.m_angularVelocity=a,i.m_linearVelocity.SetV(l),i.m_angularVelocity=c},b.prototype.SolvePositionConstraints=function(i){void 0===i&&(i=0);var n,a=this.m_bodyA,l=this.m_bodyB,c=a.m_sweep.c,u=a.m_sweep.a,h=l.m_sweep.c,m=l.m_sweep.a,p=0,f=0,_=0,y=0,d=0,v=0,g=0,x=!1,b=0,C=e.FromAngle(u),S=e.FromAngle(m);n=C;var w=this.m_localAnchor1.x-this.m_localCenterA.x,A=this.m_localAnchor1.y-this.m_localCenterA.y;p=n.col1.x*w+n.col2.x*A,A=n.col1.y*w+n.col2.y*A,w=p,n=S;var D=this.m_localAnchor2.x-this.m_localCenterB.x,M=this.m_localAnchor2.y-this.m_localCenterB.y;p=n.col1.x*D+n.col2.x*M,M=n.col1.y*D+n.col2.y*M,D=p;var k=h.x+D-c.x-w,B=h.y+M-c.y-A;if(this.m_enableLimit){this.m_axis=o.MulMV(C,this.m_localXAxis1),this.m_a1=(k+w)*this.m_axis.y-(B+A)*this.m_axis.x,this.m_a2=D*this.m_axis.y-M*this.m_axis.x;var I=this.m_axis.x*k+this.m_axis.y*B;o.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*t.b2_linearSlop?(b=o.Clamp(I,-t.b2_maxLinearCorrection,t.b2_maxLinearCorrection),v=o.Abs(I),x=!0):I<=this.m_lowerTranslation?(b=o.Clamp(I-this.m_lowerTranslation+t.b2_linearSlop,-t.b2_maxLinearCorrection,0),v=this.m_lowerTranslation-I,x=!0):I>=this.m_upperTranslation&&(b=o.Clamp(I-this.m_upperTranslation+t.b2_linearSlop,0,t.b2_maxLinearCorrection),v=I-this.m_upperTranslation,x=!0)}this.m_perp=o.MulMV(C,this.m_localYAxis1),this.m_s1=(k+w)*this.m_perp.y-(B+A)*this.m_perp.x,this.m_s2=D*this.m_perp.y-M*this.m_perp.x;var P=new s,T=this.m_perp.x*k+this.m_perp.y*B,E=m-u-this.m_refAngle;if(v=o.Max(v,o.Abs(T)),g=o.Abs(E),x)f=this.m_invMassA,_=this.m_invMassB,y=this.m_invIA,d=this.m_invIB,this.m_K.col1.x=f+_+y*this.m_s1*this.m_s1+d*this.m_s2*this.m_s2,this.m_K.col1.y=y*this.m_s1+d*this.m_s2,this.m_K.col1.z=y*this.m_s1*this.m_a1+d*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=y+d,this.m_K.col2.z=y*this.m_a1+d*this.m_a2,this.m_K.col3.x=this.m_K.col1.z,this.m_K.col3.y=this.m_K.col2.z,this.m_K.col3.z=f+_+y*this.m_a1*this.m_a1+d*this.m_a2*this.m_a2,this.m_K.Solve33(P,-T,-E,-b);else{f=this.m_invMassA,_=this.m_invMassB,y=this.m_invIA,d=this.m_invIB;var V=f+_+y*this.m_s1*this.m_s1+d*this.m_s2*this.m_s2,L=y*this.m_s1+d*this.m_s2,R=y+d;this.m_K.col1.Set(V,L,0),this.m_K.col2.Set(L,R,0);var N=this.m_K.Solve22(new r,-T,-E);P.x=N.x,P.y=N.y,P.z=0}var F=P.x*this.m_perp.x+P.z*this.m_axis.x,O=P.x*this.m_perp.y+P.z*this.m_axis.y,G=P.x*this.m_s1+P.y+P.z*this.m_a1,J=P.x*this.m_s2+P.y+P.z*this.m_a2;return c.x-=this.m_invMassA*F,c.y-=this.m_invMassA*O,u-=this.m_invIA*G,h.x+=this.m_invMassB*F,h.y+=this.m_invMassB*O,m+=this.m_invIB*J,a.m_sweep.a=u,l.m_sweep.a=m,a.SynchronizeTransform(),l.SynchronizeTransform(),v<=t.b2_linearSlop&&g<=t.b2_angularSlop},n.inherit(C,n.Dynamics.Joints.b2JointDef),C.prototype.__super=n.Dynamics.Joints.b2JointDef.prototype,C.b2PrismaticJointDef=function(){n.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.localAnchorA=new r,this.localAnchorB=new r,this.localAxisA=new r},C.prototype.b2PrismaticJointDef=function(){this.__super.b2JointDef.call(this),this.type=f.e_prismaticJoint,this.localAxisA.Set(1,0),this.referenceAngle=0,this.enableLimit=!1,this.lowerTranslation=0,this.upperTranslation=0,this.enableMotor=!1,this.maxMotorForce=0,this.motorSpeed=0},C.prototype.Initialize=function(t,e,i,n){this.bodyA=t,this.bodyB=e,this.localAnchorA=this.bodyA.GetLocalPoint(i),this.localAnchorB=this.bodyB.GetLocalPoint(i),this.localAxisA=this.bodyA.GetLocalVector(n),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()},n.inherit(S,n.Dynamics.Joints.b2Joint),S.prototype.__super=n.Dynamics.Joints.b2Joint.prototype,S.b2PulleyJoint=function(){n.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_groundAnchor1=new r,this.m_groundAnchor2=new r,this.m_localAnchor1=new r,this.m_localAnchor2=new r,this.m_u1=new r,this.m_u2=new r},S.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},S.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},S.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new r(t*this.m_impulse*this.m_u2.x,t*this.m_impulse*this.m_u2.y)},S.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),0},S.prototype.GetGroundAnchorA=function(){var t=this.m_ground.m_xf.position.Copy();return t.Add(this.m_groundAnchor1),t},S.prototype.GetGroundAnchorB=function(){var t=this.m_ground.m_xf.position.Copy();return t.Add(this.m_groundAnchor2),t},S.prototype.GetLength1=function(){var t=this.m_bodyA.GetWorldPoint(this.m_localAnchor1),e=this.m_ground.m_xf.position.x+this.m_groundAnchor1.x,i=this.m_ground.m_xf.position.y+this.m_groundAnchor1.y,n=t.x-e,o=t.y-i;return Math.sqrt(n*n+o*o)},S.prototype.GetLength2=function(){var t=this.m_bodyB.GetWorldPoint(this.m_localAnchor2),e=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x,i=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y,n=t.x-e,o=t.y-i;return Math.sqrt(n*n+o*o)},S.prototype.GetRatio=function(){return this.m_ratio},S.prototype.b2PulleyJoint=function(t){this.__super.b2Joint.call(this,t);this.m_ground=this.m_bodyA.m_world.m_groundBody,this.m_groundAnchor1.x=t.groundAnchorA.x-this.m_ground.m_xf.position.x,this.m_groundAnchor1.y=t.groundAnchorA.y-this.m_ground.m_xf.position.y,this.m_groundAnchor2.x=t.groundAnchorB.x-this.m_ground.m_xf.position.x,this.m_groundAnchor2.y=t.groundAnchorB.y-this.m_ground.m_xf.position.y,this.m_localAnchor1.SetV(t.localAnchorA),this.m_localAnchor2.SetV(t.localAnchorB),this.m_ratio=t.ratio,this.m_constant=t.lengthA+this.m_ratio*t.lengthB,this.m_maxLength1=o.Min(t.maxLengthA,this.m_constant-this.m_ratio*S.b2_minPulleyLength),this.m_maxLength2=o.Min(t.maxLengthB,(this.m_constant-S.b2_minPulleyLength)/this.m_ratio),this.m_impulse=0,this.m_limitImpulse1=0,this.m_limitImpulse2=0},S.prototype.InitVelocityConstraints=function(e){var i,n=this.m_bodyA,o=this.m_bodyB;i=n.m_xf.R;var r=this.m_localAnchor1.x-n.m_sweep.localCenter.x,s=this.m_localAnchor1.y-n.m_sweep.localCenter.y,a=i.col1.x*r+i.col2.x*s;s=i.col1.y*r+i.col2.y*s,r=a,i=o.m_xf.R;var l=this.m_localAnchor2.x-o.m_sweep.localCenter.x,c=this.m_localAnchor2.y-o.m_sweep.localCenter.y;a=i.col1.x*l+i.col2.x*c,c=i.col1.y*l+i.col2.y*c,l=a;var u=n.m_sweep.c.x+r,h=n.m_sweep.c.y+s,m=o.m_sweep.c.x+l,p=o.m_sweep.c.y+c,_=this.m_ground.m_xf.position.x+this.m_groundAnchor1.x,y=this.m_ground.m_xf.position.y+this.m_groundAnchor1.y,d=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x,v=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y;this.m_u1.Set(u-_,h-y),this.m_u2.Set(m-d,p-v);var g=this.m_u1.Length(),x=this.m_u2.Length();g>t.b2_linearSlop?this.m_u1.Multiply(1/g):this.m_u1.SetZero(),x>t.b2_linearSlop?this.m_u2.Multiply(1/x):this.m_u2.SetZero(),this.m_constant-g-this.m_ratio*x>0?(this.m_state=f.e_inactiveLimit,this.m_impulse=0):this.m_state=f.e_atUpperLimit,g<this.m_maxLength1?(this.m_limitState1=f.e_inactiveLimit,this.m_limitImpulse1=0):this.m_limitState1=f.e_atUpperLimit,x<this.m_maxLength2?(this.m_limitState2=f.e_inactiveLimit,this.m_limitImpulse2=0):this.m_limitState2=f.e_atUpperLimit;var b=r*this.m_u1.y-s*this.m_u1.x,C=l*this.m_u2.y-c*this.m_u2.x;if(this.m_limitMass1=n.m_invMass+n.m_invI*b*b,this.m_limitMass2=o.m_invMass+o.m_invI*C*C,this.m_pulleyMass=this.m_limitMass1+this.m_ratio*this.m_ratio*this.m_limitMass2,this.m_limitMass1=1/this.m_limitMass1,this.m_limitMass2=1/this.m_limitMass2,this.m_pulleyMass=1/this.m_pulleyMass,e.warmStarting){this.m_impulse*=e.dtRatio,this.m_limitImpulse1*=e.dtRatio,this.m_limitImpulse2*=e.dtRatio;var S=(-this.m_impulse-this.m_limitImpulse1)*this.m_u1.x,w=(-this.m_impulse-this.m_limitImpulse1)*this.m_u1.y,A=(-this.m_ratio*this.m_impulse-this.m_limitImpulse2)*this.m_u2.x,D=(-this.m_ratio*this.m_impulse-this.m_limitImpulse2)*this.m_u2.y;n.m_linearVelocity.x+=n.m_invMass*S,n.m_linearVelocity.y+=n.m_invMass*w,n.m_angularVelocity+=n.m_invI*(r*w-s*S),o.m_linearVelocity.x+=o.m_invMass*A,o.m_linearVelocity.y+=o.m_invMass*D,o.m_angularVelocity+=o.m_invI*(l*D-c*A)}else this.m_impulse=0,this.m_limitImpulse1=0,this.m_limitImpulse2=0},S.prototype.SolveVelocityConstraints=function(t){var e,i=this.m_bodyA,n=this.m_bodyB;e=i.m_xf.R;var r=this.m_localAnchor1.x-i.m_sweep.localCenter.x,s=this.m_localAnchor1.y-i.m_sweep.localCenter.y,a=e.col1.x*r+e.col2.x*s;s=e.col1.y*r+e.col2.y*s,r=a,e=n.m_xf.R;var l=this.m_localAnchor2.x-n.m_sweep.localCenter.x,c=this.m_localAnchor2.y-n.m_sweep.localCenter.y;a=e.col1.x*l+e.col2.x*c,c=e.col1.y*l+e.col2.y*c,l=a;var u=0,h=0,m=0,p=0,_=0,y=0,d=0,v=0,g=0,x=0,b=0;this.m_state==f.e_atUpperLimit&&(u=i.m_linearVelocity.x+-i.m_angularVelocity*s,h=i.m_linearVelocity.y+i.m_angularVelocity*r,m=n.m_linearVelocity.x+-n.m_angularVelocity*c,p=n.m_linearVelocity.y+n.m_angularVelocity*l,g=-(this.m_u1.x*u+this.m_u1.y*h)-this.m_ratio*(this.m_u2.x*m+this.m_u2.y*p),x=this.m_pulleyMass*-g,b=this.m_impulse,this.m_impulse=o.Max(0,this.m_impulse+x),x=this.m_impulse-b,_=-x*this.m_u1.x,y=-x*this.m_u1.y,d=-this.m_ratio*x*this.m_u2.x,v=-this.m_ratio*x*this.m_u2.y,i.m_linearVelocity.x+=i.m_invMass*_,i.m_linearVelocity.y+=i.m_invMass*y,i.m_angularVelocity+=i.m_invI*(r*y-s*_),n.m_linearVelocity.x+=n.m_invMass*d,n.m_linearVelocity.y+=n.m_invMass*v,n.m_angularVelocity+=n.m_invI*(l*v-c*d)),this.m_limitState1==f.e_atUpperLimit&&(u=i.m_linearVelocity.x+-i.m_angularVelocity*s,h=i.m_linearVelocity.y+i.m_angularVelocity*r,g=-(this.m_u1.x*u+this.m_u1.y*h),x=-this.m_limitMass1*g,b=this.m_limitImpulse1,this.m_limitImpulse1=o.Max(0,this.m_limitImpulse1+x),x=this.m_limitImpulse1-b,_=-x*this.m_u1.x,y=-x*this.m_u1.y,i.m_linearVelocity.x+=i.m_invMass*_,i.m_linearVelocity.y+=i.m_invMass*y,i.m_angularVelocity+=i.m_invI*(r*y-s*_)),this.m_limitState2==f.e_atUpperLimit&&(m=n.m_linearVelocity.x+-n.m_angularVelocity*c,p=n.m_linearVelocity.y+n.m_angularVelocity*l,g=-(this.m_u2.x*m+this.m_u2.y*p),x=-this.m_limitMass2*g,b=this.m_limitImpulse2,this.m_limitImpulse2=o.Max(0,this.m_limitImpulse2+x),x=this.m_limitImpulse2-b,d=-x*this.m_u2.x,v=-x*this.m_u2.y,n.m_linearVelocity.x+=n.m_invMass*d,n.m_linearVelocity.y+=n.m_invMass*v,n.m_angularVelocity+=n.m_invI*(l*v-c*d))},S.prototype.SolvePositionConstraints=function(e){void 0===e&&(e=0);var i,n=this.m_bodyA,r=this.m_bodyB,s=this.m_ground.m_xf.position.x+this.m_groundAnchor1.x,a=this.m_ground.m_xf.position.y+this.m_groundAnchor1.y,l=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x,c=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y,u=0,h=0,m=0,p=0,_=0,y=0,d=0,v=0,g=0,x=0,b=0,C=0,S=0,w=0;return this.m_state==f.e_atUpperLimit&&(i=n.m_xf.R,u=this.m_localAnchor1.x-n.m_sweep.localCenter.x,h=this.m_localAnchor1.y-n.m_sweep.localCenter.y,S=i.col1.x*u+i.col2.x*h,h=i.col1.y*u+i.col2.y*h,u=S,i=r.m_xf.R,m=this.m_localAnchor2.x-r.m_sweep.localCenter.x,p=this.m_localAnchor2.y-r.m_sweep.localCenter.y,S=i.col1.x*m+i.col2.x*p,p=i.col1.y*m+i.col2.y*p,m=S,_=n.m_sweep.c.x+u,y=n.m_sweep.c.y+h,d=r.m_sweep.c.x+m,v=r.m_sweep.c.y+p,this.m_u1.Set(_-s,y-a),this.m_u2.Set(d-l,v-c),g=this.m_u1.Length(),x=this.m_u2.Length(),g>t.b2_linearSlop?this.m_u1.Multiply(1/g):this.m_u1.SetZero(),x>t.b2_linearSlop?this.m_u2.Multiply(1/x):this.m_u2.SetZero(),b=this.m_constant-g-this.m_ratio*x,w=o.Max(w,-b),b=o.Clamp(b+t.b2_linearSlop,-t.b2_maxLinearCorrection,0),C=-this.m_pulleyMass*b,_=-C*this.m_u1.x,y=-C*this.m_u1.y,d=-this.m_ratio*C*this.m_u2.x,v=-this.m_ratio*C*this.m_u2.y,n.m_sweep.c.x+=n.m_invMass*_,n.m_sweep.c.y+=n.m_invMass*y,n.m_sweep.a+=n.m_invI*(u*y-h*_),r.m_sweep.c.x+=r.m_invMass*d,r.m_sweep.c.y+=r.m_invMass*v,r.m_sweep.a+=r.m_invI*(m*v-p*d),n.SynchronizeTransform(),r.SynchronizeTransform()),this.m_limitState1==f.e_atUpperLimit&&(i=n.m_xf.R,u=this.m_localAnchor1.x-n.m_sweep.localCenter.x,h=this.m_localAnchor1.y-n.m_sweep.localCenter.y,S=i.col1.x*u+i.col2.x*h,h=i.col1.y*u+i.col2.y*h,u=S,_=n.m_sweep.c.x+u,y=n.m_sweep.c.y+h,this.m_u1.Set(_-s,y-a),g=this.m_u1.Length(),g>t.b2_linearSlop?(this.m_u1.x*=1/g,this.m_u1.y*=1/g):this.m_u1.SetZero(),b=this.m_maxLength1-g,w=o.Max(w,-b),b=o.Clamp(b+t.b2_linearSlop,-t.b2_maxLinearCorrection,0),C=-this.m_limitMass1*b,_=-C*this.m_u1.x,y=-C*this.m_u1.y,n.m_sweep.c.x+=n.m_invMass*_,n.m_sweep.c.y+=n.m_invMass*y,n.m_sweep.a+=n.m_invI*(u*y-h*_),n.SynchronizeTransform()),this.m_limitState2==f.e_atUpperLimit&&(i=r.m_xf.R,m=this.m_localAnchor2.x-r.m_sweep.localCenter.x,p=this.m_localAnchor2.y-r.m_sweep.localCenter.y,S=i.col1.x*m+i.col2.x*p,p=i.col1.y*m+i.col2.y*p,m=S,d=r.m_sweep.c.x+m,v=r.m_sweep.c.y+p,this.m_u2.Set(d-l,v-c),x=this.m_u2.Length(),x>t.b2_linearSlop?(this.m_u2.x*=1/x,this.m_u2.y*=1/x):this.m_u2.SetZero(),b=this.m_maxLength2-x,w=o.Max(w,-b),b=o.Clamp(b+t.b2_linearSlop,-t.b2_maxLinearCorrection,0),C=-this.m_limitMass2*b,d=-C*this.m_u2.x,v=-C*this.m_u2.y,r.m_sweep.c.x+=r.m_invMass*d,r.m_sweep.c.y+=r.m_invMass*v,r.m_sweep.a+=r.m_invI*(m*v-p*d),r.SynchronizeTransform()),w<t.b2_linearSlop},n.postDefs.push(function(){n.Dynamics.Joints.b2PulleyJoint.b2_minPulleyLength=2}),n.inherit(w,n.Dynamics.Joints.b2JointDef),w.prototype.__super=n.Dynamics.Joints.b2JointDef.prototype,w.b2PulleyJointDef=function(){n.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.groundAnchorA=new r,this.groundAnchorB=new r,this.localAnchorA=new r,this.localAnchorB=new r},w.prototype.b2PulleyJointDef=function(){this.__super.b2JointDef.call(this),this.type=f.e_pulleyJoint,this.groundAnchorA.Set(-1,1),this.groundAnchorB.Set(1,1),this.localAnchorA.Set(-1,0),this.localAnchorB.Set(1,0),this.lengthA=0,this.maxLengthA=0,this.lengthB=0,this.maxLengthB=0,this.ratio=1,this.collideConnected=!0},w.prototype.Initialize=function(t,e,i,n,o,r,s){void 0===s&&(s=0),this.bodyA=t,this.bodyB=e,this.groundAnchorA.SetV(i),this.groundAnchorB.SetV(n),this.localAnchorA=this.bodyA.GetLocalPoint(o),this.localAnchorB=this.bodyB.GetLocalPoint(r);var a=o.x-i.x,l=o.y-i.y;this.lengthA=Math.sqrt(a*a+l*l);var c=r.x-n.x,u=r.y-n.y;this.lengthB=Math.sqrt(c*c+u*u),this.ratio=s;var h=this.lengthA+this.ratio*this.lengthB;this.maxLengthA=h-this.ratio*S.b2_minPulleyLength,this.maxLengthB=(h-S.b2_minPulleyLength)/this.ratio},n.inherit(A,n.Dynamics.Joints.b2Joint),A.prototype.__super=n.Dynamics.Joints.b2Joint.prototype,A.b2RevoluteJoint=function(){n.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.K=new e,this.K1=new e,this.K2=new e,this.K3=new e,this.impulse3=new s,this.impulse2=new r,this.reduced=new r,this.m_localAnchor1=new r,this.m_localAnchor2=new r,this.m_impulse=new s,this.m_mass=new i},A.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},A.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},A.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new r(t*this.m_impulse.x,t*this.m_impulse.y)},A.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),t*this.m_impulse.z},A.prototype.GetJointAngle=function(){return this.m_bodyB.m_sweep.a-this.m_bodyA.m_sweep.a-this.m_referenceAngle},A.prototype.GetJointSpeed=function(){return this.m_bodyB.m_angularVelocity-this.m_bodyA.m_angularVelocity},A.prototype.IsLimitEnabled=function(){return this.m_enableLimit};A.prototype.EnableLimit=function(t){this.m_enableLimit=t},A.prototype.GetLowerLimit=function(){return this.m_lowerAngle},A.prototype.GetUpperLimit=function(){return this.m_upperAngle},A.prototype.SetLimits=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.m_lowerAngle=t,this.m_upperAngle=e},A.prototype.IsMotorEnabled=function(){return this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor},A.prototype.EnableMotor=function(t){this.m_enableMotor=t},A.prototype.SetMotorSpeed=function(t){void 0===t&&(t=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=t},A.prototype.GetMotorSpeed=function(){return this.m_motorSpeed},A.prototype.SetMaxMotorTorque=function(t){void 0===t&&(t=0),this.m_maxMotorTorque=t},A.prototype.GetMotorTorque=function(){return this.m_maxMotorTorque},A.prototype.b2RevoluteJoint=function(t){this.__super.b2Joint.call(this,t),this.m_localAnchor1.SetV(t.localAnchorA),this.m_localAnchor2.SetV(t.localAnchorB),this.m_referenceAngle=t.referenceAngle,this.m_impulse.SetZero(),this.m_motorImpulse=0,this.m_lowerAngle=t.lowerAngle,this.m_upperAngle=t.upperAngle,this.m_maxMotorTorque=t.maxMotorTorque,this.m_motorSpeed=t.motorSpeed,this.m_enableLimit=t.enableLimit,this.m_enableMotor=t.enableMotor,this.m_limitState=f.e_inactiveLimit},A.prototype.InitVelocityConstraints=function(e){var i,n=this.m_bodyA,r=this.m_bodyB,s=0;this.m_enableMotor||this.m_enableLimit,i=n.m_xf.R;var a=this.m_localAnchor1.x-n.m_sweep.localCenter.x,l=this.m_localAnchor1.y-n.m_sweep.localCenter.y;s=i.col1.x*a+i.col2.x*l,l=i.col1.y*a+i.col2.y*l,a=s,i=r.m_xf.R;var c=this.m_localAnchor2.x-r.m_sweep.localCenter.x,u=this.m_localAnchor2.y-r.m_sweep.localCenter.y;s=i.col1.x*c+i.col2.x*u,u=i.col1.y*c+i.col2.y*u,c=s;var h=n.m_invMass,m=r.m_invMass,p=n.m_invI,_=r.m_invI;if(this.m_mass.col1.x=h+m+l*l*p+u*u*_,this.m_mass.col2.x=-l*a*p-u*c*_,this.m_mass.col3.x=-l*p-u*_,this.m_mass.col1.y=this.m_mass.col2.x,this.m_mass.col2.y=h+m+a*a*p+c*c*_,this.m_mass.col3.y=a*p+c*_,this.m_mass.col1.z=this.m_mass.col3.x,this.m_mass.col2.z=this.m_mass.col3.y,this.m_mass.col3.z=p+_,this.m_motorMass=1/(p+_),0==this.m_enableMotor&&(this.m_motorImpulse=0),this.m_enableLimit){var y=r.m_sweep.a-n.m_sweep.a-this.m_referenceAngle;o.Abs(this.m_upperAngle-this.m_lowerAngle)<2*t.b2_angularSlop?this.m_limitState=f.e_equalLimits:y<=this.m_lowerAngle?(this.m_limitState!=f.e_atLowerLimit&&(this.m_impulse.z=0),this.m_limitState=f.e_atLowerLimit):y>=this.m_upperAngle?(this.m_limitState!=f.e_atUpperLimit&&(this.m_impulse.z=0),this.m_limitState=f.e_atUpperLimit):(this.m_limitState=f.e_inactiveLimit,this.m_impulse.z=0)}else this.m_limitState=f.e_inactiveLimit;if(e.warmStarting){this.m_impulse.x*=e.dtRatio,this.m_impulse.y*=e.dtRatio,this.m_motorImpulse*=e.dtRatio;var d=this.m_impulse.x,v=this.m_impulse.y;n.m_linearVelocity.x-=h*d,n.m_linearVelocity.y-=h*v,n.m_angularVelocity-=p*(a*v-l*d+this.m_motorImpulse+this.m_impulse.z),r.m_linearVelocity.x+=m*d,r.m_linearVelocity.y+=m*v,r.m_angularVelocity+=_*(c*v-u*d+this.m_motorImpulse+this.m_impulse.z)}else this.m_impulse.SetZero(),this.m_motorImpulse=0},A.prototype.SolveVelocityConstraints=function(t){var e,i=this.m_bodyA,n=this.m_bodyB,r=0,s=0,a=0,l=0,c=0,u=i.m_linearVelocity,h=i.m_angularVelocity,m=n.m_linearVelocity,p=n.m_angularVelocity,_=i.m_invMass,y=n.m_invMass,d=i.m_invI,v=n.m_invI;if(this.m_enableMotor&&this.m_limitState!=f.e_equalLimits){var g=p-h-this.m_motorSpeed,x=this.m_motorMass*-g,b=this.m_motorImpulse,C=t.dt*this.m_maxMotorTorque;this.m_motorImpulse=o.Clamp(this.m_motorImpulse+x,-C,C),x=this.m_motorImpulse-b,h-=d*x,p+=v*x}if(this.m_enableLimit&&this.m_limitState!=f.e_inactiveLimit){e=i.m_xf.R,s=this.m_localAnchor1.x-i.m_sweep.localCenter.x,a=this.m_localAnchor1.y-i.m_sweep.localCenter.y,r=e.col1.x*s+e.col2.x*a,a=e.col1.y*s+e.col2.y*a,s=r,e=n.m_xf.R,l=this.m_localAnchor2.x-n.m_sweep.localCenter.x,c=this.m_localAnchor2.y-n.m_sweep.localCenter.y,r=e.col1.x*l+e.col2.x*c,c=e.col1.y*l+e.col2.y*c,l=r;var S=m.x+-p*c-u.x- -h*a,w=m.y+p*l-u.y-h*s,A=p-h;this.m_mass.Solve33(this.impulse3,-S,-w,-A),this.m_limitState==f.e_equalLimits?this.m_impulse.Add(this.impulse3):this.m_limitState==f.e_atLowerLimit?this.m_impulse.z+this.impulse3.z<0&&(this.m_mass.Solve22(this.reduced,-S,-w),this.impulse3.x=this.reduced.x,this.impulse3.y=this.reduced.y,this.impulse3.z=-this.m_impulse.z,this.m_impulse.x+=this.reduced.x,this.m_impulse.y+=this.reduced.y,this.m_impulse.z=0):this.m_limitState==f.e_atUpperLimit&&this.m_impulse.z+this.impulse3.z>0&&(this.m_mass.Solve22(this.reduced,-S,-w),this.impulse3.x=this.reduced.x,this.impulse3.y=this.reduced.y,this.impulse3.z=-this.m_impulse.z,this.m_impulse.x+=this.reduced.x,this.m_impulse.y+=this.reduced.y,this.m_impulse.z=0),u.x-=_*this.impulse3.x,u.y-=_*this.impulse3.y,h-=d*(s*this.impulse3.y-a*this.impulse3.x+this.impulse3.z),m.x+=y*this.impulse3.x,m.y+=y*this.impulse3.y,p+=v*(l*this.impulse3.y-c*this.impulse3.x+this.impulse3.z)}else{e=i.m_xf.R,s=this.m_localAnchor1.x-i.m_sweep.localCenter.x,a=this.m_localAnchor1.y-i.m_sweep.localCenter.y,r=e.col1.x*s+e.col2.x*a,a=e.col1.y*s+e.col2.y*a,s=r,e=n.m_xf.R,l=this.m_localAnchor2.x-n.m_sweep.localCenter.x,c=this.m_localAnchor2.y-n.m_sweep.localCenter.y,r=e.col1.x*l+e.col2.x*c,c=e.col1.y*l+e.col2.y*c,l=r;var D=m.x+-p*c-u.x- -h*a,M=m.y+p*l-u.y-h*s;this.m_mass.Solve22(this.impulse2,-D,-M),this.m_impulse.x+=this.impulse2.x,this.m_impulse.y+=this.impulse2.y,u.x-=_*this.impulse2.x,u.y-=_*this.impulse2.y,h-=d*(s*this.impulse2.y-a*this.impulse2.x),m.x+=y*this.impulse2.x,m.y+=y*this.impulse2.y,p+=v*(l*this.impulse2.y-c*this.impulse2.x)}i.m_linearVelocity.SetV(u),i.m_angularVelocity=h,n.m_linearVelocity.SetV(m),n.m_angularVelocity=p},A.prototype.SolvePositionConstraints=function(e){void 0===e&&(e=0);var i,n=0,r=this.m_bodyA,s=this.m_bodyB,a=0,l=0,c=0,u=0,h=0;if(this.m_enableLimit&&this.m_limitState!=f.e_inactiveLimit){var m=s.m_sweep.a-r.m_sweep.a-this.m_referenceAngle,p=0;this.m_limitState==f.e_equalLimits?(n=o.Clamp(m-this.m_lowerAngle,-t.b2_maxAngularCorrection,t.b2_maxAngularCorrection),p=-this.m_motorMass*n,a=o.Abs(n)):this.m_limitState==f.e_atLowerLimit?(n=m-this.m_lowerAngle,a=-n,n=o.Clamp(n+t.b2_angularSlop,-t.b2_maxAngularCorrection,0),p=-this.m_motorMass*n):this.m_limitState==f.e_atUpperLimit&&(n=m-this.m_upperAngle,a=n,n=o.Clamp(n-t.b2_angularSlop,0,t.b2_maxAngularCorrection),p=-this.m_motorMass*n),r.m_sweep.a-=r.m_invI*p,s.m_sweep.a+=s.m_invI*p,r.SynchronizeTransform(),s.SynchronizeTransform()}i=r.m_xf.R;var _=this.m_localAnchor1.x-r.m_sweep.localCenter.x,y=this.m_localAnchor1.y-r.m_sweep.localCenter.y;c=i.col1.x*_+i.col2.x*y,y=i.col1.y*_+i.col2.y*y,_=c,i=s.m_xf.R;var d=this.m_localAnchor2.x-s.m_sweep.localCenter.x,v=this.m_localAnchor2.y-s.m_sweep.localCenter.y;c=i.col1.x*d+i.col2.x*v,v=i.col1.y*d+i.col2.y*v,d=c;var g=s.m_sweep.c.x+d-r.m_sweep.c.x-_,x=s.m_sweep.c.y+v-r.m_sweep.c.y-y,b=g*g+x*x,C=Math.sqrt(b);l=C;var S=r.m_invMass,w=s.m_invMass,D=r.m_invI,M=s.m_invI,k=10*t.b2_linearSlop;if(b>k*k){var B=S+w,I=1/B;u=I*-g,h=I*-x;r.m_sweep.c.x-=.5*S*u,r.m_sweep.c.y-=.5*S*h,s.m_sweep.c.x+=.5*w*u,s.m_sweep.c.y+=.5*w*h,g=s.m_sweep.c.x+d-r.m_sweep.c.x-_,x=s.m_sweep.c.y+v-r.m_sweep.c.y-y}return this.K1.col1.x=S+w,this.K1.col2.x=0,this.K1.col1.y=0,this.K1.col2.y=S+w,this.K2.col1.x=D*y*y,this.K2.col2.x=-D*_*y,this.K2.col1.y=-D*_*y,this.K2.col2.y=D*_*_,this.K3.col1.x=M*v*v,this.K3.col2.x=-M*d*v,this.K3.col1.y=-M*d*v,this.K3.col2.y=M*d*d,this.K.SetM(this.K1),this.K.AddM(this.K2),this.K.AddM(this.K3),this.K.Solve(A.tImpulse,-g,-x),u=A.tImpulse.x,h=A.tImpulse.y,r.m_sweep.c.x-=r.m_invMass*u,r.m_sweep.c.y-=r.m_invMass*h,r.m_sweep.a-=r.m_invI*(_*h-y*u),s.m_sweep.c.x+=s.m_invMass*u,s.m_sweep.c.y+=s.m_invMass*h,s.m_sweep.a+=s.m_invI*(d*h-v*u),r.SynchronizeTransform(),s.SynchronizeTransform(),l<=t.b2_linearSlop&&a<=t.b2_angularSlop},n.postDefs.push(function(){n.Dynamics.Joints.b2RevoluteJoint.tImpulse=new r}),n.inherit(D,n.Dynamics.Joints.b2JointDef),D.prototype.__super=n.Dynamics.Joints.b2JointDef.prototype,D.b2RevoluteJointDef=function(){n.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.localAnchorA=new r,this.localAnchorB=new r},D.prototype.b2RevoluteJointDef=function(){this.__super.b2JointDef.call(this),this.type=f.e_revoluteJoint,this.localAnchorA.Set(0,0),this.localAnchorB.Set(0,0),this.referenceAngle=0,this.lowerAngle=0,this.upperAngle=0,this.maxMotorTorque=0,this.motorSpeed=0,this.enableLimit=!1,this.enableMotor=!1},D.prototype.Initialize=function(t,e,i){this.bodyA=t,this.bodyB=e,this.localAnchorA=this.bodyA.GetLocalPoint(i),this.localAnchorB=this.bodyB.GetLocalPoint(i),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()},n.inherit(M,n.Dynamics.Joints.b2Joint),M.prototype.__super=n.Dynamics.Joints.b2Joint.prototype,M.b2WeldJoint=function(){n.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_localAnchorA=new r,this.m_localAnchorB=new r,this.m_impulse=new s,this.m_mass=new i},M.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA)},M.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB)},M.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new r(t*this.m_impulse.x,t*this.m_impulse.y)},M.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),t*this.m_impulse.z},M.prototype.b2WeldJoint=function(t){this.__super.b2Joint.call(this,t),this.m_localAnchorA.SetV(t.localAnchorA),this.m_localAnchorB.SetV(t.localAnchorB),this.m_referenceAngle=t.referenceAngle,this.m_impulse.SetZero(),this.m_mass=new i},M.prototype.InitVelocityConstraints=function(t){var e,i=0,n=this.m_bodyA,o=this.m_bodyB;e=n.m_xf.R;var r=this.m_localAnchorA.x-n.m_sweep.localCenter.x,s=this.m_localAnchorA.y-n.m_sweep.localCenter.y;i=e.col1.x*r+e.col2.x*s,s=e.col1.y*r+e.col2.y*s,r=i,e=o.m_xf.R;var a=this.m_localAnchorB.x-o.m_sweep.localCenter.x,l=this.m_localAnchorB.y-o.m_sweep.localCenter.y;i=e.col1.x*a+e.col2.x*l,l=e.col1.y*a+e.col2.y*l,a=i;var c=n.m_invMass,u=o.m_invMass,h=n.m_invI,m=o.m_invI;this.m_mass.col1.x=c+u+s*s*h+l*l*m,this.m_mass.col2.x=-s*r*h-l*a*m,this.m_mass.col3.x=-s*h-l*m,this.m_mass.col1.y=this.m_mass.col2.x,this.m_mass.col2.y=c+u+r*r*h+a*a*m,this.m_mass.col3.y=r*h+a*m,this.m_mass.col1.z=this.m_mass.col3.x,this.m_mass.col2.z=this.m_mass.col3.y,this.m_mass.col3.z=h+m,t.warmStarting?(this.m_impulse.x*=t.dtRatio,this.m_impulse.y*=t.dtRatio,this.m_impulse.z*=t.dtRatio,n.m_linearVelocity.x-=c*this.m_impulse.x,n.m_linearVelocity.y-=c*this.m_impulse.y,n.m_angularVelocity-=h*(r*this.m_impulse.y-s*this.m_impulse.x+this.m_impulse.z),o.m_linearVelocity.x+=u*this.m_impulse.x,o.m_linearVelocity.y+=u*this.m_impulse.y,o.m_angularVelocity+=m*(a*this.m_impulse.y-l*this.m_impulse.x+this.m_impulse.z)):this.m_impulse.SetZero()},M.prototype.SolveVelocityConstraints=function(t){var e,i=0,n=this.m_bodyA,o=this.m_bodyB,r=n.m_linearVelocity,a=n.m_angularVelocity,l=o.m_linearVelocity,c=o.m_angularVelocity,u=n.m_invMass,h=o.m_invMass,m=n.m_invI,p=o.m_invI;e=n.m_xf.R;var f=this.m_localAnchorA.x-n.m_sweep.localCenter.x,_=this.m_localAnchorA.y-n.m_sweep.localCenter.y;i=e.col1.x*f+e.col2.x*_,_=e.col1.y*f+e.col2.y*_,f=i,e=o.m_xf.R;var y=this.m_localAnchorB.x-o.m_sweep.localCenter.x,d=this.m_localAnchorB.y-o.m_sweep.localCenter.y;i=e.col1.x*y+e.col2.x*d,d=e.col1.y*y+e.col2.y*d,y=i;var v=l.x-c*d-r.x+a*_,g=l.y+c*y-r.y-a*f,x=c-a,b=new s;this.m_mass.Solve33(b,-v,-g,-x),this.m_impulse.Add(b),r.x-=u*b.x,r.y-=u*b.y,a-=m*(f*b.y-_*b.x+b.z),l.x+=h*b.x,l.y+=h*b.y,c+=p*(y*b.y-d*b.x+b.z),n.m_angularVelocity=a,o.m_angularVelocity=c},M.prototype.SolvePositionConstraints=function(e){void 0===e&&(e=0);var i,n=0,r=this.m_bodyA,a=this.m_bodyB;i=r.m_xf.R;var l=this.m_localAnchorA.x-r.m_sweep.localCenter.x,c=this.m_localAnchorA.y-r.m_sweep.localCenter.y;n=i.col1.x*l+i.col2.x*c,c=i.col1.y*l+i.col2.y*c,l=n,i=a.m_xf.R;var u=this.m_localAnchorB.x-a.m_sweep.localCenter.x,h=this.m_localAnchorB.y-a.m_sweep.localCenter.y;n=i.col1.x*u+i.col2.x*h,h=i.col1.y*u+i.col2.y*h,u=n;var m=r.m_invMass,p=a.m_invMass,f=r.m_invI,_=a.m_invI,y=a.m_sweep.c.x+u-r.m_sweep.c.x-l,d=a.m_sweep.c.y+h-r.m_sweep.c.y-c,v=a.m_sweep.a-r.m_sweep.a-this.m_referenceAngle,g=10*t.b2_linearSlop,x=Math.sqrt(y*y+d*d),b=o.Abs(v);x>g&&(f*=1,_*=1),this.m_mass.col1.x=m+p+c*c*f+h*h*_,this.m_mass.col2.x=-c*l*f-h*u*_,this.m_mass.col3.x=-c*f-h*_,this.m_mass.col1.y=this.m_mass.col2.x,this.m_mass.col2.y=m+p+l*l*f+u*u*_,this.m_mass.col3.y=l*f+u*_,this.m_mass.col1.z=this.m_mass.col3.x,this.m_mass.col2.z=this.m_mass.col3.y,this.m_mass.col3.z=f+_;var C=new s;return this.m_mass.Solve33(C,-y,-d,-v),r.m_sweep.c.x-=m*C.x,r.m_sweep.c.y-=m*C.y,r.m_sweep.a-=f*(l*C.y-c*C.x+C.z),a.m_sweep.c.x+=p*C.x,a.m_sweep.c.y+=p*C.y,a.m_sweep.a+=_*(u*C.y-h*C.x+C.z),r.SynchronizeTransform(),a.SynchronizeTransform(),x<=t.b2_linearSlop&&b<=t.b2_angularSlop},n.inherit(k,n.Dynamics.Joints.b2JointDef),k.prototype.__super=n.Dynamics.Joints.b2JointDef.prototype,k.b2WeldJointDef=function(){n.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.localAnchorA=new r,this.localAnchorB=new r},k.prototype.b2WeldJointDef=function(){this.__super.b2JointDef.call(this),this.type=f.e_weldJoint,this.referenceAngle=0},k.prototype.Initialize=function(t,e,i){this.bodyA=t,this.bodyB=e,this.localAnchorA.SetV(this.bodyA.GetLocalPoint(i)),this.localAnchorB.SetV(this.bodyB.GetLocalPoint(i)),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()}}(),function(){var t=n.Dynamics.b2DebugDraw;t.b2DebugDraw=function(){this.m_drawScale=1,this.m_lineThickness=1,this.m_alpha=1,this.m_fillAlpha=1,this.m_xformScale=1;var t=this;this.m_sprite={graphics:{clear:function(){t.m_ctx.clearRect(0,0,t.m_ctx.canvas.width,t.m_ctx.canvas.height)}}}},t.prototype._color=function(t,e){return"rgba("+((16711680&t)>>16)+","+((65280&t)>>8)+","+(255&t)+","+e+")"},t.prototype.b2DebugDraw=function(){this.m_drawFlags=0},t.prototype.SetFlags=function(t){void 0===t&&(t=0),this.m_drawFlags=t},t.prototype.GetFlags=function(){return this.m_drawFlags},t.prototype.AppendFlags=function(t){void 0===t&&(t=0),this.m_drawFlags|=t},t.prototype.ClearFlags=function(t){void 0===t&&(t=0),this.m_drawFlags&=~t},t.prototype.SetSprite=function(t){this.m_ctx=t},t.prototype.GetSprite=function(){return this.m_ctx},t.prototype.SetDrawScale=function(t){void 0===t&&(t=0),this.m_drawScale=t},t.prototype.GetDrawScale=function(){return this.m_drawScale},t.prototype.SetLineThickness=function(t){void 0===t&&(t=0),this.m_lineThickness=t,this.m_ctx.strokeWidth=t},t.prototype.GetLineThickness=function(){return this.m_lineThickness},t.prototype.SetAlpha=function(t){void 0===t&&(t=0),this.m_alpha=t},t.prototype.GetAlpha=function(){return this.m_alpha},t.prototype.SetFillAlpha=function(t){void 0===t&&(t=0),this.m_fillAlpha=t},t.prototype.GetFillAlpha=function(){return this.m_fillAlpha},t.prototype.SetXFormScale=function(t){void 0===t&&(t=0),this.m_xformScale=t},t.prototype.GetXFormScale=function(){return this.m_xformScale},t.prototype.DrawPolygon=function(t,e,i){if(e){var n=this.m_ctx,o=this.m_drawScale;n.beginPath(),n.strokeStyle=this._color(i.color,this.m_alpha),n.moveTo(t[0].x*o,t[0].y*o);for(var r=1;r<e;r++)n.lineTo(t[r].x*o,t[r].y*o);n.lineTo(t[0].x*o,t[0].y*o),n.closePath(),n.stroke()}},t.prototype.DrawSolidPolygon=function(t,e,i){if(e){var n=this.m_ctx,o=this.m_drawScale;n.beginPath(),n.strokeStyle=this._color(i.color,this.m_alpha),n.fillStyle=this._color(i.color,this.m_fillAlpha),n.moveTo(t[0].x*o,t[0].y*o);for(var r=1;r<e;r++)n.lineTo(t[r].x*o,t[r].y*o);n.lineTo(t[0].x*o,t[0].y*o),n.closePath(),n.fill(),n.stroke()}},t.prototype.DrawCircle=function(t,e,i){if(e){var n=this.m_ctx,o=this.m_drawScale;n.beginPath(),n.strokeStyle=this._color(i.color,this.m_alpha),n.arc(t.x*o,t.y*o,e*o,0,2*Math.PI,!0),n.closePath(),n.stroke()}},t.prototype.DrawSolidCircle=function(t,e,i,n){if(e){var o=this.m_ctx,r=this.m_drawScale,s=t.x*r,a=t.y*r;o.moveTo(0,0),o.beginPath(),o.strokeStyle=this._color(n.color,this.m_alpha),o.fillStyle=this._color(n.color,this.m_fillAlpha),o.arc(s,a,e*r,0,2*Math.PI,!0),o.moveTo(s,a),o.lineTo((t.x+i.x*e)*r,(t.y+i.y*e)*r),o.closePath(),o.fill(),o.stroke()}},t.prototype.DrawSegment=function(t,e,i){var n=this.m_ctx,o=this.m_drawScale;n.strokeStyle=this._color(i.color,this.m_alpha),n.beginPath(),n.moveTo(t.x*o,t.y*o),n.lineTo(e.x*o,e.y*o),n.closePath(),n.stroke()},t.prototype.DrawTransform=function(t){var e=this.m_ctx,i=this.m_drawScale;e.beginPath(),e.strokeStyle=this._color(16711680,this.m_alpha),e.moveTo(t.position.x*i,t.position.y*i),e.lineTo((t.position.x+this.m_xformScale*t.R.col1.x)*i,(t.position.y+this.m_xformScale*t.R.col1.y)*i),e.strokeStyle=this._color(65280,this.m_alpha),e.moveTo(t.position.x*i,t.position.y*i),e.lineTo((t.position.x+this.m_xformScale*t.R.col2.x)*i,(t.position.y+this.m_xformScale*t.R.col2.y)*i),e.closePath(),e.stroke()}}();var s;for(s=0;s<n.postDefs.length;++s)n.postDefs[s]();t.exports=n},function(t,e,i){i(12),Crafty.c("PlayerParticles",{init:function(){this.requires("BattleParticles")},playerParticles:function(){return this}})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(11),o={name:"bayou",filepath:n.IMG_BG_BAYOU,width:800,height:336,css:"url("+n.IMG_BG_BAYOU+") center center / 110% no-repeat rgb(255, 255, 255)",offsetX:"center",offsetY:"center",size:"110%",color:"rgb(255,255,255)"};e.default=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(22),o={spriteId:"player_zero",spriteFrame:"plz_st0",animationComponent:"BattlePlayerZeroAnimation",width:80,height:72,hitbox:[20,0,45,0,45,75,20,75],charSheet:{name:"player 1",properties:{blunt:1,slashing:1,piercing:1,fire:1,earth:1,water:1,air:1,light:1,dark:1,poison:1,life:1,death:1},stats:{level:1,str:1,spd:1,sta:1,dex:1,int:1,cha:1,wis:1},skills:[n.ZeroLightSlash,n.ZeroMedSlash,n.ZeroHardSlash,n.ZeroUpperSlash]}};e.default=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(24),o=i(5),r=i(3);i.d(e,"ZeroLightSlash",function(){return s}),i.d(e,"ZeroMedSlash",function(){return a}),i.d(e,"ZeroHardSlash",function(){return l}),i.d(e,"ZeroUpperSlash",function(){return c});var s={effects:[{klass:n.Damage,properties:{blunt:0,slashing:2,piercing:0,fire:0,earth:0,water:0,air:0,light:0,dark:0,poison:0,life:0,death:0}},{klass:n.TriggerAnimation,target:"self",animation:o.ANIM_LIGHT_ATTACK},{klass:n.TriggerAnimation,animation:o.ANIM_HIT},{klass:n.SetCooldown,target:"self",cooldownLength:700},{klass:n.PlaySound,soundId:r.SOUND_SWORD_SLASH}],cost:0,name:"light slash",textOptions:{minLength:4,maxLength:7}},a={effects:[{klass:n.Damage,properties:{blunt:0,slashing:3,piercing:0,fire:0,earth:0,water:0,air:0,light:0,dark:0,poison:0,life:0,death:0}},{klass:n.TriggerAnimation,target:"self",animation:o.ANIM_MED_ATTACK},{klass:n.TriggerAnimation,animation:o.ANIM_HIT},{klass:n.SetCooldown,target:"self",cooldownLength:2e3},{klass:n.PlaySound,soundId:r.SOUND_SWORD_SLASH}],cost:0,name:"medium slash",textOptions:{minLength:6,maxLength:9}},l={effects:[{klass:n.Damage,properties:{blunt:0,slashing:4,piercing:0,fire:0,earth:0,water:0,air:0,light:0,dark:0,poison:0,life:0,death:0}},{klass:n.TriggerAnimation,target:"self",animation:o.ANIM_HEAVY_ATTACK},{klass:n.TriggerAnimation,animation:o.ANIM_HIT},{klass:n.SetCooldown,target:"self",cooldownLength:5e3},{klass:n.PlaySound,soundId:r.SOUND_SWORD_SLASH}],cost:0,name:"heavy slash",textOptions:{minLength:8,maxLength:20}},c={effects:[{klass:n.Damage,properties:{blunt:0,slashing:3,piercing:0,fire:0,earth:0,water:0,air:0,light:0,dark:0,poison:0,life:0,death:0}},{klass:n.TriggerAnimation,target:"self",animation:o.ANIM_SPECIAL_ATTACK},{klass:n.TriggerAnimation,animation:o.ANIM_HIT},{klass:n.SetCooldown,target:"self",cooldownLength:2200},{klass:n.PlaySound,soundId:r.SOUND_SWORD_SLASH}],cost:0,name:"upper slash",textOptions:{minLength:5,maxLength:13}}},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r={id:null,name:"please enter a name",status:{hp:20,maxHp:20},stats:{level:0,str:0,spd:0,sta:0,dex:0,int:0,cha:0,wis:0},properties:{blunt:0,slashing:0,piercing:0,fire:0,earth:0,water:0,air:0,light:0,dark:0,poison:0,life:0,death:0},skills:[],vocabulary:""},s=function(){function t(e){n(this,t),this._data=_.merge({},r,e)}return o(t,[{key:"packaged",value:function(){return{id:this.get("id"),name:this.get("name"),status:this.get("status"),stats:this.get("stats"),skills:this.get("skills")}}},{key:"data",get:function(){return this._data},set:function(t){this._data=t}}]),t}();e.default=s},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){var i,n;i=_.reduce(e,function(t,e,i){return t+e},0),t.hp=t.hp-i,n=new Function("entity","let new_health, old_health;old_health = entity.getHP();new_health = old_health - "+i+";entity.setHP(new_health);"),t.getEffectQueue().push(n)}function r(t,e){var i;i=t.body.GetWorldCenter(),t.body.ApplyForce(e,i)}function s(t,e){var i={};if(t.charSheet)return _.each(t.charSheet.data.properties,function(t,n){var o=void 0;o=e[n]-t,i[n]=o<0?0:o}),i}function a(t,e){return Crafty.e("2D, DOM, Collision, TextFragment, TextFragmentAttackDisplay, DefendableAttack, Box2D, TriggerableEffectOnCollide, BattleProjectile, BattlePhysicsProjectile").attr({x:e.source._x,y:e.source._y-20,z:e.source._z+1,h:20,w:20}).textFragment(t).textFragmentAttackDisplay().defendableAttack({source:e.source,target:e.target,effects:e.effects}).collision().battleProjectile().box2d(e.box2d).triggerableEffectOnCollide({source:e.source,target:e.target,effects:e.effects,targetComponent:"BattlePlayer"})}function l(t){var e,i,n;for(t.minLength&&t.maxLength?i=t.minLength==t.maxLength?t.minLength:_.random(t.minLength,t.maxLength):t.minLength?i=_.random(t.minLength,100):t.maxLength&&(i=_.random(1,t.maxLength)),n="",e=0;e<i;e++)n+=_.sample(d);return n}function c(t,e){return p.default.retrieve(t.getVocabulary(),e)}function u(t){return"self"==t.target&&(t.target=t.source),t}function h(t){t.has("BattleParticles")&&t.triggerParticles()}function m(t,e){if(!e)throw new Error(t+" being executed without a target")}Object.defineProperty(e,"__esModule",{value:!0});var p=i(6);i.d(e,"Damage",function(){return v}),i.d(e,"PlaySound",function(){return g}),i.d(e,"ScreenShake",function(){return b}),i.d(e,"SetCooldown",function(){return x}),i.d(e,"SpawnTextProjectile",function(){return w}),i.d(e,"SpawnScatterTextProjectilePhysics",function(){return C}),i.d(e,"SpawnTextProjectilePhysics",function(){return S}),i.d(e,"TriggerAnimation",function(){return A});var f=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),y=i(18);i(7),i(41),i(40),i(39),i(14),i(42),i(38),i(43),i(19);var d=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],v=function(){function t(){n(this,t)}return f(t,null,[{key:"execute",value:function(t){var e;if(m("EffectDamage",t.target),!t.target.has("BattleCharacter"))throw new Error("EffectDamage being executed without a valid target");t=u(t),e=s(t.target,t.properties),o(t.target,e),h(t.target)}}]),t}(),g=function(){function t(){n(this,t)}return f(t,null,[{key:"execute",value:function(t){t.soundId&&(t.delay||Crafty.trigger("PlaySound",t.soundId))}}]),t}(),x=function(){function t(){n(this,t)}return f(t,null,[{key:"execute",value:function(t){var e;m("EffectSetCooldown",t.target),t=u(t),e=_.merge({},t),setTimeout(function(){e.skill.prepare()},t.cooldownLength)}}]),t}(),b=function(){function t(){n(this,t)}return f(t,null,[{key:"execute",value:function(t){window.camera.shake(t)}}]),t}(),C=function(){function t(){n(this,t)}return f(t,null,[{key:"execute",value:function(t){var e,i,n;if(!t.count)throw new Error("Error, attempting to SpawnScatterTextProjectilePhysics without a count");for(m("SpawnScatterTextProjectilePhysics",t.target),e=0;e<t.count;e++)n=t.textOptions.randomString?l(t.textOptions):c(t.source,t.textOptions),i=a(n,t),r(i,this.getRandomForceVectorToHit())}},{key:"getRandomForceVectorToHit",value:function(){var t,e;return t=_.random(-9300,-15e3),e=_.random(-12e3,-26e3),new y.Common.Math.b2Vec2(t,e)}}]),t}(),S=function(){function t(){n(this,t)}return f(t,null,[{key:"execute",value:function(t){var e,i;return m("EffectSpawnTextProjectilePhysics",t.target),e=c(t.source,t.textOptions),i=a(e,t),r(i,this.getRandomForceVectorToHit()),i}},{key:"getRandomForceVectorToHit",value:function(){var t,e;return t=_.random(-9300,-15e3),e=_.random(-12e3,-26e3),new y.Common.Math.b2Vec2(t,e)}}]),t}(),w=function(){function t(){n(this,t)}return f(t,null,[{key:"execute",value:function(t){var e;return m("EffectSpawnTextProjectile",t.target),e=c(t.source,t.textOptions),Crafty.e("2D, DOM, Collision, TextFragment, TextFragmentAttackDisplay, DefendableAttack, BattleProjectile, BattleNPCProjectile, TriggerableEffectOnCollide").attr({x:t.source._x,y:t.source._y-20,z:t.source._z+1,h:10,w:10}).textFragment(e).textFragmentAttackDisplay().defendableAttack().collision().battleProjectile().battleNPCProjectile(t.positionFunction,t.speed).triggerableEffectOnCollide({source:t.source,target:t.target,effects:t.effects,targetComponent:"BattlePlayer"})}}]),t}(),A=function(){function t(){n(this,t)}return f(t,null,[{key:"execute",value:function(t){if(m("EffectTriggerAnimation",t.target),t=u(t),!t.target.has("SpriteAnimation"))throw new Error("EffectTriggerAnimation being executed without a valid target");t.target.playAnim(t.animation)}}]),t}()},function(t,e,i){"use strict";function n(t,e){var i,n=e.audioData;i=t.e("AudioManager").audioManager(),i.getAudioQueue(),a(n.sounds),s(i)}function o(t){var e,i,n;e=t("AudioManager"),0!=e.length&&(i=e.getAudioQueue(),0!=i.length&&(n=i.pop(),t.audio.play(n)))}function r(t){t("AudioManager").destroy()}function s(t){Crafty.bind("PlaySound",l.bind(t.getAudioQueue()))}function a(t){_.each(t,function(t){Crafty.audio.add(t,c.SOUNDS[t])})}function l(t){this.push(t)}Object.defineProperty(e,"__esModule",{value:!0});var c=i(3);e.initAudioSystem=n,e.audioSystem=o,e.teardownAudioSystem=r,i(45)},function(t,e,i){"use strict";function n(t){}function o(t){var e;e=t("BattleEffectable").get(),_.each(e,function(t){r(t)})}function r(t){var e;for(e=t.getEffectQueue();;){var i=void 0;if(_.isEmpty(e)||e.length<1)return;i=e.pop(),i(t),t.setStatusDirty()}}Object.defineProperty(e,"__esModule",{value:!0}),e.initBattleEffectSystem=n,e.battleEffectSystem=o},function(t,e,i){"use strict";function n(t){var e,i;i=t.e("BattleStatusBarView").battleStatusBarView(),e=t("BattleStatus").get(),_.each(e,function(e){var n;e.renderStatus(),i.getView().insertChild(e.getStatusView()),n=t.e("ModeIcon, 2D, DOM").attr({x:e._x+16,y:e._y+u,w:32,h:32}),e.attach(n),s(e),e.bind("Remove",function(){this.getStatusView().remove()})}),i.render()}function o(t){var e;e=t("BattleStatus").get(),_.each(e,function(t){t.isStatusDirty()&&(t.renderStatus(),s(t),t.resetStatusDirty())})}function r(t){var e,i;e=t("BattleStatusBarView"),i=e.getView(),i.cleanupChildViews(),i.remove(),e._view=null,e.destroy()}function s(t){var e,i,n;(e=_.find(t._children,function(t){return t.has&&t.has("ModeIcon")}))&&(i=l(t.getStance()),n=a(i),$(e._element).html(n))}function a(t){return'<img class="battle-status-icon battle-character-stance" src="'+t+'"></img>'}function l(t){switch(t){case"offense":return c.ICON_CROSSED_SWORDS;case"defense":default:return c.ICON_CHECKED_SHIELD}}Object.defineProperty(e,"__esModule",{value:!0});var c=i(11);e.initBattleStatusSystem=n,e.battleStatusSystem=o,e.teardownBattleStatusSystem=r,i(47);var u=-40},function(t,e,i){"use strict";function n(){}function o(t){var e,i;e=t("TextFragment DefendableAttack").get(),i=_.filter(e,function(t){return t.isComplete()}),_.each(i,function(t){r(t.getTarget()),s(t)})}function r(t){t.has("SpriteAnimation")&&t.playAnim(a.ANIM_GUARD)}function s(t){t.destroy()}Object.defineProperty(e,"__esModule",{value:!0});var a=i(5);e.initDefendableSkillSystem=n,e.defendableSkillSystem=o},function(t,e,i){"use strict";function n(t){t("BattlePlayer").addComponent("BattleInput").battleInput()}function o(t){var e,i,n,o;e=t("BattleInput BattleStance").get(),e.length<1||(i=e[0],n=i.getInputQueue(),0!=n.length&&(n.forEach(function(t){f(t,i)||(o=c(i),o=h(o),o=m(o),o=p(o),y(t,o))}),i.clearInputQueue()))}function r(){var t;t=u(Crafty("TextFragment").get()),t.forEach(function(t){t.cancel()})}function s(t){r(),t.toggleStance(),t.setStatusDirty()}function a(){return Crafty("TextFragment BattlePCSkill").get()}function l(){return Crafty("TextFragment DefendableAttack").get()}function c(t){if(t.isStance("offense"))return a();if(t.isStance("defense"))return l();throw new Error("Input entity is in an invalid stance")}function u(t){return _.filter(t,function(t){return t.isActive()})}function h(t){return _.filter(t,function(t){return!t.isComplete()})}function m(t){return _.filter(t,function(t){return!t.isCooling()})}function p(t){return _.filter(t,function(t){return!t.isProcessed()})}function f(t,e){switch(t){case d.CMD_CHANGE_STANCE:return s(e),!0;default:return!1}}function y(t,e){var i,n,o;if(i=u(e),_.isEmpty(i))return o=_.filter(e,function(e){return e.matchFirstChar(t)}),void o.forEach(function(e){e.activate(),e.acceptInput(t)});if(1==i.length)return void i[0].acceptInput(t);if(n=_.filter(i,function(e){return e.matchNextChar(t)}),0==n.length);else{if(!(n.length>=1))throw new Error("Error, something funky is going on here....");i.forEach(function(e){e.matchNextChar(t)?e.acceptInput(t):e.cancel()})}}Object.defineProperty(e,"__esModule",{value:!0});var d=i(16);e.initInputSystem=n,e.inputSystem=o,i(46)},function(t,e,i){"use strict";function n(t){var e;e=t("BattleNPCSkill").get(),_.each(e,function(t){t.activate(),setTimeout(function(){t.prepare()},t.getSkillDef().startupDelay)})}function o(t){var e;e=t("BattleNPCBrain BattleNPCSkillManager").get(),_.each(e,function(t){var e;e=r(t),e.length<1||_.each(e,function(e){t.getSkillQueue().push(e)})})}function r(t){return _.filter(t.getSkills(),function(t){return t.isReady()})}Object.defineProperty(e,"__esModule",{value:!0}),e.initNPCAISystem=n,e.nPCAISystem=o},function(t,e,i){"use strict";function n(t){var e;e=t("BattleNPCSkillManager").get(),_.each(e,function(t){c(t),l(t),u(t)}),r(e)}function o(t){var e=t("BattleNPCSkillManager").get();_.each(e,function(t){var e;e=t.getSkillQueue(),e.length<1||(_.each(e,function(e){e.activate(),a(t,e)}),t.setSkillQueue([]))})}function r(t){_.each(t,function(t){t.bind("Remove",function(){console.log("DEBUG: IN THE REMOVE CALLBACK OF NPCSKLL MANAGER...."),_.each(t.getSkills(),function(t){t.destroy()}),t._skills=null,t._skillset=null,t._skillQueue=null})})}function s(t){return Crafty.e("BattleNPCSkill").battleNPCSkill(t)}function a(t,e){var i;i=t.getTarget(),_.each(e.getSkillDef().effects,function(n){var o,r,s;o=n.klass,r=n,s={target:i,source:t,skill:e},s=_.merge(s,r),o.execute(s)})}function l(t){var e,i;e=t.getSkillset(),i=[],_.each(e,function(t){i.push(s(t))}),t.setSkills(i)}function c(t){var e=t.charSheet.data.skills;!e||e.length<1||t.setSkillset(e)}function u(t){t.setSkillQueue([])}Object.defineProperty(e,"__esModule",{value:!0}),e.initNPCSkillSystem=n,e.npcSkillSystem=o},function(t,e,i){"use strict";function n(t){var e,i;e=t("BattlePlayer"),e.addComponent("PlayerParticles").playerParticles(),i=t("BattleNPC"),i.addComponent("NPCParticles").nPCParticles(),r()}function o(t){var e;e=t("BattleParticles").get(),_.each(e,function(t){t.needTriggerParticles()&&l(t),s(t)})}function r(){Crafty("BattleParticles").bind("Remove",function(){_.each(this.getParticleBuffer(),function(t){t.destroy()}),this._particleBuffer=null})}function s(t){var e;e=t.getParticleBuffer(),_.each(e,function(t){Crafty.frame()-t.getStartFrame()>=m&&(t.destroy(),t.setDestroyFlag(!0))}),_.remove(e,function(t){return t.getDestroyFlag()}),t.setParticleBuffer(e)}function a(t){return t.e("2D, Canvas, ParticleSource, Particles").particleSource(t.frame())}function l(t){var e;if(t._triggerParticles=!1,e=a(Crafty),e.attr({x:t._x,y:t._y,w:10,h:10}),t.attach(e),t.getParticleBuffer().push(e),t.has("PlayerParticles"))e.particles(c);else{if(!t.has("NPCParticles"))return void console.log("DEBUG: ERROR: some unknown entity has BattleParticles attached");e.particles(u)}}Object.defineProperty(e,"__esModule",{value:!0});i(51);e.initParticleSystem=n,e.particleSystem=o,i(19),i(48),i(49);var c,u,h={maxParticles:150,size:18,sizeRandom:4,speed:3,speedRandom:1.2,lifeSpan:29,lifeSpanRandom:25,angle:270,angleRandom:34,startColour:[255,131,0,1],startColourRandom:[48,50,45,0],endColour:[245,35,0,0],endColourRandom:[60,60,60,0],sharpness:20,sharpnessRandom:10,spread:10,duration:5,fastMode:!1,gravity:{x:0,y:.1},jitter:3,originOffset:{x:0,y:0}},m=300;c=_.cloneDeep(h),u=_.cloneDeep(h),c.originOffset.x=10,c.originOffset.y=30,u.angle=65,u.originOffset.x=10,u.originOffset.y=20},function(t,e,i){"use strict";function n(t){var e;e=t("PlayerSkillManager").get(),_.each(e,function(t){t.playerSkillManager(),l(t),t.renderSkillManager()}),o(e)}function o(t){_.each(t,function(t){t.bind("Remove",function(){var e;_.each(t.getSkills(),function(t){t.destroy()}),e=t.getSkillManagerView(),e.cleanupSkillViews(),e.remove(),t._skills=null})})}function r(t){var e,i;e=t("BattlePCSkill TextFragment").get(),i=_.filter(e,function(t){return t.isComplete()}),_.each(i,function(t){t.processed(),a(t)})}function s(t,e){return Crafty.e("BattlePCSkill, TextFragment").textFragment(c.default.retrieve(t.getVocabulary(),e.textOptions)).battlePCSkill(t,e)}function a(t){var e;e=t.getTarget(),_.each(t.skill.effects,function(i){var n,o,r;n=i.klass,o=i,r={target:e,source:t.getOwner(),skill:t},r=_.merge(t.getSkillDef(),r,o),n.execute(r)})}function l(t){var e;_.each(t.getSkillset(),function(i){e=s(t,i),t.getSkills().push(e)})}Object.defineProperty(e,"__esModule",{value:!0});var c=i(6);i.d(e,"initPlayerSkillSystem",function(){return n}),i.d(e,"playerSkillSystem",function(){return r}),i(50)},function(t,e,i){"use strict";function n(t){}function o(t,e){var i,n;e.frame,n=e.dt,i=t("BattleNPCProjectile").get(),_.each(i,function(t){l(t,n)}),i=t("BattleProjectile BattleProjectileOutOfBounds").get(),_.each(i,function(t){t.destroy()}),i=t("BattlePhysicsProjectile").get(),_.each(i,function(t){s(t),r(t)})}function r(t){t.getDeadCounter()>=c&&t.destroy()}function s(t){a(t)&&t.setDeadCounter(t.getDeadCounter()+1)}function a(t){var e;return e=t.body.GetLinearVelocity(),0==e.x&&0==e.y}function l(t,e){var i;i=t.positionFunction(e,t.speed),t.x=t.x+i.x,t.y=t.y+i.y}Object.defineProperty(e,"__esModule",{value:!0}),e.initProjectileSystem=n,e.projectileSystem=o;var c=20},function(t,e,i){"use strict";function n(t){}function o(t){var e,i;e=t("TextFragment TextFragmentAttackDisplay").get(),i=_.filter(e,function(t){return t.isComplete()}),_.each(i,function(t){t.cleanupView()})}Object.defineProperty(e,"__esModule",{value:!0}),e.initTextFragmentAttackDisplaySystem=n,e.textFragmentAttackDisplaySystem=o},function(t,e,i){"use strict";function n(t){}function o(t){var e;e=t("TriggerableEffectOnCollide TriggerableEffectOnCollideHit").get(),_.each(e,function(t){r(t),t.destroy()})}function r(t){var e,i,n;e=t.getSource(),i=t.getTarget(),n=t.getEffects(),_.each(n,function(t){var n,o;n=t.klass,o=t,o=_.merge({source:e,target:i},o),n.execute(o)})}Object.defineProperty(e,"__esModule",{value:!0}),e.initTriggerEffectOnCollideSystem=n,e.triggerEffectOnCollideSystem=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(23);Crafty.c("BattleCharacter",{charSheet:null,_currentTarget:null,_model:null,init:function(){this.requires("2D")},battleCharacter:function(t){return t&&(this.charSheet=new n.default(t)),this.z=5,this},remove:function(t){this.z=-9999},getHP:function(){return this.getStatus().hp},getName:function(){return this.charSheet.data.name},getStatus:function(){return this.charSheet.data.status},getTarget:function(){return this._currentTarget},getVocabulary:function(){return this.charSheet.data.vocabulary},setHP:function(t){this.getStatus().hp=t},getPercentHP:function(){return this.getStatus().hp/this.getStatus().maxHp*100},setTarget:function(t){this._currentTarget=t},updateStatus:function(){this.trigger("UpdateStatus")}})},function(t,e){Crafty.c("BattlePhysicsProjectile",{_deadCount:null,init:function(){this._deadCount=0},battlePhysicsProjectile:function(){return this},getDeadCounter:function(){return this._deadCount},setDeadCounter:function(t){this._deadCount=t}})},function(t,e){Crafty.c("BattleProjectile",{init:function(){this.requires("2D, Collision")},battleProjectile:function(){return this.onHit("BattleStageBoundary",this._handleBattleBoundaryHit.bind(this)),this},_handleBattleBoundaryHit:function(t){this.addComponent("BattleProjectileOutOfBounds")}})},function(t,e){Crafty.c("DefendableAttack",{init:function(){},defendableAttack:function(t){return this},acceptInput:function(t){return this.takeInput(t)},cancel:function(){this._textFragFsm.cancel()}})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(0),o=i.n(n);i(7),i(14);var r=i(1),s=o.a.View.extend({tagName:"div",className:"text-fragment-attack",_templateId:"#text_fragment_attack_template",initialize:function(t){if(this._entity=t.entity,!this._entity)throw new Error("Attempting to initialize TextFragmentAttackDisplayView without an entity");this._template=r.compile($(this._templateId).html())},render:function(){var t,e;e=this._prepareTemplateOptions(),0===$(this.id).length?(this.id=this._generateId(this._entity),this.$el.html(this._template(e)),t=this._entity.getDomId(),$("#"+t).append(this.$el)):this.$el.html(this._template(e))},_generateId:function(t){return"text_fragment_"+t.getId()},_prepareTemplateOptions:function(){var t=this._entity;return{typed:t.getCorrectCharacters(),missed:t.getIncorrectCharacters(),rest:t.getRemainingCharacters(),activeClass:t.isActive()?"active":"inactive"}}});Crafty.c("TextFragmentAttackDisplay",{_view:null,init:function(){this.requires("2D, DOM, Collision, TextFragment")},textFragmentAttackDisplay:function(t){return this._initView(),this._bindRerenderOnRedraw(),this.render(),this},cleanupView:function(){this._view.undelegateEvents(),this._view.remove()},render:function(){this._view.render()},_bindRerenderOnRedraw:function(){this.bind("TextFragmentRedraw",this.render.bind(this))},_initView:function(){this._view=new s({entity:this})}})},function(t,e){Crafty.c("TriggerableEffectOnCollide",{init:function(){this.requires("2D, Collision")},triggerableEffectOnCollide:function(t){return this._source=t.source,this._target=t.target,this._effects=t.effects,this._targetComponent=t.targetComponent,this.onHit(this._targetComponent,this._handleTargetHit.bind(this)),this},getEffects:function(){return this._effects},getSource:function(){return this._source},getTarget:function(){return this._target},getTargetComponent:function(){return this._targetComponent},_handleTargetHit:function(t){console.log("DEBUG: the player was hit by a projectile.!!!!!!"),this.addComponent("TriggerableEffectOnCollideHit")}})},function(t,e,i){var n=i(18),o=n.Common.Math.b2Vec2,r=n.Dynamics.b2BodyDef,s=n.Dynamics.b2Body,a=n.Dynamics.b2FixtureDef,l=(n.Dynamics.b2Fixture,n.Dynamics.b2World),c=(n.Collision.Shapes.b2MassData,n.Collision.Shapes.b2PolygonShape),u=n.Collision.Shapes.b2CircleShape,h=n.Dynamics.b2DebugDraw,m=(n.Dynamics.Joints.b2MouseJointDef,n.Dynamics.Joints.b2PrismaticJointDef,n.Dynamics.b2ContactListener),p=n.Dynamics.b2FilterData;Crafty.c("Box2D",{body:null,fixtures:null,init:function(){this.requires("2D"),Crafty.box2D.world||Crafty.box2D.init(0,10,55,!0)},box2d:function(t){var e,i=Crafty.box2D.world,n=Crafty.box2D.PTM_RATIO;if(this.fixtures=[],t.bodyDef)var e=t.bodyDef;else{var e=new r;"dynamic"===t.bodyType?e.type=s.b2_dynamicBody:"static"===t.bodyType?e.type=s.b2_staticBody:e.type=s.b2_kinematicBody,e.position.Set(this._x/n,this._y/n)}return e.userData=this,this.body=i.CreateBody(e),this.addFixture(t),this.bind("Remove",this.box2dRemoved),this.bind("RemoveComponent",this.box2dRemoved),this},box2dRemoved:function(t){void 0!==t&&"Box2D"!==t||Crafty.box2D.world.DestroyBody(this.body)},addFixture:function(t){var e={};return t.fixDef?(e=t.fixDef,e.shape=this._addShapeToFixture(e.shape)):(e=new a,e.density=isNaN(t.density)?1:t.density,e.friction=isNaN(t.friction)?.5:t.friction,e.restitution=isNaN(t.restitution)?.2:t.restitution,e.isSensor=Boolean(t.isSensor),e.filter=this._addFilterToFixture(t),e.shape=this._addShapeToFixture(t.shape)),Object.keys(e).length&&this.fixtures.push(this.body.CreateFixture(e)),this},_addFilterToFixture:function(t){var e=new p;return e.categoryBits=isNaN(t.categoryBits)?1:t.categoryBits,e.maskBits=isNaN(t.maskBits)?65535:t.maskBits,e.groupIndex=isNaN(t.groupIndex)?0:t.groupIndex,e},_addShapeToFixture:function(t){var e,i=Crafty.box2D.PTM_RATIO;if("string"==typeof t&&"circle"===t)e=new u(this._w/i/2),e.SetLocalPosition(new o(this._w/i/2,this._h/i/2));else if("[object Array]"===Object.prototype.toString.call(t)){e=new c;for(var n=t.length,r=[],s=0;s<n;s++){var a=t[s];r.push(new o(a[0]/i,a[1]/i))}e.SetAsArray(r,n)}else e=new c,e.SetAsOrientedBox(this.w/2/i,this.h/2/i,new o(this.w/2/i,this.h/2/i));return e||null},contact:function(t){if(0===Crafty.box2D.contacts.length)return!1;for(var e=Crafty(t),i=[],n=0;n<Crafty.box2D.contacts.length;n++)for(var o=Crafty.box2D.contacts[n],r=0;r<e.length;r++){var s=e.get(r);if(!s.__c.Box2D)return!1;for(var a=0;a<this.fixtures.length;a++)for(var l=0;l<this.fixtures.length;l++)(o.fixtureA===this.fixtures[a]&&o.fixtureB===s.fixtures[l]||o.fixtureA===s.fixtures[l]&&o.fixtureB===this.fixtures[a])&&i.push({obj:s,contact:o})}return!!i.length&&i},onContact:function(t,e){return this.bind("EnterFrame",function(){var i=this.contact(t);i&&e.call(this,i)}),this}}),Crafty.extend({box2D:{ShowBox2DDebug:!1,contacts:null,world:null,PTM_RATIO:null,init:function(t,e,i,n){var r=new l(new o(t,e),n),s=i,a=[],c=new m;c.BeginContact=function(t){var e={fixtureA:t.GetFixtureA(),fixtureB:t.GetFixtureB()};for(t in a)if(a[t].fixtureA==e.fixtureA&&a[t].fixtureB==e.fixtureB)return;a.push(e)},c.EndContact=function(t){var e={fixtureA:t.GetFixtureA(),fixtureB:t.GetFixtureB()};for(t in a)if(a[t].fixtureA==e.fixtureA&&a[t].fixtureB==e.fixtureB)return void a.splice(t,1)},r.SetContactListener(c),Crafty.bind("EnterFrame",function(t){r.Step(t.dt/1e3,8,3);for(var e=r.GetBodyList();e;e=e.GetNext())if(e.GetUserData()){var i=e.GetUserData();0!==e.GetType()?(i.attr({x:e.GetPosition().x*s,y:e.GetPosition().y*s}),i.rotation=Crafty.math.radToDeg(e.GetAngle())):e.SetPosition({x:i.x/s,y:i.y/s})}Crafty.box2D.ShowBox2DDebug&&r.DrawDebugData(),r.ClearForces()}),Crafty.box2D.world=r,Crafty.box2D.PTM_RATIO=s,Crafty.box2D.contacts=a},showDebugInfo:function(){var t=Crafty.box2D.world,e=Crafty.box2D.PTM_RATIO;if(Crafty.support.canvas){var i=document.createElement("canvas");i.id="Box2DCanvasDebug",i.width=Crafty.viewport.width,i.height=Crafty.viewport.height,i.style.position="absolute",i.style.left="0px",i.style.top="0px",Crafty.stage.elem.appendChild(i);var n=new h;n.SetSprite(i.getContext("2d")),n.SetDrawScale(e),n.SetFillAlpha(.7),n.SetLineThickness(1),n.SetFlags(h.e_shapeBit|h.e_jointBit),t.SetDebugDraw(n),Crafty.box2D.ShowBox2DDebug=!0}else Crafty.box2D.ShowBox2DDebug=!1}}})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(0),o=i.n(n),r=i(6),s=i(1),a=i(4);i(7);var l=o.a.View.extend({tagName:"div",className:"battle-skill",_template_id:"#battle_skill_template",initialize:function(t){if(!t.entity)throw"ERROR: Battle Skill View initialized without an entity";this._entity=t.entity,this.text_fragment=t.text_fragment,this.id="battle-skill-"+this._entity[0],this._template=s.compile($(this._template_id).html())},render:function(t){var e,i;return i=this._buildViewOptions(t),e=this._template(i),this.$el.html(e),this.$el.html()},setTextFragment:function(t){this.text_fragment=t},_buildViewOptions:function(t){var e,i;return i={},e={name:this._entity.skill.name,css_classes:this._entity._battlePCFsm.current,skill_slot_num:this._entity.getSkillSlotNum()},_.extend(i,this._entity,e,this._getTextFragmentOptions(),t)},_defaultTextFragmentOptions:function(){return{typed:"",missed:"",rest:""}},_getTextFragmentOptions:function(){return this._entity.getTextStatus()}});Crafty.c("BattlePCSkill",{skill:null,text_fragment:null,text_fragment_graveyard:null,_battlePCFsm:null,_owner:null,_view:null,init:function(){},battlePCSkill:function(t,e){return this._owner=t,this.skill=e,this._setupStateMachine(),this._initializeView(),this._battlePCFsm.initialize(),this},remove:function(){this._view.remove()},cancel:function(){this._battlePCFsm.cancel()},canTakeInput:function(t){return this._battlePCFsm.is("ready")||this._battlePCFsm.is("active")},currentText:function(){return this.getText()},getOwner:function(){return this._owner},getSkillDef:function(){return this.skill},getTarget:function(){return this._owner.getTarget()},getView:function(){return this._view},prepare:function(){this._battlePCFsm.prepared()},ready:function(){this._battlePCFsm.initialize()},render:function(){this._view&&this._view.render()},getSkillSlotNum:function(){return this._owner.getSlotNum(this.skill)},acceptInput:function(t){return this.canTakeInput()?!!this.takeInput(t)&&(this._battlePCFsm.is("ready")&&this._battlePCFsm.start(),this.isComplete()&&this._battlePCFsm.complete(),!0):null},_bindRedrawOnTextFragmentUpdate:function(){this.bind("TextFragmentRedraw",_.bind(this.render,this))},_cycleTextFragment:function(){this._generateNewText()},_generateNewText:function(){this.setText(r.default.retrieve(this._owner.getVocabulary(),this.skill.textOptions))},_getTextFromVocabulary:function(t){return r.default.retrieve(this.getVocabulary(),this.skill.textOptions)},_initializeView:function(){this._view=new l({entity:this,text_fragment:this})},_setupStateMachine:function(){var t=this;this._battlePCFsm=a.create({initial:"inactive",events:[{name:"initialize",from:"inactive",to:"ready"},{name:"start",from:"ready",to:"active"},{name:"complete",from:"active",to:"cooling"},{name:"complete",from:"ready",to:"cooling"},{name:"cancel",from:"active",to:"ready"},{name:"prepared",from:"cooling",to:"ready"}],callbacks:{onbeforeinitialize:function(e,i,n){t._bindRedrawOnTextFragmentUpdate()},onready:function(t,e,i){},onstart:function(t,e,i){},onbeforecancel:function(e,i,n){t._textFragFsm.cancel()},onaftercomplete:function(e,i,n){t._cycleTextFragment()},onafterevent:function(e,i,n){t.render()},onprepared:function(e,i,n){t.restart()}}})},_unbindCombatModeSwitch:function(){this.unbind("SwitchedCombatMode")},_unbindRedrawOnTextFragmentUpdate:function(){this.text_fragment.unbind("TextFragmentRedraw")}})},function(t,e){Crafty.c("AudioManager",{_audioQueue:null,init:function(){},audioManager:function(t){return this._audioQueue=[],this},getAudioQueue:function(){return this._audioQueue},setAudioQueue:function(t){this._audioQueue=t}})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(16);Crafty.c("BattleInput",{init:function(){this._inputQueue=[],this.is_shift_key_down=!1},battleInput:function(){return this._attachKeyboardHandler(),this},clearInputQueue:function(){this._inputQueue=[]},getInputQueue:function(){return this._inputQueue},remove:function(t){this._detachKeyboardHandler()},_attachKeyboardHandler:function(){this.bind("KeyDown",this._handleKeyPress),this.bind("KeyUp",this._handleKeyRelease),this._handleBrowserKeyOverrides()},_detachKeyboardHandler:function(){this.unbind("KeyDown",this._handleKeyPress),this.unbind("KeyUp",this._handleKeyRelease),this._unbindBrowserKeyOverrides()},_handleBrowserKeyOverrides:function(){this._preventBackspaceNavigation(),this._preventTabFieldSwitch(),this._preventSpacebarScroll()},_handleKeyPress:function(t){var e;if(!Crafty.isPaused()){if(e=this._translateKeyToLetter(t.key),this._isModifierKey(e))return this._handleModifierKeyPressed(e);this._inputQueue.push(e)}},_handleKeyRelease:function(t){var e;Crafty.isPaused()||(e=this._translateKeyToLetter(t.key),this._isModifierKey(e)&&this._handleModifierKeyReleased(e))},_handleModifierKeyPressed:function(t){switch(t){case"shift":this.is_shift_key_down=!0;default:return!1}},_handleModifierKeyReleased:function(t){switch(t){case"shift":this.is_shift_key_down=!1;default:return!1}},_isModifierKey:function(t){switch(t){case"shift":return!0;default:return!1}},_preventBackspaceNavigation:function(){$(document).on("keydown",function(t){8!==t.which||$(t.target).is("input, textarea")||t.preventDefault()})},_preventTabFieldSwitch:function(){$(document).on("keydown",function(t){9!==t.which||$(t.target).is("input, textarea")||t.preventDefault()})},_preventSpacebarScroll:function(){$(document).on("keydown",function(t){32!==t.which||$(t.target).is("input, textarea")||t.preventDefault()})},_translateKeyToLetter:function(t){switch(t){case Crafty.keys.BACKSPACE:return"";case Crafty.keys.TAB:return n.COMMANDS.tab;case Crafty.keys.ENTER:return"";case Crafty.keys.SPACE:return" ";case Crafty.keys[0]:return"0";case Crafty.keys[1]:return this.is_shift_key_down?"!":"1";case Crafty.keys[2]:return"2";case Crafty.keys[3]:return"3";case Crafty.keys[4]:return"4";case Crafty.keys[5]:return"5";case Crafty.keys[6]:return"6";case Crafty.keys[7]:return"7";case Crafty.keys[8]:return"8";case Crafty.keys[9]:return"9";case Crafty.keys.A:return this.is_shift_key_down?"A":"a";case Crafty.keys.B:return this.is_shift_key_down?"B":"b";case Crafty.keys.C:return this.is_shift_key_down?"C":"c";case Crafty.keys.D:return this.is_shift_key_down?"D":"d";case Crafty.keys.E:return this.is_shift_key_down?"E":"e";case Crafty.keys.F:return this.is_shift_key_down?"F":"f";case Crafty.keys.G:return this.is_shift_key_down?"G":"g";case Crafty.keys.H:return this.is_shift_key_down?"H":"h";case Crafty.keys.I:return this.is_shift_key_down?"I":"i";case Crafty.keys.J:return this.is_shift_key_down?"J":"j";case Crafty.keys.K:return this.is_shift_key_down?"K":"k";case Crafty.keys.L:return this.is_shift_key_down?"L":"l";case Crafty.keys.M:return this.is_shift_key_down?"M":"m";case Crafty.keys.N:return this.is_shift_key_down?"N":"n";case Crafty.keys.O:return this.is_shift_key_down?"O":"o";case Crafty.keys.P:return this.is_shift_key_down?"P":"p";case Crafty.keys.Q:return this.is_shift_key_down?"Q":"q";case Crafty.keys.R:return this.is_shift_key_down?"R":"r";case Crafty.keys.S:return this.is_shift_key_down?"S":"s";case Crafty.keys.T:return this.is_shift_key_down?"T":"t";case Crafty.keys.U:return this.is_shift_key_down?"U":"u";case Crafty.keys.V:return this.is_shift_key_down?"V":"v";case Crafty.keys.W:return this.is_shift_key_down?"W":"w";case Crafty.keys.X:return this.is_shift_key_down?"X":"x";case Crafty.keys.Y:return this.is_shift_key_down?"Y":"y";case Crafty.keys.Z:return this.is_shift_key_down?"Z":"z";case Crafty.keys.DECIMAL:return".";case Crafty.keys.SHIFT:return"shift";case Crafty.keys.COMMA:return",";case Crafty.keys.MINUS:return"-";case 186:return this.is_shift_key_down?":":";";case 190:return".";case 191:return"?";case 222:return"'";default:return""}},_unbindBrowserKeyOverrides:function(){$(document).off("keydown")}})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,o=i(0),r=i.n(o),s=i(1);n=r.a.View.extend({tagName:"div",className:"status-bar",_templateId:"#status-bar-template",initialize:function(){this._childViews=[],this._template=s.compile($(this._templateId).html())},insertChild:function(t){this._childViews.push(t)},cleanupChildViews:function(){_.each(this._childViews,function(t){t.remove()}),this._childViews=null},render:function(t){return this._existsOnPage()||this._insertIntoPage(),this.$el.html(this._template()),this._renderChildViews(),this},_existsOnPage:function(){return _.some($(this.id))},_insertIntoPage:function(){$("#typewar-status-bar-wrap").append(this.$el)},_renderChildViews:function(){var t=this;_.each(this._childViews,function(e){t.$el.append(e.render())})}}),Crafty.c("BattleStatusBarView",{init:function(){},battleStatusBarView:function(){return this._view=new n,this},getView:function(){return this._view},render:function(){this._view.render()}})},function(t,e,i){i(12),Crafty.c("NPCParticles",{init:function(){this.requires("BattleParticles")},nPCParticles:function(){return this}})},function(t,e){Crafty.c("ParticleSource",{init:function(){this._startFrame=null,this._deleteMe=!1},particleSource:function(t){return this._startFrame=t,this},getStartFrame:function(){return this._startFrame},getDestroyFlag:function(){return this._deleteMe},setDestroyFlag:function(t){this._deleteMe=t}})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(0),o=i.n(n);i(13),i(6);i(44);var r=i(1),s=o.a.View.extend({tagName:"div",className:"skill-manager",_template_id:"#skill_manager_template",initialize:function(){this._template=r.compile($(this._template_id).html())},render:function(){var t;t=this,this.$el.html(this._template()),this._existsOnPage()||this._insertIntoPage(),_.each(this._skill_views,function(e,i){e.render({number:i}),t.$el.find(".skill-manager-wrapper").append(e.$el)})},cleanupSkillViews:function(){_.each(this._skill_views,function(t){t.remove()}),this._skill_views=null},registerSkillViews:function(t){this._skill_views=t},_existsOnPage:function(){return _.some($(this.id))},_insertIntoPage:function(){$("#typewar-skill-manager-wrap").append(this.$el)}});Crafty.c("PlayerSkillManager",{_skills:null,_view:null,init:function(){this._skills=[]},playerSkillManager:function(){return this},getSkillManagerView:function(){return this._view},getSkills:function(){return this._skills},getSkillset:function(){return this.charSheet.data.skills},renderSkillManager:function(){this._view||this._initializeView(),this._view.render()},getSlotNum:function(t){return this.getSkillset().indexOf(t)+1},_initializeView:function(){var t;this._view=new s({id:"battle-skillset"}),t=_.map(this._skills,function(t){return t.render(),t.getView()}),this._view.registerSkillViews(t)}})},function(t,e,i){"use strict";function n(t,e){return[t*Crafty.viewport._scale+Crafty.viewport.x,e*Crafty.viewport._scale+Crafty.viewport.y]}Object.defineProperty(e,"__esModule",{value:!0}),e.viewportConvert=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(15),o={spriteId:"slime",spriteFrame:"slime_st0",animationComponent:"BattleSlimeAnimation",width:42,height:42,hitbox:[0,0,0,50,50,60,0,60],charSheet:{name:"Slime",properties:{blunt:1,slashing:1,piercing:1,fire:1,earth:1,water:1,air:1,light:1,dark:1,poison:1,life:1,death:1},status:{hp:10,maxHp:10},stats:{level:0,str:0,spd:0,sta:0,dex:0,int:0,cha:0,wis:0},skills:[n.SlimeStandardAttack]}};e.default=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n={spriteId:"slime",spriteFrame:"slime_st0",animationComponent:"BattleSlimeAnimation",width:42,height:42,hitbox:[0,0,0,50,50,60,0,60],charSheet:{name:"Training dummy",properties:{blunt:1,slashing:1,piercing:1,fire:1,earth:1,water:1,air:1,light:1,dark:1,poison:1,life:1,death:1},status:{hp:10,maxHp:10},stats:{level:0,str:0,spd:0,sta:0,dex:0,int:0,cha:0,wis:0},skills:[]}};e.default=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(26),o=i(27),r=i(29),s=i(33),a=i(31),l=i(30),c=i(34),u=i(36),h=i(28),m=i(35),p=i(25),f=i(64),_=i(65),y=i(32),d={initializers:[{system:p.initAudioSystem,options:{audioData:["audio"]}},{system:o.initBattleStatusSystem},{system:r.initInputSystem},{system:s.initPlayerSkillSystem},{system:a.initNPCSkillSystem},{system:l.initNPCAISystem},{system:y.initParticleSystem}],runners:[{system:r.inputSystem},{system:s.playerSkillSystem},{system:a.npcSkillSystem},{system:l.nPCAISystem},{system:m.textFragmentAttackDisplaySystem},{system:h.defendableSkillSystem},{system:c.projectileSystem},{system:u.triggerEffectOnCollideSystem},{system:n.battleEffectSystem},{system:o.battleStatusSystem},{system:y.particleSystem},{system:p.audioSystem},{system:f.npcDiedPlayerWinSystem},{system:_.playerDieLoseSystem}],cleanup:[{system:o.teardownBattleStatusSystem},{system:p.teardownAudioSystem}]};e.default=d},function(t,e,i){"use strict";function n(t,e){var i;i=l(t,e.tutorialData),c(i,t)}function o(t){}function r(t){var e;e=t("Tutorial"),e.length>0&&e.destroy()}function s(t){_.each(t("UICallout").get(),function(t){t.cleanup(),t.destroy()})}function a(t,e){t.e("UICallout").uiCallout().render(e)}function l(t,e){return t.e("Tutorial, Delay").tutorial(e)}function c(t,e){t.getCurrTutorialStep();if(!t.getCurrTutorialStep())return void t.destroy();switch(t.getCurrTutorialStep().type){case"modal":return void p(t,e);case"wait":return void f(t,e);case"wait_input":return void d(t,e);case"wait_event":return void y(t,e);case"end":return t.destroy(),void e.trigger(x.SCENE_TRANSITION_EVT,x.BATTLE_VICTORY_COND);default:return void t.destroy()}}function u(t){var e,i,n;e=this.Crafty,n=this.entity,i=n.getCurrTutorialStep(),this.boundFunc,e.keydown[e.keys[i.input]]&&(e("UICallout").removeComponent("Keyboard",!1),n.incrementTutorialStep(),s(e),v(),g(),e.pause(),c(n,e))}function h(t){t&&"string"==typeof t&&_.each(Crafty(t).get(),function(t){t.addComponent("TWHighlight").tWHighlight()})}function m(t){t&&("string"==typeof t?$(t).addClass("ui-callout-target"):_.each(t,function(t){$(t).addClass("ui-callout-target")}))}function p(t,e){var i;i=t.getCurrTutorialStep(),a(e,i.modalData),m(i.highlightSelectors),h(i.highlightEntities),t.incrementTutorialStep(),c(t,e)}function f(t,e){var i;i=t.getCurrTutorialStep(),e.pause(),window.setTimeout(function(){t.incrementTutorialStep(),e.pause(),c(t,e)},i.duration)}function y(t,e){var i=t.getCurrTutorialStep();e.one(i.eventTarget,function(){t.incrementTutorialStep(),c(t,e)})}function d(t,e){e.pause(),e("UICallout").addComponent("Keyboard").bind("KeyDown",u.bind({Crafty:e,entity:t,boundFunc:u}))}function v(){_.each(Crafty("TWHighlight").get(),function(t){t.removeTWHighlight(),t.removeComponent("TWHighlight")})}function g(){_.each($(".ui-callout-target"),function(t){$(t).removeClass("ui-callout-target")})}Object.defineProperty(e,"__esModule",{value:!0});var x=i(2);e.initTutorialSystem=n,e.tutorialSystem=o,e.teardownTutorialSystem=r,i(61),i(63),i(60)},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(0),o=i.n(n),r=i(1),s=o.a.View.extend({tagName:"div",className:"entity-status",_templateId:"#entity-status-template",entity:null,initialize:function(t){this.entity=t.entity,this._template=r.compile($(this._templateId).html())},render:function(){var t;return t={name:this.entity.getName()||"Unnamed",className:_.kebabCase(this.entity.getName())||"Unnamed",percentHP:this.entity.getPercentHP(),statusHP:this.getStatusHP()},this.$el.html(this._template(t)),this.$el},getStatusHP:function(){var t;return t=this.entity.getPercentHP(),t<30?"health-bar-danger":t<70?"health-bar-warning":"health-bar-success"}});Crafty.c("BattleStatus",{_battleStatusDirty:!1,_statusView:null,init:function(){this.requires("BattleCharacter")},battleStatus:function(){return this},getStatusView:function(){return this._statusView},renderStatus:function(){this._statusView||(this._statusView=new s({entity:this,id:"entity-status-"+this[0]})),this._statusView.render()},isStatusDirty:function(){return this._battleStatusDirty},resetStatusDirty:function(){this._battleStatusDirty=!1},setStatusDirty:function(){this._battleStatusDirty=!0}})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i.d(e,"DUMMY_TEXT_LIBRARY",function(){return n});var n=["Literally"]},function(t,e,i){"use strict";function n(t){var e,i;return e="2D, DOM, BattleEffectable, BattleCharacter, BattleNPC, BattleNPCSlime, NPCBrain, Collision, BattleStatus, BattleNPCBrain, BattleNPCSkillManager",e+=", "+t.spriteFrame,e+=", "+t.animationComponent,i=Crafty.e(e),i.battleCharacter(t.charSheet).battleNPCEnemy().battleStatus().battleNPCBrain().collision(new Crafty.polygon(t.hitbox)),i[_.lowerFirst(t.animationComponent)].call(i),o(i)}function o(t){return r(t)}function r(t){return window.serverCaller?serverCaller.getVocabulariesPromise().then(function(e,i,n){return t.charSheet.data.vocabulary=e,t}):new Promise(function(e,i){t.charSheet.data.vocabulary=s.DUMMY_TEXT_LIBRARY,e(t)})}Object.defineProperty(e,"__esModule",{value:!0});var s=i(57);e.default=n,i(37),i(73),i(72),i(71),i(56)},function(t,e,i){"use strict";function n(t){var e;e=t("BattleNPC"),0!=e.length&&e.getHP()<=0&&t.trigger(o.TRAINING_TUTORIAL_COMPLETED_EVT)}Object.defineProperty(e,"__esModule",{value:!0});var o=i(2);e.npcDiedTutorialSystem=n},function(t,e){function i(t,e,i,n){var o,r;return'<div class="typewar-entity-highlight"></div>',o="position: fixed; z-index: 9999999; left: "+t+"px; top: "+e+"px; width: "+i+"px; height: "+n+"px;",r=document.createElement("div"),$(r).prop("style",o),$(r).addClass("typewar-entity-highlight"),$("body").prepend(r),r}Crafty.c("TWHighlight",{init:function(){this.requires("2D, DOM")},tWHighlight:function(){var t;if(t=$(this._element).offset(),this.has("ModeIcon")){var e=$(this._element).children().first();this._highlightElement=i(t.left,t.top,e.width()*Crafty.viewport._scale,e.height()*Crafty.viewport._scale)}else this._highlightElement=i(t.left,t.top,this.w,this.h);return this},removeTWHighlight:function(){$(this._highlightElement).remove()}})},function(t,e,i){i(4);Crafty.c("Tutorial",{init:function(){this._isListeningForInput=!1},tutorial:function(t){return this.setTutorialData(t),this.setTutorialStepNum(0),this},getTutorialData:function(){return this._tutorialData},setTutorialData:function(t){this._tutorialData=t},getTutorialSteps:function(){return this._tutorialData.steps},getTutorialStepNum:function(){return this._tutorialStep},setTutorialStepNum:function(t){this._tutorialStep=t},getCurrTutorialStep:function(){return this._tutorialData.steps[this._tutorialStep]},incrementTutorialStep:function(){this._tutorialStep+=1},listenForInput:function(){this._isListeningForInput=!0},isListeningForInput:function(){return this._isListeningForInput},stopListeningForInput:function(){return this._isListeningForInput=!1},getCallback:function(){return this._callback},setCallback:function(t){this._callback=t}})},function(t,e){Crafty.c("BattlePlayerAnim",{_ATTACK_ANIM_SPEED:8,_BLOCK_ANIM_SPEED:18,_HIT_ANIM_SPEED:16,_READY_ANIM_SPEED:29,init:function(){this.requires("SpriteAnimation")},battlePlayerAnim:function(){var t=this;return this.reel("ready",this._READY_ANIM_SPEED,0,0,6).reel("hit",this._HIT_ANIM_SPEED,0,1,6).reel("attack1",this._ATTACK_ANIM_SPEED,0,2,6).reel("block",this._BLOCK_ANIM_SPEED,0,3,6).bind("EnterFrame",function(e){t.isPlaying()||t.animReady()}),this},animAttack:function(){this.animate("attack1",0)},animBlock:function(){this.animate("block",0)},animHit:function(){this.animate("hit",0)},animReady:function(){this.animate("ready",-1)}})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(0),o=i.n(n),r=i(1),s=o.a.View.extend({tagName:"div",className:"typewar-ui-modal",_templateId:"#modal-template",initialize:function(t){this._template=r.compile($(this._templateId).html())},render:function(t){var e;e=t||{},this.$el.html(this._template(e)),$("body").prepend(this.$el)}});Crafty.c("UICallout",{init:function(){},uiCallout:function(t){return this._view=new s,this},render:function(t){this._view.render(t)},cleanup:function(){this._view.remove()}})},function(t,e,i){"use strict";function n(t){var e;e=t("BattleNPC"),0!=e.length&&e.getHP()<=0&&t.trigger(o.SCENE_TRANSITION_EVT,o.BATTLE_VICTORY_COND)}Object.defineProperty(e,"__esModule",{value:!0});var o=i(2);e.npcDiedPlayerWinSystem=n},function(t,e,i){"use strict";function n(t){var e;e=t("BattlePlayer"),0!=e.length&&e.getHP()<=0&&(console.log("DEBUG: PLAYER DIED> GAME LOST!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!"),t.trigger(o.SCENE_TRANSITION_EVT,o.BATTLE_DEFEAT_COND))}Object.defineProperty(e,"__esModule",{value:!0});var o=i(2);e.playerDieLoseSystem=n},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),i.d(e,"Fadeout",function(){return r}),i.d(e,"Fadein",function(){return s});var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();Crafty.c("FadeoutTransition",{init:function(){this.requires("2D, DOM")},fadeoutTransition:function(){return this},fadeout:function(){var t;t=$(this._element),t.addClass("transition-end-state")}}),Crafty.c("FadeinTransition",{init:function(){this.requires("2D, DOM")},fadeinTransition:function(){return this},fadein:function(){$(this._element).addClass("transition-end-state")}});var r=function(){function t(){n(this,t)}return o(t,null,[{key:"execute",value:function(t){var e=t.fulfill;t.reject;window.setTimeout(function(){e&&e()},3e3),Crafty.e("FadeoutTransition, 2D, DOM").attr({x:0,y:0,z:9999999,w:Crafty.stage.elem.offsetWidth,h:Crafty.stage.elem.offsetHeight}).fadeoutTransition().fadeout()}}]),t}(),s=function(){function t(){n(this,t)}return o(t,null,[{key:"execute",value:function(t){var e=t.fulfill;t.reject;window.setTimeout(function(){e&&e()},3e3),Crafty.e("FadeinTransition, 2D, DOM").attr({x:0,y:0,z:9999999,w:Crafty.stage.elem.offsetWidth,h:Crafty.stage.elem.offsetHeight}).fadeinTransition().fadein()}}]),t}()},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=i(75),r=i(80),s=i(81),a=i(58),l=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();i(76),i(77),i(78);var c=function(){function t(e,i){n(this,t),this._sceneId=e,this._sceneData=i,Crafty.scene(this._sceneId,this.init.bind(this),this.stop.bind(this))}return l(t,[{key:"play",value:function(){Crafty.scene(this._sceneId)}},{key:"clearBG",value:function(){Crafty.background("")}},{key:"deallocateStageEdges",value:function(){this._stageBorders.leftEdge=null,this._stageBorders.rightEdge=null,this._stageBorders.bottomEdge=null}},{key:"init",value:function(){var t;t=this,t.initBox2d(),t.initSprites(),t.initBackground(),t.initStageEdges(),t.initCombatants().then(function(e){t.initSystems(),t.registerSystems(),t.initCamera()},function(t){throw t}).catch(function(t){throw t})}},{key:"initBackground",value:function(){var t,e;t=this._sceneData.background,e="url("+t.filepath+") "+t.offsetX+" "+t.offsetY+" / "+t.size+" no-repeat "+t.color,Crafty.background(e)}},{key:"initBox2d",value:function(){Crafty.box2D.init(0,10,2,!0)}},{key:"initCamera",value:function(){var t;t={background:this._sceneData.background},t=_.merge(t,{scale:2.4,offsetX:-10,offsetY:-70}),window.camera=new r.default(t)}},{key:"initCombatants",value:function(){var t,e,i;return i=this,new Promise(function(n,o){i.initPC().then(function(t){return e=t,i.initEnemyNPC()},function(t){console.log("ERROR: there was an error initializing the player character",t)}).then(function(o){t=o,i._combatants={player:e,npc:t},e.setTarget(t),t.setTarget(e),n()},function(t){console.log("ERROR: there was an error initializing the npc",t)}).catch(function(t){console.log("ERROR: there was an error initializing the player or NPC and adding them to the battle manager",t)})})}},{key:"initEnemyNPC",value:function(){var t;return t=i.i(a.default)(this._sceneData.combatants.npc),t.then(function(t){return t.x=390,t.y=210,t})}},{key:"initPC",value:function(){var t;return t=i.i(s.default)(this._sceneData.combatants.player),t.then(function(t){return t.x=20,t.y=180,t})}},{key:"initSprites",value:function(){o.default.create(this._sceneData.combatants.player.spriteId),o.default.create(this._sceneData.combatants.npc.spriteId)}},{key:"initStageEdges",value:function(){this._stageBorders={leftEdge:Crafty.e("2D, DOM, Collision, BattleStageEdge, BattleStageBoundary").attr({x:this._sceneData.borders.left,y:0,w:5,h:9e3}).collision(),rightEdge:Crafty.e("2D, DOM, Collision, BattleStageEdge, BattleStageBoundary").attr({x:this._sceneData.borders.right,y:0,w:5,h:9e3}).collision(),bottomEdge:Crafty.e("2D, DOM, Collision, BattleStageEdge, Box2D").attr({x:0,y:this._sceneData.borders.floor,w:9e3,h:5}).collision().box2d({bodyType:"rigid"})}}},{key:"initSystems",value:function(){var t=this;_.each(this._sceneData.systems.initializers,function(e){if(e.options&&Object.keys(e.options).length>0){var i={};_.each(e.options,function(e,n){i[n]=t._sceneData[e[0]]}),e.system.call(t,Crafty,i)}else e.system.call(t,Crafty)})}},{key:"registerSystems",value:function(){Crafty.settings.register("systemRunners",function(){}),Crafty.settings.modify("systemRunners",this._sceneData.systems.runners),Crafty.bind("EnterFrame",this.runSystems)}},{key:"resetCamera",value:function(){Crafty.viewport.scale(1),Crafty.viewport.x-=-10,Crafty.viewport.y-=-70}},{key:"runSystems",value:function(t){var e=this,i=Crafty.settings.get("systemRunners");_.each(i,function(i){i.system.call(e,Crafty,t)})}},{key:"stop",value:function(){this.teardownSystems(),this.clearBG(),this.deallocateStageEdges(),delete window.camera,window.camera=null}},{key:"teardownSystems",value:function(){var t=this;Crafty.settings.modify("systemRunners",null),Crafty.unbind("EnterFrame",this.runSystems),_.each(this._sceneData.systems.cleanup,function(e){e.system.call(t,Crafty)})}},{key:"sceneId",get:function(){return this._sceneId}}]),t}();e.default=c},function(t,e,i){var n=i(4);Crafty.c("BattleNPCSkill",{_nPCSkillFsm:null,_skill:null,init:function(){},battleNPCSkill:function(t){if(!t)throw"ERROR: attempting to initialize NPCSkill component without any skill data";return this._skill=t,this._setupStateMachine(),this},activate:function(){this._nPCSkillFsm.activate()},getSkillDef:function(){return this._skill},isReady:function(){return this._nPCSkillFsm.is("ready")},prepare:function(){this._nPCSkillFsm.prepare()},_setupStateMachine:function(){this._nPCSkillFsm=n.create({initial:"ready",events:[{name:"activate",from:"ready",to:"cooling"},{name:"prepare",from:"cooling",to:"ready"}],callbacks:{onafteractivate:function(t,e,i){},onbeforeready:function(t,e,i){}}})}})},function(t,e,i){var n=i(4);Crafty.c("BattleStance",{init:function(){},battleStance:function(t){return this._setupModeFSM(t),this},getStance:function(){return this._stance.current},isStance:function(t){return this._stance.is(t)},toggleStance:function(){return this._stance.toggle(),this.getStance()},_setupModeFSM:function(t){var e;e=t||"defense",this._stance=n.create({initial:e,events:[{name:"toggle",from:"defense",to:"offense"},{name:"toggle",from:"offense",to:"defense"}],callbacks:{}})}})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(5),o={ANIM_READY:"ZERO_READY",ANIM_LIGHT_ATTACK:"ZERO_LIGHT_SLASH",ANIM_MED_ATTACK:"ZERO_MED_SLASH",ANIM_HEAVY_ATTACK:"ZERO_HEAVY_SLASH",ANIM_SPECIAL_ATTACK:"ZERO_UPPER_SLASH",ANIM_GUARD:"ZERO_BLOCK",ANIM_DASH:"ZERO_DASH",ANIM_JUMP:"ZERO_JUMP",ANIM_ENTER:"ZERO_ENTER",ANIM_CHARGE:"ZERO_CHARGE",ANIM_HIT:"ZERO_HIT"};Crafty.c("BattlePlayerZeroAnimation",{init:function(){this.requires("SpriteAnimation")},battlePlayerZeroAnimation:function(){var t=this;return this.reel("ZERO_READY",900,0,0,4).reel("ZERO_LIGHT_SLASH",380,0,1,8).reel("ZERO_MED_SLASH",380,0,2,6).reel("ZERO_HEAVY_SLASH",380,0,3,8).reel("ZERO_UPPER_SLASH",380,0,4,8).reel("ZERO_BLOCK",480,0,5,7).reel("ZERO_DASH",700,0,8,3).reel("ZERO_JUMP",700,9,6).reel("ZERO_ENTER",700,10,13).reel("ZERO_CHARGE",700,11,7)._setupHitAnim().bind("EnterFrame",function(e){t.isPlaying()||t.playAnim(n.ANIM_READY)}),this},animAttack:function(t){var e,i;t?e=t:(i=["ZERO_LIGHT_SLASH",ZERO_ANIM_MED_SLASH_ZERO_ANIM_HEAVY_SLASH,"ZERO_UPPER_SLASH"],e=i[Math.floor(i.length*Math.random())]),this.animate(e,0)},playAnim:function(t){this._playAnim(o[t])},_playAnim:function(t){if(!t)throw"ERROR: No reel id passed to play animation";this.animate(t,0)},_setupHitAnim:function(){var t;return t=[[0,6],[1,6],[0,7],[1,7],[0,6],[1,6],[0,7],[1,7],[0,6],[1,6],[0,7],[1,7],[0,6],[1,6],[0,7],[1,7],[0,6],[1,6],[0,7],[1,7]],this.reel("ZERO_HIT",320,t),this}})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(5),o={ANIM_READY:"SLIME_READY",ANIM_LIGHT_ATTACK:"SLIME_SLASH",ANIM_MED_ATTACK:"SLIME_SLASH",ANIM_HEAVY_ATTACK:"SLIME_THROW",ANIM_SPECIAL_ATTACK:"SLIME_THROW",ANIM_GUARD:"SLIME_BLOCK",ANIM_DASH:"",ANIM_JUMP:"",ANIM_ENTER:"",ANIM_CHARGE:"",ANIM_HIT:"SLIME_HIT"};Crafty.c("BattleSlimeAnimation",{init:function(){this.requires("SpriteAnimation")},battleSlimeAnimation:function(){var t=this;return this.reel("SLIME_READY",600,0,0,4).reel("SLIME_HIT",420,0,1,7).reel("SLIME_SLASH",500,0,2,7).reel("SLIME_THROW",500,0,4,8).reel("SLIME_BLOCK",270,0,3,7).bind("EnterFrame",function(e){t.isPlaying()||t.playAnim(n.ANIM_READY)}),this},playAnim:function(t){this._playAnim(o[t])},_playAnim:function(t){if(!t)throw new Error("ERROR: No reel id passed to play animation");this.animate(t,0)}})},function(t,e){Crafty.c("BattleNPCBrain",{init:function(){this.requires("BattleNPCEnemy")},battleNPCBrain:function(){return this}})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(23);Crafty.c("BattleNPCSlime",{_ANIM_HIT_DELAY:430,_ANIM_ATTACK_DELAY:200,init:function(){this.requires("2D, SpriteAnimation, BattleCharacter")},battleNPCEnemy:function(t){return this.charSheet||(this.charSheet=new n.default({name:"Slime"})),this._fragment_timers=[],this},getStance:function(){return"offense"},isPlayer:function(){return!1},isNPC:function(){return!0}})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});i(23);i(37),i(62),Crafty.c("BattlePlayer",{_ANIM_HIT_DELAY:410,_fragment_spawner:null,init:function(){this.requires("2D, BattlePlayerAnimation, BattleCharacter")},battlePlayer:function(t){return console.log("DEBUG: ~~~~~~~~~~~~~~~~~~~~~~~~~~~ battlePlayer second initializer"),this},die:function(){Crafty.trigger("PlayerDied",{target:this})},getStance:function(){return this.stance},isPlayer:function(){return!0},isNPC:function(){return!1},_unbindChangeStance:function(){this.unbind("SwitchedCombatMode")}})},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}Object.defineProperty(e,"__esModule",{value:!0});var r,s=i(11),a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l={player:{file:s.IMG_SPR_PLAYER_TEST,tile:108,tileh:76,elements:{pl_st0:[0,0],pl_st1:[1,0],pl_st2:[2,0],pl_st3:[3,0],pl_st4:[4,0],pl_st5:[5,0],pl_st6:[6,0],pl_hit0:[0,1],pl_hit1:[1,1],pl_hit2:[2,1],pl_hit3:[3,1],pl_hit4:[4,1],pl_hit5:[5,1],pl_hit6:[6,1],pl_att00:[0,2],pl_att01:[1,2],pl_att02:[2,2],pl_att03:[3,2],pl_att04:[4,2],pl_att05:[5,2],pl_att06:[6,2],pl_blk00:[0,3],pl_blk01:[1,3],pl_blk02:[2,3],pl_blk03:[3,3],pl_blk04:[4,3],pl_blk05:[5,3],pl_blk06:[6,3]}},player_zero:{file:s.IMG_SPR_PLAYER_ZERO,tile:80,tileh:72,elements:{plz_st0:[0,0],plz_st1:[0,1],plz_st2:[0,2],plz_st3:[0,3],plz_st4:[0,4],plz_att00:[1,0],plz_att01:[1,1],plz_att02:[1,2],plz_att03:[1,3],plz_att04:[1,4],plz_att05:[1,5],plz_att06:[1,6],plz_att07:[1,7],plz_att08:[1,8],plz_att10:[2,0],plz_att11:[2,1],plz_att12:[2,2],plz_att13:[2,3],plz_att14:[2,4],plz_att15:[2,5],plz_att16:[2,6],plz_att20:[3,0],plz_att21:[3,1],plz_att22:[3,2],plz_att23:[3,3],plz_att24:[3,4],plz_att25:[3,5],plz_att26:[3,6],plz_att27:[3,7],plz_att28:[3,8],plz_att30:[4,0],plz_att31:[4,1],plz_att32:[4,2],plz_att33:[4,3],plz_att34:[4,4],plz_att35:[4,5],plz_att36:[4,6],plz_att37:[4,7],plz_att38:[4,8],plz_dodge00:[5,0],plz_dodge01:[5,1],plz_dodge02:[5,2],plz_dodge03:[5,3],plz_dodge04:[5,4],plz_dodge05:[5,5],plz_dodge06:[5,6],plz_dodge07:[5,7],plz_hit00:[6,0],plz_hit01:[6,1],plz_hit10:[7,0],plz_hit11:[7,1],plz_dash0:[8,0],plz_dash1:[8,1],plz_dash2:[8,2],plz_dash3:[8,3],plz_jump0:[9,0],plz_jump1:[9,1],plz_jump2:[9,2],plz_jump3:[9,3],plz_jump4:[9,4],plz_jump5:[9,5],plz_jump6:[9,6],plz_in0:[10,0],plz_in1:[10,1],plz_in2:[10,2],plz_in3:[10,3],plz_in4:[10,4],plz_in5:[10,5],plz_in6:[10,6],plz_in7:[10,7],plz_in8:[10,8],plz_in9:[10,9],plz_in10:[10,10],plz_in11:[10,11],plz_in12:[10,12],plz_in13:[10,13],plz_charge0:[11,0],plz_charge1:[11,1],plz_charge2:[11,2],plz_charge3:[11,3],plz_charge4:[11,4],plz_charge5:[11,5],plz_charge6:[11,6],plz_charge7:[11,7]}},slime:{file:s.IMG_SPR_NPC_SLIME,tile:42,elements:(r={slime_st0:[0,0],slime_st1:[1,0],slime_st2:[2,0],slime_st3:[3,0],slime_st4:[4,0],slime_hit0:[0,1],slime_hit1:[1,1],slime_hit2:[2,1],slime_hit3:[3,1],slime_hit4:[4,1],slime_hit5:[5,1],slime_hit6:[6,1]},o(r,"slime_hit6",[7,1]),o(r,"slime_att00",[0,2]),o(r,"slime_att01",[1,2]),o(r,"slime_att02",[2,2]),o(r,"slime_att03",[3,2]),o(r,"slime_att04",[4,2]),o(r,"slime_att05",[5,2]),o(r,"slime_att06",[6,2]),o(r,"slime_att06",[7,2]),o(r,"slime_blk00",[0,3]),o(r,"slime_blk01",[1,3]),o(r,"slime_blk02",[2,3]),o(r,"slime_blk03",[3,3]),o(r,"slime_blk04",[4,3]),o(r,"slime_blk05",[5,3]),o(r,"slime_blk06",[6,3]),o(r,"slime_blk07",[7,3]),o(r,"slime_att200",[0,4]),o(r,"slime_att201",[1,4]),o(r,"slime_att202",[2,4]),o(r,"slime_att203",[3,4]),o(r,"slime_att204",[4,4]),o(r,"slime_att205",[5,4]),o(r,"slime_att206",[6,4]),o(r,"slime_att207",[7,4]),r)}},c=function(){function t(){n(this,t)}return a(t,null,[{key:"create",value:function(t){var e;return void 0!=t&&(e=l[t],void 0==e.tileh?Crafty.sprite(e.tile,e.file,e.elements):Crafty.sprite(e.tile,e.tileh,e.file,e.elements),!0)}},{key:"getPaths",value:function(){var t=[],e=0;return _.each(l,function(i,n){t[e]=i.file,e++}),t}}]),t}();e.default=c},function(t,e){Crafty.c("BattleBackground",{_height:void 0,_width:void 0,_path:"",init:function(){this.requires("2D, DOM, Image")},battleBackground:function(t,e,i){return this.h=e,this.w=i,this.image(t,"no-repeat"),this}})},function(t,e){Crafty.c("BattleEffectable",{init:function(){this._effectQueue=[]},battleEffectable:function(){return this},getEffectQueue:function(){return this._effectQueue},setEffectQueue:function(t){this._effectQueue=t}})},function(t,e,i){i(68),Crafty.c("BattleNPCSkillManager",{_skills:null,_skillset:null,_skillQueue:null,init:function(){},battleNPCSkillManager:function(){return this},getSkillQueue:function(){return this._skillQueue},getSkillset:function(){return this._skillset},getSkills:function(){return this._skills},setSkillQueue:function(t){this._skillQueue=t},setSkills:function(t){this._skills=t},setSkillset:function(t){this._skillset=t}})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(0),o=i.n(n),r=i(1),s=o.a.View.extend({tagName:"div",className:"defense-tutorial-notification",id:"defense-tutorial-notification",_templateId:"#defense-tutorial-notif-template",initialize:function(){console.log("DEBUG: initializing tutorial notification view"),this._template=r.compile($(this._templateId).html())},render:function(t){var e={count:t};console.log("DEBUG: rendering tutorial notif view.  With count -> ",e),this.$el.html(this._template(e)),$("#"+this.id).length<1&&$("#typewar-game").prepend(this.$el)}});Crafty.c("DefenseTutorial",{init:function(){this._defendedCount=0},defenseTutorial:function(t){return this._defendedGoal=t,this._view=new s,this._view.render(t),this},cleanup:function(){this._view.remove()},getDefenseGoal:function(){return this._defendedGoal},getDefendedCount:function(){return this._defendedCount},getView:function(){return this._view},incrementDefendedCount:function(){this._defendedCount+=1}})},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){return[_.random(-t,t),_.random(-e,e)]}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s={duration:60,range:2,timing:4},a=function(){function t(e){n(this,t),this.options=_.cloneDeep(e),this._initViewport(),this._initBackground()}return r(t,[{key:"shake",value:function(t){var e,i,n;for(n=this,e=_.merge(s,t),i=0,this._setBackgroundOffsetAsPixels();;){if(i>=e.duration)return void window.setTimeout(function(){Crafty.viewport.x=n.originalViewportX,Crafty.viewport.y=n.originalViewportY,Crafty.stage.elem.style.backgroundPositionX=n.originalBackgroundOffsetX,Crafty.stage.elem.style.backgroundPositionY=n.originalBackgroundOffsetY},(i+2)*e.timing);window.setTimeout(function(){var t,i,n;t=o(e.range,e.range),Crafty.viewport.x=Crafty.viewport._x+t[0],Crafty.viewport.y=Crafty.viewport._y+t[1],i=_.parseInt(Crafty.stage.elem.style.backgroundPositionX),n=_.parseInt(Crafty.stage.elem.style.backgroundPositionY),i+=t[0],n+=t[1],Crafty.stage.elem.style.backgroundPositionX=i+"%",Crafty.stage.elem.style.backgroundPositionY=n+"%"},(i+1)*e.timing),i+=e.timing}}},{key:"_initBackground",value:function(){this.backgroundOffsetX=Crafty.stage.elem.style.backgroundPositionX,this.backgroundOffsetY=Crafty.stage.elem.style.backgroundPositionY,this.originalBackgroundOffsetX=this.backgroundOffsetX,this.originalBackgroundOffsetY=this.backgroundOffsetY}},{key:"_initViewport",value:function(){Crafty.viewport.scale(this.options.scale),Crafty.viewport.x+=this.options.offsetX,Crafty.viewport.y+=this.options.offsetY,this.originalViewportX=Crafty.viewport._x,this.originalViewportY=Crafty.viewport._y}},{key:"_setBackgroundOffsetAsPixels",value:function(){var t,e;t=Crafty.stage.elem.style.backgroundPositionX,e=Crafty.stage.elem.style.backgroundPositionY,"center"==t&&(t="50%"),"center"==e&&(e="50%"),Crafty.stage.elem.style.backgroundPositionX=t,Crafty.stage.elem.style.backgroundPositionY=e}}]),t}();e.default=a},function(t,e,i){"use strict";function n(t){var e,i;return e="2D, DOM, BattleEffectable, BattleCharacter, BattlePlayer, PlayerSkillManager, Collision, BattleStatus, BattleStance",e+=", "+t.spriteFrame,e+=", "+t.animationComponent,i=Crafty.e(e),i.attr({w:t.width,h:t.height}).battleCharacter(t.charSheet).battlePlayer().battleStatus().battleStance(t.initialStance).collision(new Crafty.polygon(t.hitbox)),i[_.lowerFirst(t.animationComponent)].call(i),o(i)}function o(t){return r(t)}function r(t){return window.serverCaller?serverCaller.getVocabulariesPromise().then(function(e,i,n){return t.charSheet.data.vocabulary=e,t}):new Promise(function(e,i){t.charSheet.data.vocabulary=s.DUMMY_TEXT_LIBRARY,e(t)})}Object.defineProperty(e,"__esModule",{value:!0});var s=i(57);e.default=n,i(37),i(74),i(70),i(69),i(56)},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(11),o={name:"player_died",filepath:n.IMG_BG_PL_DIED,width:800,height:336,css:"url("+n.IMG_BG_PL_DIED+") center center / 110% no-repeat rgb(255, 255, 255)",offsetX:"center",offsetY:"center",size:"110%"};e.default=o},function(t,e,i){"use strict";function n(t){var e,i;e=t("TextFragment DefendableAttack").get(),i=_.filter(e,function(t){return t.isComplete()}),_.each(i,function(e){t.trigger(o.PLAYER_DEFENDED_ATTACK_EVT)})}Object.defineProperty(e,"__esModule",{value:!0});var o=i(2);e.triggerPlayerDefendedEventSystem=n},function(t,e,i){"use strict";function n(t){var e,i;e=t("BattlePCSkill TextFragment").get(),i=_.filter(e,function(t){return t.isComplete()}),_.each(i,function(e){t.trigger(o.PLAYER_USED_SKILL_EVT)})}Object.defineProperty(e,"__esModule",{value:!0});var o=i(2);e.triggerPlayerSkillEventSystem=n},function(t,e,i){"use strict";function n(t){var e,i,n;e=t("BattleInput BattleStance").get(),e.length<1||(i=e[0],n=i.getInputQueue(),0!=n.length&&n.forEach(function(e){e==o.CMD_CHANGE_STANCE&&t.trigger(r.PLAYER_SWITCHED_TO_OFFENSE_EVT)}))}Object.defineProperty(e,"__esModule",{value:!0});var o=i(16),r=i(2);e.triggerPlayerSwitchedToOffenseEventSystem=n},function(t,e,i){"use strict";function n(t){t.e("DefenseTutorial").defenseTutorial(5)}function o(t){var e,i;e=t("DefenseTutorial"),i=_.filter(t("TextFragment DefendableAttack").get(),function(t){return t.isComplete()}),i.length>=1&&(e.incrementDefendedCount(),e.getView().render(e.getDefenseGoal()-e.getDefendedCount())),e.getDefendedCount()>=e.getDefenseGoal()&&t.trigger(s.TRAINING_TUTORIAL_COMPLETED_EVT)}function r(t){_.each(t("DefenseTutorial").get(),function(t){t.cleanup(),t.destroy()})}Object.defineProperty(e,"__esModule",{value:!0});var s=i(2);e.initTutorialDefendWinSystem=n,e.tutorialDefendWinSystem=o,e.teardownTutorialDefendWinSystem=r,i(79)},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(21),o=i(52),r=i(20),s=(i(15),i(3)),a=i(54),l=_.cloneDeep(o.default);l.charSheet.status.hp=6,l.charSheet.status.maxHp=6;var c={id:"prototype_battle",name:"prototype battle scene",width:450,height:240,borders:{left:3,right:510,floor:240},background:r.default,combatants:{player:n.default,npc:l},audio:{sounds:[s.SOUND_LETTER_TYPED,s.SOUND_SWORD_SLASH]},systems:a.default};e.default=c},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(21),o=i(52),r=i(20),s=(i(22),i(15)),a=i(3),l=i(54),c=_.cloneDeep(o.default),u=_.cloneDeep(s.SlimeGlobAttack);u.effects[0].textOptions.minLength=3,u.effects[0].textOptions.maxLength=6,c.charSheet.status.maxHp=30,c.charSheet.status.hp=30,c.charSheet.skills=[s.SlimeStandardAttack,u];var h={id:"prototype_battle",name:"prototype battle scene",width:450,height:240,borders:{left:3,right:510,floor:240},background:r.default,combatants:{player:n.default,npc:c},audio:{sounds:[a.SOUND_LETTER_TYPED,a.SOUND_SWORD_SLASH]},systems:l.default};e.default=h},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(21),o=i(52),r=i(20),s=i(15),a=i(3),l=i(54),c=_.cloneDeep(o.default);c.charSheet.status.maxHp=18,c.charSheet.status.hp=18,c.charSheet.skills=[s.SlimeScatterAttack];var u={id:"prototype_battle",name:"prototype battle scene",width:450,height:240,borders:{left:3,right:510,floor:240},background:r.default,combatants:{player:n.default,npc:c},audio:{sounds:[a.SOUND_LETTER_TYPED,a.SOUND_SWORD_SLASH]},systems:l.default};e.default=u},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(21),o=i(53),r=i(20),s=i(22),a=i(3),l=i(2),c=i(26),u=i(27),h=i(29),m=i(33),p=i(31),f=i(30),y=i(34),d=i(36),v=i(28),g=i(35),x=i(25),b=i(32),C=i(55),S=i(59),w=_.cloneDeep(n.default);w.charSheet.skills=[s.ZeroLightSlash],w.initialStance="offense";var A=_.cloneDeep(o.default);A.charSheet.status.hp=1,A.charSheet.status.maxHp=1;var D={id:l.SID_TRAINING1,name:"Training scene 1",width:450,height:240,borders:{left:3,right:510,floor:240},background:r.default,combatants:{player:w,npc:A},audio:{sounds:[a.SOUND_LETTER_TYPED,a.SOUND_SWORD_SLASH]},systems:{initializers:[{system:x.initAudioSystem,options:{audioData:["audio"]}},{system:u.initBattleStatusSystem},{system:h.initInputSystem},{system:m.initPlayerSkillSystem},{system:p.initNPCSkillSystem},{system:f.initNPCAISystem},{system:b.initParticleSystem},{system:C.initTutorialSystem,options:{tutorialData:["tutorial"]}}],runners:[{system:C.tutorialSystem},{system:h.inputSystem},{system:m.playerSkillSystem},{system:p.npcSkillSystem},{system:f.nPCAISystem},{system:g.textFragmentAttackDisplaySystem},{system:v.defendableSkillSystem},{system:y.projectileSystem},{system:d.triggerEffectOnCollideSystem},{system:c.battleEffectSystem},{system:u.battleStatusSystem},{system:b.particleSystem},{system:x.audioSystem},{system:S.npcDiedTutorialSystem}],cleanup:[{system:u.teardownBattleStatusSystem},{system:x.teardownAudioSystem},{system:C.teardownTutorialSystem}]},tutorial:{steps:[{type:"wait",duration:1e3},{type:"modal",modalData:{headerContent:"Welcome to Typewarrior!",modalContent:"This is a fighting game featuring typing.",footerContent:"Press space to continue..."}},{type:"wait_input",input:"SPACE"},{type:"modal",modalData:{headerContent:"How to Play: Defeat Your Opponent!",modalContent:"Type the words to attack and defend.  Successful attacks will deplete the enemy's health.  Successful attacks against you will deplete your health.  Reduce the enemy's health to zero before you are defeated. In this stage we'll show you how to attack.",footerContent:"Press space to continue..."}},{type:"wait_input",input:"SPACE"},{type:"modal",modalData:{headerContent:"How to Play: Opponent's Health",modalContent:"Here's your opponent's health bar.  As you attack, this bar will deplete.  Bring it to zero and you've won!",footerContent:"Press space to continue..."},highlightSelectors:".entity-status-training-dummy"},{type:"wait_input",input:"SPACE"},{type:"modal",modalData:{headerContent:"How to Play: Your Skills",modalContent:"Here are your skills, type the word or words shown here to attack.  There will be a cooldown after you've used a given skill where it won't yet be ready.",footerContent:"Press space to continue..."},highlightSelectors:".battle-skill"},{type:"wait_input",input:"SPACE"},{type:"modal",modalData:{headerContent:"How to Play: Prepare to Fight",modalContent:"This training dummy won't fight back.  Just keep hitting it to get the hang of attacking.",footerContent:"Ready? Press space to continue..."}},{type:"wait_input",input:"SPACE"},{type:"wait_event",eventTarget:"tutorial_completed"},{type:"end"}]}};e.default=D},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(21),o=i(53),r=i(20),s=i(15),a=i(3),l=i(2),c=i(26),u=i(27),h=i(29),m=i(33),p=i(31),f=i(30),y=i(34),d=i(36),v=i(28),g=i(35),x=i(25),b=i(32),C=i(55),S=i(86),w=_.cloneDeep(n.default);w.charSheet.skills=[];var A=_.cloneDeep(o.default);A.charSheet.skills=[s.SlimeStandardAttack];var D={id:"training_scene_1",name:"Training scene 1",width:450,height:240,borders:{left:3,right:510,floor:240},background:r.default,combatants:{player:w,npc:A},audio:{sounds:[a.SOUND_LETTER_TYPED,a.SOUND_SWORD_SLASH]},systems:{initializers:[{system:x.initAudioSystem,options:{audioData:["audio"]}},{system:u.initBattleStatusSystem},{system:h.initInputSystem},{system:m.initPlayerSkillSystem},{system:p.initNPCSkillSystem},{system:f.initNPCAISystem},{system:b.initParticleSystem},{system:S.initTutorialDefendWinSystem},{system:C.initTutorialSystem,options:{tutorialData:["tutorial"]}}],runners:[{system:C.tutorialSystem},{system:h.inputSystem},{system:m.playerSkillSystem},{system:p.npcSkillSystem},{system:f.nPCAISystem},{system:g.textFragmentAttackDisplaySystem},{system:S.tutorialDefendWinSystem},{system:v.defendableSkillSystem},{system:y.projectileSystem},{system:d.triggerEffectOnCollideSystem},{system:c.battleEffectSystem},{system:u.battleStatusSystem},{system:b.particleSystem},{system:x.audioSystem}],cleanup:[{system:u.teardownBattleStatusSystem},{system:x.teardownAudioSystem},{system:C.teardownTutorialSystem},{system:S.teardownTutorialDefendWinSystem}]},tutorial:{steps:[{type:"modal",modalData:{headerContent:"Defend Yourself!",modalContent:"Now we'll practice defense.  The training dummy will attempt to attack you by sending words your way. Type the words successfully to guard against them.  If they hit you, you will receive damage.",footerContent:"Press space to continue..."}},{type:"wait_input",input:"SPACE"},{type:"modal",modalData:{headerContent:"Defend Yourself!",modalContent:"Defend against 5 attacks to complete the training.",footerContent:"Press space to continue..."}},{type:"wait_input",input:"SPACE"},{type:"wait_event",eventTarget:l.TRAINING_TUTORIAL_COMPLETED_EVT},{type:"end"}]}};e.default=D},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(21),o=i(53),r=i(20),s=i(22),a=i(15),l=i(3),c=i(2),u=i(26),h=i(27),m=i(29),p=i(33),f=i(31),y=i(30),d=i(34),v=i(36),g=i(28),x=i(35),b=i(25),C=i(32),S=i(55),w=i(59),A=i(83),D=i(85),M=i(84),k=_.cloneDeep(n.default);k.charSheet.skills=[s.ZeroLightSlash];var B=_.cloneDeep(o.default);B.charSheet.skills=[a.SlimeStandardAttack],B.charSheet.status.hp=5,B.charSheet.status.maxHp=5;var I={id:"training_scene_1",name:"Training scene 1",width:450,height:240,borders:{left:3,right:510,floor:240},background:r.default,combatants:{player:k,npc:B},audio:{sounds:[l.SOUND_LETTER_TYPED,l.SOUND_SWORD_SLASH]},systems:{initializers:[{system:b.initAudioSystem,options:{audioData:["audio"]}},{system:h.initBattleStatusSystem},{system:m.initInputSystem},{system:p.initPlayerSkillSystem},{system:f.initNPCSkillSystem},{system:y.initNPCAISystem},{system:C.initParticleSystem},{system:S.initTutorialSystem,options:{tutorialData:["tutorial"]}}],runners:[{system:S.tutorialSystem},{system:A.triggerPlayerDefendedEventSystem},{system:D.triggerPlayerSwitchedToOffenseEventSystem},{system:m.inputSystem},{system:M.triggerPlayerSkillEventSystem},{system:p.playerSkillSystem},{system:f.npcSkillSystem},{system:y.nPCAISystem},{system:x.textFragmentAttackDisplaySystem},{system:A.triggerPlayerDefendedEventSystem},{system:g.defendableSkillSystem},{system:d.projectileSystem},{system:v.triggerEffectOnCollideSystem},{system:u.battleEffectSystem},{system:h.battleStatusSystem},{system:C.particleSystem},{system:b.audioSystem},{system:w.npcDiedTutorialSystem}],cleanup:[{system:h.teardownBattleStatusSystem},{system:b.teardownAudioSystem},{system:S.teardownTutorialSystem}]},tutorial:{steps:[{type:"modal",modalData:{headerContent:"Mock Battle",modalContent:"Here's where you'll put what you've learned in the past two training exercises together.  Try defending against the dummy's attack.",footerContent:"Press space to continue..."}},{type:"wait_input",input:"SPACE"},{type:"wait_event",eventTarget:c.PLAYER_DEFENDED_ATTACK_EVT},{type:"modal",modalData:{headerContent:"Switching Defense to Offense",modalContent:"Now we'll switch from defending against attacks to using our skills to hit the dummy.",footerContent:"Press space to continue..."}},{type:"wait_input",input:"SPACE"},{type:"modal",modalData:{headerContent:"Switching Defense to Offense",modalContent:"These icons indicate the stance that each character is in.  The shield above your character indicates that you are defending.  You can switch stances with tab.",footerContent:"Press space to continue..."},highlightEntities:"ModeIcon"},{type:"wait_input",input:"SPACE"},{type:"modal",modalData:{headerContent:"Switching Defense to Offense",modalContent:"Press tab now to switch to offense.",footerContent:"Press space to continue..."},highlightEntities:"ModeIcon"},{type:"wait_input",input:"SPACE"},{type:"wait_event",eventTarget:c.PLAYER_SWITCHED_TO_OFFENSE_EVT},{type:"modal",modalData:{headerContent:"Switching Defense to Offense",modalContent:"See how the icon above your character has changed to crossed swords?",footerContent:"Press space to continue..."},highlightEntities:"ModeIcon"},{type:"wait_input",input:"SPACE"},{type:"modal",modalData:{headerContent:"Ready to Attack",modalContent:"Now you're ready to start typing the words here (your skills) ",footerContent:"Press space to continue..."},highlightSelectors:".battle-skill"},{type:"wait_input",input:"SPACE"},{type:"wait_event",eventTarget:c.PLAYER_USED_SKILL_EVT},{type:"modal",modalData:{headerContent:"Finish Your Training",modalContent:"Great! You've defended against the dummy's attacks, then switched to an offensive stance and struck the dummy.",footerContent:"Press space to continue..."}},{type:"wait_input",input:"SPACE"},{type:"modal",modalData:{headerContent:"Finish Your Training",modalContent:"Now use the skills you've learned to protect yourself as you break the practice dummy.  Keep switching to defense to prevent yourself from being hit.  Keep switching back to offense to deal damage when it's safe. These are the fundamentals of battle.  Now, have at it!",footerContent:"Press space to continue..."}},{type:"wait_input",input:"SPACE"},{type:"wait_event",eventTarget:c.TRAINING_TUTORIAL_COMPLETED_EVT},{type:"end"}]}};e.default=I},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=i(2),r=i(82),s=i(66),a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=function(){function t(){n(this,t),Crafty.scene(o.SID_PL_LOSE,this.init.bind(this),function(){})}return a(t,[{key:"play",value:function(){Crafty.scene(o.SID_PL_LOSE)}},{key:"init",value:function(){this._initFadeIn(),this._setBackground()}},{key:"stop",value:function(){throw new Error("Stop method not implemented on PlayerLoseScene")}},{key:"_initFadeIn",value:function(){s.Fadein.execute({})}},{key:"_setBackground",value:function(){Crafty.background('#000 url("'+r.default.filepath+'") no-repeat center center')}},{key:"sceneId",get:function(){return o.SID_PL_LOSE}}]),t}();e.default=l},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=i(67),a=i(58),l=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),c=function(t){function e(t,i){return n(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i))}return r(e,t),l(e,[{key:"init",value:function(){var t;t=this,t.initSprites(),t.initBackground(),t.initStageEdges(),t.initCombatants().then(function(e){console.log("DEBUG: in the 'then' after trainingScene#initCombatants"),t.initSystems(),t.registerSystems(),t.initCamera()},function(t){throw console.log("DEBUG: FAILED TO INITIALIZE COMBATANTS FOR SOME REASON..."),t}).catch(function(t){throw console.log("DEBUG: ERROR IN PROMISE GROUP~~~~~~~---->",t),t})}},{key:"initEnemyNPC",value:function(){var t;return t=i.i(a.default)(this._sceneData.combatants.npc),t.then(function(t){return t.x=390,t.y=210,t})}}]),e}(s.default);e.default=c},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(){return new Promise(function(t,e){d.Fadeout.execute({fulfill:t,reject:e})})}function r(){var t=this;return new Promise(function(e,i){t.playScene(t._currentSceneIndex+1),e()})}function s(){var t=this;return new Promise(function(e,i){t.playScene(v.SID_PL_LOSE)})}Object.defineProperty(e,"__esModule",{value:!0});var a=i(67),l=i(94),c=i(93),u=i(87),h=i(89),m=i(88),p=i(90),f=i(91),y=i(92),d=i(66),v=i(2),g=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),x=[{id:v.SID_TRAINING1,sceneKlass:l.default,sceneData:p.default,transitions:{victory:[v.TRN_FADEOUT,v.TRN_NEXT],defeat:[v.TRN_LOSE]}},{id:v.SID_TRAINING2,sceneKlass:l.default,sceneData:f.default,transitions:{victory:[v.TRN_FADEOUT,v.TRN_NEXT],defeat:[v.TRN_LOSE]}},{id:v.SID_TRAINING3,sceneKlass:l.default,sceneData:y.default,transitions:{victory:[v.TRN_FADEOUT,v.TRN_NEXT],defeat:[v.TRN_LOSE]}},{id:v.SID_BABY_SLIME,sceneKlass:a.default,sceneData:u.default,transitions:{victory:[v.TRN_NEXT],defeat:[v.TRN_LOSE]}},{id:v.SID_SLIME_BLAST,sceneKlass:a.default,sceneData:h.default,transitions:{victory:[v.TRN_NEXT],defeat:[v.TRN_LOSE]}},{id:v.SID_PROTOTYPE_BATTLE,sceneKlass:a.default,sceneData:m.default,transitions:{victory:[v.TRN_NEXT],defeat:[v.TRN_LOSE]}},{id:v.SID_PL_LOSE,sceneKlass:c.default}],b=function(){function t(){n(this,t),this._initSceneGraph(),this._bindSceneListeners()}return g(t,[{key:"playScene",value:function(t){t||this.loadScene(this._sceneGraph[0]),"number"==typeof t&&this.loadScene(this._sceneGraph[t]),"string"==typeof t&&this.loadScene(this._findSceneFromId(t)),this._currentScene.play()}},{key:"loadScene",value:function(t){this._currentScene=new t.sceneKlass(t.id,t.sceneData),this._currentSceneIndex=_.indexOf(this._sceneGraph,t)}},{key:"_bindSceneListeners",value:function(){Crafty.bind(v.SCENE_TRANSITION_EVT,this._handleSceneTransition.bind(this))}},{key:"_findSceneFromId",value:function(t){return _.find(this._sceneGraph,function(e){return e.id==t})}},{key:"_getCurrentSceneId",value:function(){return this._currentScene.get("scene_id")}},{key:"_handleSceneTransition",value:function(t){var e;e=this._sceneGraph[this._currentSceneIndex].transitions[t],this._playTransitionSequence(e,0)}},{key:"_playTransitionSequence",value:function(t,e){var i,n,o;if(i=this,!t)return void console.log("DEBUG: there is no transition directive declared for the event");n=_.map(t,function(t){return i._promiseFromTransition(t)}),o=Promise.resolve(),_.each(n,function(t){o=o.then(t.bind(i))})}},{key:"_initSceneGraph",value:function(){this._sceneGraph=x}},{key:"_promiseFromTransition",value:function(t){switch(t){case v.TRN_FADEOUT:return o;case v.TRN_NEXT:if(!this._sceneGraph[this._currentSceneIndex+1])throw new Error("This is the end of the game! we're working on new levels");return r;case v.TRN_LOSE:return s;case"default":throw new Error("Error, invalid transition declared ---> ",t)}}},{key:"currentScene",get:function(){return this._currentScene}}]),t}();e.default=b},function(t,e){function i(t,e,i){if(i)return Crafty.e("2D, Canvas, Particles").attr({x:t,y:e,w:10,h:10}).particles(i)}var n={maxParticles:150,size:18,sizeRandom:4,speed:1,speedRandom:1.2,lifeSpan:29,lifeSpanRandom:25,angle:65,angleRandom:34,startColour:[255,131,0,1],startColourRandom:[48,50,45,0],endColour:[245,35,0,0],endColourRandom:[60,60,60,0],sharpness:20,sharpnessRandom:10,spread:10,duration:5,fastMode:!1,gravity:{x:0,y:.1},jitter:3,originOffset:{x:0,y:0}};window.d_particle_options=_.cloneDeep(n),window.particleFactory=i},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=function(){function t(e){n(this,t),this._storeOptions(e)}return o(t,[{key:"getVocabularies",value:function(t){this.getVocabulariesPromise().done(function(e,i,n){t()})}},{key:"getVocabulariesPromise",value:function(){return $.ajax(this.urls.vocabulariesUrl,{dataType:"json"})}},{key:"_storeOptions",value:function(t){console.log("DEBUG: initializing typewar server caller"),_.isEmpty(t)||(this.urls={vocabulariesUrl:t.vocabulariesUrl||null})}}]),t}();e.default=r},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=i(95),r=i(97),s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();i(96);var a=function(){function t(e,i){if(n(this,t),!e)throw new Error("No container provided to house the game window");this.container=e,this.$container=$(this.container),this.options=i||{},this._setupApi(i),this._setupContainer(),this._initCrafty(),this._initManagers(),this.sceneManager.playScene()}return s(t,[{key:"_initCrafty",value:function(){console.log("DEBUG: initializing Crafty"),Crafty.init(this.viewportWidth,this.viewportHeight),Crafty.viewport.init(this.viewportWidth,this.viewportHeight),Crafty.background("blue")}},{key:"_initManagers",value:function(){this.managers={},this.sceneManager=new o.default}},{key:"_setupApi",value:function(t){window.serverCaller=new r.default(t)}},{key:"_setupContainer",value:function(){switch(this.options.containerSize){case"standard":this.viewportWidth=1080,this.viewportHeight=480;break;default:this.viewportWidth=1080,this.viewportHeight=480}this.$container.css({margin:"auto",width:this.viewportWidth+"px"})}}]),t}();e.default=a},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(98);window.onload=function(t){var e,i;e=$("[data-typewar-container]"),1==e.length&&(i=e.data(),new n.default(e[0],i))}}]);