!function(t){function e(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var r={};e.m=t,e.c=r,e.i=function(t){return t},e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=7)}({17:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),r.d(e,"SND_TYPEWRITER",function(){return n}),r.d(e,"SND_SWORD_SWIPE",function(){return i});var n=["/audios/typewar/typewriter-key-1.mp3","/audios/typewar/typewriter-key-1.wav","/audios/typewar/typewriter-key-1.ogg"],i=["/audios/typewar/59999__qubodup__sword-or-bullet-swish-swosh-12.mp3","/audios/typewar/59999__qubodup__sword-or-bullet-swish-swosh-12.wav","/audios/typewar/59999__qubodup__sword-or-bullet-swish-swosh-12.ogg"]},3:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(17);r.d(e,"SOUND_LETTER_TYPED",function(){return i}),r.d(e,"SOUND_SWORD_SLASH",function(){return o}),r.d(e,"SOUNDS",function(){return a});var i="LETTER_TYPED",o="SWORD_SLASH",a={LETTER_TYPED:n.SND_TYPEWRITER,SWORD_SLASH:n.SND_SWORD_SWIPE}},4:function(t,e,r){!function(){var r={VERSION:"2.4.0",Result:{SUCCEEDED:1,NOTRANSITION:2,CANCELLED:3,PENDING:4},Error:{INVALID_TRANSITION:100,PENDING_TRANSITION:200,INVALID_CALLBACK:300},WILDCARD:"*",ASYNC:"async",create:function(t,e){var n="string"==typeof t.initial?{state:t.initial}:t.initial,i=t.terminal||t.final,o=e||t.target||{},a=t.events||[],s=t.callbacks||{},c={},u={},h=function(t){var e=Array.isArray(t.from)?t.from:t.from?[t.from]:[r.WILDCARD];c[t.name]=c[t.name]||{};for(var n=0;n<e.length;n++)u[e[n]]=u[e[n]]||[],u[e[n]].push(t.name),c[t.name][e[n]]=t.to||e[n];t.to&&(u[t.to]=u[t.to]||[])};n&&(n.event=n.event||"startup",h({name:n.event,from:"none",to:n.state}));for(var _=0;_<a.length;_++)h(a[_]);for(var f in c)c.hasOwnProperty(f)&&(o[f]=r.buildEvent(f,c[f]));for(var f in s)s.hasOwnProperty(f)&&(o[f]=s[f]);return o.current="none",o.is=function(t){return Array.isArray(t)?t.indexOf(this.current)>=0:this.current===t},o.can=function(t){return!this.transition&&void 0!==c[t]&&(c[t].hasOwnProperty(this.current)||c[t].hasOwnProperty(r.WILDCARD))},o.cannot=function(t){return!this.can(t)},o.transitions=function(){return(u[this.current]||[]).concat(u[r.WILDCARD]||[])},o.isFinished=function(){return this.is(i)},o.error=t.error||function(t,e,r,n,i,o,a){throw a||o},o.states=function(){return Object.keys(u).sort()},n&&!n.defer&&o[n.event](),o},doCallback:function(t,e,n,i,o,a){if(e)try{return e.apply(t,[n,i,o].concat(a))}catch(e){return t.error(n,i,o,a,r.Error.INVALID_CALLBACK,"an exception occurred in a caller-provided callback function",e)}},beforeAnyEvent:function(t,e,n,i,o){return r.doCallback(t,t.onbeforeevent,e,n,i,o)},afterAnyEvent:function(t,e,n,i,o){return r.doCallback(t,t.onafterevent||t.onevent,e,n,i,o)},leaveAnyState:function(t,e,n,i,o){return r.doCallback(t,t.onleavestate,e,n,i,o)},enterAnyState:function(t,e,n,i,o){return r.doCallback(t,t.onenterstate||t.onstate,e,n,i,o)},changeState:function(t,e,n,i,o){return r.doCallback(t,t.onchangestate,e,n,i,o)},beforeThisEvent:function(t,e,n,i,o){return r.doCallback(t,t["onbefore"+e],e,n,i,o)},afterThisEvent:function(t,e,n,i,o){return r.doCallback(t,t["onafter"+e]||t["on"+e],e,n,i,o)},leaveThisState:function(t,e,n,i,o){return r.doCallback(t,t["onleave"+n],e,n,i,o)},enterThisState:function(t,e,n,i,o){return r.doCallback(t,t["onenter"+i]||t["on"+i],e,n,i,o)},beforeEvent:function(t,e,n,i,o){if(!1===r.beforeThisEvent(t,e,n,i,o)||!1===r.beforeAnyEvent(t,e,n,i,o))return!1},afterEvent:function(t,e,n,i,o){r.afterThisEvent(t,e,n,i,o),r.afterAnyEvent(t,e,n,i,o)},leaveState:function(t,e,n,i,o){var a=r.leaveThisState(t,e,n,i,o),s=r.leaveAnyState(t,e,n,i,o);return!1!==a&&!1!==s&&(r.ASYNC===a||r.ASYNC===s?r.ASYNC:void 0)},enterState:function(t,e,n,i,o){r.enterThisState(t,e,n,i,o),r.enterAnyState(t,e,n,i,o)},buildEvent:function(t,e){return function(){var n=this.current,i=e[n]||(e[r.WILDCARD]!=r.WILDCARD?e[r.WILDCARD]:n)||n,o=Array.prototype.slice.call(arguments);if(this.transition)return this.error(t,n,i,o,r.Error.PENDING_TRANSITION,"event "+t+" inappropriate because previous transition did not complete");if(this.cannot(t))return this.error(t,n,i,o,r.Error.INVALID_TRANSITION,"event "+t+" inappropriate in current state "+this.current);if(!1===r.beforeEvent(this,t,n,i,o))return r.Result.CANCELLED;if(n===i)return r.afterEvent(this,t,n,i,o),r.Result.NOTRANSITION;var a=this;this.transition=function(){return a.transition=null,a.current=i,r.enterState(a,t,n,i,o),r.changeState(a,t,n,i,o),r.afterEvent(a,t,n,i,o),r.Result.SUCCEEDED},this.transition.cancel=function(){a.transition=null,r.afterEvent(a,t,n,i,o)};var s=r.leaveState(this,t,n,i,o);return!1===s?(this.transition=null,r.Result.CANCELLED):r.ASYNC===s?r.Result.PENDING:this.transition?this.transition():void 0}}};void 0!==t&&t.exports&&(e=t.exports=r),e.StateMachine=r}()},7:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(3),i=r(4);Crafty.c("TextFragment",{_correct_characters:"",_current_position:null,_incorrect_characters:"",_text:"",_textFragFsm:null,textFragment:function(t){return this._initTextFragFsm(),this._text=t,this},activate:function(){this._textFragFsm.activate()},complete:function(){this._textFragFsm.finish()},errorCount:function(){return this._incorrect_characters.length},getCorrectCharacters:function(){return this._correct_characters},getIncorrectCharacters:function(){return this._incorrect_characters},getNextChar:function(){return this._text[this._current_position]},getRemainingCharacters:function(){return this.getText().slice(this._current_position)},getText:function(){return this._text},getTextStatus:function(){return{typed:this.getCorrectCharacters()||"",missed:this.getIncorrectCharacters()||"",rest:this.getRemainingCharacters()||""}},isActive:function(){return this._textFragFsm.is("active")},isComplete:function(){return this._textFragFsm.is("completed")},isCooling:function(){return this._textFragFsm.is("cooling")},isProcessed:function(){return this._textFragFsm.is("processed")},processed:function(){return this._textFragFsm.process()},textLength:function(){return this._text.length},matchFirstChar:function(t){return this._text[0]==t},matchNextChar:function(t){return this.getNextChar()==t},restart:function(){this._textFragFsm.restart()},setText:function(t){this._text=t},successPct:function(){return this.isComplete()?100*(1-this._incorrect_characters.length/this._correct_characters.length):(this._correct_characters.length-this._incorrect_characters.length)/this._text.length*100},takeInput:function(t){return this._text[this._current_position]==t?(this._correctInput(),this._checkForCompletion(),this._triggerRedraw(),!0):(this._wrongInput(t),this._triggerRedraw(),!1)},wasPerfect:function(){return this.successPct()>=99.9},_checkForCompletion:function(){this._correct_characters.length==this._text.length&&this.complete()},_clearTimestamps:function(){this.completed_at=null,this.started_at=null},_correctInput:function(t){this._correct_characters+=this._text[this._current_position],this._current_position++,Crafty.trigger("PlaySound",n.SOUND_LETTER_TYPED)},_getClasses:function(){return this._classes.concat(this._classesFunc(this._currentTime()))},_getClassesForDom:function(){return _.reduce(this._getClasses(),function(t,e){return t+" "+e},"")},_initTextFragFsm:function(){var t=this;this._textFragFsm=i.create({initial:"ready",events:[{name:"activate",from:"ready",to:"active"},{name:"finish",from:"active",to:"completed"},{name:"process",from:"completed",to:"processed"},{name:"restart",from:"completed",to:"ready"},{name:"restart",from:"processed",to:"ready"},{name:"cancel",from:"active",to:"ready"}],callbacks:{onactivate:function(e,r,n){t._onActivate()},oncomplete:function(e,r,n){t._onComplete()},onrestart:function(e,r,n){t._onRestart()},oncancel:function(e,r,n){t._onRestart()}}})},_onActivate:function(){this._current_position=0,this._tagStartedTimestamp(),this.z=99999,Crafty.trigger("TextFragmentActivated",this),this._triggerRedraw()},_onComplete:function(){console.log("DEBUG: TEXT FRAGMENT COMPONENT _COMPLETE ~~~~~~~~"),this._tagCompletedTimestamp(),this._triggerRedraw(),Crafty.trigger("TextFragmentCompleted",this),this.trigger("TextFragmentCompleted")},_onRestart:function(){this._incorrect_characters="",this._correct_characters="",this._current_position=null,this._clearTimestamps(),this._triggerRedraw()},_tagStartedTimestamp:function(){this.started_at=new Date},_tagCompletedTimestamp:function(){this.completed_at=new Date},_triggerRedraw:function(){this.trigger("TextFragmentRedraw")},_wrongInput:function(t){this._incorrect_characters+=t,this.trigger("InputIncorrect")}})}});