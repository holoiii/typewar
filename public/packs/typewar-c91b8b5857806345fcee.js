!function(t){function e(n){if(i[n])return i[n].exports;var r=i[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var i={};e.m=t,e.c=i,e.i=function(t){return t},e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=104)}([function(t,e,i){(function(n){var r,o;!function(s){var a="object"==typeof self&&self.self===self&&self||"object"==typeof n&&n.global===n&&n;r=[i(10),i(9),e],void 0!==(o=function(t,e,i){a.Backbone=s(a,i,t,e)}.apply(e,r))&&(t.exports=o)}(function(t,e,i,n){var r=t.Backbone,o=Array.prototype.slice;e.VERSION="1.3.3",e.$=n,e.noConflict=function(){return t.Backbone=r,this},e.emulateHTTP=!1,e.emulateJSON=!1;var s=function(t,e,n){switch(t){case 1:return function(){return i[e](this[n])};case 2:return function(t){return i[e](this[n],t)};case 3:return function(t,r){return i[e](this[n],l(t,this),r)};case 4:return function(t,r,o){return i[e](this[n],l(t,this),r,o)};default:return function(){var t=o.call(arguments);return t.unshift(this[n]),i[e].apply(i,t)}}},a=function(t,e,n){i.each(e,function(e,r){i[r]&&(t.prototype[r]=s(e,r,n))})},l=function(t,e){return i.isFunction(t)?t:i.isObject(t)&&!e._isModel(t)?c(t):i.isString(t)?function(e){return e.get(t)}:t},c=function(t){var e=i.matches(t);return function(t){return e(t.attributes)}},u=e.Events={},h=/\s+/,p=function(t,e,n,r,o){var s,a=0;if(n&&"object"==typeof n){void 0!==r&&"context"in o&&void 0===o.context&&(o.context=r);for(s=i.keys(n);a<s.length;a++)e=p(t,e,s[a],n[s[a]],o)}else if(n&&h.test(n))for(s=n.split(h);a<s.length;a++)e=t(e,s[a],r,o);else e=t(e,n,r,o);return e};u.on=function(t,e,i){return m(this,t,e,i)};var m=function(t,e,i,n,r){if(t._events=p(f,t._events||{},e,i,{context:n,ctx:t,listening:r}),r){(t._listeners||(t._listeners={}))[r.id]=r}return t};u.listenTo=function(t,e,n){if(!t)return this;var r=t._listenId||(t._listenId=i.uniqueId("l")),o=this._listeningTo||(this._listeningTo={}),s=o[r];if(!s){var a=this._listenId||(this._listenId=i.uniqueId("l"));s=o[r]={obj:t,objId:r,id:a,listeningTo:o,count:0}}return m(t,e,n,this,s),this};var f=function(t,e,i,n){if(i){var r=t[e]||(t[e]=[]),o=n.context,s=n.ctx,a=n.listening;a&&a.count++,r.push({callback:i,context:o,ctx:o||s,listening:a})}return t};u.off=function(t,e,i){return this._events?(this._events=p(_,this._events,t,e,{context:i,listeners:this._listeners}),this):this},u.stopListening=function(t,e,n){var r=this._listeningTo;if(!r)return this;for(var o=t?[t._listenId]:i.keys(r),s=0;s<o.length;s++){var a=r[o[s]];if(!a)break;a.obj.off(e,n,this)}return this};var _=function(t,e,n,r){if(t){var o,s=0,a=r.context,l=r.listeners;if(e||n||a){for(var c=e?[e]:i.keys(t);s<c.length;s++){e=c[s];var u=t[e];if(!u)break;for(var h=[],p=0;p<u.length;p++){var m=u[p];n&&n!==m.callback&&n!==m.callback._callback||a&&a!==m.context?h.push(m):(o=m.listening)&&0==--o.count&&(delete l[o.id],delete o.listeningTo[o.objId])}h.length?t[e]=h:delete t[e]}return t}for(var f=i.keys(l);s<f.length;s++)o=l[f[s]],delete l[o.id],delete o.listeningTo[o.objId]}};u.once=function(t,e,n){var r=p(d,{},t,e,i.bind(this.off,this));return"string"==typeof t&&null==n&&(e=void 0),this.on(r,e,n)},u.listenToOnce=function(t,e,n){var r=p(d,{},e,n,i.bind(this.stopListening,this,t));return this.listenTo(t,r)};var d=function(t,e,n,r){if(n){var o=t[e]=i.once(function(){r(e,o),n.apply(this,arguments)});o._callback=n}return t};u.trigger=function(t){if(!this._events)return this;for(var e=Math.max(0,arguments.length-1),i=Array(e),n=0;n<e;n++)i[n]=arguments[n+1];return p(y,this._events,t,void 0,i),this};var y=function(t,e,i,n){if(t){var r=t[e],o=t.all;r&&o&&(o=o.slice()),r&&g(r,n),o&&g(o,[e].concat(n))}return t},g=function(t,e){var i,n=-1,r=t.length,o=e[0],s=e[1],a=e[2];switch(e.length){case 0:for(;++n<r;)(i=t[n]).callback.call(i.ctx);return;case 1:for(;++n<r;)(i=t[n]).callback.call(i.ctx,o);return;case 2:for(;++n<r;)(i=t[n]).callback.call(i.ctx,o,s);return;case 3:for(;++n<r;)(i=t[n]).callback.call(i.ctx,o,s,a);return;default:for(;++n<r;)(i=t[n]).callback.apply(i.ctx,e);return}};u.bind=u.on,u.unbind=u.off,i.extend(e,u);var v=e.Model=function(t,e){var n=t||{};e||(e={}),this.cid=i.uniqueId(this.cidPrefix),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(n=this.parse(n,e)||{});var r=i.result(this,"defaults");n=i.defaults(i.extend({},r,n),r),this.set(n,e),this.changed={},this.initialize.apply(this,arguments)};i.extend(v.prototype,u,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",initialize:function(){},toJSON:function(t){return i.clone(this.attributes)},sync:function(){return e.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return i.escape(this.get(t))},has:function(t){return null!=this.get(t)},matches:function(t){return!!i.iteratee(t,this)(this.attributes)},set:function(t,e,n){if(null==t)return this;var r;if("object"==typeof t?(r=t,n=e):(r={})[t]=e,n||(n={}),!this._validate(r,n))return!1;var o=n.unset,s=n.silent,a=[],l=this._changing;this._changing=!0,l||(this._previousAttributes=i.clone(this.attributes),this.changed={});var c=this.attributes,u=this.changed,h=this._previousAttributes;for(var p in r)e=r[p],i.isEqual(c[p],e)||a.push(p),i.isEqual(h[p],e)?delete u[p]:u[p]=e,o?delete c[p]:c[p]=e;if(this.idAttribute in r&&(this.id=this.get(this.idAttribute)),!s){a.length&&(this._pending=n);for(var m=0;m<a.length;m++)this.trigger("change:"+a[m],this,c[a[m]],n)}if(l)return this;if(!s)for(;this._pending;)n=this._pending,this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,i.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var n in this.attributes)e[n]=void 0;return this.set(e,i.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!i.isEmpty(this.changed):i.has(this.changed,t)},changedAttributes:function(t){if(!t)return!!this.hasChanged()&&i.clone(this.changed);var e=this._changing?this._previousAttributes:this.attributes,n={};for(var r in t){var o=t[r];i.isEqual(e[r],o)||(n[r]=o)}return!!i.size(n)&&n},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return i.clone(this._previousAttributes)},fetch:function(t){t=i.extend({parse:!0},t);var e=this,n=t.success;return t.success=function(i){var r=t.parse?e.parse(i,t):i;if(!e.set(r,t))return!1;n&&n.call(t.context,e,i,t),e.trigger("sync",e,i,t)},P(this,t),this.sync("read",this,t)},save:function(t,e,n){var r;null==t||"object"==typeof t?(r=t,n=e):(r={})[t]=e,n=i.extend({validate:!0,parse:!0},n);var o=n.wait;if(r&&!o){if(!this.set(r,n))return!1}else if(!this._validate(r,n))return!1;var s=this,a=n.success,l=this.attributes;n.success=function(t){s.attributes=l;var e=n.parse?s.parse(t,n):t;if(o&&(e=i.extend({},r,e)),e&&!s.set(e,n))return!1;a&&a.call(n.context,s,t,n),s.trigger("sync",s,t,n)},P(this,n),r&&o&&(this.attributes=i.extend({},l,r));var c=this.isNew()?"create":n.patch?"patch":"update";"patch"!==c||n.attrs||(n.attrs=r);var u=this.sync(c,this,n);return this.attributes=l,u},destroy:function(t){t=t?i.clone(t):{};var e=this,n=t.success,r=t.wait,o=function(){e.stopListening(),e.trigger("destroy",e,e.collection,t)};t.success=function(i){r&&o(),n&&n.call(t.context,e,i,t),e.isNew()||e.trigger("sync",e,i,t)};var s=!1;return this.isNew()?i.defer(t.success):(P(this,t),s=this.sync("delete",this,t)),r||o(),s},url:function(){var t=i.result(this,"urlRoot")||i.result(this.collection,"url")||I();if(this.isNew())return t;var e=this.get(this.idAttribute);return t.replace(/[^\/]$/,"$&/")+encodeURIComponent(e)},parse:function(t,e){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(t){return this._validate({},i.extend({},t,{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=i.extend({},this.attributes,t);var n=this.validationError=this.validate(t,e)||null;return!n||(this.trigger("invalid",this,n,i.extend(e,{validationError:n})),!1)}}),a(v,{keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1},"attributes");var x=e.Collection=function(t,e){e||(e={}),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,i.extend({silent:!0},e))},b={add:!0,remove:!0,merge:!0},w={add:!0,remove:!1},C=function(t,e,i){i=Math.min(Math.max(i,0),t.length);var n,r=Array(t.length-i),o=e.length;for(n=0;n<r.length;n++)r[n]=t[n+i];for(n=0;n<o;n++)t[n+i]=e[n];for(n=0;n<r.length;n++)t[n+o+i]=r[n]};i.extend(x.prototype,u,{model:v,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return e.sync.apply(this,arguments)},add:function(t,e){return this.set(t,i.extend({merge:!1},e,w))},remove:function(t,e){e=i.extend({},e);var n=!i.isArray(t);t=n?[t]:t.slice();var r=this._removeModels(t,e);return!e.silent&&r.length&&(e.changes={added:[],merged:[],removed:r},this.trigger("update",this,e)),n?r[0]:r},set:function(t,e){if(null!=t){e=i.extend({},b,e),e.parse&&!this._isModel(t)&&(t=this.parse(t,e)||[]);var n=!i.isArray(t);t=n?[t]:t.slice();var r=e.at;null!=r&&(r=+r),r>this.length&&(r=this.length),r<0&&(r+=this.length+1);var o,s,a=[],l=[],c=[],u=[],h={},p=e.add,m=e.merge,f=e.remove,_=!1,d=this.comparator&&null==r&&!1!==e.sort,y=i.isString(this.comparator)?this.comparator:null;for(s=0;s<t.length;s++){o=t[s];var g=this.get(o);if(g){if(m&&o!==g){var v=this._isModel(o)?o.attributes:o;e.parse&&(v=g.parse(v,e)),g.set(v,e),c.push(g),d&&!_&&(_=g.hasChanged(y))}h[g.cid]||(h[g.cid]=!0,a.push(g)),t[s]=g}else p&&(o=t[s]=this._prepareModel(o,e))&&(l.push(o),this._addReference(o,e),h[o.cid]=!0,a.push(o))}if(f){for(s=0;s<this.length;s++)o=this.models[s],h[o.cid]||u.push(o);u.length&&this._removeModels(u,e)}var x=!1,w=!d&&p&&f;if(a.length&&w?(x=this.length!==a.length||i.some(this.models,function(t,e){return t!==a[e]}),this.models.length=0,C(this.models,a,0),this.length=this.models.length):l.length&&(d&&(_=!0),C(this.models,l,null==r?this.length:r),this.length=this.models.length),_&&this.sort({silent:!0}),!e.silent){for(s=0;s<l.length;s++)null!=r&&(e.index=r+s),o=l[s],o.trigger("add",o,this,e);(_||x)&&this.trigger("sort",this,e),(l.length||u.length||c.length)&&(e.changes={added:l,removed:u,merged:c},this.trigger("update",this,e))}return n?t[0]:t}},reset:function(t,e){e=e?i.clone(e):{};for(var n=0;n<this.models.length;n++)this._removeReference(this.models[n],e);return e.previousModels=this.models,this._reset(),t=this.add(t,i.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},push:function(t,e){return this.add(t,i.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t)},unshift:function(t,e){return this.add(t,i.extend({at:0},e))},shift:function(t){var e=this.at(0);return this.remove(e,t)},slice:function(){return o.apply(this.models,arguments)},get:function(t){if(null!=t)return this._byId[t]||this._byId[this.modelId(t.attributes||t)]||t.cid&&this._byId[t.cid]},has:function(t){return null!=this.get(t)},at:function(t){return t<0&&(t+=this.length),this.models[t]},where:function(t,e){return this[e?"find":"filter"](t)},findWhere:function(t){return this.where(t,!0)},sort:function(t){var e=this.comparator;if(!e)throw new Error("Cannot sort a set without a comparator");t||(t={});var n=e.length;return i.isFunction(e)&&(e=i.bind(e,this)),1===n||i.isString(e)?this.models=this.sortBy(e):this.models.sort(e),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return this.map(t+"")},fetch:function(t){t=i.extend({parse:!0},t);var e=t.success,n=this;return t.success=function(i){var r=t.reset?"reset":"set";n[r](i,t),e&&e.call(t.context,n,i,t),n.trigger("sync",n,i,t)},P(this,t),this.sync("read",this,t)},create:function(t,e){e=e?i.clone(e):{};var n=e.wait;if(!(t=this._prepareModel(t,e)))return!1;n||this.add(t,e);var r=this,o=e.success;return e.success=function(t,e,i){n&&r.add(t,i),o&&o.call(i.context,t,e,i)},t.save(null,e),t},parse:function(t,e){return t},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(t){return t[this.model.prototype.idAttribute||"id"]},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(this._isModel(t))return t.collection||(t.collection=this),t;e=e?i.clone(e):{},e.collection=this;var n=new this.model(t,e);return n.validationError?(this.trigger("invalid",this,n.validationError,e),!1):n},_removeModels:function(t,e){for(var i=[],n=0;n<t.length;n++){var r=this.get(t[n]);if(r){var o=this.indexOf(r);this.models.splice(o,1),this.length--,delete this._byId[r.cid];var s=this.modelId(r.attributes);null!=s&&delete this._byId[s],e.silent||(e.index=o,r.trigger("remove",r,this,e)),i.push(r),this._removeReference(r,e)}}return i},_isModel:function(t){return t instanceof v},_addReference:function(t,e){this._byId[t.cid]=t;var i=this.modelId(t.attributes);null!=i&&(this._byId[i]=t),t.on("all",this._onModelEvent,this)},_removeReference:function(t,e){delete this._byId[t.cid];var i=this.modelId(t.attributes);null!=i&&delete this._byId[i],this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,i,n){if(e){if(("add"===t||"remove"===t)&&i!==this)return;if("destroy"===t&&this.remove(e,n),"change"===t){var r=this.modelId(e.previousAttributes()),o=this.modelId(e.attributes);r!==o&&(null!=r&&delete this._byId[r],null!=o&&(this._byId[o]=e))}}this.trigger.apply(this,arguments)}}),a(x,{forEach:3,each:3,map:3,collect:3,reduce:0,foldl:0,inject:0,reduceRight:0,foldr:0,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:3,includes:3,contains:3,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3,groupBy:3,countBy:3,sortBy:3,indexBy:3,findIndex:3,findLastIndex:3},"models");var S=e.View=function(t){this.cid=i.uniqueId("view"),i.extend(this,i.pick(t,A)),this._ensureElement(),this.initialize.apply(this,arguments)},A=["model","collection","el","id","attributes","className","tagName","events"];i.extend(S.prototype,u,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(t){return this.undelegateEvents(),this._setElement(t),this.delegateEvents(),this},_setElement:function(t){this.$el=t instanceof e.$?t:e.$(t),this.el=this.$el[0]},delegateEvents:function(t){if(t||(t=i.result(this,"events")),!t)return this;this.undelegateEvents();for(var e in t){var n=t[e];if(i.isFunction(n)||(n=this[n]),n){var r=e.match(/^(\S+)\s*(.*)$/);this.delegate(r[1],r[2],i.bind(n,this))}}return this},delegate:function(t,e,i){return this.$el.on(t+".delegateEvents"+this.cid,e,i),this},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(t,e,i){return this.$el.off(t+".delegateEvents"+this.cid,e,i),this},_createElement:function(t){return document.createElement(t)},_ensureElement:function(){if(this.el)this.setElement(i.result(this,"el"));else{var t=i.extend({},i.result(this,"attributes"));this.id&&(t.id=i.result(this,"id")),this.className&&(t.class=i.result(this,"className")),this.setElement(this._createElement(i.result(this,"tagName"))),this._setAttributes(t)}},_setAttributes:function(t){this.$el.attr(t)}}),e.sync=function(t,n,r){var o=D[t];i.defaults(r||(r={}),{emulateHTTP:e.emulateHTTP,emulateJSON:e.emulateJSON});var s={type:o,dataType:"json"};if(r.url||(s.url=i.result(n,"url")||I()),null!=r.data||!n||"create"!==t&&"update"!==t&&"patch"!==t||(s.contentType="application/json",s.data=JSON.stringify(r.attrs||n.toJSON(r))),r.emulateJSON&&(s.contentType="application/x-www-form-urlencoded",s.data=s.data?{model:s.data}:{}),r.emulateHTTP&&("PUT"===o||"DELETE"===o||"PATCH"===o)){s.type="POST",r.emulateJSON&&(s.data._method=o);var a=r.beforeSend;r.beforeSend=function(t){if(t.setRequestHeader("X-HTTP-Method-Override",o),a)return a.apply(this,arguments)}}"GET"===s.type||r.emulateJSON||(s.processData=!1);var l=r.error;r.error=function(t,e,i){r.textStatus=e,r.errorThrown=i,l&&l.call(r.context,t,e,i)};var c=r.xhr=e.ajax(i.extend(s,r));return n.trigger("request",n,c,r),c};var D={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};e.ajax=function(){return e.$.ajax.apply(e.$,arguments)};var M=e.Router=function(t){t||(t={}),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)};i.extend(M.prototype,u,{initialize:function(){},route:function(t,n,r){i.isRegExp(t)||(t=this._routeToRegExp(t)),i.isFunction(n)&&(r=n,n=""),r||(r=this[n]);var o=this;return e.history.route(t,function(i){var s=o._extractParameters(t,i);!1!==o.execute(r,s,n)&&(o.trigger.apply(o,["route:"+n].concat(s)),o.trigger("route",n,s),e.history.trigger("route",o,n,s))}),this},execute:function(t,e,i){t&&t.apply(this,e)},navigate:function(t,i){return e.history.navigate(t,i),this},_bindRoutes:function(){if(this.routes){this.routes=i.result(this,"routes");for(var t,e=i.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace(/[\-{}\[\]+?.,\\\^$|#\s]/g,"\\$&").replace(/\((.*?)\)/g,"(?:$1)?").replace(/(\(\?)?:\w+/g,function(t,e){return e?t:"([^/?]+)"}).replace(/\*\w+/g,"([^?]*?)"),new RegExp("^"+t+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(t,e){var n=t.exec(e).slice(1);return i.map(n,function(t,e){return e===n.length-1?t||null:t?decodeURIComponent(t):null})}});var T=e.History=function(){this.handlers=[],this.checkUrl=i.bind(this.checkUrl,this),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)};T.started=!1,i.extend(T.prototype,u,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root&&!this.getSearch()},matchRoot:function(){return this.decodeFragment(this.location.pathname).slice(0,this.root.length-1)+"/"===this.root},decodeFragment:function(t){return decodeURI(t.replace(/%25/g,"%2525"))},getSearch:function(){var t=this.location.href.replace(/#.*/,"").match(/\?.+/);return t?t[0]:""},getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getPath:function(){var t=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return"/"===t.charAt(0)?t.slice(1):t},getFragment:function(t){return null==t&&(t=this._usePushState||!this._wantsHashChange?this.getPath():this.getHash()),t.replace(/^[#\/]|\s+$/g,"")},start:function(t){if(T.started)throw new Error("Backbone.history has already been started");if(T.started=!0,this.options=i.extend({root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._hasHashChange="onhashchange"in window&&(void 0===document.documentMode||document.documentMode>7),this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.history||!this.history.pushState),this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(/^\/+|\/+$/g,"/"),this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){var e=this.root.slice(0,-1)||"/";return this.location.replace(e+"#"+this.getPath()),!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1;var n=document.body,r=n.insertBefore(this.iframe,n.firstChild).contentWindow;r.document.open(),r.document.close(),r.location.hash="#"+this.fragment}var o=window.addEventListener||function(t,e){return attachEvent("on"+t,e)};if(this._usePushState?o("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?o("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),!this.options.silent)return this.loadUrl()},stop:function(){var t=window.removeEventListener||function(t,e){return detachEvent("on"+t,e)};this._usePushState?t("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&t("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),T.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(t){var e=this.getFragment();if(e===this.fragment&&this.iframe&&(e=this.getHash(this.iframe.contentWindow)),e===this.fragment)return!1;this.iframe&&this.navigate(e),this.loadUrl()},loadUrl:function(t){return!!this.matchRoot()&&(t=this.fragment=this.getFragment(t),i.some(this.handlers,function(e){if(e.route.test(t))return e.callback(t),!0}))},navigate:function(t,e){if(!T.started)return!1;e&&!0!==e||(e={trigger:!!e}),t=this.getFragment(t||"");var i=this.root;""!==t&&"?"!==t.charAt(0)||(i=i.slice(0,-1)||"/");var n=i+t;if(t=this.decodeFragment(t.replace(/#.*$/,"")),this.fragment!==t){if(this.fragment=t,this._usePushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);if(this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getHash(this.iframe.contentWindow)){var r=this.iframe.contentWindow;e.replace||(r.document.open(),r.document.close()),this._updateHash(r.location,t,e.replace)}}return e.trigger?this.loadUrl(t):void 0}},_updateHash:function(t,e,i){if(i){var n=t.href.replace(/(javascript:|#).*$/,"");t.replace(n+"#"+e)}else t.hash="#"+e}}),e.history=new T;var k=function(t,e){var n,r=this;return n=t&&i.has(t,"constructor")?t.constructor:function(){return r.apply(this,arguments)},i.extend(n,r,e),n.prototype=i.create(r.prototype,t),n.prototype.constructor=n,n.__super__=r.prototype,n};v.extend=x.extend=M.extend=S.extend=T.extend=k;var I=function(){throw new Error('A "url" property or function must be specified')},P=function(t,e){var i=e.error;e.error=function(n){i&&i.call(e.context,t,n,e),t.trigger("error",t,n,e)}};return e})}).call(e,i(8))},function(t,e,i){!function(e,i){t.exports=i()}(0,function(){return function(t){function e(n){if(i[n])return i[n].exports;var r=i[n]={exports:{},id:n,loaded:!1};return t[n].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){"use strict";function n(){var t=y();return t.compile=function(e,i){return u.compile(e,i,t)},t.precompile=function(e,i){return u.precompile(e,i,t)},t.AST=l.default,t.Compiler=u.Compiler,t.JavaScriptCompiler=p.default,t.Parser=c.parser,t.parse=c.parse,t}var r=i(1).default;e.__esModule=!0;var o=i(2),s=r(o),a=i(24),l=r(a),c=i(25),u=i(30),h=i(31),p=r(h),m=i(28),f=r(m),_=i(23),d=r(_),y=s.default.create,g=n();g.create=n,d.default(g),g.Visitor=f.default,g.default=g,e.default=g,t.exports=e.default},function(t,e){"use strict";e.default=function(t){return t&&t.__esModule?t:{default:t}},e.__esModule=!0},function(t,e,i){"use strict";function n(){var t=new a.HandlebarsEnvironment;return m.extend(t,a),t.SafeString=c.default,t.Exception=h.default,t.Utils=m,t.escapeExpression=m.escapeExpression,t.VM=_,t.template=function(e){return _.template(e,t)},t}var r=i(3).default,o=i(1).default;e.__esModule=!0;var s=i(4),a=r(s),l=i(21),c=o(l),u=i(6),h=o(u),p=i(5),m=r(p),f=i(22),_=r(f),d=i(23),y=o(d),g=n();g.create=n,y.default(g),g.default=g,e.default=g,t.exports=e.default},function(t,e){"use strict";e.default=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e},e.__esModule=!0},function(t,e,i){"use strict";function n(t,e,i){this.helpers=t||{},this.partials=e||{},this.decorators=i||{},l.registerDefaultHelpers(this),c.registerDefaultDecorators(this)}var r=i(1).default;e.__esModule=!0,e.HandlebarsEnvironment=n;var o=i(5),s=i(6),a=r(s),l=i(10),c=i(18),u=i(20),h=r(u);e.VERSION="4.0.5";e.COMPILER_REVISION=7;var p={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1",7:">= 4.0.0"};e.REVISION_CHANGES=p;var m="[object Object]";n.prototype={constructor:n,logger:h.default,log:h.default.log,registerHelper:function(t,e){if(o.toString.call(t)===m){if(e)throw new a.default("Arg not supported with multiple helpers");o.extend(this.helpers,t)}else this.helpers[t]=e},unregisterHelper:function(t){delete this.helpers[t]},registerPartial:function(t,e){if(o.toString.call(t)===m)o.extend(this.partials,t);else{if(void 0===e)throw new a.default('Attempting to register a partial called "'+t+'" as undefined');this.partials[t]=e}},unregisterPartial:function(t){delete this.partials[t]},registerDecorator:function(t,e){if(o.toString.call(t)===m){if(e)throw new a.default("Arg not supported with multiple decorators");o.extend(this.decorators,t)}else this.decorators[t]=e},unregisterDecorator:function(t){delete this.decorators[t]}};var f=h.default.log;e.log=f,e.createFrame=o.createFrame,e.logger=h.default},function(t,e){"use strict";function i(t){return u[t]}function n(t){for(var e=1;e<arguments.length;e++)for(var i in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],i)&&(t[i]=arguments[e][i]);return t}function r(t,e){for(var i=0,n=t.length;i<n;i++)if(t[i]===e)return i;return-1}function o(t){if("string"!=typeof t){if(t&&t.toHTML)return t.toHTML();if(null==t)return"";if(!t)return t+"";t=""+t}return p.test(t)?t.replace(h,i):t}function s(t){return!t&&0!==t||!(!_(t)||0!==t.length)}function a(t){var e=n({},t);return e._parent=t,e}function l(t,e){return t.path=e,t}function c(t,e){return(t?t+".":"")+e}e.__esModule=!0,e.extend=n,e.indexOf=r,e.escapeExpression=o,e.isEmpty=s,e.createFrame=a,e.blockParams=l,e.appendContextPath=c;var u={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;","=":"&#x3D;"},h=/[&<>"'`=]/g,p=/[&<>"'`=]/,m=Object.prototype.toString;e.toString=m;var f=function(t){return"function"==typeof t};f(/x/)&&(e.isFunction=f=function(t){return"function"==typeof t&&"[object Function]"===m.call(t)}),e.isFunction=f;var _=Array.isArray||function(t){return!(!t||"object"!=typeof t)&&"[object Array]"===m.call(t)};e.isArray=_},function(t,e,i){"use strict";function n(t,e){var i=e&&e.loc,s=void 0,a=void 0;i&&(s=i.start.line,a=i.start.column,t+=" - "+s+":"+a);for(var l=Error.prototype.constructor.call(this,t),c=0;c<o.length;c++)this[o[c]]=l[o[c]];Error.captureStackTrace&&Error.captureStackTrace(this,n);try{i&&(this.lineNumber=s,r?Object.defineProperty(this,"column",{value:a}):this.column=a)}catch(t){}}var r=i(7).default;e.__esModule=!0;var o=["description","fileName","lineNumber","message","name","number","stack"];n.prototype=new Error,e.default=n,t.exports=e.default},function(t,e,i){t.exports={default:i(8),__esModule:!0}},function(t,e,i){var n=i(9);t.exports=function(t,e,i){return n.setDesc(t,e,i)}},function(t,e){var i=Object;t.exports={create:i.create,getProto:i.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:i.getOwnPropertyDescriptor,setDesc:i.defineProperty,setDescs:i.defineProperties,getKeys:i.keys,getNames:i.getOwnPropertyNames,getSymbols:i.getOwnPropertySymbols,each:[].forEach}},function(t,e,i){"use strict";function n(t){s.default(t),l.default(t),u.default(t),p.default(t),f.default(t),d.default(t),g.default(t)}var r=i(1).default;e.__esModule=!0,e.registerDefaultHelpers=n;var o=i(11),s=r(o),a=i(12),l=r(a),c=i(13),u=r(c),h=i(14),p=r(h),m=i(15),f=r(m),_=i(16),d=r(_),y=i(17),g=r(y)},function(t,e,i){"use strict";e.__esModule=!0;var n=i(5);e.default=function(t){t.registerHelper("blockHelperMissing",function(e,i){var r=i.inverse,o=i.fn;if(!0===e)return o(this);if(!1===e||null==e)return r(this);if(n.isArray(e))return e.length>0?(i.ids&&(i.ids=[i.name]),t.helpers.each(e,i)):r(this);if(i.data&&i.ids){var s=n.createFrame(i.data);s.contextPath=n.appendContextPath(i.data.contextPath,i.name),i={data:s}}return o(e,i)})},t.exports=e.default},function(t,e,i){"use strict";var n=i(1).default;e.__esModule=!0;var r=i(5),o=i(6),s=n(o);e.default=function(t){t.registerHelper("each",function(t,e){function i(e,i,o){c&&(c.key=e,c.index=i,c.first=0===i,c.last=!!o,u&&(c.contextPath=u+e)),l+=n(t[e],{data:c,blockParams:r.blockParams([t[e],e],[u+e,null])})}if(!e)throw new s.default("Must pass iterator to #each");var n=e.fn,o=e.inverse,a=0,l="",c=void 0,u=void 0;if(e.data&&e.ids&&(u=r.appendContextPath(e.data.contextPath,e.ids[0])+"."),r.isFunction(t)&&(t=t.call(this)),e.data&&(c=r.createFrame(e.data)),t&&"object"==typeof t)if(r.isArray(t))for(var h=t.length;a<h;a++)a in t&&i(a,a,a===t.length-1);else{var p=void 0;for(var m in t)t.hasOwnProperty(m)&&(void 0!==p&&i(p,a-1),p=m,a++);void 0!==p&&i(p,a-1,!0)}return 0===a&&(l=o(this)),l})},t.exports=e.default},function(t,e,i){"use strict";var n=i(1).default;e.__esModule=!0;var r=i(6),o=n(r);e.default=function(t){t.registerHelper("helperMissing",function(){if(1!==arguments.length)throw new o.default('Missing helper: "'+arguments[arguments.length-1].name+'"')})},t.exports=e.default},function(t,e,i){"use strict";e.__esModule=!0;var n=i(5);e.default=function(t){t.registerHelper("if",function(t,e){return n.isFunction(t)&&(t=t.call(this)),!e.hash.includeZero&&!t||n.isEmpty(t)?e.inverse(this):e.fn(this)}),t.registerHelper("unless",function(e,i){return t.helpers.if.call(this,e,{fn:i.inverse,inverse:i.fn,hash:i.hash})})},t.exports=e.default},function(t,e){"use strict";e.__esModule=!0,e.default=function(t){t.registerHelper("log",function(){for(var e=[void 0],i=arguments[arguments.length-1],n=0;n<arguments.length-1;n++)e.push(arguments[n]);var r=1;null!=i.hash.level?r=i.hash.level:i.data&&null!=i.data.level&&(r=i.data.level),e[0]=r,t.log.apply(t,e)})},t.exports=e.default},function(t,e){"use strict";e.__esModule=!0,e.default=function(t){t.registerHelper("lookup",function(t,e){return t&&t[e]})},t.exports=e.default},function(t,e,i){"use strict";e.__esModule=!0;var n=i(5);e.default=function(t){t.registerHelper("with",function(t,e){n.isFunction(t)&&(t=t.call(this));var i=e.fn;if(n.isEmpty(t))return e.inverse(this);var r=e.data;return e.data&&e.ids&&(r=n.createFrame(e.data),r.contextPath=n.appendContextPath(e.data.contextPath,e.ids[0])),i(t,{data:r,blockParams:n.blockParams([t],[r&&r.contextPath])})})},t.exports=e.default},function(t,e,i){"use strict";function n(t){s.default(t)}var r=i(1).default;e.__esModule=!0,e.registerDefaultDecorators=n;var o=i(19),s=r(o)},function(t,e,i){"use strict";e.__esModule=!0;var n=i(5);e.default=function(t){t.registerDecorator("inline",function(t,e,i,r){var o=t;return e.partials||(e.partials={},o=function(r,o){var s=i.partials;i.partials=n.extend({},s,e.partials);var a=t(r,o);return i.partials=s,a}),e.partials[r.args[0]]=r.fn,o})},t.exports=e.default},function(t,e,i){"use strict";e.__esModule=!0;var n=i(5),r={methodMap:["debug","info","warn","error"],level:"info",lookupLevel:function(t){if("string"==typeof t){var e=n.indexOf(r.methodMap,t.toLowerCase());t=e>=0?e:parseInt(t,10)}return t},log:function(t){if(t=r.lookupLevel(t),"undefined"!=typeof console&&r.lookupLevel(r.level)<=t){var e=r.methodMap[t];console[e]||(e="log");for(var i=arguments.length,n=Array(i>1?i-1:0),o=1;o<i;o++)n[o-1]=arguments[o];console[e].apply(console,n)}}};e.default=r,t.exports=e.default},function(t,e){"use strict";function i(t){this.string=t}e.__esModule=!0,i.prototype.toString=i.prototype.toHTML=function(){return""+this.string},e.default=i,t.exports=e.default},function(t,e,i){"use strict";function n(t){var e=t&&t[0]||1,i=y.COMPILER_REVISION;if(e!==i){if(e<i){var n=y.REVISION_CHANGES[i],r=y.REVISION_CHANGES[e];throw new d.default("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+n+") or downgrade your runtime to an older version ("+r+").")}throw new d.default("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+t[1]+").")}}function r(t,e){function i(i,n,r){r.hash&&(n=f.extend({},n,r.hash),r.ids&&(r.ids[0]=!0)),i=e.VM.resolvePartial.call(this,i,n,r);var o=e.VM.invokePartial.call(this,i,n,r);if(null==o&&e.compile&&(r.partials[r.name]=e.compile(i,t.compilerOptions,e),o=r.partials[r.name](n,r)),null!=o){if(r.indent){for(var s=o.split("\n"),a=0,l=s.length;a<l&&(s[a]||a+1!==l);a++)s[a]=r.indent+s[a];o=s.join("\n")}return o}throw new d.default("The partial "+r.name+" could not be compiled when running in runtime-only mode")}function n(e){function i(e){return""+t.main(r,e,r.helpers,r.partials,s,l,a)}var o=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],s=o.data;n._setup(o),!o.partial&&t.useData&&(s=c(e,s));var a=void 0,l=t.useBlockParams?[]:void 0;return t.useDepths&&(a=o.depths?e!=o.depths[0]?[e].concat(o.depths):o.depths:[e]),(i=u(t.main,i,r,o.depths||[],s,l))(e,o)}if(!e)throw new d.default("No environment passed to template");if(!t||!t.main)throw new d.default("Unknown template object: "+typeof t);t.main.decorator=t.main_d,e.VM.checkRevision(t.compiler);var r={strict:function(t,e){if(!(e in t))throw new d.default('"'+e+'" not defined in '+t);return t[e]},lookup:function(t,e){for(var i=t.length,n=0;n<i;n++)if(t[n]&&null!=t[n][e])return t[n][e]},lambda:function(t,e){return"function"==typeof t?t.call(e):t},escapeExpression:f.escapeExpression,invokePartial:i,fn:function(e){var i=t[e];return i.decorator=t[e+"_d"],i},programs:[],program:function(t,e,i,n,r){var s=this.programs[t],a=this.fn(t);return e||r||n||i?s=o(this,t,a,e,i,n,r):s||(s=this.programs[t]=o(this,t,a)),s},data:function(t,e){for(;t&&e--;)t=t._parent;return t},merge:function(t,e){var i=t||e;return t&&e&&t!==e&&(i=f.extend({},e,t)),i},noop:e.VM.noop,compilerInfo:t.compiler};return n.isTop=!0,n._setup=function(i){i.partial?(r.helpers=i.helpers,r.partials=i.partials,r.decorators=i.decorators):(r.helpers=r.merge(i.helpers,e.helpers),t.usePartial&&(r.partials=r.merge(i.partials,e.partials)),(t.usePartial||t.useDecorators)&&(r.decorators=r.merge(i.decorators,e.decorators)))},n._child=function(e,i,n,s){if(t.useBlockParams&&!n)throw new d.default("must pass block params");if(t.useDepths&&!s)throw new d.default("must pass parent depths");return o(r,e,t[e],i,0,n,s)},n}function o(t,e,i,n,r,o,s){function a(e){var r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],a=s;return s&&e!=s[0]&&(a=[e].concat(s)),i(t,e,t.helpers,t.partials,r.data||n,o&&[r.blockParams].concat(o),a)}return a=u(i,a,t,s,n,o),a.program=e,a.depth=s?s.length:0,a.blockParams=r||0,a}function s(t,e,i){if(t)t.call||i.name||(i.name=t,t=i.partials[t]);else if("@partial-block"===i.name){for(var n=i.data;n["partial-block"]===l;)n=n._parent;t=n["partial-block"],n["partial-block"]=l}else t=i.partials[i.name];return t}function a(t,e,i){i.partial=!0,i.ids&&(i.data.contextPath=i.ids[0]||i.data.contextPath);var n=void 0;if(i.fn&&i.fn!==l&&(i.data=y.createFrame(i.data),n=i.data["partial-block"]=i.fn,n.partials&&(i.partials=f.extend({},i.partials,n.partials))),void 0===t&&n&&(t=n),void 0===t)throw new d.default("The partial "+i.name+" could not be found");if(t instanceof Function)return t(e,i)}function l(){return""}function c(t,e){return e&&"root"in e||(e=e?y.createFrame(e):{},e.root=t),e}function u(t,e,i,n,r,o){if(t.decorator){var s={};e=t.decorator(e,s,i,n&&n[0],r,o,n),f.extend(e,s)}return e}var h=i(3).default,p=i(1).default;e.__esModule=!0,e.checkRevision=n,e.template=r,e.wrapProgram=o,e.resolvePartial=s,e.invokePartial=a,e.noop=l;var m=i(5),f=h(m),_=i(6),d=p(_),y=i(4)},function(t,e){(function(i){"use strict";e.__esModule=!0,e.default=function(t){var e=void 0!==i?i:window,n=e.Handlebars;t.noConflict=function(){return e.Handlebars===t&&(e.Handlebars=n),t}},t.exports=e.default}).call(e,function(){return this}())},function(t,e){"use strict";e.__esModule=!0;var i={helpers:{helperExpression:function(t){return"SubExpression"===t.type||("MustacheStatement"===t.type||"BlockStatement"===t.type)&&!!(t.params&&t.params.length||t.hash)},scopedId:function(t){return/^\.|this\b/.test(t.original)},simpleId:function(t){return 1===t.parts.length&&!i.helpers.scopedId(t)&&!t.depth}}};e.default=i,t.exports=e.default},function(t,e,i){"use strict";function n(t,e){return"Program"===t.type?t:(a.default.yy=m,m.locInfo=function(t){return new m.SourceLocation(e&&e.srcName,t)},new c.default(e).accept(a.default.parse(t)))}var r=i(1).default,o=i(3).default;e.__esModule=!0,e.parse=n;var s=i(26),a=r(s),l=i(27),c=r(l),u=i(29),h=o(u),p=i(5);e.parser=a.default;var m={};p.extend(m,h)},function(t,e){"use strict";var i=function(){function t(){this.yy={}}var e={trace:function(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,program_repetition0:6,statement:7,mustache:8,block:9,rawBlock:10,partial:11,partialBlock:12,content:13,COMMENT:14,CONTENT:15,openRawBlock:16,rawBlock_repetition_plus0:17,END_RAW_BLOCK:18,OPEN_RAW_BLOCK:19,helperName:20,openRawBlock_repetition0:21,openRawBlock_option0:22,CLOSE_RAW_BLOCK:23,openBlock:24,block_option0:25,closeBlock:26,openInverse:27,block_option1:28,OPEN_BLOCK:29,openBlock_repetition0:30,openBlock_option0:31,openBlock_option1:32,CLOSE:33,OPEN_INVERSE:34,openInverse_repetition0:35,openInverse_option0:36,openInverse_option1:37,openInverseChain:38,OPEN_INVERSE_CHAIN:39,openInverseChain_repetition0:40,openInverseChain_option0:41,openInverseChain_option1:42,inverseAndProgram:43,INVERSE:44,inverseChain:45,inverseChain_option0:46,OPEN_ENDBLOCK:47,OPEN:48,mustache_repetition0:49,mustache_option0:50,OPEN_UNESCAPED:51,mustache_repetition1:52,mustache_option1:53,CLOSE_UNESCAPED:54,OPEN_PARTIAL:55,partialName:56,partial_repetition0:57,partial_option0:58,openPartialBlock:59,OPEN_PARTIAL_BLOCK:60,openPartialBlock_repetition0:61,openPartialBlock_option0:62,param:63,sexpr:64,OPEN_SEXPR:65,sexpr_repetition0:66,sexpr_option0:67,CLOSE_SEXPR:68,hash:69,hash_repetition_plus0:70,hashSegment:71,ID:72,EQUALS:73,blockParams:74,OPEN_BLOCK_PARAMS:75,blockParams_repetition_plus0:76,CLOSE_BLOCK_PARAMS:77,path:78,dataName:79,STRING:80,NUMBER:81,BOOLEAN:82,UNDEFINED:83,NULL:84,DATA:85,pathSegments:86,SEP:87,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",14:"COMMENT",15:"CONTENT",18:"END_RAW_BLOCK",19:"OPEN_RAW_BLOCK",23:"CLOSE_RAW_BLOCK",29:"OPEN_BLOCK",33:"CLOSE",34:"OPEN_INVERSE",39:"OPEN_INVERSE_CHAIN",44:"INVERSE",47:"OPEN_ENDBLOCK",48:"OPEN",51:"OPEN_UNESCAPED",54:"CLOSE_UNESCAPED",55:"OPEN_PARTIAL",60:"OPEN_PARTIAL_BLOCK",65:"OPEN_SEXPR",68:"CLOSE_SEXPR",72:"ID",73:"EQUALS",75:"OPEN_BLOCK_PARAMS",77:"CLOSE_BLOCK_PARAMS",80:"STRING",81:"NUMBER",82:"BOOLEAN",83:"UNDEFINED",84:"NULL",85:"DATA",87:"SEP"},productions_:[0,[3,2],[4,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[13,1],[10,3],[16,5],[9,4],[9,4],[24,6],[27,6],[38,6],[43,2],[45,3],[45,1],[26,3],[8,5],[8,5],[11,5],[12,3],[59,5],[63,1],[63,1],[64,5],[69,1],[71,3],[74,3],[20,1],[20,1],[20,1],[20,1],[20,1],[20,1],[20,1],[56,1],[56,1],[79,2],[78,1],[86,3],[86,1],[6,0],[6,2],[17,1],[17,2],[21,0],[21,2],[22,0],[22,1],[25,0],[25,1],[28,0],[28,1],[30,0],[30,2],[31,0],[31,1],[32,0],[32,1],[35,0],[35,2],[36,0],[36,1],[37,0],[37,1],[40,0],[40,2],[41,0],[41,1],[42,0],[42,1],[46,0],[46,1],[49,0],[49,2],[50,0],[50,1],[52,0],[52,2],[53,0],[53,1],[57,0],[57,2],[58,0],[58,1],[61,0],[61,2],[62,0],[62,1],[66,0],[66,2],[67,0],[67,1],[70,1],[70,2],[76,1],[76,2]],performAction:function(t,e,i,n,r,o,s){var a=o.length-1;switch(r){case 1:return o[a-1];case 2:this.$=n.prepareProgram(o[a]);break;case 3:case 4:case 5:case 6:case 7:case 8:this.$=o[a];break;case 9:this.$={type:"CommentStatement",value:n.stripComment(o[a]),strip:n.stripFlags(o[a],o[a]),loc:n.locInfo(this._$)};break;case 10:this.$={type:"ContentStatement",original:o[a],value:o[a],loc:n.locInfo(this._$)};break;case 11:this.$=n.prepareRawBlock(o[a-2],o[a-1],o[a],this._$);break;case 12:this.$={path:o[a-3],params:o[a-2],hash:o[a-1]};break;case 13:this.$=n.prepareBlock(o[a-3],o[a-2],o[a-1],o[a],!1,this._$);break;case 14:this.$=n.prepareBlock(o[a-3],o[a-2],o[a-1],o[a],!0,this._$);break;case 15:this.$={open:o[a-5],path:o[a-4],params:o[a-3],hash:o[a-2],blockParams:o[a-1],strip:n.stripFlags(o[a-5],o[a])};break;case 16:case 17:this.$={path:o[a-4],params:o[a-3],hash:o[a-2],blockParams:o[a-1],strip:n.stripFlags(o[a-5],o[a])};break;case 18:this.$={strip:n.stripFlags(o[a-1],o[a-1]),program:o[a]};break;case 19:var l=n.prepareBlock(o[a-2],o[a-1],o[a],o[a],!1,this._$),c=n.prepareProgram([l],o[a-1].loc);c.chained=!0,this.$={strip:o[a-2].strip,program:c,chain:!0};break;case 20:this.$=o[a];break;case 21:this.$={path:o[a-1],strip:n.stripFlags(o[a-2],o[a])};break;case 22:case 23:this.$=n.prepareMustache(o[a-3],o[a-2],o[a-1],o[a-4],n.stripFlags(o[a-4],o[a]),this._$);break;case 24:this.$={type:"PartialStatement",name:o[a-3],params:o[a-2],hash:o[a-1],indent:"",strip:n.stripFlags(o[a-4],o[a]),loc:n.locInfo(this._$)};break;case 25:this.$=n.preparePartialBlock(o[a-2],o[a-1],o[a],this._$);break;case 26:this.$={path:o[a-3],params:o[a-2],hash:o[a-1],strip:n.stripFlags(o[a-4],o[a])};break;case 27:case 28:this.$=o[a];break;case 29:this.$={type:"SubExpression",path:o[a-3],params:o[a-2],hash:o[a-1],loc:n.locInfo(this._$)};break;case 30:this.$={type:"Hash",pairs:o[a],loc:n.locInfo(this._$)};break;case 31:this.$={type:"HashPair",key:n.id(o[a-2]),value:o[a],loc:n.locInfo(this._$)};break;case 32:this.$=n.id(o[a-1]);break;case 33:case 34:this.$=o[a];break;case 35:this.$={type:"StringLiteral",value:o[a],original:o[a],loc:n.locInfo(this._$)};break;case 36:this.$={type:"NumberLiteral",value:Number(o[a]),original:Number(o[a]),loc:n.locInfo(this._$)};break;case 37:this.$={type:"BooleanLiteral",value:"true"===o[a],original:"true"===o[a],loc:n.locInfo(this._$)};break;case 38:this.$={type:"UndefinedLiteral",original:void 0,value:void 0,loc:n.locInfo(this._$)};break;case 39:this.$={type:"NullLiteral",original:null,value:null,loc:n.locInfo(this._$)};break;case 40:case 41:this.$=o[a];break;case 42:this.$=n.preparePath(!0,o[a],this._$);break;case 43:this.$=n.preparePath(!1,o[a],this._$);break;case 44:o[a-2].push({part:n.id(o[a]),original:o[a],separator:o[a-1]}),this.$=o[a-2];break;case 45:this.$=[{part:n.id(o[a]),original:o[a]}];break;case 46:this.$=[];break;case 47:o[a-1].push(o[a]);break;case 48:this.$=[o[a]];break;case 49:o[a-1].push(o[a]);break;case 50:this.$=[];break;case 51:o[a-1].push(o[a]);break;case 58:this.$=[];break;case 59:o[a-1].push(o[a]);break;case 64:this.$=[];break;case 65:o[a-1].push(o[a]);break;case 70:this.$=[];break;case 71:o[a-1].push(o[a]);break;case 78:this.$=[];break;case 79:o[a-1].push(o[a]);break;case 82:this.$=[];break;case 83:o[a-1].push(o[a]);break;case 86:this.$=[];break;case 87:o[a-1].push(o[a]);break;case 90:this.$=[];break;case 91:o[a-1].push(o[a]);break;case 94:this.$=[];break;case 95:o[a-1].push(o[a]);break;case 98:this.$=[o[a]];break;case 99:o[a-1].push(o[a]);break;case 100:this.$=[o[a]];break;case 101:o[a-1].push(o[a])}},table:[{3:1,4:2,5:[2,46],6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{1:[3]},{5:[1,4]},{5:[2,2],7:5,8:6,9:7,10:8,11:9,12:10,13:11,14:[1,12],15:[1,20],16:17,19:[1,23],24:15,27:16,29:[1,21],34:[1,22],39:[2,2],44:[2,2],47:[2,2],48:[1,13],51:[1,14],55:[1,18],59:19,60:[1,24]},{1:[2,1]},{5:[2,47],14:[2,47],15:[2,47],19:[2,47],29:[2,47],34:[2,47],39:[2,47],44:[2,47],47:[2,47],48:[2,47],51:[2,47],55:[2,47],60:[2,47]},{5:[2,3],14:[2,3],15:[2,3],19:[2,3],29:[2,3],34:[2,3],39:[2,3],44:[2,3],47:[2,3],48:[2,3],51:[2,3],55:[2,3],60:[2,3]},{5:[2,4],14:[2,4],15:[2,4],19:[2,4],29:[2,4],34:[2,4],39:[2,4],44:[2,4],47:[2,4],48:[2,4],51:[2,4],55:[2,4],60:[2,4]},{5:[2,5],14:[2,5],15:[2,5],19:[2,5],29:[2,5],34:[2,5],39:[2,5],44:[2,5],47:[2,5],48:[2,5],51:[2,5],55:[2,5],60:[2,5]},{5:[2,6],14:[2,6],15:[2,6],19:[2,6],29:[2,6],34:[2,6],39:[2,6],44:[2,6],47:[2,6],48:[2,6],51:[2,6],55:[2,6],60:[2,6]},{5:[2,7],14:[2,7],15:[2,7],19:[2,7],29:[2,7],34:[2,7],39:[2,7],44:[2,7],47:[2,7],48:[2,7],51:[2,7],55:[2,7],60:[2,7]},{5:[2,8],14:[2,8],15:[2,8],19:[2,8],29:[2,8],34:[2,8],39:[2,8],44:[2,8],47:[2,8],48:[2,8],51:[2,8],55:[2,8],60:[2,8]},{5:[2,9],14:[2,9],15:[2,9],19:[2,9],29:[2,9],34:[2,9],39:[2,9],44:[2,9],47:[2,9],48:[2,9],51:[2,9],55:[2,9],60:[2,9]},{20:25,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:36,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:37,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],39:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{4:38,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{13:40,15:[1,20],17:39},{20:42,56:41,64:43,65:[1,44],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:45,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{5:[2,10],14:[2,10],15:[2,10],18:[2,10],19:[2,10],29:[2,10],34:[2,10],39:[2,10],44:[2,10],47:[2,10],48:[2,10],51:[2,10],55:[2,10],60:[2,10]},{20:46,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:47,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:48,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:42,56:49,64:43,65:[1,44],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[2,78],49:50,65:[2,78],72:[2,78],80:[2,78],81:[2,78],82:[2,78],83:[2,78],84:[2,78],85:[2,78]},{23:[2,33],33:[2,33],54:[2,33],65:[2,33],68:[2,33],72:[2,33],75:[2,33],80:[2,33],81:[2,33],82:[2,33],83:[2,33],84:[2,33],85:[2,33]},{23:[2,34],33:[2,34],54:[2,34],65:[2,34],68:[2,34],72:[2,34],75:[2,34],80:[2,34],81:[2,34],82:[2,34],83:[2,34],84:[2,34],85:[2,34]},{23:[2,35],33:[2,35],54:[2,35],65:[2,35],68:[2,35],72:[2,35],75:[2,35],80:[2,35],81:[2,35],82:[2,35],83:[2,35],84:[2,35],85:[2,35]},{23:[2,36],33:[2,36],54:[2,36],65:[2,36],68:[2,36],72:[2,36],75:[2,36],80:[2,36],81:[2,36],82:[2,36],83:[2,36],84:[2,36],85:[2,36]},{23:[2,37],33:[2,37],54:[2,37],65:[2,37],68:[2,37],72:[2,37],75:[2,37],80:[2,37],81:[2,37],82:[2,37],83:[2,37],84:[2,37],85:[2,37]},{23:[2,38],33:[2,38],54:[2,38],65:[2,38],68:[2,38],72:[2,38],75:[2,38],80:[2,38],81:[2,38],82:[2,38],83:[2,38],84:[2,38],85:[2,38]},{23:[2,39],33:[2,39],54:[2,39],65:[2,39],68:[2,39],72:[2,39],75:[2,39],80:[2,39],81:[2,39],82:[2,39],83:[2,39],84:[2,39],85:[2,39]},{23:[2,43],33:[2,43],54:[2,43],65:[2,43],68:[2,43],72:[2,43],75:[2,43],80:[2,43],81:[2,43],82:[2,43],83:[2,43],84:[2,43],85:[2,43],87:[1,51]},{72:[1,35],86:52},{23:[2,45],33:[2,45],54:[2,45],65:[2,45],68:[2,45],72:[2,45],75:[2,45],80:[2,45],81:[2,45],82:[2,45],83:[2,45],84:[2,45],85:[2,45],87:[2,45]},{52:53,54:[2,82],65:[2,82],72:[2,82],80:[2,82],81:[2,82],82:[2,82],83:[2,82],84:[2,82],85:[2,82]},{25:54,38:56,39:[1,58],43:57,44:[1,59],45:55,47:[2,54]},{28:60,43:61,44:[1,59],47:[2,56]},{13:63,15:[1,20],18:[1,62]},{15:[2,48],18:[2,48]},{33:[2,86],57:64,65:[2,86],72:[2,86],80:[2,86],81:[2,86],82:[2,86],83:[2,86],84:[2,86],85:[2,86]},{33:[2,40],65:[2,40],72:[2,40],80:[2,40],81:[2,40],82:[2,40],83:[2,40],84:[2,40],85:[2,40]},{33:[2,41],65:[2,41],72:[2,41],80:[2,41],81:[2,41],82:[2,41],83:[2,41],84:[2,41],85:[2,41]},{20:65,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{26:66,47:[1,67]},{30:68,33:[2,58],65:[2,58],72:[2,58],75:[2,58],80:[2,58],81:[2,58],82:[2,58],83:[2,58],84:[2,58],85:[2,58]},{33:[2,64],35:69,65:[2,64],72:[2,64],75:[2,64],80:[2,64],81:[2,64],82:[2,64],83:[2,64],84:[2,64],85:[2,64]},{21:70,23:[2,50],65:[2,50],72:[2,50],80:[2,50],81:[2,50],82:[2,50],83:[2,50],84:[2,50],85:[2,50]},{33:[2,90],61:71,65:[2,90],72:[2,90],80:[2,90],81:[2,90],82:[2,90],83:[2,90],84:[2,90],85:[2,90]},{20:75,33:[2,80],50:72,63:73,64:76,65:[1,44],69:74,70:77,71:78,72:[1,79],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{72:[1,80]},{23:[2,42],33:[2,42],54:[2,42],65:[2,42],68:[2,42],72:[2,42],75:[2,42],80:[2,42],81:[2,42],82:[2,42],83:[2,42],84:[2,42],85:[2,42],87:[1,51]},{20:75,53:81,54:[2,84],63:82,64:76,65:[1,44],69:83,70:77,71:78,72:[1,79],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{26:84,47:[1,67]},{47:[2,55]},{4:85,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],39:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{47:[2,20]},{20:86,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:87,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{26:88,47:[1,67]},{47:[2,57]},{5:[2,11],14:[2,11],15:[2,11],19:[2,11],29:[2,11],34:[2,11],39:[2,11],44:[2,11],47:[2,11],48:[2,11],51:[2,11],55:[2,11],60:[2,11]},{15:[2,49],18:[2,49]},{20:75,33:[2,88],58:89,63:90,64:76,65:[1,44],69:91,70:77,71:78,72:[1,79],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{65:[2,94],66:92,68:[2,94],72:[2,94],80:[2,94],81:[2,94],82:[2,94],83:[2,94],84:[2,94],85:[2,94]},{5:[2,25],14:[2,25],15:[2,25],19:[2,25],29:[2,25],34:[2,25],39:[2,25],44:[2,25],47:[2,25],48:[2,25],51:[2,25],55:[2,25],60:[2,25]},{20:93,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:75,31:94,33:[2,60],63:95,64:76,65:[1,44],69:96,70:77,71:78,72:[1,79],75:[2,60],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:75,33:[2,66],36:97,63:98,64:76,65:[1,44],69:99,70:77,71:78,72:[1,79],75:[2,66],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:75,22:100,23:[2,52],63:101,64:76,65:[1,44],69:102,70:77,71:78,72:[1,79],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:75,33:[2,92],62:103,63:104,64:76,65:[1,44],69:105,70:77,71:78,72:[1,79],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[1,106]},{33:[2,79],65:[2,79],72:[2,79],80:[2,79],81:[2,79],82:[2,79],83:[2,79],84:[2,79],85:[2,79]},{33:[2,81]},{23:[2,27],33:[2,27],54:[2,27],65:[2,27],68:[2,27],72:[2,27],75:[2,27],80:[2,27],81:[2,27],82:[2,27],83:[2,27],84:[2,27],85:[2,27]},{23:[2,28],33:[2,28],54:[2,28],65:[2,28],68:[2,28],72:[2,28],75:[2,28],80:[2,28],81:[2,28],82:[2,28],83:[2,28],84:[2,28],85:[2,28]},{23:[2,30],33:[2,30],54:[2,30],68:[2,30],71:107,72:[1,108],75:[2,30]},{23:[2,98],33:[2,98],54:[2,98],68:[2,98],72:[2,98],75:[2,98]},{23:[2,45],33:[2,45],54:[2,45],65:[2,45],68:[2,45],72:[2,45],73:[1,109],75:[2,45],80:[2,45],81:[2,45],82:[2,45],83:[2,45],84:[2,45],85:[2,45],87:[2,45]},{23:[2,44],33:[2,44],54:[2,44],65:[2,44],68:[2,44],72:[2,44],75:[2,44],80:[2,44],81:[2,44],82:[2,44],83:[2,44],84:[2,44],85:[2,44],87:[2,44]},{54:[1,110]},{54:[2,83],65:[2,83],72:[2,83],80:[2,83],81:[2,83],82:[2,83],83:[2,83],84:[2,83],85:[2,83]},{54:[2,85]},{5:[2,13],14:[2,13],15:[2,13],19:[2,13],29:[2,13],34:[2,13],39:[2,13],44:[2,13],47:[2,13],48:[2,13],51:[2,13],55:[2,13],60:[2,13]},{38:56,39:[1,58],43:57,44:[1,59],45:112,46:111,47:[2,76]},{33:[2,70],40:113,65:[2,70],72:[2,70],75:[2,70],80:[2,70],81:[2,70],82:[2,70],83:[2,70],84:[2,70],85:[2,70]},{47:[2,18]},{5:[2,14],14:[2,14],15:[2,14],19:[2,14],29:[2,14],34:[2,14],39:[2,14],44:[2,14],47:[2,14],48:[2,14],51:[2,14],55:[2,14],60:[2,14]},{33:[1,114]},{33:[2,87],65:[2,87],72:[2,87],80:[2,87],81:[2,87],82:[2,87],83:[2,87],84:[2,87],85:[2,87]},{33:[2,89]},{20:75,63:116,64:76,65:[1,44],67:115,68:[2,96],69:117,70:77,71:78,72:[1,79],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[1,118]},{32:119,33:[2,62],74:120,75:[1,121]},{33:[2,59],65:[2,59],72:[2,59],75:[2,59],80:[2,59],81:[2,59],82:[2,59],83:[2,59],84:[2,59],85:[2,59]},{33:[2,61],75:[2,61]},{33:[2,68],37:122,74:123,75:[1,121]},{33:[2,65],65:[2,65],72:[2,65],75:[2,65],80:[2,65],81:[2,65],82:[2,65],83:[2,65],84:[2,65],85:[2,65]},{33:[2,67],75:[2,67]},{23:[1,124]},{23:[2,51],65:[2,51],72:[2,51],80:[2,51],81:[2,51],82:[2,51],83:[2,51],84:[2,51],85:[2,51]},{23:[2,53]},{33:[1,125]},{33:[2,91],65:[2,91],72:[2,91],80:[2,91],81:[2,91],82:[2,91],83:[2,91],84:[2,91],85:[2,91]},{33:[2,93]},{5:[2,22],14:[2,22],15:[2,22],19:[2,22],29:[2,22],34:[2,22],39:[2,22],44:[2,22],47:[2,22],48:[2,22],51:[2,22],55:[2,22],60:[2,22]},{23:[2,99],33:[2,99],54:[2,99],68:[2,99],72:[2,99],75:[2,99]},{73:[1,109]},{20:75,63:126,64:76,65:[1,44],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{5:[2,23],14:[2,23],15:[2,23],19:[2,23],29:[2,23],34:[2,23],39:[2,23],44:[2,23],47:[2,23],48:[2,23],51:[2,23],55:[2,23],60:[2,23]},{47:[2,19]},{47:[2,77]},{20:75,33:[2,72],41:127,63:128,64:76,65:[1,44],69:129,70:77,71:78,72:[1,79],75:[2,72],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{5:[2,24],14:[2,24],15:[2,24],19:[2,24],29:[2,24],34:[2,24],39:[2,24],44:[2,24],47:[2,24],48:[2,24],51:[2,24],55:[2,24],60:[2,24]},{68:[1,130]},{65:[2,95],68:[2,95],72:[2,95],80:[2,95],81:[2,95],82:[2,95],83:[2,95],84:[2,95],85:[2,95]},{68:[2,97]},{5:[2,21],14:[2,21],15:[2,21],19:[2,21],29:[2,21],34:[2,21],39:[2,21],44:[2,21],47:[2,21],48:[2,21],51:[2,21],55:[2,21],60:[2,21]},{33:[1,131]},{33:[2,63]},{72:[1,133],76:132},{33:[1,134]},{33:[2,69]},{15:[2,12]},{14:[2,26],15:[2,26],19:[2,26],29:[2,26],34:[2,26],47:[2,26],48:[2,26],51:[2,26],55:[2,26],60:[2,26]},{23:[2,31],33:[2,31],54:[2,31],68:[2,31],72:[2,31],75:[2,31]},{33:[2,74],42:135,74:136,75:[1,121]},{33:[2,71],65:[2,71],72:[2,71],75:[2,71],80:[2,71],81:[2,71],82:[2,71],83:[2,71],84:[2,71],85:[2,71]},{33:[2,73],75:[2,73]},{23:[2,29],33:[2,29],54:[2,29],65:[2,29],68:[2,29],72:[2,29],75:[2,29],80:[2,29],81:[2,29],82:[2,29],83:[2,29],84:[2,29],85:[2,29]},{14:[2,15],15:[2,15],19:[2,15],29:[2,15],34:[2,15],39:[2,15],44:[2,15],47:[2,15],48:[2,15],51:[2,15],55:[2,15],60:[2,15]},{72:[1,138],77:[1,137]},{72:[2,100],77:[2,100]},{14:[2,16],15:[2,16],19:[2,16],29:[2,16],34:[2,16],44:[2,16],47:[2,16],48:[2,16],51:[2,16],55:[2,16],60:[2,16]},{33:[1,139]},{33:[2,75]},{33:[2,32]},{72:[2,101],77:[2,101]},{14:[2,17],15:[2,17],19:[2,17],29:[2,17],34:[2,17],39:[2,17],44:[2,17],47:[2,17],48:[2,17],51:[2,17],55:[2,17],60:[2,17]}],defaultActions:{4:[2,1],55:[2,55],57:[2,20],61:[2,57],74:[2,81],83:[2,85],87:[2,18],91:[2,89],102:[2,53],105:[2,93],111:[2,19],112:[2,77],117:[2,97],120:[2,63],123:[2,69],124:[2,12],136:[2,75],137:[2,32]},parseError:function(t,e){throw new Error(t)},parse:function(t){var e=this,i=[0],n=[null],r=[],o=this.table,s="",a=0,l=0,c=0;this.lexer.setInput(t),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,void 0===this.lexer.yylloc&&(this.lexer.yylloc={});var u=this.lexer.yylloc;r.push(u);var h=this.lexer.options&&this.lexer.options.ranges;"function"==typeof this.yy.parseError&&(this.parseError=this.yy.parseError);for(var p,m,f,_,d,y,g,v,x,b={};;){if(f=i[i.length-1],this.defaultActions[f]?_=this.defaultActions[f]:(null!==p&&void 0!==p||(p=function(){var t;return t=e.lexer.lex()||1,"number"!=typeof t&&(t=e.symbols_[t]||t),t}()),_=o[f]&&o[f][p]),void 0===_||!_.length||!_[0]){var w="";if(!c){x=[];for(y in o[f])this.terminals_[y]&&y>2&&x.push("'"+this.terminals_[y]+"'");w=this.lexer.showPosition?"Parse error on line "+(a+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+x.join(", ")+", got '"+(this.terminals_[p]||p)+"'":"Parse error on line "+(a+1)+": Unexpected "+(1==p?"end of input":"'"+(this.terminals_[p]||p)+"'"),this.parseError(w,{text:this.lexer.match,token:this.terminals_[p]||p,line:this.lexer.yylineno,loc:u,expected:x})}}if(_[0]instanceof Array&&_.length>1)throw new Error("Parse Error: multiple actions possible at state: "+f+", token: "+p);switch(_[0]){case 1:i.push(p),n.push(this.lexer.yytext),r.push(this.lexer.yylloc),i.push(_[1]),p=null,m?(p=m,m=null):(l=this.lexer.yyleng,s=this.lexer.yytext,a=this.lexer.yylineno,u=this.lexer.yylloc,c>0&&c--);break;case 2:if(g=this.productions_[_[1]][1],b.$=n[n.length-g],b._$={first_line:r[r.length-(g||1)].first_line,last_line:r[r.length-1].last_line,first_column:r[r.length-(g||1)].first_column,last_column:r[r.length-1].last_column},h&&(b._$.range=[r[r.length-(g||1)].range[0],r[r.length-1].range[1]]),void 0!==(d=this.performAction.call(b,s,l,a,this.yy,_[1],n,r)))return d;g&&(i=i.slice(0,-1*g*2),n=n.slice(0,-1*g),r=r.slice(0,-1*g)),i.push(this.productions_[_[1]][0]),n.push(b.$),r.push(b._$),v=o[i[i.length-2]][i[i.length-1]],i.push(v);break;case 3:return!0}}return!0}},i=function(){var t={EOF:1,parseError:function(t,e){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,e)},setInput:function(t){return this._input=t,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var t=this._input[0];return this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t,t.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),t},unput:function(t){var e=t.length,i=t.split(/(?:\r\n?|\n)/g);this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-e-1),this.offset-=e;var n=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),i.length-1&&(this.yylineno-=i.length-1);var r=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:i?(i.length===n.length?this.yylloc.first_column:0)+n[n.length-i.length].length-i[0].length:this.yylloc.first_column-e},this.options.ranges&&(this.yylloc.range=[r[0],r[0]+this.yyleng-e]),this},more:function(){return this._more=!0,this},less:function(t){this.unput(this.match.slice(t))},pastInput:function(){var t=this.matched.substr(0,this.matched.length-this.match.length);return(t.length>20?"...":"")+t.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var t=this.match;return t.length<20&&(t+=this._input.substr(0,20-t.length)),(t.substr(0,20)+(t.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var t=this.pastInput(),e=new Array(t.length+1).join("-");return t+this.upcomingInput()+"\n"+e+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var t,e,i,n,r;this._more||(this.yytext="",this.match="");for(var o=this._currentRules(),s=0;s<o.length&&(!(i=this._input.match(this.rules[o[s]]))||e&&!(i[0].length>e[0].length)||(e=i,n=s,this.options.flex));s++);return e?(r=e[0].match(/(?:\r\n?|\n).*/g),r&&(this.yylineno+=r.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:r?r[r.length-1].length-r[r.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],t=this.performAction.call(this,this.yy,this,o[n],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),t||void 0):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var t=this.next();return void 0!==t?t:this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(t){this.begin(t)}};return t.options={},t.performAction=function(t,e,i,n){function r(t,i){return e.yytext=e.yytext.substr(t,e.yyleng-i)}switch(i){case 0:if("\\\\"===e.yytext.slice(-2)?(r(0,1),this.begin("mu")):"\\"===e.yytext.slice(-1)?(r(0,1),this.begin("emu")):this.begin("mu"),e.yytext)return 15;break;case 1:return 15;case 2:return this.popState(),15;case 3:return this.begin("raw"),15;case 4:return this.popState(),"raw"===this.conditionStack[this.conditionStack.length-1]?15:(e.yytext=e.yytext.substr(5,e.yyleng-9),"END_RAW_BLOCK");case 5:return 15;case 6:return this.popState(),14;case 7:return 65;case 8:return 68;case 9:return 19;case 10:return this.popState(),this.begin("raw"),23;case 11:return 55;case 12:return 60;case 13:return 29;case 14:return 47;case 15:case 16:return this.popState(),44;case 17:return 34;case 18:return 39;case 19:return 51;case 20:return 48;case 21:this.unput(e.yytext),this.popState(),this.begin("com");break;case 22:return this.popState(),14;case 23:return 48;case 24:return 73;case 25:case 26:return 72;case 27:return 87;case 28:break;case 29:return this.popState(),54;case 30:return this.popState(),33;case 31:return e.yytext=r(1,2).replace(/\\"/g,'"'),80;case 32:return e.yytext=r(1,2).replace(/\\'/g,"'"),80;case 33:return 85;case 34:case 35:return 82;case 36:return 83;case 37:return 84;case 38:return 81;case 39:return 75;case 40:return 77;case 41:return 72;case 42:return e.yytext=e.yytext.replace(/\\([\\\]])/g,"$1"),72;case 43:return"INVALID";case 44:return 5}},t.rules=[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|\\\{\{|\\\\\{\{|$)))/,/^(?:\{\{\{\{(?=[^\/]))/,/^(?:\{\{\{\{\/[^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=[=}\s\/.])\}\}\}\})/,/^(?:[^\x00]*?(?=(\{\{\{\{)))/,/^(?:[\s\S]*?--(~)?\}\})/,/^(?:\()/,/^(?:\))/,/^(?:\{\{\{\{)/,/^(?:\}\}\}\})/,/^(?:\{\{(~)?>)/,/^(?:\{\{(~)?#>)/,/^(?:\{\{(~)?#\*?)/,/^(?:\{\{(~)?\/)/,/^(?:\{\{(~)?\^\s*(~)?\}\})/,/^(?:\{\{(~)?\s*else\s*(~)?\}\})/,/^(?:\{\{(~)?\^)/,/^(?:\{\{(~)?\s*else\b)/,/^(?:\{\{(~)?\{)/,/^(?:\{\{(~)?&)/,/^(?:\{\{(~)?!--)/,/^(?:\{\{(~)?![\s\S]*?\}\})/,/^(?:\{\{(~)?\*?)/,/^(?:=)/,/^(?:\.\.)/,/^(?:\.(?=([=~}\s\/.)|])))/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}(~)?\}\})/,/^(?:(~)?\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=([~}\s)])))/,/^(?:false(?=([~}\s)])))/,/^(?:undefined(?=([~}\s)])))/,/^(?:null(?=([~}\s)])))/,/^(?:-?[0-9]+(?:\.[0-9]+)?(?=([~}\s)])))/,/^(?:as\s+\|)/,/^(?:\|)/,/^(?:([^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=([=~}\s\/.)|]))))/,/^(?:\[(\\\]|[^\]])*\])/,/^(?:.)/,/^(?:$)/],t.conditions={mu:{rules:[7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],inclusive:!1},emu:{rules:[2],inclusive:!1},com:{rules:[6],inclusive:!1},raw:{rules:[3,4,5],inclusive:!1},INITIAL:{rules:[0,1,44],inclusive:!0}},t}();return e.lexer=i,t.prototype=e,e.Parser=t,new t}();e.__esModule=!0,e.default=i},function(t,e,i){"use strict";function n(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];this.options=t}function r(t,e,i){void 0===e&&(e=t.length);var n=t[e-1],r=t[e-2];return n?"ContentStatement"===n.type?(r||!i?/\r?\n\s*?$/:/(^|\r?\n)\s*?$/).test(n.original):void 0:i}function o(t,e,i){void 0===e&&(e=-1);var n=t[e+1],r=t[e+2];return n?"ContentStatement"===n.type?(r||!i?/^\s*?\r?\n/:/^\s*?(\r?\n|$)/).test(n.original):void 0:i}function s(t,e,i){var n=t[null==e?0:e+1];if(n&&"ContentStatement"===n.type&&(i||!n.rightStripped)){var r=n.value;n.value=n.value.replace(i?/^\s+/:/^[ \t]*\r?\n?/,""),n.rightStripped=n.value!==r}}function a(t,e,i){var n=t[null==e?t.length-1:e-1];if(n&&"ContentStatement"===n.type&&(i||!n.leftStripped)){var r=n.value;return n.value=n.value.replace(i?/\s+$/:/[ \t]+$/,""),n.leftStripped=n.value!==r,n.leftStripped}}var l=i(1).default;e.__esModule=!0;var c=i(28),u=l(c);n.prototype=new u.default,n.prototype.Program=function(t){var e=!this.options.ignoreStandalone,i=!this.isRootSeen;this.isRootSeen=!0;for(var n=t.body,l=0,c=n.length;l<c;l++){var u=n[l],h=this.accept(u);if(h){var p=r(n,l,i),m=o(n,l,i),f=h.openStandalone&&p,_=h.closeStandalone&&m,d=h.inlineStandalone&&p&&m;h.close&&s(n,l,!0),h.open&&a(n,l,!0),e&&d&&(s(n,l),a(n,l)&&"PartialStatement"===u.type&&(u.indent=/([ \t]+$)/.exec(n[l-1].original)[1])),e&&f&&(s((u.program||u.inverse).body),a(n,l)),e&&_&&(s(n,l),a((u.inverse||u.program).body))}}return t},n.prototype.BlockStatement=n.prototype.DecoratorBlock=n.prototype.PartialBlockStatement=function(t){this.accept(t.program),this.accept(t.inverse);var e=t.program||t.inverse,i=t.program&&t.inverse,n=i,l=i;if(i&&i.chained)for(n=i.body[0].program;l.chained;)l=l.body[l.body.length-1].program;var c={open:t.openStrip.open,close:t.closeStrip.close,openStandalone:o(e.body),closeStandalone:r((n||e).body)};if(t.openStrip.close&&s(e.body,null,!0),i){var u=t.inverseStrip;u.open&&a(e.body,null,!0),u.close&&s(n.body,null,!0),t.closeStrip.open&&a(l.body,null,!0),!this.options.ignoreStandalone&&r(e.body)&&o(n.body)&&(a(e.body),s(n.body))}else t.closeStrip.open&&a(e.body,null,!0);return c},n.prototype.Decorator=n.prototype.MustacheStatement=function(t){return t.strip},n.prototype.PartialStatement=n.prototype.CommentStatement=function(t){var e=t.strip||{};return{inlineStandalone:!0,open:e.open,close:e.close}},e.default=n,t.exports=e.default},function(t,e,i){"use strict";function n(){this.parents=[]}function r(t){this.acceptRequired(t,"path"),this.acceptArray(t.params),this.acceptKey(t,"hash")}function o(t){r.call(this,t),this.acceptKey(t,"program"),this.acceptKey(t,"inverse")}function s(t){this.acceptRequired(t,"name"),this.acceptArray(t.params),this.acceptKey(t,"hash")}var a=i(1).default;e.__esModule=!0;var l=i(6),c=a(l);n.prototype={constructor:n,mutating:!1,acceptKey:function(t,e){var i=this.accept(t[e]);if(this.mutating){if(i&&!n.prototype[i.type])throw new c.default('Unexpected node type "'+i.type+'" found when accepting '+e+" on "+t.type);t[e]=i}},acceptRequired:function(t,e){if(this.acceptKey(t,e),!t[e])throw new c.default(t.type+" requires "+e)},acceptArray:function(t){for(var e=0,i=t.length;e<i;e++)this.acceptKey(t,e),t[e]||(t.splice(e,1),e--,i--)},accept:function(t){if(t){if(!this[t.type])throw new c.default("Unknown type: "+t.type,t);this.current&&this.parents.unshift(this.current),this.current=t;var e=this[t.type](t);return this.current=this.parents.shift(),!this.mutating||e?e:!1!==e?t:void 0}},Program:function(t){this.acceptArray(t.body)},MustacheStatement:r,Decorator:r,BlockStatement:o,DecoratorBlock:o,PartialStatement:s,PartialBlockStatement:function(t){s.call(this,t),this.acceptKey(t,"program")},ContentStatement:function(){},CommentStatement:function(){},SubExpression:r,PathExpression:function(){},StringLiteral:function(){},NumberLiteral:function(){},BooleanLiteral:function(){},UndefinedLiteral:function(){},NullLiteral:function(){},Hash:function(t){this.acceptArray(t.pairs)},HashPair:function(t){this.acceptRequired(t,"value")}},e.default=n,t.exports=e.default},function(t,e,i){"use strict";function n(t,e){if(e=e.path?e.path.original:e,t.path.original!==e){var i={loc:t.path.loc};throw new d.default(t.path.original+" doesn't match "+e,i)}}function r(t,e){this.source=t,this.start={line:e.first_line,column:e.first_column},this.end={line:e.last_line,column:e.last_column}}function o(t){return/^\[.*\]$/.test(t)?t.substr(1,t.length-2):t}function s(t,e){return{open:"~"===t.charAt(2),close:"~"===e.charAt(e.length-3)}}function a(t){return t.replace(/^\{\{~?\!-?-?/,"").replace(/-?-?~?\}\}$/,"")}function l(t,e,i){i=this.locInfo(i);for(var n=t?"@":"",r=[],o=0,s="",a=0,l=e.length;a<l;a++){var c=e[a].part,u=e[a].original!==c;if(n+=(e[a].separator||"")+c,u||".."!==c&&"."!==c&&"this"!==c)r.push(c);else{if(r.length>0)throw new d.default("Invalid path: "+n,{loc:i});".."===c&&(o++,s+="../")}}return{type:"PathExpression",data:t,depth:o,parts:r,original:n,loc:i}}function c(t,e,i,n,r,o){var s=n.charAt(3)||n.charAt(2),a="{"!==s&&"&"!==s;return{type:/\*/.test(n)?"Decorator":"MustacheStatement",path:t,params:e,hash:i,escaped:a,strip:r,loc:this.locInfo(o)}}function u(t,e,i,r){n(t,i),r=this.locInfo(r);var o={type:"Program",body:e,strip:{},loc:r};return{type:"BlockStatement",path:t.path,params:t.params,hash:t.hash,program:o,openStrip:{},inverseStrip:{},closeStrip:{},loc:r}}function h(t,e,i,r,o,s){r&&r.path&&n(t,r);var a=/\*/.test(t.open);e.blockParams=t.blockParams;var l=void 0,c=void 0;if(i){if(a)throw new d.default("Unexpected inverse block on decorator",i);i.chain&&(i.program.body[0].closeStrip=r.strip),c=i.strip,l=i.program}return o&&(o=l,l=e,e=o),{type:a?"DecoratorBlock":"BlockStatement",path:t.path,params:t.params,hash:t.hash,program:e,inverse:l,openStrip:t.strip,inverseStrip:c,closeStrip:r&&r.strip,loc:this.locInfo(s)}}function p(t,e){if(!e&&t.length){var i=t[0].loc,n=t[t.length-1].loc;i&&n&&(e={source:i.source,start:{line:i.start.line,column:i.start.column},end:{line:n.end.line,column:n.end.column}})}return{type:"Program",body:t,strip:{},loc:e}}function m(t,e,i,r){return n(t,i),{type:"PartialBlockStatement",name:t.path,params:t.params,hash:t.hash,program:e,openStrip:t.strip,closeStrip:i&&i.strip,loc:this.locInfo(r)}}var f=i(1).default;e.__esModule=!0,e.SourceLocation=r,e.id=o,e.stripFlags=s,e.stripComment=a,e.preparePath=l,e.prepareMustache=c,e.prepareRawBlock=u,e.prepareBlock=h,e.prepareProgram=p,e.preparePartialBlock=m;var _=i(6),d=f(_)},function(t,e,i){"use strict";function n(){}function r(t,e,i){if(null==t||"string"!=typeof t&&"Program"!==t.type)throw new u.default("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+t);e=e||{},"data"in e||(e.data=!0),e.compat&&(e.useDepths=!0);var n=i.parse(t,e),r=(new i.Compiler).compile(n,e);return(new i.JavaScriptCompiler).compile(r,e)}function o(t,e,i){function n(){var n=i.parse(t,e),r=(new i.Compiler).compile(n,e),o=(new i.JavaScriptCompiler).compile(r,e,void 0,!0);return i.template(o)}function r(t,e){return o||(o=n()),o.call(this,t,e)}if(void 0===e&&(e={}),null==t||"string"!=typeof t&&"Program"!==t.type)throw new u.default("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+t);"data"in e||(e.data=!0),e.compat&&(e.useDepths=!0);var o=void 0;return r._setup=function(t){return o||(o=n()),o._setup(t)},r._child=function(t,e,i,r){return o||(o=n()),o._child(t,e,i,r)},r}function s(t,e){if(t===e)return!0;if(h.isArray(t)&&h.isArray(e)&&t.length===e.length){for(var i=0;i<t.length;i++)if(!s(t[i],e[i]))return!1;return!0}}function a(t){if(!t.path.parts){var e=t.path;t.path={type:"PathExpression",data:!1,depth:0,parts:[e.original+""],original:e.original+"",loc:e.loc}}}var l=i(1).default;e.__esModule=!0,e.Compiler=n,e.precompile=r,e.compile=o;var c=i(6),u=l(c),h=i(5),p=i(24),m=l(p),f=[].slice;n.prototype={compiler:n,equals:function(t){var e=this.opcodes.length;if(t.opcodes.length!==e)return!1;for(var i=0;i<e;i++){var n=this.opcodes[i],r=t.opcodes[i];if(n.opcode!==r.opcode||!s(n.args,r.args))return!1}e=this.children.length;for(var i=0;i<e;i++)if(!this.children[i].equals(t.children[i]))return!1;return!0},guid:0,compile:function(t,e){this.sourceNode=[],this.opcodes=[],this.children=[],this.options=e,this.stringParams=e.stringParams,this.trackIds=e.trackIds,e.blockParams=e.blockParams||[];var i=e.knownHelpers;if(e.knownHelpers={helperMissing:!0,blockHelperMissing:!0,each:!0,if:!0,unless:!0,with:!0,log:!0,lookup:!0},i)for(var n in i)n in i&&(e.knownHelpers[n]=i[n]);return this.accept(t)},compileProgram:function(t){var e=new this.compiler,i=e.compile(t,this.options),n=this.guid++;return this.usePartial=this.usePartial||i.usePartial,this.children[n]=i,this.useDepths=this.useDepths||i.useDepths,n},accept:function(t){if(!this[t.type])throw new u.default("Unknown type: "+t.type,t);this.sourceNode.unshift(t);var e=this[t.type](t);return this.sourceNode.shift(),e},Program:function(t){this.options.blockParams.unshift(t.blockParams);for(var e=t.body,i=e.length,n=0;n<i;n++)this.accept(e[n]);return this.options.blockParams.shift(),this.isSimple=1===i,this.blockParams=t.blockParams?t.blockParams.length:0,this},BlockStatement:function(t){a(t);var e=t.program,i=t.inverse;e=e&&this.compileProgram(e),i=i&&this.compileProgram(i);var n=this.classifySexpr(t);"helper"===n?this.helperSexpr(t,e,i):"simple"===n?(this.simpleSexpr(t),this.opcode("pushProgram",e),this.opcode("pushProgram",i),this.opcode("emptyHash"),this.opcode("blockValue",t.path.original)):(this.ambiguousSexpr(t,e,i),this.opcode("pushProgram",e),this.opcode("pushProgram",i),this.opcode("emptyHash"),this.opcode("ambiguousBlockValue")),this.opcode("append")},DecoratorBlock:function(t){var e=t.program&&this.compileProgram(t.program),i=this.setupFullMustacheParams(t,e,void 0),n=t.path;this.useDecorators=!0,this.opcode("registerDecorator",i.length,n.original)},PartialStatement:function(t){this.usePartial=!0;var e=t.program;e&&(e=this.compileProgram(t.program));var i=t.params;if(i.length>1)throw new u.default("Unsupported number of partial arguments: "+i.length,t);i.length||(this.options.explicitPartialContext?this.opcode("pushLiteral","undefined"):i.push({type:"PathExpression",parts:[],depth:0}));var n=t.name.original,r="SubExpression"===t.name.type;r&&this.accept(t.name),this.setupFullMustacheParams(t,e,void 0,!0);var o=t.indent||"";this.options.preventIndent&&o&&(this.opcode("appendContent",o),o=""),this.opcode("invokePartial",r,n,o),this.opcode("append")},PartialBlockStatement:function(t){this.PartialStatement(t)},MustacheStatement:function(t){this.SubExpression(t),t.escaped&&!this.options.noEscape?this.opcode("appendEscaped"):this.opcode("append")},Decorator:function(t){this.DecoratorBlock(t)},ContentStatement:function(t){t.value&&this.opcode("appendContent",t.value)},CommentStatement:function(){},SubExpression:function(t){a(t);var e=this.classifySexpr(t);"simple"===e?this.simpleSexpr(t):"helper"===e?this.helperSexpr(t):this.ambiguousSexpr(t)},ambiguousSexpr:function(t,e,i){var n=t.path,r=n.parts[0],o=null!=e||null!=i;this.opcode("getContext",n.depth),this.opcode("pushProgram",e),this.opcode("pushProgram",i),n.strict=!0,this.accept(n),this.opcode("invokeAmbiguous",r,o)},simpleSexpr:function(t){var e=t.path;e.strict=!0,this.accept(e),this.opcode("resolvePossibleLambda")},helperSexpr:function(t,e,i){var n=this.setupFullMustacheParams(t,e,i),r=t.path,o=r.parts[0];if(this.options.knownHelpers[o])this.opcode("invokeKnownHelper",n.length,o);else{if(this.options.knownHelpersOnly)throw new u.default("You specified knownHelpersOnly, but used the unknown helper "+o,t);r.strict=!0,r.falsy=!0,this.accept(r),this.opcode("invokeHelper",n.length,r.original,m.default.helpers.simpleId(r))}},PathExpression:function(t){this.addDepth(t.depth),this.opcode("getContext",t.depth);var e=t.parts[0],i=m.default.helpers.scopedId(t),n=!t.depth&&!i&&this.blockParamIndex(e);n?this.opcode("lookupBlockParam",n,t.parts):e?t.data?(this.options.data=!0,this.opcode("lookupData",t.depth,t.parts,t.strict)):this.opcode("lookupOnContext",t.parts,t.falsy,t.strict,i):this.opcode("pushContext")},StringLiteral:function(t){this.opcode("pushString",t.value)},NumberLiteral:function(t){this.opcode("pushLiteral",t.value)},BooleanLiteral:function(t){this.opcode("pushLiteral",t.value)},UndefinedLiteral:function(){this.opcode("pushLiteral","undefined")},NullLiteral:function(){this.opcode("pushLiteral","null")},Hash:function(t){var e=t.pairs,i=0,n=e.length;for(this.opcode("pushHash");i<n;i++)this.pushParam(e[i].value);for(;i--;)this.opcode("assignToHash",e[i].key);this.opcode("popHash")},opcode:function(t){this.opcodes.push({opcode:t,args:f.call(arguments,1),loc:this.sourceNode[0].loc})},addDepth:function(t){t&&(this.useDepths=!0)},classifySexpr:function(t){var e=m.default.helpers.simpleId(t.path),i=e&&!!this.blockParamIndex(t.path.parts[0]),n=!i&&m.default.helpers.helperExpression(t),r=!i&&(n||e);if(r&&!n){var o=t.path.parts[0],s=this.options;s.knownHelpers[o]?n=!0:s.knownHelpersOnly&&(r=!1)}return n?"helper":r?"ambiguous":"simple"},pushParams:function(t){for(var e=0,i=t.length;e<i;e++)this.pushParam(t[e])},pushParam:function(t){var e=null!=t.value?t.value:t.original||"";if(this.stringParams)e.replace&&(e=e.replace(/^(\.?\.\/)*/g,"").replace(/\//g,".")),t.depth&&this.addDepth(t.depth),this.opcode("getContext",t.depth||0),this.opcode("pushStringParam",e,t.type),"SubExpression"===t.type&&this.accept(t);else{if(this.trackIds){var i=void 0;if(!t.parts||m.default.helpers.scopedId(t)||t.depth||(i=this.blockParamIndex(t.parts[0])),i){var n=t.parts.slice(1).join(".");this.opcode("pushId","BlockParam",i,n)}else e=t.original||e,e.replace&&(e=e.replace(/^this(?:\.|$)/,"").replace(/^\.\//,"").replace(/^\.$/,"")),this.opcode("pushId",t.type,e)}this.accept(t)}},setupFullMustacheParams:function(t,e,i,n){var r=t.params;return this.pushParams(r),this.opcode("pushProgram",e),this.opcode("pushProgram",i),t.hash?this.accept(t.hash):this.opcode("emptyHash",n),r},blockParamIndex:function(t){for(var e=0,i=this.options.blockParams.length;e<i;e++){var n=this.options.blockParams[e],r=n&&h.indexOf(n,t);if(n&&r>=0)return[e,r]}}}},function(t,e,i){"use strict";function n(t){this.value=t}function r(){}function o(t,e,i,n){var r=e.popStack(),o=0,s=i.length;for(t&&s--;o<s;o++)r=e.nameLookup(r,i[o],n);return t?[e.aliasable("container.strict"),"(",r,", ",e.quotedString(i[o]),")"]:r}var s=i(1).default;e.__esModule=!0;var a=i(4),l=i(6),c=s(l),u=i(5),h=i(32),p=s(h);r.prototype={nameLookup:function(t,e){return r.isValidJavaScriptVariableName(e)?[t,".",e]:[t,"[",JSON.stringify(e),"]"]},depthedLookup:function(t){return[this.aliasable("container.lookup"),'(depths, "',t,'")']},compilerInfo:function(){var t=a.COMPILER_REVISION;return[t,a.REVISION_CHANGES[t]]},appendToBuffer:function(t,e,i){return u.isArray(t)||(t=[t]),t=this.source.wrap(t,e),this.environment.isSimple?["return ",t,";"]:i?["buffer += ",t,";"]:(t.appendToBuffer=!0,t)},initializeBuffer:function(){return this.quotedString("")},compile:function(t,e,i,n){this.environment=t,this.options=e,this.stringParams=this.options.stringParams,this.trackIds=this.options.trackIds,this.precompile=!n,this.name=this.environment.name,this.isChild=!!i,this.context=i||{decorators:[],programs:[],environments:[]},this.preamble(),this.stackSlot=0,this.stackVars=[],this.aliases={},this.registers={list:[]},this.hashes=[],this.compileStack=[],this.inlineStack=[],this.blockParams=[],this.compileChildren(t,e),this.useDepths=this.useDepths||t.useDepths||t.useDecorators||this.options.compat,this.useBlockParams=this.useBlockParams||t.useBlockParams;var r=t.opcodes,o=void 0,s=void 0,a=void 0,l=void 0;for(a=0,l=r.length;a<l;a++)o=r[a],this.source.currentLocation=o.loc,s=s||o.loc,this[o.opcode].apply(this,o.args);if(this.source.currentLocation=s,this.pushSource(""),this.stackSlot||this.inlineStack.length||this.compileStack.length)throw new c.default("Compile completed with content left on stack");this.decorators.isEmpty()?this.decorators=void 0:(this.useDecorators=!0,this.decorators.prepend("var decorators = container.decorators;\n"),this.decorators.push("return fn;"),n?this.decorators=Function.apply(this,["fn","props","container","depth0","data","blockParams","depths",this.decorators.merge()]):(this.decorators.prepend("function(fn, props, container, depth0, data, blockParams, depths) {\n"),this.decorators.push("}\n"),this.decorators=this.decorators.merge()));var u=this.createFunctionContext(n);if(this.isChild)return u;var h={compiler:this.compilerInfo(),main:u};this.decorators&&(h.main_d=this.decorators,h.useDecorators=!0);var p=this.context,m=p.programs,f=p.decorators;for(a=0,l=m.length;a<l;a++)m[a]&&(h[a]=m[a],f[a]&&(h[a+"_d"]=f[a],h.useDecorators=!0));return this.environment.usePartial&&(h.usePartial=!0),this.options.data&&(h.useData=!0),this.useDepths&&(h.useDepths=!0),this.useBlockParams&&(h.useBlockParams=!0),this.options.compat&&(h.compat=!0),n?h.compilerOptions=this.options:(h.compiler=JSON.stringify(h.compiler),this.source.currentLocation={start:{line:1,column:0}},h=this.objectLiteral(h),e.srcName?(h=h.toStringWithSourceMap({file:e.destName}),h.map=h.map&&h.map.toString()):h=h.toString()),h},preamble:function(){this.lastContext=0,this.source=new p.default(this.options.srcName),this.decorators=new p.default(this.options.srcName)},createFunctionContext:function(t){var e="",i=this.stackVars.concat(this.registers.list);i.length>0&&(e+=", "+i.join(", "));var n=0;for(var r in this.aliases){var o=this.aliases[r];this.aliases.hasOwnProperty(r)&&o.children&&o.referenceCount>1&&(e+=", alias"+ ++n+"="+r,o.children[0]="alias"+n)}var s=["container","depth0","helpers","partials","data"];(this.useBlockParams||this.useDepths)&&s.push("blockParams"),this.useDepths&&s.push("depths");var a=this.mergeSource(e);return t?(s.push(a),Function.apply(this,s)):this.source.wrap(["function(",s.join(","),") {\n  ",a,"}"])},mergeSource:function(t){var e=this.environment.isSimple,i=!this.forceBuffer,n=void 0,r=void 0,o=void 0,s=void 0;return this.source.each(function(t){t.appendToBuffer?(o?t.prepend("  + "):o=t,s=t):(o&&(r?o.prepend("buffer += "):n=!0,s.add(";"),o=s=void 0),r=!0,e||(i=!1))}),i?o?(o.prepend("return "),s.add(";")):r||this.source.push('return "";'):(t+=", buffer = "+(n?"":this.initializeBuffer()),o?(o.prepend("return buffer + "),s.add(";")):this.source.push("return buffer;")),t&&this.source.prepend("var "+t.substring(2)+(n?"":";\n")),this.source.merge()},blockValue:function(t){var e=this.aliasable("helpers.blockHelperMissing"),i=[this.contextName(0)];this.setupHelperArgs(t,0,i);var n=this.popStack();i.splice(1,0,n),this.push(this.source.functionCall(e,"call",i))},ambiguousBlockValue:function(){var t=this.aliasable("helpers.blockHelperMissing"),e=[this.contextName(0)];this.setupHelperArgs("",0,e,!0),this.flushInline();var i=this.topStack();e.splice(1,0,i),this.pushSource(["if (!",this.lastHelper,") { ",i," = ",this.source.functionCall(t,"call",e),"}"])},appendContent:function(t){this.pendingContent?t=this.pendingContent+t:this.pendingLocation=this.source.currentLocation,this.pendingContent=t},append:function(){if(this.isInline())this.replaceStack(function(t){return[" != null ? ",t,' : ""']}),this.pushSource(this.appendToBuffer(this.popStack()));else{var t=this.popStack();this.pushSource(["if (",t," != null) { ",this.appendToBuffer(t,void 0,!0)," }"]),this.environment.isSimple&&this.pushSource(["else { ",this.appendToBuffer("''",void 0,!0)," }"])}},appendEscaped:function(){this.pushSource(this.appendToBuffer([this.aliasable("container.escapeExpression"),"(",this.popStack(),")"]))},getContext:function(t){this.lastContext=t},pushContext:function(){this.pushStackLiteral(this.contextName(this.lastContext))},lookupOnContext:function(t,e,i,n){var r=0;n||!this.options.compat||this.lastContext?this.pushContext():this.push(this.depthedLookup(t[r++])),this.resolvePath("context",t,r,e,i)},lookupBlockParam:function(t,e){this.useBlockParams=!0,this.push(["blockParams[",t[0],"][",t[1],"]"]),this.resolvePath("context",e,1)},lookupData:function(t,e,i){t?this.pushStackLiteral("container.data(data, "+t+")"):this.pushStackLiteral("data"),this.resolvePath("data",e,0,!0,i)},resolvePath:function(t,e,i,n,r){var s=this;if(this.options.strict||this.options.assumeObjects)return void this.push(o(this.options.strict&&r,this,e,t));for(var a=e.length;i<a;i++)this.replaceStack(function(r){var o=s.nameLookup(r,e[i],t);return n?[" && ",o]:[" != null ? ",o," : ",r]})},resolvePossibleLambda:function(){this.push([this.aliasable("container.lambda"),"(",this.popStack(),", ",this.contextName(0),")"])},pushStringParam:function(t,e){this.pushContext(),this.pushString(e),"SubExpression"!==e&&("string"==typeof t?this.pushString(t):this.pushStackLiteral(t))},emptyHash:function(t){this.trackIds&&this.push("{}"),this.stringParams&&(this.push("{}"),this.push("{}")),this.pushStackLiteral(t?"undefined":"{}")},pushHash:function(){this.hash&&this.hashes.push(this.hash),this.hash={values:[],types:[],contexts:[],ids:[]}},popHash:function(){var t=this.hash;this.hash=this.hashes.pop(),this.trackIds&&this.push(this.objectLiteral(t.ids)),this.stringParams&&(this.push(this.objectLiteral(t.contexts)),this.push(this.objectLiteral(t.types))),this.push(this.objectLiteral(t.values))},pushString:function(t){this.pushStackLiteral(this.quotedString(t))},pushLiteral:function(t){this.pushStackLiteral(t)},pushProgram:function(t){null!=t?this.pushStackLiteral(this.programExpression(t)):this.pushStackLiteral(null)},registerDecorator:function(t,e){var i=this.nameLookup("decorators",e,"decorator"),n=this.setupHelperArgs(e,t);this.decorators.push(["fn = ",this.decorators.functionCall(i,"",["fn","props","container",n])," || fn;"])},invokeHelper:function(t,e,i){var n=this.popStack(),r=this.setupHelper(t,e),o=i?[r.name," || "]:"",s=["("].concat(o,n);this.options.strict||s.push(" || ",this.aliasable("helpers.helperMissing")),s.push(")"),this.push(this.source.functionCall(s,"call",r.callParams))},invokeKnownHelper:function(t,e){var i=this.setupHelper(t,e);this.push(this.source.functionCall(i.name,"call",i.callParams))},invokeAmbiguous:function(t,e){this.useRegister("helper");var i=this.popStack();this.emptyHash();var n=this.setupHelper(0,t,e),r=this.lastHelper=this.nameLookup("helpers",t,"helper"),o=["(","(helper = ",r," || ",i,")"];this.options.strict||(o[0]="(helper = ",o.push(" != null ? helper : ",this.aliasable("helpers.helperMissing"))),this.push(["(",o,n.paramsInit?["),(",n.paramsInit]:[],"),","(typeof helper === ",this.aliasable('"function"')," ? ",this.source.functionCall("helper","call",n.callParams)," : helper))"])},invokePartial:function(t,e,i){var n=[],r=this.setupParams(e,1,n);t&&(e=this.popStack(),delete r.name),i&&(r.indent=JSON.stringify(i)),r.helpers="helpers",r.partials="partials",r.decorators="container.decorators",t?n.unshift(e):n.unshift(this.nameLookup("partials",e,"partial")),this.options.compat&&(r.depths="depths"),r=this.objectLiteral(r),n.push(r),this.push(this.source.functionCall("container.invokePartial","",n))},assignToHash:function(t){var e=this.popStack(),i=void 0,n=void 0,r=void 0;this.trackIds&&(r=this.popStack()),this.stringParams&&(n=this.popStack(),i=this.popStack());var o=this.hash;i&&(o.contexts[t]=i),n&&(o.types[t]=n),r&&(o.ids[t]=r),o.values[t]=e},pushId:function(t,e,i){"BlockParam"===t?this.pushStackLiteral("blockParams["+e[0]+"].path["+e[1]+"]"+(i?" + "+JSON.stringify("."+i):"")):"PathExpression"===t?this.pushString(e):"SubExpression"===t?this.pushStackLiteral("true"):this.pushStackLiteral("null")},compiler:r,compileChildren:function(t,e){for(var i=t.children,n=void 0,r=void 0,o=0,s=i.length;o<s;o++){n=i[o],r=new this.compiler;var a=this.matchExistingProgram(n);if(null==a){this.context.programs.push("");var l=this.context.programs.length;n.index=l,n.name="program"+l,this.context.programs[l]=r.compile(n,e,this.context,!this.precompile),this.context.decorators[l]=r.decorators,this.context.environments[l]=n,this.useDepths=this.useDepths||r.useDepths,this.useBlockParams=this.useBlockParams||r.useBlockParams,n.useDepths=this.useDepths,n.useBlockParams=this.useBlockParams}else n.index=a.index,n.name="program"+a.index,this.useDepths=this.useDepths||a.useDepths,this.useBlockParams=this.useBlockParams||a.useBlockParams}},matchExistingProgram:function(t){for(var e=0,i=this.context.environments.length;e<i;e++){var n=this.context.environments[e];if(n&&n.equals(t))return n}},programExpression:function(t){var e=this.environment.children[t],i=[e.index,"data",e.blockParams];return(this.useBlockParams||this.useDepths)&&i.push("blockParams"),this.useDepths&&i.push("depths"),"container.program("+i.join(", ")+")"},useRegister:function(t){this.registers[t]||(this.registers[t]=!0,this.registers.list.push(t))},push:function(t){return t instanceof n||(t=this.source.wrap(t)),this.inlineStack.push(t),t},pushStackLiteral:function(t){this.push(new n(t))},pushSource:function(t){this.pendingContent&&(this.source.push(this.appendToBuffer(this.source.quotedString(this.pendingContent),this.pendingLocation)),this.pendingContent=void 0),t&&this.source.push(t)},replaceStack:function(t){var e=["("],i=void 0,r=void 0,o=void 0;if(!this.isInline())throw new c.default("replaceStack on non-inline");var s=this.popStack(!0);if(s instanceof n)i=[s.value],e=["(",i],o=!0;else{r=!0;var a=this.incrStack();e=["((",this.push(a)," = ",s,")"],i=this.topStack()}var l=t.call(this,i);o||this.popStack(),r&&this.stackSlot--,this.push(e.concat(l,")"))},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),this.topStackName()},topStackName:function(){return"stack"+this.stackSlot},flushInline:function(){var t=this.inlineStack;this.inlineStack=[];for(var e=0,i=t.length;e<i;e++){var r=t[e];if(r instanceof n)this.compileStack.push(r);else{var o=this.incrStack();this.pushSource([o," = ",r,";"]),this.compileStack.push(o)}}},isInline:function(){return this.inlineStack.length},popStack:function(t){var e=this.isInline(),i=(e?this.inlineStack:this.compileStack).pop();if(!t&&i instanceof n)return i.value;if(!e){if(!this.stackSlot)throw new c.default("Invalid stack pop");this.stackSlot--}return i},topStack:function(){var t=this.isInline()?this.inlineStack:this.compileStack,e=t[t.length-1];return e instanceof n?e.value:e},contextName:function(t){return this.useDepths&&t?"depths["+t+"]":"depth"+t},quotedString:function(t){return this.source.quotedString(t)},objectLiteral:function(t){return this.source.objectLiteral(t)},aliasable:function(t){var e=this.aliases[t];return e?(e.referenceCount++,e):(e=this.aliases[t]=this.source.wrap(t),e.aliasable=!0,e.referenceCount=1,e)},setupHelper:function(t,e,i){var n=[];return{params:n,paramsInit:this.setupHelperArgs(e,t,n,i),name:this.nameLookup("helpers",e,"helper"),callParams:[this.aliasable(this.contextName(0)+" != null ? "+this.contextName(0)+" : {}")].concat(n)}},setupParams:function(t,e,i){var n={},r=[],o=[],s=[],a=!i,l=void 0;a&&(i=[]),n.name=this.quotedString(t),n.hash=this.popStack(),this.trackIds&&(n.hashIds=this.popStack()),this.stringParams&&(n.hashTypes=this.popStack(),n.hashContexts=this.popStack());var c=this.popStack(),u=this.popStack();(u||c)&&(n.fn=u||"container.noop",n.inverse=c||"container.noop");for(var h=e;h--;)l=this.popStack(),i[h]=l,this.trackIds&&(s[h]=this.popStack()),this.stringParams&&(o[h]=this.popStack(),r[h]=this.popStack());return a&&(n.args=this.source.generateArray(i)),this.trackIds&&(n.ids=this.source.generateArray(s)),this.stringParams&&(n.types=this.source.generateArray(o),n.contexts=this.source.generateArray(r)),this.options.data&&(n.data="data"),this.useBlockParams&&(n.blockParams="blockParams"),n},setupHelperArgs:function(t,e,i,n){var r=this.setupParams(t,e,i);return r=this.objectLiteral(r),n?(this.useRegister("options"),i.push("options"),["options=",r]):i?(i.push(r),""):r}},function(){for(var t="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield await null true false".split(" "),e=r.RESERVED_WORDS={},i=0,n=t.length;i<n;i++)e[t[i]]=!0}(),r.isValidJavaScriptVariableName=function(t){return!r.RESERVED_WORDS[t]&&/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(t)},e.default=r,t.exports=e.default},function(t,e,i){"use strict";function n(t,e,i){if(o.isArray(t)){for(var n=[],r=0,s=t.length;r<s;r++)n.push(e.wrap(t[r],i));return n}return"boolean"==typeof t||"number"==typeof t?t+"":t}function r(t){this.srcFile=t,this.source=[]}e.__esModule=!0;var o=i(5),s=void 0;s||(s=function(t,e,i,n){this.src="",n&&this.add(n)},s.prototype={add:function(t){o.isArray(t)&&(t=t.join("")),this.src+=t},prepend:function(t){o.isArray(t)&&(t=t.join("")),this.src=t+this.src},toStringWithSourceMap:function(){return{code:this.toString()}},toString:function(){return this.src}}),r.prototype={isEmpty:function(){return!this.source.length},prepend:function(t,e){this.source.unshift(this.wrap(t,e))},push:function(t,e){this.source.push(this.wrap(t,e))},merge:function(){var t=this.empty();return this.each(function(e){t.add(["  ",e,"\n"])}),t},each:function(t){for(var e=0,i=this.source.length;e<i;e++)t(this.source[e])},empty:function(){var t=this.currentLocation||{start:{}};return new s(t.start.line,t.start.column,this.srcFile)},wrap:function(t){var e=arguments.length<=1||void 0===arguments[1]?this.currentLocation||{start:{}}:arguments[1];return t instanceof s?t:(t=n(t,this,e),new s(e.start.line,e.start.column,this.srcFile,t))},functionCall:function(t,e,i){return i=this.generateList(i),this.wrap([t,e?"."+e+"(":"(",i,")"])},quotedString:function(t){return'"'+(t+"").replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},objectLiteral:function(t){var e=[];for(var i in t)if(t.hasOwnProperty(i)){var r=n(t[i],this);"undefined"!==r&&e.push([this.quotedString(i),":",r])}var o=this.generateList(e);return o.prepend("{"),o.add("}"),o},generateList:function(t){for(var e=this.empty(),i=0,r=t.length;i<r;i++)i&&e.add(","),e.add(n(t[i],this));return e},generateArray:function(t){var e=this.generateList(t);return e.prepend("["),e.add("]"),e}},e.default=r,t.exports=e.default}])})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i.d(e,"PLAYER_DEFENDED_ATTACK_EVT",function(){return n}),i.d(e,"PLAYER_SWITCHED_TO_OFFENSE_EVT",function(){return r}),i.d(e,"PLAYER_USED_SKILL_EVT",function(){return o}),i.d(e,"SCENE_TRANSITION_EVT",function(){return s}),i.d(e,"TRAINING_TUTORIAL_COMPLETED_EVT",function(){return a}),i.d(e,"BATTLE_VICTORY_COND",function(){return l}),i.d(e,"BATTLE_DEFEAT_COND",function(){return c}),i.d(e,"SID_TRAINING1",function(){return u}),i.d(e,"SID_TRAINING2",function(){return h}),i.d(e,"SID_TRAINING3",function(){return p}),i.d(e,"SID_BABY_SLIME",function(){return m}),i.d(e,"SID_SLIME_BLAST",function(){return f}),i.d(e,"SID_PROTOTYPE_BATTLE",function(){return _}),i.d(e,"SID_PL_LOSE",function(){return d}),i.d(e,"TRN_FADEOUT",function(){return y}),i.d(e,"TRN_NEXT",function(){return g}),i.d(e,"TRN_LOSE",function(){return v});var n="player_defended_attack",r="player_switched_to_offensive_stance",o="player_used_a_skill",s="scene_transition",a="tutorial_completed",l="victory",c="defeat",u="training_scene_1",h="training_scene_2",p="training_scene_3",m="baby_slime",f="slime_blaster",_="prototype_battle",d="player_lose_scene",y="fadeout",g="next",v="lose"},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(17);i.d(e,"SOUND_LETTER_TYPED",function(){return r}),i.d(e,"SOUND_SWORD_SLASH",function(){return o}),i.d(e,"SOUNDS",function(){return s});var r="LETTER_TYPED",o="SWORD_SLASH",s={LETTER_TYPED:n.SND_TYPEWRITER,SWORD_SLASH:n.SND_SWORD_SWIPE}},function(t,e,i){!function(){var i={VERSION:"2.4.0",Result:{SUCCEEDED:1,NOTRANSITION:2,CANCELLED:3,PENDING:4},Error:{INVALID_TRANSITION:100,PENDING_TRANSITION:200,INVALID_CALLBACK:300},WILDCARD:"*",ASYNC:"async",create:function(t,e){var n="string"==typeof t.initial?{state:t.initial}:t.initial,r=t.terminal||t.final,o=e||t.target||{},s=t.events||[],a=t.callbacks||{},l={},c={},u=function(t){var e=Array.isArray(t.from)?t.from:t.from?[t.from]:[i.WILDCARD];l[t.name]=l[t.name]||{};for(var n=0;n<e.length;n++)c[e[n]]=c[e[n]]||[],c[e[n]].push(t.name),l[t.name][e[n]]=t.to||e[n];t.to&&(c[t.to]=c[t.to]||[])};n&&(n.event=n.event||"startup",u({name:n.event,from:"none",to:n.state}));for(var h=0;h<s.length;h++)u(s[h]);for(var p in l)l.hasOwnProperty(p)&&(o[p]=i.buildEvent(p,l[p]));for(var p in a)a.hasOwnProperty(p)&&(o[p]=a[p]);return o.current="none",o.is=function(t){return Array.isArray(t)?t.indexOf(this.current)>=0:this.current===t},o.can=function(t){return!this.transition&&void 0!==l[t]&&(l[t].hasOwnProperty(this.current)||l[t].hasOwnProperty(i.WILDCARD))},o.cannot=function(t){return!this.can(t)},o.transitions=function(){return(c[this.current]||[]).concat(c[i.WILDCARD]||[])},o.isFinished=function(){return this.is(r)},o.error=t.error||function(t,e,i,n,r,o,s){throw s||o},o.states=function(){return Object.keys(c).sort()},n&&!n.defer&&o[n.event](),o},doCallback:function(t,e,n,r,o,s){if(e)try{return e.apply(t,[n,r,o].concat(s))}catch(e){return t.error(n,r,o,s,i.Error.INVALID_CALLBACK,"an exception occurred in a caller-provided callback function",e)}},beforeAnyEvent:function(t,e,n,r,o){return i.doCallback(t,t.onbeforeevent,e,n,r,o)},afterAnyEvent:function(t,e,n,r,o){return i.doCallback(t,t.onafterevent||t.onevent,e,n,r,o)},leaveAnyState:function(t,e,n,r,o){return i.doCallback(t,t.onleavestate,e,n,r,o)},enterAnyState:function(t,e,n,r,o){return i.doCallback(t,t.onenterstate||t.onstate,e,n,r,o)},changeState:function(t,e,n,r,o){return i.doCallback(t,t.onchangestate,e,n,r,o)},beforeThisEvent:function(t,e,n,r,o){return i.doCallback(t,t["onbefore"+e],e,n,r,o)},afterThisEvent:function(t,e,n,r,o){return i.doCallback(t,t["onafter"+e]||t["on"+e],e,n,r,o)},leaveThisState:function(t,e,n,r,o){return i.doCallback(t,t["onleave"+n],e,n,r,o)},enterThisState:function(t,e,n,r,o){return i.doCallback(t,t["onenter"+r]||t["on"+r],e,n,r,o)},beforeEvent:function(t,e,n,r,o){if(!1===i.beforeThisEvent(t,e,n,r,o)||!1===i.beforeAnyEvent(t,e,n,r,o))return!1},afterEvent:function(t,e,n,r,o){i.afterThisEvent(t,e,n,r,o),i.afterAnyEvent(t,e,n,r,o)},leaveState:function(t,e,n,r,o){var s=i.leaveThisState(t,e,n,r,o),a=i.leaveAnyState(t,e,n,r,o);return!1!==s&&!1!==a&&(i.ASYNC===s||i.ASYNC===a?i.ASYNC:void 0)},enterState:function(t,e,n,r,o){i.enterThisState(t,e,n,r,o),i.enterAnyState(t,e,n,r,o)},buildEvent:function(t,e){return function(){var n=this.current,r=e[n]||(e[i.WILDCARD]!=i.WILDCARD?e[i.WILDCARD]:n)||n,o=Array.prototype.slice.call(arguments);if(this.transition)return this.error(t,n,r,o,i.Error.PENDING_TRANSITION,"event "+t+" inappropriate because previous transition did not complete");if(this.cannot(t))return this.error(t,n,r,o,i.Error.INVALID_TRANSITION,"event "+t+" inappropriate in current state "+this.current);if(!1===i.beforeEvent(this,t,n,r,o))return i.Result.CANCELLED;if(n===r)return i.afterEvent(this,t,n,r,o),i.Result.NOTRANSITION;var s=this;this.transition=function(){return s.transition=null,s.current=r,i.enterState(s,t,n,r,o),i.changeState(s,t,n,r,o),i.afterEvent(s,t,n,r,o),i.Result.SUCCEEDED},this.transition.cancel=function(){s.transition=null,i.afterEvent(s,t,n,r,o)};var a=i.leaveState(this,t,n,r,o);return!1===a?(this.transition=null,i.Result.CANCELLED):i.ASYNC===a?i.Result.PENDING:this.transition?this.transition():void 0}}};void 0!==t&&t.exports&&(e=t.exports=i),e.StateMachine=i}()},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i.d(e,"ANIM_READY",function(){return n}),i.d(e,"ANIM_LIGHT_ATTACK",function(){return r}),i.d(e,"ANIM_MED_ATTACK",function(){return o}),i.d(e,"ANIM_HEAVY_ATTACK",function(){return s}),i.d(e,"ANIM_SPECIAL_ATTACK",function(){return a}),i.d(e,"ANIM_GUARD",function(){return l}),i.d(e,"ANIM_DASH",function(){return c}),i.d(e,"ANIM_JUMP",function(){return u}),i.d(e,"ANIM_ENTER",function(){return h}),i.d(e,"ANIM_CHARGE",function(){return p}),i.d(e,"ANIM_HIT",function(){return m});var n="ANIM_READY",r="ANIM_LIGHT_ATTACK",o="ANIM_MED_ATTACK",s="ANIM_HEAVY_ATTACK",a="ANIM_SPECIAL_ATTACK",l="ANIM_GUARD",c="ANIM_DASH",u="ANIM_JUMP",h="ANIM_ENTER",p="ANIM_CHARGE",m="ANIM_HIT"},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){s&&console.log(t,e)}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=!1,a=function(){function t(){n(this,t)}return o(t,null,[{key:"retrieve",value:function(t,e){if(!t)throw"ERROR: TextLibrarian.retrieve called without a text library";return e||(e={}),this.getTextFromLibrary(t,e)}},{key:"getTextFromLibrary",value:function(t,e){var i,n,o,s,a;for(r("DEBUG: BEGIN LIB REQ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~"),r("DEBUG: options are ---->",e),i=[],s=_.sample(t),n=t.indexOf(s),o=0,i.push(s),a=e.minLength&&e.maxLength?_.random(e.minLength,e.maxLength):e.minLength,r("DEBUG: target length determined as ---->",a);;){if(o+=1,this.lengthOfOutputString(i)>a)return r("DEBUG: finished building string from library -----------> ",i),r("DEBUG: END LIB REQ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~"),r("~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~"),i.join(" ");if(n+1>t.length){var l=_.sample(t);n=t.indexOf(l),i.push(l)}else i.push(t[++n]);if(o>=20)return i.join(" ")}}},{key:"lengthOfOutputString",value:function(t){return t.join(" ").length}}]),t}();e.default=a},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(3),r=i(4);Crafty.c("TextFragment",{_correct_characters:"",_current_position:null,_incorrect_characters:"",_text:"",_textFragFsm:null,textFragment:function(t){return this._initTextFragFsm(),this._text=t,this},activate:function(){this._textFragFsm.activate()},complete:function(){this._textFragFsm.finish()},errorCount:function(){return this._incorrect_characters.length},getCorrectCharacters:function(){return this._correct_characters},getIncorrectCharacters:function(){return this._incorrect_characters},getNextChar:function(){return this._text[this._current_position]},getRemainingCharacters:function(){return this.getText().slice(this._current_position)},getText:function(){return this._text},getTextStatus:function(){return{typed:this.getCorrectCharacters()||"",missed:this.getIncorrectCharacters()||"",rest:this.getRemainingCharacters()||""}},isActive:function(){return this._textFragFsm.is("active")},isComplete:function(){return this._textFragFsm.is("completed")},isCooling:function(){return this._textFragFsm.is("cooling")},isProcessed:function(){return this._textFragFsm.is("processed")},processed:function(){return this._textFragFsm.process()},textLength:function(){return this._text.length},matchFirstChar:function(t){return this._text[0]==t},matchNextChar:function(t){return this.getNextChar()==t},restart:function(){this._textFragFsm.restart()},setText:function(t){this._text=t},successPct:function(){return this.isComplete()?100*(1-this._incorrect_characters.length/this._correct_characters.length):(this._correct_characters.length-this._incorrect_characters.length)/this._text.length*100},takeInput:function(t){return this._text[this._current_position]==t?(this._correctInput(),this._checkForCompletion(),this._triggerRedraw(),!0):(this._wrongInput(t),this._triggerRedraw(),!1)},wasPerfect:function(){return this.successPct()>=99.9},_checkForCompletion:function(){this._correct_characters.length==this._text.length&&this.complete()},_clearTimestamps:function(){this.completed_at=null,this.started_at=null},_correctInput:function(t){this._correct_characters+=this._text[this._current_position],this._current_position++,Crafty.trigger("PlaySound",n.SOUND_LETTER_TYPED)},_getClasses:function(){return this._classes.concat(this._classesFunc(this._currentTime()))},_getClassesForDom:function(){return _.reduce(this._getClasses(),function(t,e){return t+" "+e},"")},_initTextFragFsm:function(){var t=this;this._textFragFsm=r.create({initial:"ready",events:[{name:"activate",from:"ready",to:"active"},{name:"finish",from:"active",to:"completed"},{name:"process",from:"completed",to:"processed"},{name:"restart",from:"completed",to:"ready"},{name:"restart",from:"processed",to:"ready"},{name:"cancel",from:"active",to:"ready"}],callbacks:{onactivate:function(e,i,n){t._onActivate()},oncomplete:function(e,i,n){t._onComplete()},onrestart:function(e,i,n){t._onRestart()},oncancel:function(e,i,n){t._onRestart()}}})},_onActivate:function(){this._current_position=0,this._tagStartedTimestamp(),this.z=99999,Crafty.trigger("TextFragmentActivated",this),this._triggerRedraw()},_onComplete:function(){console.log("DEBUG: TEXT FRAGMENT COMPONENT _COMPLETE ~~~~~~~~"),this._tagCompletedTimestamp(),this._triggerRedraw(),Crafty.trigger("TextFragmentCompleted",this),this.trigger("TextFragmentCompleted")},_onRestart:function(){this._incorrect_characters="",this._correct_characters="",this._current_position=null,this._clearTimestamps(),this._triggerRedraw()},_tagStartedTimestamp:function(){this.started_at=new Date},_tagCompletedTimestamp:function(){this.completed_at=new Date},_triggerRedraw:function(){this.trigger("TextFragmentRedraw")},_wrongInput:function(t){this._incorrect_characters+=t,this.trigger("InputIncorrect")}})},function(t,e){var i;i=function(){return this}();try{i=i||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(i=window)}t.exports=i},function(t,e,i){var n,r;!function(e,i){"use strict";"object"==typeof t&&"object"==typeof t.exports?t.exports=e.document?i(e,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return i(t)}:i(e)}("undefined"!=typeof window?window:this,function(i,o){"use strict";function s(t,e){e=e||st;var i=e.createElement("script");i.text=t,e.head.appendChild(i).parentNode.removeChild(i)}function a(t){var e=!!t&&"length"in t&&t.length,i=gt.type(t);return"function"!==i&&!gt.isWindow(t)&&("array"===i||0===e||"number"==typeof e&&e>0&&e-1 in t)}function l(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()}function c(t,e,i){return gt.isFunction(e)?gt.grep(t,function(t,n){return!!e.call(t,n,t)!==i}):e.nodeType?gt.grep(t,function(t){return t===e!==i}):"string"!=typeof e?gt.grep(t,function(t){return ht.call(e,t)>-1!==i}):At.test(e)?gt.filter(e,t,i):(e=gt.filter(e,t),gt.grep(t,function(t){return ht.call(e,t)>-1!==i&&1===t.nodeType}))}function u(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}function h(t){var e={};return gt.each(t.match(It)||[],function(t,i){e[i]=!0}),e}function p(t){return t}function m(t){throw t}function f(t,e,i,n){var r;try{t&&gt.isFunction(r=t.promise)?r.call(t).done(e).fail(i):t&&gt.isFunction(r=t.then)?r.call(t,e,i):e.apply(void 0,[t].slice(n))}catch(t){i.apply(void 0,[t])}}function _(){st.removeEventListener("DOMContentLoaded",_),i.removeEventListener("load",_),gt.ready()}function d(){this.expando=gt.expando+d.uid++}function y(t){return"true"===t||"false"!==t&&("null"===t?null:t===+t+""?+t:Ot.test(t)?JSON.parse(t):t)}function g(t,e,i){var n;if(void 0===i&&1===t.nodeType)if(n="data-"+e.replace(Ft,"-$&").toLowerCase(),"string"==typeof(i=t.getAttribute(n))){try{i=y(i)}catch(t){}Vt.set(t,e,i)}else i=void 0;return i}function v(t,e,i,n){var r,o=1,s=20,a=n?function(){return n.cur()}:function(){return gt.css(t,e,"")},l=a(),c=i&&i[3]||(gt.cssNumber[e]?"":"px"),u=(gt.cssNumber[e]||"px"!==c&&+l)&&jt.exec(gt.css(t,e));if(u&&u[3]!==c){c=c||u[3],i=i||[],u=+l||1;do{o=o||".5",u/=o,gt.style(t,e,u+c)}while(o!==(o=a()/l)&&1!==o&&--s)}return i&&(u=+u||+l||0,r=i[1]?u+(i[1]+1)*i[2]:+i[2],n&&(n.unit=c,n.start=u,n.end=r)),r}function x(t){var e,i=t.ownerDocument,n=t.nodeName,r=Ht[n];return r||(e=i.body.appendChild(i.createElement(n)),r=gt.css(e,"display"),e.parentNode.removeChild(e),"none"===r&&(r="block"),Ht[n]=r,r)}function b(t,e){for(var i,n,r=[],o=0,s=t.length;o<s;o++)n=t[o],n.style&&(i=n.style.display,e?("none"===i&&(r[o]=Rt.get(n,"display")||null,r[o]||(n.style.display="")),""===n.style.display&&zt(n)&&(r[o]=x(n))):"none"!==i&&(r[o]="none",Rt.set(n,"display",i)));for(o=0;o<s;o++)null!=r[o]&&(t[o].style.display=r[o]);return t}function w(t,e){var i;return i=void 0!==t.getElementsByTagName?t.getElementsByTagName(e||"*"):void 0!==t.querySelectorAll?t.querySelectorAll(e||"*"):[],void 0===e||e&&l(t,e)?gt.merge([t],i):i}function C(t,e){for(var i=0,n=t.length;i<n;i++)Rt.set(t[i],"globalEval",!e||Rt.get(e[i],"globalEval"))}function S(t,e,i,n,r){for(var o,s,a,l,c,u,h=e.createDocumentFragment(),p=[],m=0,f=t.length;m<f;m++)if((o=t[m])||0===o)if("object"===gt.type(o))gt.merge(p,o.nodeType?[o]:o);else if(Kt.test(o)){for(s=s||h.appendChild(e.createElement("div")),a=(qt.exec(o)||["",""])[1].toLowerCase(),l=$t[a]||$t._default,s.innerHTML=l[1]+gt.htmlPrefilter(o)+l[2],u=l[0];u--;)s=s.lastChild;gt.merge(p,s.childNodes),s=h.firstChild,s.textContent=""}else p.push(e.createTextNode(o));for(h.textContent="",m=0;o=p[m++];)if(n&&gt.inArray(o,n)>-1)r&&r.push(o);else if(c=gt.contains(o.ownerDocument,o),s=w(h.appendChild(o),"script"),c&&C(s),i)for(u=0;o=s[u++];)Wt.test(o.type||"")&&i.push(o);return h}function A(){return!0}function D(){return!1}function M(){try{return st.activeElement}catch(t){}}function T(t,e,i,n,r,o){var s,a;if("object"==typeof e){"string"!=typeof i&&(n=n||i,i=void 0);for(a in e)T(t,a,i,n,e[a],o);return t}if(null==n&&null==r?(r=i,n=i=void 0):null==r&&("string"==typeof i?(r=n,n=void 0):(r=n,n=i,i=void 0)),!1===r)r=D;else if(!r)return t;return 1===o&&(s=r,r=function(t){return gt().off(t),s.apply(this,arguments)},r.guid=s.guid||(s.guid=gt.guid++)),t.each(function(){gt.event.add(this,e,r,n,i)})}function k(t,e){return l(t,"table")&&l(11!==e.nodeType?e:e.firstChild,"tr")?gt(">tbody",t)[0]||t:t}function I(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function P(t){var e=ie.exec(t.type);return e?t.type=e[1]:t.removeAttribute("type"),t}function B(t,e){var i,n,r,o,s,a,l,c;if(1===e.nodeType){if(Rt.hasData(t)&&(o=Rt.access(t),s=Rt.set(e,o),c=o.events)){delete s.handle,s.events={};for(r in c)for(i=0,n=c[r].length;i<n;i++)gt.event.add(e,r,c[r][i])}Vt.hasData(t)&&(a=Vt.access(t),l=gt.extend({},a),Vt.set(e,l))}}function E(t,e){var i=e.nodeName.toLowerCase();"input"===i&&Ut.test(t.type)?e.checked=t.checked:"input"!==i&&"textarea"!==i||(e.defaultValue=t.defaultValue)}function L(t,e,i,n){e=ct.apply([],e);var r,o,a,l,c,u,h=0,p=t.length,m=p-1,f=e[0],_=gt.isFunction(f);if(_||p>1&&"string"==typeof f&&!yt.checkClone&&ee.test(f))return t.each(function(r){var o=t.eq(r);_&&(e[0]=f.call(this,r,o.html())),L(o,e,i,n)});if(p&&(r=S(e,t[0].ownerDocument,!1,t,n),o=r.firstChild,1===r.childNodes.length&&(r=o),o||n)){for(a=gt.map(w(r,"script"),I),l=a.length;h<p;h++)c=r,h!==m&&(c=gt.clone(c,!0,!0),l&&gt.merge(a,w(c,"script"))),i.call(t[h],c,h);if(l)for(u=a[a.length-1].ownerDocument,gt.map(a,P),h=0;h<l;h++)c=a[h],Wt.test(c.type||"")&&!Rt.access(c,"globalEval")&&gt.contains(u,c)&&(c.src?gt._evalUrl&&gt._evalUrl(c.src):s(c.textContent.replace(ne,""),u))}return t}function R(t,e,i){for(var n,r=e?gt.filter(e,t):t,o=0;null!=(n=r[o]);o++)i||1!==n.nodeType||gt.cleanData(w(n)),n.parentNode&&(i&&gt.contains(n.ownerDocument,n)&&C(w(n,"script")),n.parentNode.removeChild(n));return t}function V(t,e,i){var n,r,o,s,a=t.style;return i=i||se(t),i&&(s=i.getPropertyValue(e)||i[e],""!==s||gt.contains(t.ownerDocument,t)||(s=gt.style(t,e)),!yt.pixelMarginRight()&&oe.test(s)&&re.test(e)&&(n=a.width,r=a.minWidth,o=a.maxWidth,a.minWidth=a.maxWidth=a.width=s,s=i.width,a.width=n,a.minWidth=r,a.maxWidth=o)),void 0!==s?s+"":s}function O(t,e){return{get:function(){return t()?void delete this.get:(this.get=e).apply(this,arguments)}}}function F(t){if(t in pe)return t;for(var e=t[0].toUpperCase()+t.slice(1),i=he.length;i--;)if((t=he[i]+e)in pe)return t}function N(t){var e=gt.cssProps[t];return e||(e=gt.cssProps[t]=F(t)||t),e}function j(t,e,i){var n=jt.exec(e);return n?Math.max(0,n[2]-(i||0))+(n[3]||"px"):e}function G(t,e,i,n,r){var o,s=0;for(o=i===(n?"border":"content")?4:"width"===e?1:0;o<4;o+=2)"margin"===i&&(s+=gt.css(t,i+Gt[o],!0,r)),n?("content"===i&&(s-=gt.css(t,"padding"+Gt[o],!0,r)),"margin"!==i&&(s-=gt.css(t,"border"+Gt[o]+"Width",!0,r))):(s+=gt.css(t,"padding"+Gt[o],!0,r),"padding"!==i&&(s+=gt.css(t,"border"+Gt[o]+"Width",!0,r)));return s}function z(t,e,i){var n,r=se(t),o=V(t,e,r),s="border-box"===gt.css(t,"boxSizing",!1,r);return oe.test(o)?o:(n=s&&(yt.boxSizingReliable()||o===t.style[e]),"auto"===o&&(o=t["offset"+e[0].toUpperCase()+e.slice(1)]),(o=parseFloat(o)||0)+G(t,e,i||(s?"border":"content"),n,r)+"px")}function J(t,e,i,n,r){return new J.prototype.init(t,e,i,n,r)}function H(){fe&&(!1===st.hidden&&i.requestAnimationFrame?i.requestAnimationFrame(H):i.setTimeout(H,gt.fx.interval),gt.fx.tick())}function U(){return i.setTimeout(function(){me=void 0}),me=gt.now()}function q(t,e){var i,n=0,r={height:t};for(e=e?1:0;n<4;n+=2-e)i=Gt[n],r["margin"+i]=r["padding"+i]=t;return e&&(r.opacity=r.width=t),r}function W(t,e,i){for(var n,r=(X.tweeners[e]||[]).concat(X.tweeners["*"]),o=0,s=r.length;o<s;o++)if(n=r[o].call(i,e,t))return n}function $(t,e,i){var n,r,o,s,a,l,c,u,h="width"in e||"height"in e,p=this,m={},f=t.style,_=t.nodeType&&zt(t),d=Rt.get(t,"fxshow");i.queue||(s=gt._queueHooks(t,"fx"),null==s.unqueued&&(s.unqueued=0,a=s.empty.fire,s.empty.fire=function(){s.unqueued||a()}),s.unqueued++,p.always(function(){p.always(function(){s.unqueued--,gt.queue(t,"fx").length||s.empty.fire()})}));for(n in e)if(r=e[n],_e.test(r)){if(delete e[n],o=o||"toggle"===r,r===(_?"hide":"show")){if("show"!==r||!d||void 0===d[n])continue;_=!0}m[n]=d&&d[n]||gt.style(t,n)}if((l=!gt.isEmptyObject(e))||!gt.isEmptyObject(m)){h&&1===t.nodeType&&(i.overflow=[f.overflow,f.overflowX,f.overflowY],c=d&&d.display,null==c&&(c=Rt.get(t,"display")),u=gt.css(t,"display"),"none"===u&&(c?u=c:(b([t],!0),c=t.style.display||c,u=gt.css(t,"display"),b([t]))),("inline"===u||"inline-block"===u&&null!=c)&&"none"===gt.css(t,"float")&&(l||(p.done(function(){f.display=c}),null==c&&(u=f.display,c="none"===u?"":u)),f.display="inline-block")),i.overflow&&(f.overflow="hidden",p.always(function(){f.overflow=i.overflow[0],f.overflowX=i.overflow[1],f.overflowY=i.overflow[2]})),l=!1;for(n in m)l||(d?"hidden"in d&&(_=d.hidden):d=Rt.access(t,"fxshow",{display:c}),o&&(d.hidden=!_),_&&b([t],!0),p.done(function(){_||b([t]),Rt.remove(t,"fxshow");for(n in m)gt.style(t,n,m[n])})),l=W(_?d[n]:0,n,p),n in d||(d[n]=l.start,_&&(l.end=l.start,l.start=0))}}function K(t,e){var i,n,r,o,s;for(i in t)if(n=gt.camelCase(i),r=e[n],o=t[i],Array.isArray(o)&&(r=o[1],o=t[i]=o[0]),i!==n&&(t[n]=o,delete t[i]),(s=gt.cssHooks[n])&&"expand"in s){o=s.expand(o),delete t[n];for(i in o)i in t||(t[i]=o[i],e[i]=r)}else e[n]=r}function X(t,e,i){var n,r,o=0,s=X.prefilters.length,a=gt.Deferred().always(function(){delete l.elem}),l=function(){if(r)return!1;for(var e=me||U(),i=Math.max(0,c.startTime+c.duration-e),n=i/c.duration||0,o=1-n,s=0,l=c.tweens.length;s<l;s++)c.tweens[s].run(o);return a.notifyWith(t,[c,o,i]),o<1&&l?i:(l||a.notifyWith(t,[c,1,0]),a.resolveWith(t,[c]),!1)},c=a.promise({elem:t,props:gt.extend({},e),opts:gt.extend(!0,{specialEasing:{},easing:gt.easing._default},i),originalProperties:e,originalOptions:i,startTime:me||U(),duration:i.duration,tweens:[],createTween:function(e,i){var n=gt.Tween(t,c.opts,e,i,c.opts.specialEasing[e]||c.opts.easing);return c.tweens.push(n),n},stop:function(e){var i=0,n=e?c.tweens.length:0;if(r)return this;for(r=!0;i<n;i++)c.tweens[i].run(1);return e?(a.notifyWith(t,[c,1,0]),a.resolveWith(t,[c,e])):a.rejectWith(t,[c,e]),this}}),u=c.props;for(K(u,c.opts.specialEasing);o<s;o++)if(n=X.prefilters[o].call(c,t,u,c.opts))return gt.isFunction(n.stop)&&(gt._queueHooks(c.elem,c.opts.queue).stop=gt.proxy(n.stop,n)),n;return gt.map(u,W,c),gt.isFunction(c.opts.start)&&c.opts.start.call(t,c),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always),gt.fx.timer(gt.extend(l,{elem:t,anim:c,queue:c.opts.queue})),c}function Y(t){return(t.match(It)||[]).join(" ")}function Z(t){return t.getAttribute&&t.getAttribute("class")||""}function Q(t,e,i,n){var r;if(Array.isArray(e))gt.each(e,function(e,r){i||Ae.test(t)?n(t,r):Q(t+"["+("object"==typeof r&&null!=r?e:"")+"]",r,i,n)});else if(i||"object"!==gt.type(e))n(t,e);else for(r in e)Q(t+"["+r+"]",e[r],i,n)}function tt(t){return function(e,i){"string"!=typeof e&&(i=e,e="*");var n,r=0,o=e.toLowerCase().match(It)||[];if(gt.isFunction(i))for(;n=o[r++];)"+"===n[0]?(n=n.slice(1)||"*",(t[n]=t[n]||[]).unshift(i)):(t[n]=t[n]||[]).push(i)}}function et(t,e,i,n){function r(a){var l;return o[a]=!0,gt.each(t[a]||[],function(t,a){var c=a(e,i,n);return"string"!=typeof c||s||o[c]?s?!(l=c):void 0:(e.dataTypes.unshift(c),r(c),!1)}),l}var o={},s=t===Be;return r(e.dataTypes[0])||!o["*"]&&r("*")}function it(t,e){var i,n,r=gt.ajaxSettings.flatOptions||{};for(i in e)void 0!==e[i]&&((r[i]?t:n||(n={}))[i]=e[i]);return n&&gt.extend(!0,t,n),t}function nt(t,e,i){for(var n,r,o,s,a=t.contents,l=t.dataTypes;"*"===l[0];)l.shift(),void 0===n&&(n=t.mimeType||e.getResponseHeader("Content-Type"));if(n)for(r in a)if(a[r]&&a[r].test(n)){l.unshift(r);break}if(l[0]in i)o=l[0];else{for(r in i){if(!l[0]||t.converters[r+" "+l[0]]){o=r;break}s||(s=r)}o=o||s}if(o)return o!==l[0]&&l.unshift(o),i[o]}function rt(t,e,i,n){var r,o,s,a,l,c={},u=t.dataTypes.slice();if(u[1])for(s in t.converters)c[s.toLowerCase()]=t.converters[s];for(o=u.shift();o;)if(t.responseFields[o]&&(i[t.responseFields[o]]=e),!l&&n&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),l=o,o=u.shift())if("*"===o)o=l;else if("*"!==l&&l!==o){if(!(s=c[l+" "+o]||c["* "+o]))for(r in c)if(a=r.split(" "),a[1]===o&&(s=c[l+" "+a[0]]||c["* "+a[0]])){!0===s?s=c[r]:!0!==c[r]&&(o=a[0],u.unshift(a[1]));break}if(!0!==s)if(s&&t.throws)e=s(e);else try{e=s(e)}catch(t){return{state:"parsererror",error:s?t:"No conversion from "+l+" to "+o}}}return{state:"success",data:e}}var ot=[],st=i.document,at=Object.getPrototypeOf,lt=ot.slice,ct=ot.concat,ut=ot.push,ht=ot.indexOf,pt={},mt=pt.toString,ft=pt.hasOwnProperty,_t=ft.toString,dt=_t.call(Object),yt={},gt=function(t,e){return new gt.fn.init(t,e)},vt=function(t,e){return e.toUpperCase()};gt.fn=gt.prototype={jquery:"3.2.1",constructor:gt,length:0,toArray:function(){return lt.call(this)},get:function(t){return null==t?lt.call(this):t<0?this[t+this.length]:this[t]},pushStack:function(t){var e=gt.merge(this.constructor(),t);return e.prevObject=this,e},each:function(t){return gt.each(this,t)},map:function(t){return this.pushStack(gt.map(this,function(e,i){return t.call(e,i,e)}))},slice:function(){return this.pushStack(lt.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,i=+t+(t<0?e:0);return this.pushStack(i>=0&&i<e?[this[i]]:[])},end:function(){return this.prevObject||this.constructor()},push:ut,sort:ot.sort,splice:ot.splice},gt.extend=gt.fn.extend=function(){var t,e,i,n,r,o,s=arguments[0]||{},a=1,l=arguments.length,c=!1;for("boolean"==typeof s&&(c=s,s=arguments[a]||{},a++),"object"==typeof s||gt.isFunction(s)||(s={}),a===l&&(s=this,a--);a<l;a++)if(null!=(t=arguments[a]))for(e in t)i=s[e],n=t[e],s!==n&&(c&&n&&(gt.isPlainObject(n)||(r=Array.isArray(n)))?(r?(r=!1,o=i&&Array.isArray(i)?i:[]):o=i&&gt.isPlainObject(i)?i:{},s[e]=gt.extend(c,o,n)):void 0!==n&&(s[e]=n));return s},gt.extend({expando:"jQuery"+("3.2.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isFunction:function(t){return"function"===gt.type(t)},isWindow:function(t){return null!=t&&t===t.window},isNumeric:function(t){var e=gt.type(t);return("number"===e||"string"===e)&&!isNaN(t-parseFloat(t))},isPlainObject:function(t){var e,i;return!(!t||"[object Object]"!==mt.call(t))&&(!(e=at(t))||"function"==typeof(i=ft.call(e,"constructor")&&e.constructor)&&_t.call(i)===dt)},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},type:function(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?pt[mt.call(t)]||"object":typeof t},globalEval:function(t){s(t)},camelCase:function(t){return t.replace(/^-ms-/,"ms-").replace(/-([a-z])/g,vt)},each:function(t,e){var i,n=0;if(a(t))for(i=t.length;n<i&&!1!==e.call(t[n],n,t[n]);n++);else for(n in t)if(!1===e.call(t[n],n,t[n]))break;return t},trim:function(t){return null==t?"":(t+"").replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},makeArray:function(t,e){var i=e||[];return null!=t&&(a(Object(t))?gt.merge(i,"string"==typeof t?[t]:t):ut.call(i,t)),i},inArray:function(t,e,i){return null==e?-1:ht.call(e,t,i)},merge:function(t,e){for(var i=+e.length,n=0,r=t.length;n<i;n++)t[r++]=e[n];return t.length=r,t},grep:function(t,e,i){for(var n=[],r=0,o=t.length,s=!i;r<o;r++)!e(t[r],r)!==s&&n.push(t[r]);return n},map:function(t,e,i){var n,r,o=0,s=[];if(a(t))for(n=t.length;o<n;o++)null!=(r=e(t[o],o,i))&&s.push(r);else for(o in t)null!=(r=e(t[o],o,i))&&s.push(r);return ct.apply([],s)},guid:1,proxy:function(t,e){var i,n,r;if("string"==typeof e&&(i=t[e],e=t,t=i),gt.isFunction(t))return n=lt.call(arguments,2),r=function(){return t.apply(e||this,n.concat(lt.call(arguments)))},r.guid=t.guid=t.guid||gt.guid++,r},now:Date.now,support:yt}),"function"==typeof Symbol&&(gt.fn[Symbol.iterator]=ot[Symbol.iterator]),gt.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(t,e){pt["[object "+e+"]"]=e.toLowerCase()});var xt=function(t){function e(t,e,i,n){var r,o,s,a,l,u,p,m=e&&e.ownerDocument,f=e?e.nodeType:9;if(i=i||[],"string"!=typeof t||!t||1!==f&&9!==f&&11!==f)return i;if(!n&&((e?e.ownerDocument||e:N)!==P&&I(e),e=e||P,E)){if(11!==f&&(l=_t.exec(t)))if(r=l[1]){if(9===f){if(!(s=e.getElementById(r)))return i;if(s.id===r)return i.push(s),i}else if(m&&(s=m.getElementById(r))&&O(e,s)&&s.id===r)return i.push(s),i}else{if(l[2])return X.apply(i,e.getElementsByTagName(t)),i;if((r=l[3])&&x.getElementsByClassName&&e.getElementsByClassName)return X.apply(i,e.getElementsByClassName(r)),i}if(x.qsa&&!H[t+" "]&&(!L||!L.test(t))){if(1!==f)m=e,p=t;else if("object"!==e.nodeName.toLowerCase()){for((a=e.getAttribute("id"))?a=a.replace(vt,xt):e.setAttribute("id",a=F),u=S(t),o=u.length;o--;)u[o]="#"+a+" "+h(u[o]);p=u.join(","),m=dt.test(t)&&c(e.parentNode)||e}if(p)try{return X.apply(i,m.querySelectorAll(p)),i}catch(t){}finally{a===F&&e.removeAttribute("id")}}}return D(t.replace(ot,"$1"),e,i,n)}function i(){function t(i,n){return e.push(i+" ")>b.cacheLength&&delete t[e.shift()],t[i+" "]=n}var e=[];return t}function n(t){return t[F]=!0,t}function r(t){var e=P.createElement("fieldset");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function o(t,e){for(var i=t.split("|"),n=i.length;n--;)b.attrHandle[i[n]]=e}function s(t,e){var i=e&&t,n=i&&1===t.nodeType&&1===e.nodeType&&t.sourceIndex-e.sourceIndex;if(n)return n;if(i)for(;i=i.nextSibling;)if(i===e)return-1;return t?1:-1}function a(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&wt(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function l(t){return n(function(e){return e=+e,n(function(i,n){for(var r,o=t([],i.length,e),s=o.length;s--;)i[r=o[s]]&&(i[r]=!(n[r]=i[r]))})})}function c(t){return t&&void 0!==t.getElementsByTagName&&t}function u(){}function h(t){for(var e=0,i=t.length,n="";e<i;e++)n+=t[e].value;return n}function p(t,e,i){var n=e.dir,r=e.next,o=r||n,s=i&&"parentNode"===o,a=G++;return e.first?function(e,i,r){for(;e=e[n];)if(1===e.nodeType||s)return t(e,i,r);return!1}:function(e,i,l){var c,u,h,p=[j,a];if(l){for(;e=e[n];)if((1===e.nodeType||s)&&t(e,i,l))return!0}else for(;e=e[n];)if(1===e.nodeType||s)if(h=e[F]||(e[F]={}),u=h[e.uniqueID]||(h[e.uniqueID]={}),r&&r===e.nodeName.toLowerCase())e=e[n]||e;else{if((c=u[o])&&c[0]===j&&c[1]===a)return p[2]=c[2];if(u[o]=p,p[2]=t(e,i,l))return!0}return!1}}function m(t){return t.length>1?function(e,i,n){for(var r=t.length;r--;)if(!t[r](e,i,n))return!1;return!0}:t[0]}function f(t,i,n){for(var r=0,o=i.length;r<o;r++)e(t,i[r],n);return n}function _(t,e,i,n,r){for(var o,s=[],a=0,l=t.length,c=null!=e;a<l;a++)(o=t[a])&&(i&&!i(o,n,r)||(s.push(o),c&&e.push(a)));return s}function d(t,e,i,r,o,s){return r&&!r[F]&&(r=d(r)),o&&!o[F]&&(o=d(o,s)),n(function(n,s,a,l){var c,u,h,p=[],m=[],d=s.length,y=n||f(e||"*",a.nodeType?[a]:a,[]),g=!t||!n&&e?y:_(y,p,t,a,l),v=i?o||(n?t:d||r)?[]:s:g;if(i&&i(g,v,a,l),r)for(c=_(v,m),r(c,[],a,l),u=c.length;u--;)(h=c[u])&&(v[m[u]]=!(g[m[u]]=h));if(n){if(o||t){if(o){for(c=[],u=v.length;u--;)(h=v[u])&&c.push(g[u]=h);o(null,v=[],c,l)}for(u=v.length;u--;)(h=v[u])&&(c=o?Z(n,h):p[u])>-1&&(n[c]=!(s[c]=h))}}else v=_(v===s?v.splice(d,v.length):v),o?o(null,s,v,l):X.apply(s,v)})}function y(t){for(var e,i,n,r=t.length,o=b.relative[t[0].type],s=o||b.relative[" "],a=o?1:0,l=p(function(t){return t===e},s,!0),c=p(function(t){return Z(e,t)>-1},s,!0),u=[function(t,i,n){var r=!o&&(n||i!==M)||((e=i).nodeType?l(t,i,n):c(t,i,n));return e=null,r}];a<r;a++)if(i=b.relative[t[a].type])u=[p(m(u),i)];else{if(i=b.filter[t[a].type].apply(null,t[a].matches),i[F]){for(n=++a;n<r&&!b.relative[t[n].type];n++);return d(a>1&&m(u),a>1&&h(t.slice(0,a-1).concat({value:" "===t[a-2].type?"*":""})).replace(ot,"$1"),i,a<n&&y(t.slice(a,n)),n<r&&y(t=t.slice(n)),n<r&&h(t))}u.push(i)}return m(u)}function g(t,i){var r=i.length>0,o=t.length>0,s=function(n,s,a,l,c){var u,h,p,m=0,f="0",d=n&&[],y=[],g=M,v=n||o&&b.find.TAG("*",c),x=j+=null==g?1:Math.random()||.1,w=v.length;for(c&&(M=s===P||s||c);f!==w&&null!=(u=v[f]);f++){if(o&&u){for(h=0,s||u.ownerDocument===P||(I(u),a=!E);p=t[h++];)if(p(u,s||P,a)){l.push(u);break}c&&(j=x)}r&&((u=!p&&u)&&m--,n&&d.push(u))}if(m+=f,r&&f!==m){for(h=0;p=i[h++];)p(d,y,s,a);if(n){if(m>0)for(;f--;)d[f]||y[f]||(y[f]=$.call(l));y=_(y)}X.apply(l,y),c&&!n&&y.length>0&&m+i.length>1&&e.uniqueSort(l)}return c&&(j=x,M=g),d};return r?n(s):s}var v,x,b,w,C,S,A,D,M,T,k,I,P,B,E,L,R,V,O,F="sizzle"+1*new Date,N=t.document,j=0,G=0,z=i(),J=i(),H=i(),U=function(t,e){return t===e&&(k=!0),0},q={}.hasOwnProperty,W=[],$=W.pop,K=W.push,X=W.push,Y=W.slice,Z=function(t,e){for(var i=0,n=t.length;i<n;i++)if(t[i]===e)return i;return-1},Q="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",tt="[\\x20\\t\\r\\n\\f]",et="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",it="\\["+tt+"*("+et+")(?:"+tt+"*([*^$|!~]?=)"+tt+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+et+"))|)"+tt+"*\\]",nt=":("+et+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+it+")*)|.*)\\)|)",rt=new RegExp(tt+"+","g"),ot=new RegExp("^"+tt+"+|((?:^|[^\\\\])(?:\\\\.)*)"+tt+"+$","g"),st=new RegExp("^"+tt+"*,"+tt+"*"),at=new RegExp("^"+tt+"*([>+~]|"+tt+")"+tt+"*"),lt=new RegExp("="+tt+"*([^\\]'\"]*?)"+tt+"*\\]","g"),ct=new RegExp(nt),ut=new RegExp("^"+et+"$"),ht={ID:new RegExp("^#("+et+")"),CLASS:new RegExp("^\\.("+et+")"),TAG:new RegExp("^("+et+"|[*])"),ATTR:new RegExp("^"+it),PSEUDO:new RegExp("^"+nt),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+tt+"*(even|odd|(([+-]|)(\\d*)n|)"+tt+"*(?:([+-]|)"+tt+"*(\\d+)|))"+tt+"*\\)|)","i"),bool:new RegExp("^(?:"+Q+")$","i"),needsContext:new RegExp("^"+tt+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+tt+"*((?:-\\d)?\\d*)"+tt+"*\\)|)(?=[^-]|$)","i")},pt=/^(?:input|select|textarea|button)$/i,mt=/^h\d$/i,ft=/^[^{]+\{\s*\[native \w/,_t=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,dt=/[+~]/,yt=new RegExp("\\\\([\\da-f]{1,6}"+tt+"?|("+tt+")|.)","ig"),gt=function(t,e,i){var n="0x"+e-65536;return n!==n||i?e:n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320)},vt=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,xt=function(t,e){return e?"\0"===t?"�":t.slice(0,-1)+"\\"+t.charCodeAt(t.length-1).toString(16)+" ":"\\"+t},bt=function(){I()},wt=p(function(t){return!0===t.disabled&&("form"in t||"label"in t)},{dir:"parentNode",next:"legend"});try{X.apply(W=Y.call(N.childNodes),N.childNodes),W[N.childNodes.length].nodeType}catch(t){X={apply:W.length?function(t,e){K.apply(t,Y.call(e))}:function(t,e){for(var i=t.length,n=0;t[i++]=e[n++];);t.length=i-1}}}x=e.support={},C=e.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return!!e&&"HTML"!==e.nodeName},I=e.setDocument=function(t){var e,i,n=t?t.ownerDocument||t:N;return n!==P&&9===n.nodeType&&n.documentElement?(P=n,B=P.documentElement,E=!C(P),N!==P&&(i=P.defaultView)&&i.top!==i&&(i.addEventListener?i.addEventListener("unload",bt,!1):i.attachEvent&&i.attachEvent("onunload",bt)),x.attributes=r(function(t){return t.className="i",!t.getAttribute("className")}),x.getElementsByTagName=r(function(t){return t.appendChild(P.createComment("")),!t.getElementsByTagName("*").length}),x.getElementsByClassName=ft.test(P.getElementsByClassName),x.getById=r(function(t){return B.appendChild(t).id=F,!P.getElementsByName||!P.getElementsByName(F).length}),x.getById?(b.filter.ID=function(t){var e=t.replace(yt,gt);return function(t){return t.getAttribute("id")===e}},b.find.ID=function(t,e){if(void 0!==e.getElementById&&E){var i=e.getElementById(t);return i?[i]:[]}}):(b.filter.ID=function(t){var e=t.replace(yt,gt);return function(t){var i=void 0!==t.getAttributeNode&&t.getAttributeNode("id");return i&&i.value===e}},b.find.ID=function(t,e){if(void 0!==e.getElementById&&E){var i,n,r,o=e.getElementById(t);if(o){if((i=o.getAttributeNode("id"))&&i.value===t)return[o];for(r=e.getElementsByName(t),n=0;o=r[n++];)if((i=o.getAttributeNode("id"))&&i.value===t)return[o]}return[]}}),b.find.TAG=x.getElementsByTagName?function(t,e){return void 0!==e.getElementsByTagName?e.getElementsByTagName(t):x.qsa?e.querySelectorAll(t):void 0}:function(t,e){var i,n=[],r=0,o=e.getElementsByTagName(t);if("*"===t){for(;i=o[r++];)1===i.nodeType&&n.push(i);return n}return o},b.find.CLASS=x.getElementsByClassName&&function(t,e){if(void 0!==e.getElementsByClassName&&E)return e.getElementsByClassName(t)},R=[],L=[],(x.qsa=ft.test(P.querySelectorAll))&&(r(function(t){B.appendChild(t).innerHTML="<a id='"+F+"'></a><select id='"+F+"-\r\\' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&L.push("[*^$]="+tt+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||L.push("\\["+tt+"*(?:value|"+Q+")"),t.querySelectorAll("[id~="+F+"-]").length||L.push("~="),t.querySelectorAll(":checked").length||L.push(":checked"),t.querySelectorAll("a#"+F+"+*").length||L.push(".#.+[+~]")}),r(function(t){t.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var e=P.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&L.push("name"+tt+"*[*^$|!~]?="),2!==t.querySelectorAll(":enabled").length&&L.push(":enabled",":disabled"),B.appendChild(t).disabled=!0,2!==t.querySelectorAll(":disabled").length&&L.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),L.push(",.*:")})),(x.matchesSelector=ft.test(V=B.matches||B.webkitMatchesSelector||B.mozMatchesSelector||B.oMatchesSelector||B.msMatchesSelector))&&r(function(t){x.disconnectedMatch=V.call(t,"*"),V.call(t,"[s!='']:x"),R.push("!=",nt)}),L=L.length&&new RegExp(L.join("|")),R=R.length&&new RegExp(R.join("|")),e=ft.test(B.compareDocumentPosition),O=e||ft.test(B.contains)?function(t,e){var i=9===t.nodeType?t.documentElement:t,n=e&&e.parentNode;return t===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):t.compareDocumentPosition&&16&t.compareDocumentPosition(n)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},U=e?function(t,e){if(t===e)return k=!0,0;var i=!t.compareDocumentPosition-!e.compareDocumentPosition;return i||(i=(t.ownerDocument||t)===(e.ownerDocument||e)?t.compareDocumentPosition(e):1,1&i||!x.sortDetached&&e.compareDocumentPosition(t)===i?t===P||t.ownerDocument===N&&O(N,t)?-1:e===P||e.ownerDocument===N&&O(N,e)?1:T?Z(T,t)-Z(T,e):0:4&i?-1:1)}:function(t,e){if(t===e)return k=!0,0;var i,n=0,r=t.parentNode,o=e.parentNode,a=[t],l=[e];if(!r||!o)return t===P?-1:e===P?1:r?-1:o?1:T?Z(T,t)-Z(T,e):0;if(r===o)return s(t,e);for(i=t;i=i.parentNode;)a.unshift(i);for(i=e;i=i.parentNode;)l.unshift(i);for(;a[n]===l[n];)n++;return n?s(a[n],l[n]):a[n]===N?-1:l[n]===N?1:0},P):P},e.matches=function(t,i){return e(t,null,null,i)},e.matchesSelector=function(t,i){if((t.ownerDocument||t)!==P&&I(t),i=i.replace(lt,"='$1']"),x.matchesSelector&&E&&!H[i+" "]&&(!R||!R.test(i))&&(!L||!L.test(i)))try{var n=V.call(t,i);if(n||x.disconnectedMatch||t.document&&11!==t.document.nodeType)return n}catch(t){}return e(i,P,null,[t]).length>0},e.contains=function(t,e){return(t.ownerDocument||t)!==P&&I(t),O(t,e)},e.attr=function(t,e){(t.ownerDocument||t)!==P&&I(t);var i=b.attrHandle[e.toLowerCase()],n=i&&q.call(b.attrHandle,e.toLowerCase())?i(t,e,!E):void 0;return void 0!==n?n:x.attributes||!E?t.getAttribute(e):(n=t.getAttributeNode(e))&&n.specified?n.value:null},e.escape=function(t){return(t+"").replace(vt,xt)},e.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},e.uniqueSort=function(t){var e,i=[],n=0,r=0;if(k=!x.detectDuplicates,T=!x.sortStable&&t.slice(0),t.sort(U),k){for(;e=t[r++];)e===t[r]&&(n=i.push(r));for(;n--;)t.splice(i[n],1)}return T=null,t},w=e.getText=function(t){var e,i="",n=0,r=t.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)i+=w(t)}else if(3===r||4===r)return t.nodeValue}else for(;e=t[n++];)i+=w(e);return i},b=e.selectors={cacheLength:50,createPseudo:n,match:ht,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(yt,gt),t[3]=(t[3]||t[4]||t[5]||"").replace(yt,gt),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||e.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&e.error(t[0]),t},PSEUDO:function(t){var e,i=!t[6]&&t[2];return ht.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":i&&ct.test(i)&&(e=S(i,!0))&&(e=i.indexOf(")",i.length-e)-i.length)&&(t[0]=t[0].slice(0,e),t[2]=i.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(yt,gt).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=z[t+" "];return e||(e=new RegExp("(^|"+tt+")"+t+"("+tt+"|$)"))&&z(t,function(t){return e.test("string"==typeof t.className&&t.className||void 0!==t.getAttribute&&t.getAttribute("class")||"")})},ATTR:function(t,i,n){return function(r){var o=e.attr(r,t);return null==o?"!="===i:!i||(o+="","="===i?o===n:"!="===i?o!==n:"^="===i?n&&0===o.indexOf(n):"*="===i?n&&o.indexOf(n)>-1:"$="===i?n&&o.slice(-n.length)===n:"~="===i?(" "+o.replace(rt," ")+" ").indexOf(n)>-1:"|="===i&&(o===n||o.slice(0,n.length+1)===n+"-"))}},CHILD:function(t,e,i,n,r){var o="nth"!==t.slice(0,3),s="last"!==t.slice(-4),a="of-type"===e;return 1===n&&0===r?function(t){return!!t.parentNode}:function(e,i,l){var c,u,h,p,m,f,_=o!==s?"nextSibling":"previousSibling",d=e.parentNode,y=a&&e.nodeName.toLowerCase(),g=!l&&!a,v=!1;if(d){if(o){for(;_;){for(p=e;p=p[_];)if(a?p.nodeName.toLowerCase()===y:1===p.nodeType)return!1;f=_="only"===t&&!f&&"nextSibling"}return!0}if(f=[s?d.firstChild:d.lastChild],s&&g){for(p=d,h=p[F]||(p[F]={}),u=h[p.uniqueID]||(h[p.uniqueID]={}),c=u[t]||[],m=c[0]===j&&c[1],v=m&&c[2],p=m&&d.childNodes[m];p=++m&&p&&p[_]||(v=m=0)||f.pop();)if(1===p.nodeType&&++v&&p===e){u[t]=[j,m,v];break}}else if(g&&(p=e,h=p[F]||(p[F]={}),u=h[p.uniqueID]||(h[p.uniqueID]={}),c=u[t]||[],m=c[0]===j&&c[1],v=m),!1===v)for(;(p=++m&&p&&p[_]||(v=m=0)||f.pop())&&((a?p.nodeName.toLowerCase()!==y:1!==p.nodeType)||!++v||(g&&(h=p[F]||(p[F]={}),u=h[p.uniqueID]||(h[p.uniqueID]={}),u[t]=[j,v]),p!==e)););return(v-=r)===n||v%n==0&&v/n>=0}}},PSEUDO:function(t,i){var r,o=b.pseudos[t]||b.setFilters[t.toLowerCase()]||e.error("unsupported pseudo: "+t);return o[F]?o(i):o.length>1?(r=[t,t,"",i],b.setFilters.hasOwnProperty(t.toLowerCase())?n(function(t,e){for(var n,r=o(t,i),s=r.length;s--;)n=Z(t,r[s]),t[n]=!(e[n]=r[s])}):function(t){return o(t,0,r)}):o}},pseudos:{not:n(function(t){var e=[],i=[],r=A(t.replace(ot,"$1"));return r[F]?n(function(t,e,i,n){for(var o,s=r(t,null,n,[]),a=t.length;a--;)(o=s[a])&&(t[a]=!(e[a]=o))}):function(t,n,o){return e[0]=t,r(e,null,o,i),e[0]=null,!i.pop()}}),has:n(function(t){return function(i){return e(t,i).length>0}}),contains:n(function(t){return t=t.replace(yt,gt),function(e){return(e.textContent||e.innerText||w(e)).indexOf(t)>-1}}),lang:n(function(t){return ut.test(t||"")||e.error("unsupported lang: "+t),t=t.replace(yt,gt).toLowerCase(),function(e){var i;do{if(i=E?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(i=i.toLowerCase())===t||0===i.indexOf(t+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var i=t.location&&t.location.hash;return i&&i.slice(1)===e.id},root:function(t){return t===B},focus:function(t){return t===P.activeElement&&(!P.hasFocus||P.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:a(!1),disabled:a(!0),checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!b.pseudos.empty(t)},header:function(t){return mt.test(t.nodeName)},input:function(t){return pt.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:l(function(){return[0]}),last:l(function(t,e){return[e-1]}),eq:l(function(t,e,i){return[i<0?i+e:i]}),even:l(function(t,e){for(var i=0;i<e;i+=2)t.push(i);return t}),odd:l(function(t,e){for(var i=1;i<e;i+=2)t.push(i);return t}),lt:l(function(t,e,i){for(var n=i<0?i+e:i;--n>=0;)t.push(n);return t}),gt:l(function(t,e,i){for(var n=i<0?i+e:i;++n<e;)t.push(n);return t})}},b.pseudos.nth=b.pseudos.eq;for(v in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})b.pseudos[v]=function(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}(v);for(v in{submit:!0,reset:!0})b.pseudos[v]=function(t){return function(e){var i=e.nodeName.toLowerCase();return("input"===i||"button"===i)&&e.type===t}}(v);return u.prototype=b.filters=b.pseudos,b.setFilters=new u,S=e.tokenize=function(t,i){var n,r,o,s,a,l,c,u=J[t+" "];if(u)return i?0:u.slice(0);for(a=t,l=[],c=b.preFilter;a;){n&&!(r=st.exec(a))||(r&&(a=a.slice(r[0].length)||a),l.push(o=[])),n=!1,(r=at.exec(a))&&(n=r.shift(),o.push({value:n,type:r[0].replace(ot," ")}),a=a.slice(n.length));for(s in b.filter)!(r=ht[s].exec(a))||c[s]&&!(r=c[s](r))||(n=r.shift(),o.push({value:n,type:s,matches:r}),a=a.slice(n.length));if(!n)break}return i?a.length:a?e.error(t):J(t,l).slice(0)},A=e.compile=function(t,e){var i,n=[],r=[],o=H[t+" "];if(!o){for(e||(e=S(t)),i=e.length;i--;)o=y(e[i]),o[F]?n.push(o):r.push(o);o=H(t,g(r,n)),o.selector=t}return o},D=e.select=function(t,e,i,n){var r,o,s,a,l,u="function"==typeof t&&t,p=!n&&S(t=u.selector||t);if(i=i||[],1===p.length){if(o=p[0]=p[0].slice(0),o.length>2&&"ID"===(s=o[0]).type&&9===e.nodeType&&E&&b.relative[o[1].type]){if(!(e=(b.find.ID(s.matches[0].replace(yt,gt),e)||[])[0]))return i;u&&(e=e.parentNode),t=t.slice(o.shift().value.length)}for(r=ht.needsContext.test(t)?0:o.length;r--&&(s=o[r],!b.relative[a=s.type]);)if((l=b.find[a])&&(n=l(s.matches[0].replace(yt,gt),dt.test(o[0].type)&&c(e.parentNode)||e))){if(o.splice(r,1),!(t=n.length&&h(o)))return X.apply(i,n),i;break}}return(u||A(t,p))(n,e,!E,i,!e||dt.test(t)&&c(e.parentNode)||e),i},x.sortStable=F.split("").sort(U).join("")===F,x.detectDuplicates=!!k,I(),x.sortDetached=r(function(t){return 1&t.compareDocumentPosition(P.createElement("fieldset"))}),r(function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")})||o("type|href|height|width",function(t,e,i){if(!i)return t.getAttribute(e,"type"===e.toLowerCase()?1:2)}),x.attributes&&r(function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")})||o("value",function(t,e,i){if(!i&&"input"===t.nodeName.toLowerCase())return t.defaultValue}),r(function(t){return null==t.getAttribute("disabled")})||o(Q,function(t,e,i){var n;if(!i)return!0===t[e]?e.toLowerCase():(n=t.getAttributeNode(e))&&n.specified?n.value:null}),e}(i);gt.find=xt,gt.expr=xt.selectors,gt.expr[":"]=gt.expr.pseudos,gt.uniqueSort=gt.unique=xt.uniqueSort,gt.text=xt.getText,gt.isXMLDoc=xt.isXML,gt.contains=xt.contains,gt.escapeSelector=xt.escape;var bt=function(t,e,i){for(var n=[],r=void 0!==i;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(r&&gt(t).is(i))break;n.push(t)}return n},wt=function(t,e){for(var i=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&i.push(t);return i},Ct=gt.expr.match.needsContext,St=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i,At=/^.[^:#\[\.,]*$/;gt.filter=function(t,e,i){var n=e[0];return i&&(t=":not("+t+")"),1===e.length&&1===n.nodeType?gt.find.matchesSelector(n,t)?[n]:[]:gt.find.matches(t,gt.grep(e,function(t){return 1===t.nodeType}))},gt.fn.extend({find:function(t){var e,i,n=this.length,r=this;if("string"!=typeof t)return this.pushStack(gt(t).filter(function(){for(e=0;e<n;e++)if(gt.contains(r[e],this))return!0}));for(i=this.pushStack([]),e=0;e<n;e++)gt.find(t,r[e],i);return n>1?gt.uniqueSort(i):i},filter:function(t){return this.pushStack(c(this,t||[],!1))},not:function(t){return this.pushStack(c(this,t||[],!0))},is:function(t){return!!c(this,"string"==typeof t&&Ct.test(t)?gt(t):t||[],!1).length}});var Dt,Mt=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(gt.fn.init=function(t,e,i){var n,r;if(!t)return this;if(i=i||Dt,"string"==typeof t){if(!(n="<"===t[0]&&">"===t[t.length-1]&&t.length>=3?[null,t,null]:Mt.exec(t))||!n[1]&&e)return!e||e.jquery?(e||i).find(t):this.constructor(e).find(t);if(n[1]){if(e=e instanceof gt?e[0]:e,gt.merge(this,gt.parseHTML(n[1],e&&e.nodeType?e.ownerDocument||e:st,!0)),St.test(n[1])&&gt.isPlainObject(e))for(n in e)gt.isFunction(this[n])?this[n](e[n]):this.attr(n,e[n]);return this}return r=st.getElementById(n[2]),r&&(this[0]=r,this.length=1),this}return t.nodeType?(this[0]=t,this.length=1,this):gt.isFunction(t)?void 0!==i.ready?i.ready(t):t(gt):gt.makeArray(t,this)}).prototype=gt.fn,Dt=gt(st);var Tt=/^(?:parents|prev(?:Until|All))/,kt={children:!0,contents:!0,next:!0,prev:!0};gt.fn.extend({has:function(t){var e=gt(t,this),i=e.length;return this.filter(function(){for(var t=0;t<i;t++)if(gt.contains(this,e[t]))return!0})},closest:function(t,e){var i,n=0,r=this.length,o=[],s="string"!=typeof t&&gt(t);if(!Ct.test(t))for(;n<r;n++)for(i=this[n];i&&i!==e;i=i.parentNode)if(i.nodeType<11&&(s?s.index(i)>-1:1===i.nodeType&&gt.find.matchesSelector(i,t))){o.push(i);break}return this.pushStack(o.length>1?gt.uniqueSort(o):o)},index:function(t){return t?"string"==typeof t?ht.call(gt(t),this[0]):ht.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(gt.uniqueSort(gt.merge(this.get(),gt(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),gt.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return bt(t,"parentNode")},parentsUntil:function(t,e,i){return bt(t,"parentNode",i)},next:function(t){return u(t,"nextSibling")},prev:function(t){return u(t,"previousSibling")},nextAll:function(t){return bt(t,"nextSibling")},prevAll:function(t){return bt(t,"previousSibling")},nextUntil:function(t,e,i){return bt(t,"nextSibling",i)},prevUntil:function(t,e,i){return bt(t,"previousSibling",i)},siblings:function(t){return wt((t.parentNode||{}).firstChild,t)},children:function(t){return wt(t.firstChild)},contents:function(t){return l(t,"iframe")?t.contentDocument:(l(t,"template")&&(t=t.content||t),gt.merge([],t.childNodes))}},function(t,e){gt.fn[t]=function(i,n){var r=gt.map(this,e,i);return"Until"!==t.slice(-5)&&(n=i),n&&"string"==typeof n&&(r=gt.filter(n,r)),this.length>1&&(kt[t]||gt.uniqueSort(r),Tt.test(t)&&r.reverse()),this.pushStack(r)}});var It=/[^\x20\t\r\n\f]+/g;gt.Callbacks=function(t){t="string"==typeof t?h(t):gt.extend({},t);var e,i,n,r,o=[],s=[],a=-1,l=function(){for(r=r||t.once,n=e=!0;s.length;a=-1)for(i=s.shift();++a<o.length;)!1===o[a].apply(i[0],i[1])&&t.stopOnFalse&&(a=o.length,i=!1);t.memory||(i=!1),e=!1,r&&(o=i?[]:"")},c={add:function(){return o&&(i&&!e&&(a=o.length-1,s.push(i)),function e(i){gt.each(i,function(i,n){gt.isFunction(n)?t.unique&&c.has(n)||o.push(n):n&&n.length&&"string"!==gt.type(n)&&e(n)})}(arguments),i&&!e&&l()),this},remove:function(){return gt.each(arguments,function(t,e){for(var i;(i=gt.inArray(e,o,i))>-1;)o.splice(i,1),i<=a&&a--}),this},has:function(t){return t?gt.inArray(t,o)>-1:o.length>0},empty:function(){return o&&(o=[]),this},disable:function(){return r=s=[],o=i="",this},disabled:function(){return!o},lock:function(){return r=s=[],i||e||(o=i=""),this},locked:function(){return!!r},fireWith:function(t,i){return r||(i=i||[],i=[t,i.slice?i.slice():i],s.push(i),e||l()),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!n}};return c},gt.extend({Deferred:function(t){var e=[["notify","progress",gt.Callbacks("memory"),gt.Callbacks("memory"),2],["resolve","done",gt.Callbacks("once memory"),gt.Callbacks("once memory"),0,"resolved"],["reject","fail",gt.Callbacks("once memory"),gt.Callbacks("once memory"),1,"rejected"]],n="pending",r={state:function(){return n},always:function(){return o.done(arguments).fail(arguments),this},catch:function(t){return r.then(null,t)},pipe:function(){var t=arguments;return gt.Deferred(function(i){gt.each(e,function(e,n){var r=gt.isFunction(t[n[4]])&&t[n[4]];o[n[1]](function(){var t=r&&r.apply(this,arguments);t&&gt.isFunction(t.promise)?t.promise().progress(i.notify).done(i.resolve).fail(i.reject):i[n[0]+"With"](this,r?[t]:arguments)})}),t=null}).promise()},then:function(t,n,r){function o(t,e,n,r){return function(){var a=this,l=arguments,c=function(){var i,c;if(!(t<s)){if((i=n.apply(a,l))===e.promise())throw new TypeError("Thenable self-resolution");c=i&&("object"==typeof i||"function"==typeof i)&&i.then,gt.isFunction(c)?r?c.call(i,o(s,e,p,r),o(s,e,m,r)):(s++,c.call(i,o(s,e,p,r),o(s,e,m,r),o(s,e,p,e.notifyWith))):(n!==p&&(a=void 0,l=[i]),(r||e.resolveWith)(a,l))}},u=r?c:function(){try{c()}catch(i){gt.Deferred.exceptionHook&&gt.Deferred.exceptionHook(i,u.stackTrace),t+1>=s&&(n!==m&&(a=void 0,l=[i]),e.rejectWith(a,l))}};t?u():(gt.Deferred.getStackHook&&(u.stackTrace=gt.Deferred.getStackHook()),i.setTimeout(u))}}var s=0;return gt.Deferred(function(i){e[0][3].add(o(0,i,gt.isFunction(r)?r:p,i.notifyWith)),e[1][3].add(o(0,i,gt.isFunction(t)?t:p)),e[2][3].add(o(0,i,gt.isFunction(n)?n:m))}).promise()},promise:function(t){return null!=t?gt.extend(t,r):r}},o={};return gt.each(e,function(t,i){var s=i[2],a=i[5];r[i[1]]=s.add,a&&s.add(function(){n=a},e[3-t][2].disable,e[0][2].lock),s.add(i[3].fire),o[i[0]]=function(){return o[i[0]+"With"](this===o?void 0:this,arguments),this},o[i[0]+"With"]=s.fireWith}),r.promise(o),t&&t.call(o,o),o},when:function(t){var e=arguments.length,i=e,n=Array(i),r=lt.call(arguments),o=gt.Deferred(),s=function(t){return function(i){n[t]=this,r[t]=arguments.length>1?lt.call(arguments):i,--e||o.resolveWith(n,r)}};if(e<=1&&(f(t,o.done(s(i)).resolve,o.reject,!e),"pending"===o.state()||gt.isFunction(r[i]&&r[i].then)))return o.then();for(;i--;)f(r[i],s(i),o.reject);return o.promise()}});var Pt=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;gt.Deferred.exceptionHook=function(t,e){i.console&&i.console.warn&&t&&Pt.test(t.name)&&i.console.warn("jQuery.Deferred exception: "+t.message,t.stack,e)},gt.readyException=function(t){i.setTimeout(function(){throw t})};var Bt=gt.Deferred();gt.fn.ready=function(t){return Bt.then(t).catch(function(t){gt.readyException(t)}),this},gt.extend({isReady:!1,readyWait:1,ready:function(t){(!0===t?--gt.readyWait:gt.isReady)||(gt.isReady=!0,!0!==t&&--gt.readyWait>0||Bt.resolveWith(st,[gt]))}}),gt.ready.then=Bt.then,"complete"===st.readyState||"loading"!==st.readyState&&!st.documentElement.doScroll?i.setTimeout(gt.ready):(st.addEventListener("DOMContentLoaded",_),i.addEventListener("load",_));var Et=function(t,e,i,n,r,o,s){var a=0,l=t.length,c=null==i;if("object"===gt.type(i)){r=!0;for(a in i)Et(t,e,a,i[a],!0,o,s)}else if(void 0!==n&&(r=!0,gt.isFunction(n)||(s=!0),c&&(s?(e.call(t,n),e=null):(c=e,e=function(t,e,i){return c.call(gt(t),i)})),e))for(;a<l;a++)e(t[a],i,s?n:n.call(t[a],a,e(t[a],i)));return r?t:c?e.call(t):l?e(t[0],i):o},Lt=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType};d.uid=1,d.prototype={cache:function(t){var e=t[this.expando];return e||(e={},Lt(t)&&(t.nodeType?t[this.expando]=e:Object.defineProperty(t,this.expando,{value:e,configurable:!0}))),e},set:function(t,e,i){var n,r=this.cache(t);if("string"==typeof e)r[gt.camelCase(e)]=i;else for(n in e)r[gt.camelCase(n)]=e[n];return r},get:function(t,e){return void 0===e?this.cache(t):t[this.expando]&&t[this.expando][gt.camelCase(e)]},access:function(t,e,i){return void 0===e||e&&"string"==typeof e&&void 0===i?this.get(t,e):(this.set(t,e,i),void 0!==i?i:e)},remove:function(t,e){var i,n=t[this.expando];if(void 0!==n){if(void 0!==e){Array.isArray(e)?e=e.map(gt.camelCase):(e=gt.camelCase(e),e=e in n?[e]:e.match(It)||[]),i=e.length;for(;i--;)delete n[e[i]]}(void 0===e||gt.isEmptyObject(n))&&(t.nodeType?t[this.expando]=void 0:delete t[this.expando])}},hasData:function(t){var e=t[this.expando];return void 0!==e&&!gt.isEmptyObject(e)}};var Rt=new d,Vt=new d,Ot=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Ft=/[A-Z]/g;gt.extend({hasData:function(t){return Vt.hasData(t)||Rt.hasData(t)},data:function(t,e,i){return Vt.access(t,e,i)},removeData:function(t,e){Vt.remove(t,e)},_data:function(t,e,i){return Rt.access(t,e,i)},_removeData:function(t,e){Rt.remove(t,e)}}),gt.fn.extend({data:function(t,e){var i,n,r,o=this[0],s=o&&o.attributes;if(void 0===t){if(this.length&&(r=Vt.get(o),1===o.nodeType&&!Rt.get(o,"hasDataAttrs"))){for(i=s.length;i--;)s[i]&&(n=s[i].name,0===n.indexOf("data-")&&(n=gt.camelCase(n.slice(5)),g(o,n,r[n])));Rt.set(o,"hasDataAttrs",!0)}return r}return"object"==typeof t?this.each(function(){Vt.set(this,t)}):Et(this,function(e){var i;if(o&&void 0===e){if(void 0!==(i=Vt.get(o,t)))return i;if(void 0!==(i=g(o,t)))return i}else this.each(function(){Vt.set(this,t,e)})},null,e,arguments.length>1,null,!0)},removeData:function(t){return this.each(function(){Vt.remove(this,t)})}}),gt.extend({queue:function(t,e,i){var n;if(t)return e=(e||"fx")+"queue",n=Rt.get(t,e),i&&(!n||Array.isArray(i)?n=Rt.access(t,e,gt.makeArray(i)):n.push(i)),n||[]},dequeue:function(t,e){e=e||"fx";var i=gt.queue(t,e),n=i.length,r=i.shift(),o=gt._queueHooks(t,e),s=function(){gt.dequeue(t,e)};"inprogress"===r&&(r=i.shift(),n--),r&&("fx"===e&&i.unshift("inprogress"),delete o.stop,r.call(t,s,o)),!n&&o&&o.empty.fire()},_queueHooks:function(t,e){var i=e+"queueHooks";return Rt.get(t,i)||Rt.access(t,i,{empty:gt.Callbacks("once memory").add(function(){Rt.remove(t,[e+"queue",i])})})}}),gt.fn.extend({queue:function(t,e){var i=2;return"string"!=typeof t&&(e=t,t="fx",i--),arguments.length<i?gt.queue(this[0],t):void 0===e?this:this.each(function(){var i=gt.queue(this,t,e);gt._queueHooks(this,t),"fx"===t&&"inprogress"!==i[0]&&gt.dequeue(this,t)})},dequeue:function(t){return this.each(function(){gt.dequeue(this,t)})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var i,n=1,r=gt.Deferred(),o=this,s=this.length,a=function(){--n||r.resolveWith(o,[o])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";s--;)(i=Rt.get(o[s],t+"queueHooks"))&&i.empty&&(n++,i.empty.add(a));return a(),r.promise(e)}});var Nt=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,jt=new RegExp("^(?:([+-])=|)("+Nt+")([a-z%]*)$","i"),Gt=["Top","Right","Bottom","Left"],zt=function(t,e){return t=e||t,"none"===t.style.display||""===t.style.display&&gt.contains(t.ownerDocument,t)&&"none"===gt.css(t,"display")},Jt=function(t,e,i,n){var r,o,s={};for(o in e)s[o]=t.style[o],t.style[o]=e[o];r=i.apply(t,n||[]);for(o in e)t.style[o]=s[o];return r},Ht={};gt.fn.extend({show:function(){return b(this,!0)},hide:function(){return b(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each(function(){zt(this)?gt(this).show():gt(this).hide()})}});var Ut=/^(?:checkbox|radio)$/i,qt=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i,Wt=/^$|\/(?:java|ecma)script/i,$t={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};$t.optgroup=$t.option,$t.tbody=$t.tfoot=$t.colgroup=$t.caption=$t.thead,$t.th=$t.td;var Kt=/<|&#?\w+;/;!function(){var t=st.createDocumentFragment(),e=t.appendChild(st.createElement("div")),i=st.createElement("input");i.setAttribute("type","radio"),i.setAttribute("checked","checked"),i.setAttribute("name","t"),e.appendChild(i),yt.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,e.innerHTML="<textarea>x</textarea>",yt.noCloneChecked=!!e.cloneNode(!0).lastChild.defaultValue}();var Xt=st.documentElement,Yt=/^key/,Zt=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Qt=/^([^.]*)(?:\.(.+)|)/;gt.event={global:{},add:function(t,e,i,n,r){var o,s,a,l,c,u,h,p,m,f,_,d=Rt.get(t);if(d)for(i.handler&&(o=i,i=o.handler,r=o.selector),r&&gt.find.matchesSelector(Xt,r),i.guid||(i.guid=gt.guid++),(l=d.events)||(l=d.events={}),(s=d.handle)||(s=d.handle=function(e){return void 0!==gt&&gt.event.triggered!==e.type?gt.event.dispatch.apply(t,arguments):void 0}),e=(e||"").match(It)||[""],c=e.length;c--;)a=Qt.exec(e[c])||[],m=_=a[1],f=(a[2]||"").split(".").sort(),m&&(h=gt.event.special[m]||{},m=(r?h.delegateType:h.bindType)||m,h=gt.event.special[m]||{},u=gt.extend({type:m,origType:_,data:n,handler:i,guid:i.guid,selector:r,needsContext:r&&gt.expr.match.needsContext.test(r),namespace:f.join(".")},o),(p=l[m])||(p=l[m]=[],p.delegateCount=0,h.setup&&!1!==h.setup.call(t,n,f,s)||t.addEventListener&&t.addEventListener(m,s)),h.add&&(h.add.call(t,u),u.handler.guid||(u.handler.guid=i.guid)),r?p.splice(p.delegateCount++,0,u):p.push(u),gt.event.global[m]=!0)},remove:function(t,e,i,n,r){var o,s,a,l,c,u,h,p,m,f,_,d=Rt.hasData(t)&&Rt.get(t);if(d&&(l=d.events)){for(e=(e||"").match(It)||[""],c=e.length;c--;)if(a=Qt.exec(e[c])||[],m=_=a[1],f=(a[2]||"").split(".").sort(),m){for(h=gt.event.special[m]||{},m=(n?h.delegateType:h.bindType)||m,p=l[m]||[],a=a[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=o=p.length;o--;)u=p[o],!r&&_!==u.origType||i&&i.guid!==u.guid||a&&!a.test(u.namespace)||n&&n!==u.selector&&("**"!==n||!u.selector)||(p.splice(o,1),u.selector&&p.delegateCount--,h.remove&&h.remove.call(t,u));s&&!p.length&&(h.teardown&&!1!==h.teardown.call(t,f,d.handle)||gt.removeEvent(t,m,d.handle),delete l[m])}else for(m in l)gt.event.remove(t,m+e[c],i,n,!0);gt.isEmptyObject(l)&&Rt.remove(t,"handle events")}},dispatch:function(t){var e,i,n,r,o,s,a=gt.event.fix(t),l=new Array(arguments.length),c=(Rt.get(this,"events")||{})[a.type]||[],u=gt.event.special[a.type]||{};for(l[0]=a,e=1;e<arguments.length;e++)l[e]=arguments[e];if(a.delegateTarget=this,!u.preDispatch||!1!==u.preDispatch.call(this,a)){for(s=gt.event.handlers.call(this,a,c),e=0;(r=s[e++])&&!a.isPropagationStopped();)for(a.currentTarget=r.elem,i=0;(o=r.handlers[i++])&&!a.isImmediatePropagationStopped();)a.rnamespace&&!a.rnamespace.test(o.namespace)||(a.handleObj=o,a.data=o.data,void 0!==(n=((gt.event.special[o.origType]||{}).handle||o.handler).apply(r.elem,l))&&!1===(a.result=n)&&(a.preventDefault(),a.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,a),a.result}},handlers:function(t,e){var i,n,r,o,s,a=[],l=e.delegateCount,c=t.target;if(l&&c.nodeType&&!("click"===t.type&&t.button>=1))for(;c!==this;c=c.parentNode||this)if(1===c.nodeType&&("click"!==t.type||!0!==c.disabled)){for(o=[],s={},i=0;i<l;i++)n=e[i],r=n.selector+" ",void 0===s[r]&&(s[r]=n.needsContext?gt(r,this).index(c)>-1:gt.find(r,this,null,[c]).length),s[r]&&o.push(n);o.length&&a.push({elem:c,handlers:o})}return c=this,l<e.length&&a.push({elem:c,handlers:e.slice(l)}),a},addProp:function(t,e){Object.defineProperty(gt.Event.prototype,t,{enumerable:!0,configurable:!0,get:gt.isFunction(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(t){return t[gt.expando]?t:new gt.Event(t)},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==M()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===M()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&l(this,"input"))return this.click(),!1},_default:function(t){return l(t.target,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}}},gt.removeEvent=function(t,e,i){t.removeEventListener&&t.removeEventListener(e,i)},gt.Event=function(t,e){if(!(this instanceof gt.Event))return new gt.Event(t,e);t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?A:D,this.target=t.target&&3===t.target.nodeType?t.target.parentNode:t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget):this.type=t,e&&gt.extend(this,e),this.timeStamp=t&&t.timeStamp||gt.now(),this[gt.expando]=!0},gt.Event.prototype={constructor:gt.Event,isDefaultPrevented:D,isPropagationStopped:D,isImmediatePropagationStopped:D,isSimulated:!1,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=A,t&&!this.isSimulated&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=A,t&&!this.isSimulated&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=A,t&&!this.isSimulated&&t.stopImmediatePropagation(),this.stopPropagation()}},gt.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(t){var e=t.button;return null==t.which&&Yt.test(t.type)?null!=t.charCode?t.charCode:t.keyCode:!t.which&&void 0!==e&&Zt.test(t.type)?1&e?1:2&e?3:4&e?2:0:t.which}},gt.event.addProp),gt.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(t,e){gt.event.special[t]={delegateType:e,bindType:e,handle:function(t){var i,n=this,r=t.relatedTarget,o=t.handleObj;return r&&(r===n||gt.contains(n,r))||(t.type=o.origType,i=o.handler.apply(this,arguments),t.type=e),i}}}),gt.fn.extend({on:function(t,e,i,n){return T(this,t,e,i,n)},one:function(t,e,i,n){return T(this,t,e,i,n,1)},off:function(t,e,i){var n,r;if(t&&t.preventDefault&&t.handleObj)return n=t.handleObj,gt(t.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"==typeof t){for(r in t)this.off(r,e,t[r]);return this}return!1!==e&&"function"!=typeof e||(i=e,e=void 0),!1===i&&(i=D),this.each(function(){gt.event.remove(this,t,i,e)})}});var te=/<script|<style|<link/i,ee=/checked\s*(?:[^=]|=\s*.checked.)/i,ie=/^true\/(.*)/,ne=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;gt.extend({htmlPrefilter:function(t){return t.replace(/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,"<$1></$2>")},clone:function(t,e,i){var n,r,o,s,a=t.cloneNode(!0),l=gt.contains(t.ownerDocument,t);if(!(yt.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||gt.isXMLDoc(t)))for(s=w(a),o=w(t),n=0,r=o.length;n<r;n++)E(o[n],s[n]);if(e)if(i)for(o=o||w(t),s=s||w(a),n=0,r=o.length;n<r;n++)B(o[n],s[n]);else B(t,a);return s=w(a,"script"),s.length>0&&C(s,!l&&w(t,"script")),a},cleanData:function(t){for(var e,i,n,r=gt.event.special,o=0;void 0!==(i=t[o]);o++)if(Lt(i)){if(e=i[Rt.expando]){if(e.events)for(n in e.events)r[n]?gt.event.remove(i,n):gt.removeEvent(i,n,e.handle);i[Rt.expando]=void 0}i[Vt.expando]&&(i[Vt.expando]=void 0)}}}),gt.fn.extend({detach:function(t){return R(this,t,!0)},remove:function(t){return R(this,t)},text:function(t){return Et(this,function(t){return void 0===t?gt.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)})},null,t,arguments.length)},append:function(){return L(this,arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){k(this,t).appendChild(t)}})},prepend:function(){return L(this,arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=k(this,t);e.insertBefore(t,e.firstChild)}})},before:function(){return L(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return L(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(gt.cleanData(w(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map(function(){return gt.clone(this,t,e)})},html:function(t){return Et(this,function(t){var e=this[0]||{},i=0,n=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!te.test(t)&&!$t[(qt.exec(t)||["",""])[1].toLowerCase()]){t=gt.htmlPrefilter(t);try{for(;i<n;i++)e=this[i]||{},1===e.nodeType&&(gt.cleanData(w(e,!1)),e.innerHTML=t);e=0}catch(t){}}e&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(){var t=[];return L(this,arguments,function(e){var i=this.parentNode;gt.inArray(this,t)<0&&(gt.cleanData(w(this)),i&&i.replaceChild(e,this))},t)}}),gt.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,e){gt.fn[t]=function(t){for(var i,n=[],r=gt(t),o=r.length-1,s=0;s<=o;s++)i=s===o?this:this.clone(!0),gt(r[s])[e](i),ut.apply(n,i.get());return this.pushStack(n)}});var re=/^margin/,oe=new RegExp("^("+Nt+")(?!px)[a-z%]+$","i"),se=function(t){var e=t.ownerDocument.defaultView;return e&&e.opener||(e=i),e.getComputedStyle(t)};!function(){function t(){if(a){a.style.cssText="box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",a.innerHTML="",Xt.appendChild(s);var t=i.getComputedStyle(a);e="1%"!==t.top,o="2px"===t.marginLeft,n="4px"===t.width,a.style.marginRight="50%",r="4px"===t.marginRight,Xt.removeChild(s),a=null}}var e,n,r,o,s=st.createElement("div"),a=st.createElement("div");a.style&&(a.style.backgroundClip="content-box",a.cloneNode(!0).style.backgroundClip="",yt.clearCloneStyle="content-box"===a.style.backgroundClip,s.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",s.appendChild(a),gt.extend(yt,{pixelPosition:function(){return t(),e},boxSizingReliable:function(){return t(),n},pixelMarginRight:function(){return t(),r},reliableMarginLeft:function(){return t(),o}}))}();var ae=/^(none|table(?!-c[ea]).+)/,le=/^--/,ce={position:"absolute",visibility:"hidden",display:"block"},ue={letterSpacing:"0",fontWeight:"400"},he=["Webkit","Moz","ms"],pe=st.createElement("div").style;gt.extend({cssHooks:{opacity:{get:function(t,e){if(e){var i=V(t,"opacity");return""===i?"1":i}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(t,e,i,n){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var r,o,s,a=gt.camelCase(e),l=le.test(e),c=t.style;if(l||(e=N(a)),s=gt.cssHooks[e]||gt.cssHooks[a],void 0===i)return s&&"get"in s&&void 0!==(r=s.get(t,!1,n))?r:c[e];o=typeof i,"string"===o&&(r=jt.exec(i))&&r[1]&&(i=v(t,e,r),o="number"),null!=i&&i===i&&("number"===o&&(i+=r&&r[3]||(gt.cssNumber[a]?"":"px")),yt.clearCloneStyle||""!==i||0!==e.indexOf("background")||(c[e]="inherit"),s&&"set"in s&&void 0===(i=s.set(t,i,n))||(l?c.setProperty(e,i):c[e]=i))}},css:function(t,e,i,n){var r,o,s,a=gt.camelCase(e);return le.test(e)||(e=N(a)),s=gt.cssHooks[e]||gt.cssHooks[a],s&&"get"in s&&(r=s.get(t,!0,i)),void 0===r&&(r=V(t,e,n)),"normal"===r&&e in ue&&(r=ue[e]),""===i||i?(o=parseFloat(r),!0===i||isFinite(o)?o||0:r):r}}),gt.each(["height","width"],function(t,e){gt.cssHooks[e]={get:function(t,i,n){if(i)return!ae.test(gt.css(t,"display"))||t.getClientRects().length&&t.getBoundingClientRect().width?z(t,e,n):Jt(t,ce,function(){return z(t,e,n)})},set:function(t,i,n){var r,o=n&&se(t),s=n&&G(t,e,n,"border-box"===gt.css(t,"boxSizing",!1,o),o);return s&&(r=jt.exec(i))&&"px"!==(r[3]||"px")&&(t.style[e]=i,i=gt.css(t,e)),j(t,i,s)}}}),gt.cssHooks.marginLeft=O(yt.reliableMarginLeft,function(t,e){if(e)return(parseFloat(V(t,"marginLeft"))||t.getBoundingClientRect().left-Jt(t,{marginLeft:0},function(){return t.getBoundingClientRect().left}))+"px"}),gt.each({margin:"",padding:"",border:"Width"},function(t,e){gt.cssHooks[t+e]={expand:function(i){for(var n=0,r={},o="string"==typeof i?i.split(" "):[i];n<4;n++)r[t+Gt[n]+e]=o[n]||o[n-2]||o[0];return r}},re.test(t)||(gt.cssHooks[t+e].set=j)}),gt.fn.extend({css:function(t,e){return Et(this,function(t,e,i){var n,r,o={},s=0;if(Array.isArray(e)){for(n=se(t),r=e.length;s<r;s++)o[e[s]]=gt.css(t,e[s],!1,n);return o}return void 0!==i?gt.style(t,e,i):gt.css(t,e)},t,e,arguments.length>1)}}),gt.Tween=J,J.prototype={constructor:J,init:function(t,e,i,n,r,o){this.elem=t,this.prop=i,this.easing=r||gt.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=n,this.unit=o||(gt.cssNumber[i]?"":"px")},cur:function(){var t=J.propHooks[this.prop];return t&&t.get?t.get(this):J.propHooks._default.get(this)},run:function(t){var e,i=J.propHooks[this.prop];return this.options.duration?this.pos=e=gt.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):J.propHooks._default.set(this),this}},J.prototype.init.prototype=J.prototype,J.propHooks={_default:{get:function(t){var e;return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(e=gt.css(t.elem,t.prop,""),e&&"auto"!==e?e:0)},set:function(t){gt.fx.step[t.prop]?gt.fx.step[t.prop](t):1!==t.elem.nodeType||null==t.elem.style[gt.cssProps[t.prop]]&&!gt.cssHooks[t.prop]?t.elem[t.prop]=t.now:gt.style(t.elem,t.prop,t.now+t.unit)}}},J.propHooks.scrollTop=J.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},gt.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},_default:"swing"},gt.fx=J.prototype.init,gt.fx.step={};var me,fe,_e=/^(?:toggle|show|hide)$/,de=/queueHooks$/;gt.Animation=gt.extend(X,{tweeners:{"*":[function(t,e){var i=this.createTween(t,e);return v(i.elem,t,jt.exec(e),i),i}]},tweener:function(t,e){gt.isFunction(t)?(e=t,t=["*"]):t=t.match(It);for(var i,n=0,r=t.length;n<r;n++)i=t[n],X.tweeners[i]=X.tweeners[i]||[],X.tweeners[i].unshift(e)},prefilters:[$],prefilter:function(t,e){e?X.prefilters.unshift(t):X.prefilters.push(t)}}),gt.speed=function(t,e,i){var n=t&&"object"==typeof t?gt.extend({},t):{complete:i||!i&&e||gt.isFunction(t)&&t,duration:t,easing:i&&e||e&&!gt.isFunction(e)&&e};return gt.fx.off?n.duration=0:"number"!=typeof n.duration&&(n.duration in gt.fx.speeds?n.duration=gt.fx.speeds[n.duration]:n.duration=gt.fx.speeds._default),null!=n.queue&&!0!==n.queue||(n.queue="fx"),n.old=n.complete,n.complete=function(){gt.isFunction(n.old)&&n.old.call(this),n.queue&&gt.dequeue(this,n.queue)},n},gt.fn.extend({fadeTo:function(t,e,i,n){return this.filter(zt).css("opacity",0).show().end().animate({opacity:e},t,i,n)},animate:function(t,e,i,n){var r=gt.isEmptyObject(t),o=gt.speed(e,i,n),s=function(){var e=X(this,gt.extend({},t),o);(r||Rt.get(this,"finish"))&&e.stop(!0)};return s.finish=s,r||!1===o.queue?this.each(s):this.queue(o.queue,s)},stop:function(t,e,i){var n=function(t){var e=t.stop;delete t.stop,e(i)};return"string"!=typeof t&&(i=e,e=t,t=void 0),e&&!1!==t&&this.queue(t||"fx",[]),this.each(function(){var e=!0,r=null!=t&&t+"queueHooks",o=gt.timers,s=Rt.get(this);if(r)s[r]&&s[r].stop&&n(s[r]);else for(r in s)s[r]&&s[r].stop&&de.test(r)&&n(s[r]);for(r=o.length;r--;)o[r].elem!==this||null!=t&&o[r].queue!==t||(o[r].anim.stop(i),e=!1,o.splice(r,1));!e&&i||gt.dequeue(this,t)})},finish:function(t){return!1!==t&&(t=t||"fx"),this.each(function(){var e,i=Rt.get(this),n=i[t+"queue"],r=i[t+"queueHooks"],o=gt.timers,s=n?n.length:0;for(i.finish=!0,gt.queue(this,t,[]),r&&r.stop&&r.stop.call(this,!0),e=o.length;e--;)o[e].elem===this&&o[e].queue===t&&(o[e].anim.stop(!0),o.splice(e,1));for(e=0;e<s;e++)n[e]&&n[e].finish&&n[e].finish.call(this);delete i.finish})}}),gt.each(["toggle","show","hide"],function(t,e){var i=gt.fn[e];gt.fn[e]=function(t,n,r){return null==t||"boolean"==typeof t?i.apply(this,arguments):this.animate(q(e,!0),t,n,r)}}),gt.each({slideDown:q("show"),slideUp:q("hide"),slideToggle:q("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,e){gt.fn[t]=function(t,i,n){return this.animate(e,t,i,n)}}),gt.timers=[],gt.fx.tick=function(){var t,e=0,i=gt.timers;for(me=gt.now();e<i.length;e++)(t=i[e])()||i[e]!==t||i.splice(e--,1);i.length||gt.fx.stop(),me=void 0},gt.fx.timer=function(t){gt.timers.push(t),gt.fx.start()},gt.fx.interval=13,gt.fx.start=function(){fe||(fe=!0,H())},gt.fx.stop=function(){fe=null},gt.fx.speeds={slow:600,fast:200,_default:400},gt.fn.delay=function(t,e){return t=gt.fx?gt.fx.speeds[t]||t:t,e=e||"fx",this.queue(e,function(e,n){var r=i.setTimeout(e,t);n.stop=function(){i.clearTimeout(r)}})},function(){var t=st.createElement("input"),e=st.createElement("select"),i=e.appendChild(st.createElement("option"));t.type="checkbox",yt.checkOn=""!==t.value,yt.optSelected=i.selected,t=st.createElement("input"),t.value="t",t.type="radio",yt.radioValue="t"===t.value}();var ye,ge=gt.expr.attrHandle;gt.fn.extend({attr:function(t,e){return Et(this,gt.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each(function(){gt.removeAttr(this,t)})}}),gt.extend({attr:function(t,e,i){var n,r,o=t.nodeType;if(3!==o&&8!==o&&2!==o)return void 0===t.getAttribute?gt.prop(t,e,i):(1===o&&gt.isXMLDoc(t)||(r=gt.attrHooks[e.toLowerCase()]||(gt.expr.match.bool.test(e)?ye:void 0)),void 0!==i?null===i?void gt.removeAttr(t,e):r&&"set"in r&&void 0!==(n=r.set(t,i,e))?n:(t.setAttribute(e,i+""),i):r&&"get"in r&&null!==(n=r.get(t,e))?n:(n=gt.find.attr(t,e),null==n?void 0:n))},attrHooks:{type:{set:function(t,e){if(!yt.radioValue&&"radio"===e&&l(t,"input")){var i=t.value;return t.setAttribute("type",e),i&&(t.value=i),e}}}},removeAttr:function(t,e){var i,n=0,r=e&&e.match(It);if(r&&1===t.nodeType)for(;i=r[n++];)t.removeAttribute(i)}}),ye={set:function(t,e,i){return!1===e?gt.removeAttr(t,i):t.setAttribute(i,i),i}},gt.each(gt.expr.match.bool.source.match(/\w+/g),function(t,e){var i=ge[e]||gt.find.attr;ge[e]=function(t,e,n){var r,o,s=e.toLowerCase();return n||(o=ge[s],ge[s]=r,r=null!=i(t,e,n)?s:null,ge[s]=o),r}});var ve=/^(?:input|select|textarea|button)$/i,xe=/^(?:a|area)$/i;gt.fn.extend({prop:function(t,e){return Et(this,gt.prop,t,e,arguments.length>1)},removeProp:function(t){return this.each(function(){delete this[gt.propFix[t]||t]})}}),gt.extend({prop:function(t,e,i){var n,r,o=t.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&gt.isXMLDoc(t)||(e=gt.propFix[e]||e,r=gt.propHooks[e]),void 0!==i?r&&"set"in r&&void 0!==(n=r.set(t,i,e))?n:t[e]=i:r&&"get"in r&&null!==(n=r.get(t,e))?n:t[e]},propHooks:{tabIndex:{get:function(t){var e=gt.find.attr(t,"tabindex");return e?parseInt(e,10):ve.test(t.nodeName)||xe.test(t.nodeName)&&t.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),yt.optSelected||(gt.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null},set:function(t){var e=t.parentNode;e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex)}}),gt.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){gt.propFix[this.toLowerCase()]=this}),gt.fn.extend({addClass:function(t){var e,i,n,r,o,s,a,l=0;if(gt.isFunction(t))return this.each(function(e){gt(this).addClass(t.call(this,e,Z(this)))});if("string"==typeof t&&t)for(e=t.match(It)||[];i=this[l++];)if(r=Z(i),n=1===i.nodeType&&" "+Y(r)+" "){for(s=0;o=e[s++];)n.indexOf(" "+o+" ")<0&&(n+=o+" ");a=Y(n),r!==a&&i.setAttribute("class",a)}return this},removeClass:function(t){var e,i,n,r,o,s,a,l=0;if(gt.isFunction(t))return this.each(function(e){gt(this).removeClass(t.call(this,e,Z(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof t&&t)for(e=t.match(It)||[];i=this[l++];)if(r=Z(i),n=1===i.nodeType&&" "+Y(r)+" "){for(s=0;o=e[s++];)for(;n.indexOf(" "+o+" ")>-1;)n=n.replace(" "+o+" "," ");a=Y(n),r!==a&&i.setAttribute("class",a)}return this},toggleClass:function(t,e){var i=typeof t;return"boolean"==typeof e&&"string"===i?e?this.addClass(t):this.removeClass(t):gt.isFunction(t)?this.each(function(i){gt(this).toggleClass(t.call(this,i,Z(this),e),e)}):this.each(function(){var e,n,r,o;if("string"===i)for(n=0,r=gt(this),o=t.match(It)||[];e=o[n++];)r.hasClass(e)?r.removeClass(e):r.addClass(e);else void 0!==t&&"boolean"!==i||(e=Z(this),e&&Rt.set(this,"__className__",e),this.setAttribute&&this.setAttribute("class",e||!1===t?"":Rt.get(this,"__className__")||""))})},hasClass:function(t){var e,i,n=0;for(e=" "+t+" ";i=this[n++];)if(1===i.nodeType&&(" "+Y(Z(i))+" ").indexOf(e)>-1)return!0;return!1}});gt.fn.extend({val:function(t){var e,i,n,r=this[0];{if(arguments.length)return n=gt.isFunction(t),this.each(function(i){var r;1===this.nodeType&&(r=n?t.call(this,i,gt(this).val()):t,null==r?r="":"number"==typeof r?r+="":Array.isArray(r)&&(r=gt.map(r,function(t){return null==t?"":t+""})),(e=gt.valHooks[this.type]||gt.valHooks[this.nodeName.toLowerCase()])&&"set"in e&&void 0!==e.set(this,r,"value")||(this.value=r))});if(r)return(e=gt.valHooks[r.type]||gt.valHooks[r.nodeName.toLowerCase()])&&"get"in e&&void 0!==(i=e.get(r,"value"))?i:(i=r.value,"string"==typeof i?i.replace(/\r/g,""):null==i?"":i)}}}),gt.extend({valHooks:{option:{get:function(t){var e=gt.find.attr(t,"value");return null!=e?e:Y(gt.text(t))}},select:{get:function(t){var e,i,n,r=t.options,o=t.selectedIndex,s="select-one"===t.type,a=s?null:[],c=s?o+1:r.length;for(n=o<0?c:s?o:0;n<c;n++)if(i=r[n],(i.selected||n===o)&&!i.disabled&&(!i.parentNode.disabled||!l(i.parentNode,"optgroup"))){if(e=gt(i).val(),s)return e;a.push(e)}return a},set:function(t,e){for(var i,n,r=t.options,o=gt.makeArray(e),s=r.length;s--;)n=r[s],(n.selected=gt.inArray(gt.valHooks.option.get(n),o)>-1)&&(i=!0);return i||(t.selectedIndex=-1),o}}}}),gt.each(["radio","checkbox"],function(){gt.valHooks[this]={set:function(t,e){if(Array.isArray(e))return t.checked=gt.inArray(gt(t).val(),e)>-1}},yt.checkOn||(gt.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})});var be=/^(?:focusinfocus|focusoutblur)$/;gt.extend(gt.event,{trigger:function(t,e,n,r){var o,s,a,l,c,u,h,p=[n||st],m=ft.call(t,"type")?t.type:t,f=ft.call(t,"namespace")?t.namespace.split("."):[];if(s=a=n=n||st,3!==n.nodeType&&8!==n.nodeType&&!be.test(m+gt.event.triggered)&&(m.indexOf(".")>-1&&(f=m.split("."),m=f.shift(),f.sort()),c=m.indexOf(":")<0&&"on"+m,t=t[gt.expando]?t:new gt.Event(m,"object"==typeof t&&t),t.isTrigger=r?2:3,t.namespace=f.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=n),e=null==e?[t]:gt.makeArray(e,[t]),h=gt.event.special[m]||{},r||!h.trigger||!1!==h.trigger.apply(n,e))){if(!r&&!h.noBubble&&!gt.isWindow(n)){for(l=h.delegateType||m,be.test(l+m)||(s=s.parentNode);s;s=s.parentNode)p.push(s),a=s;a===(n.ownerDocument||st)&&p.push(a.defaultView||a.parentWindow||i)}for(o=0;(s=p[o++])&&!t.isPropagationStopped();)t.type=o>1?l:h.bindType||m,u=(Rt.get(s,"events")||{})[t.type]&&Rt.get(s,"handle"),u&&u.apply(s,e),(u=c&&s[c])&&u.apply&&Lt(s)&&(t.result=u.apply(s,e),!1===t.result&&t.preventDefault());return t.type=m,r||t.isDefaultPrevented()||h._default&&!1!==h._default.apply(p.pop(),e)||!Lt(n)||c&&gt.isFunction(n[m])&&!gt.isWindow(n)&&(a=n[c],a&&(n[c]=null),gt.event.triggered=m,n[m](),gt.event.triggered=void 0,a&&(n[c]=a)),t.result}},simulate:function(t,e,i){var n=gt.extend(new gt.Event,i,{type:t,isSimulated:!0});gt.event.trigger(n,null,e)}}),gt.fn.extend({trigger:function(t,e){return this.each(function(){gt.event.trigger(t,e,this)})},triggerHandler:function(t,e){var i=this[0];if(i)return gt.event.trigger(t,e,i,!0)}}),gt.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(t,e){gt.fn[e]=function(t,i){return arguments.length>0?this.on(e,null,t,i):this.trigger(e)}}),gt.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}}),yt.focusin="onfocusin"in i,yt.focusin||gt.each({focus:"focusin",blur:"focusout"},function(t,e){var i=function(t){gt.event.simulate(e,t.target,gt.event.fix(t))};gt.event.special[e]={setup:function(){var n=this.ownerDocument||this,r=Rt.access(n,e);r||n.addEventListener(t,i,!0),Rt.access(n,e,(r||0)+1)},teardown:function(){var n=this.ownerDocument||this,r=Rt.access(n,e)-1;r?Rt.access(n,e,r):(n.removeEventListener(t,i,!0),Rt.remove(n,e))}}});var we=i.location,Ce=gt.now(),Se=/\?/;gt.parseXML=function(t){var e;if(!t||"string"!=typeof t)return null;try{e=(new i.DOMParser).parseFromString(t,"text/xml")}catch(t){e=void 0}return e&&!e.getElementsByTagName("parsererror").length||gt.error("Invalid XML: "+t),e};var Ae=/\[\]$/,De=/^(?:submit|button|image|reset|file)$/i,Me=/^(?:input|select|textarea|keygen)/i;gt.param=function(t,e){var i,n=[],r=function(t,e){var i=gt.isFunction(e)?e():e;n[n.length]=encodeURIComponent(t)+"="+encodeURIComponent(null==i?"":i)};if(Array.isArray(t)||t.jquery&&!gt.isPlainObject(t))gt.each(t,function(){r(this.name,this.value)});else for(i in t)Q(i,t[i],e,r);return n.join("&")},gt.fn.extend({serialize:function(){return gt.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=gt.prop(this,"elements");return t?gt.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!gt(this).is(":disabled")&&Me.test(this.nodeName)&&!De.test(t)&&(this.checked||!Ut.test(t))}).map(function(t,e){var i=gt(this).val();return null==i?null:Array.isArray(i)?gt.map(i,function(t){return{name:e.name,value:t.replace(/\r?\n/g,"\r\n")}}):{name:e.name,value:i.replace(/\r?\n/g,"\r\n")}}).get()}});var Te=/^(.*?):[ \t]*([^\r\n]*)$/gm,ke=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Ie=/^(?:GET|HEAD)$/,Pe={},Be={},Ee="*/".concat("*"),Le=st.createElement("a");Le.href=we.href,gt.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:we.href,type:"GET",isLocal:ke.test(we.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Ee,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":gt.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?it(it(t,gt.ajaxSettings),e):it(gt.ajaxSettings,t)},ajaxPrefilter:tt(Pe),ajaxTransport:tt(Be),ajax:function(t,e){function n(t,e,n,a){var c,p,m,x,b,w=e;u||(u=!0,l&&i.clearTimeout(l),r=void 0,s=a||"",C.readyState=t>0?4:0,c=t>=200&&t<300||304===t,n&&(x=nt(f,C,n)),x=rt(f,x,C,c),c?(f.ifModified&&(b=C.getResponseHeader("Last-Modified"),b&&(gt.lastModified[o]=b),(b=C.getResponseHeader("etag"))&&(gt.etag[o]=b)),204===t||"HEAD"===f.type?w="nocontent":304===t?w="notmodified":(w=x.state,p=x.data,m=x.error,c=!m)):(m=w,!t&&w||(w="error",t<0&&(t=0))),C.status=t,C.statusText=(e||w)+"",c?y.resolveWith(_,[p,w,C]):y.rejectWith(_,[C,w,m]),C.statusCode(v),v=void 0,h&&d.trigger(c?"ajaxSuccess":"ajaxError",[C,f,c?p:m]),g.fireWith(_,[C,w]),h&&(d.trigger("ajaxComplete",[C,f]),--gt.active||gt.event.trigger("ajaxStop")))}"object"==typeof t&&(e=t,t=void 0),e=e||{};var r,o,s,a,l,c,u,h,p,m,f=gt.ajaxSetup({},e),_=f.context||f,d=f.context&&(_.nodeType||_.jquery)?gt(_):gt.event,y=gt.Deferred(),g=gt.Callbacks("once memory"),v=f.statusCode||{},x={},b={},w="canceled",C={readyState:0,getResponseHeader:function(t){var e;if(u){if(!a)for(a={};e=Te.exec(s);)a[e[1].toLowerCase()]=e[2];e=a[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return u?s:null},setRequestHeader:function(t,e){return null==u&&(t=b[t.toLowerCase()]=b[t.toLowerCase()]||t,x[t]=e),this},overrideMimeType:function(t){return null==u&&(f.mimeType=t),this},statusCode:function(t){var e;if(t)if(u)C.always(t[C.status]);else for(e in t)v[e]=[v[e],t[e]];return this},abort:function(t){var e=t||w;return r&&r.abort(e),n(0,e),this}};if(y.promise(C),f.url=((t||f.url||we.href)+"").replace(/^\/\//,we.protocol+"//"),f.type=e.method||e.type||f.method||f.type,f.dataTypes=(f.dataType||"*").toLowerCase().match(It)||[""],null==f.crossDomain){c=st.createElement("a");try{c.href=f.url,c.href=c.href,f.crossDomain=Le.protocol+"//"+Le.host!=c.protocol+"//"+c.host}catch(t){f.crossDomain=!0}}if(f.data&&f.processData&&"string"!=typeof f.data&&(f.data=gt.param(f.data,f.traditional)),et(Pe,f,e,C),u)return C;h=gt.event&&f.global,h&&0==gt.active++&&gt.event.trigger("ajaxStart"),f.type=f.type.toUpperCase(),f.hasContent=!Ie.test(f.type),o=f.url.replace(/#.*$/,""),f.hasContent?f.data&&f.processData&&0===(f.contentType||"").indexOf("application/x-www-form-urlencoded")&&(f.data=f.data.replace(/%20/g,"+")):(m=f.url.slice(o.length),f.data&&(o+=(Se.test(o)?"&":"?")+f.data,delete f.data),!1===f.cache&&(o=o.replace(/([?&])_=[^&]*/,"$1"),m=(Se.test(o)?"&":"?")+"_="+Ce+++m),f.url=o+m),f.ifModified&&(gt.lastModified[o]&&C.setRequestHeader("If-Modified-Since",gt.lastModified[o]),gt.etag[o]&&C.setRequestHeader("If-None-Match",gt.etag[o])),(f.data&&f.hasContent&&!1!==f.contentType||e.contentType)&&C.setRequestHeader("Content-Type",f.contentType),C.setRequestHeader("Accept",f.dataTypes[0]&&f.accepts[f.dataTypes[0]]?f.accepts[f.dataTypes[0]]+("*"!==f.dataTypes[0]?", "+Ee+"; q=0.01":""):f.accepts["*"]);for(p in f.headers)C.setRequestHeader(p,f.headers[p]);if(f.beforeSend&&(!1===f.beforeSend.call(_,C,f)||u))return C.abort();if(w="abort",g.add(f.complete),C.done(f.success),C.fail(f.error),r=et(Be,f,e,C)){if(C.readyState=1,h&&d.trigger("ajaxSend",[C,f]),u)return C;f.async&&f.timeout>0&&(l=i.setTimeout(function(){C.abort("timeout")},f.timeout));try{u=!1,r.send(x,n)}catch(t){if(u)throw t;n(-1,t)}}else n(-1,"No Transport");return C},getJSON:function(t,e,i){return gt.get(t,e,i,"json")},getScript:function(t,e){return gt.get(t,void 0,e,"script")}}),gt.each(["get","post"],function(t,e){gt[e]=function(t,i,n,r){return gt.isFunction(i)&&(r=r||n,n=i,i=void 0),gt.ajax(gt.extend({url:t,type:e,dataType:r,data:i,success:n},gt.isPlainObject(t)&&t))}}),gt._evalUrl=function(t){return gt.ajax({url:t,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,throws:!0})},gt.fn.extend({wrapAll:function(t){var e;return this[0]&&(gt.isFunction(t)&&(t=t.call(this[0])),e=gt(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t}).append(this)),this},wrapInner:function(t){return gt.isFunction(t)?this.each(function(e){gt(this).wrapInner(t.call(this,e))}):this.each(function(){var e=gt(this),i=e.contents();i.length?i.wrapAll(t):e.append(t)})},wrap:function(t){var e=gt.isFunction(t);return this.each(function(i){gt(this).wrapAll(e?t.call(this,i):t)})},unwrap:function(t){return this.parent(t).not("body").each(function(){gt(this).replaceWith(this.childNodes)}),this}}),gt.expr.pseudos.hidden=function(t){return!gt.expr.pseudos.visible(t)},gt.expr.pseudos.visible=function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)},gt.ajaxSettings.xhr=function(){try{return new i.XMLHttpRequest}catch(t){}};var Re={0:200,1223:204},Ve=gt.ajaxSettings.xhr();yt.cors=!!Ve&&"withCredentials"in Ve,yt.ajax=Ve=!!Ve,gt.ajaxTransport(function(t){var e,n;if(yt.cors||Ve&&!t.crossDomain)return{send:function(r,o){var s,a=t.xhr();if(a.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(s in t.xhrFields)a[s]=t.xhrFields[s];t.mimeType&&a.overrideMimeType&&a.overrideMimeType(t.mimeType),t.crossDomain||r["X-Requested-With"]||(r["X-Requested-With"]="XMLHttpRequest");for(s in r)a.setRequestHeader(s,r[s]);e=function(t){return function(){e&&(e=n=a.onload=a.onerror=a.onabort=a.onreadystatechange=null,"abort"===t?a.abort():"error"===t?"number"!=typeof a.status?o(0,"error"):o(a.status,a.statusText):o(Re[a.status]||a.status,a.statusText,"text"!==(a.responseType||"text")||"string"!=typeof a.responseText?{binary:a.response}:{text:a.responseText},a.getAllResponseHeaders()))}},a.onload=e(),n=a.onerror=e("error"),void 0!==a.onabort?a.onabort=n:a.onreadystatechange=function(){4===a.readyState&&i.setTimeout(function(){e&&n()})},e=e("abort");try{a.send(t.hasContent&&t.data||null)}catch(t){if(e)throw t}},abort:function(){e&&e()}}}),gt.ajaxPrefilter(function(t){t.crossDomain&&(t.contents.script=!1)}),gt.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return gt.globalEval(t),t}}}),gt.ajaxPrefilter("script",function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")}),gt.ajaxTransport("script",function(t){if(t.crossDomain){var e,i;return{send:function(n,r){e=gt("<script>").prop({charset:t.scriptCharset,src:t.url}).on("load error",i=function(t){e.remove(),i=null,t&&r("error"===t.type?404:200,t.type)}),st.head.appendChild(e[0])},abort:function(){i&&i()}}}});var Oe=[],Fe=/(=)\?(?=&|$)|\?\?/;gt.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=Oe.pop()||gt.expando+"_"+Ce++;return this[t]=!0,t}}),gt.ajaxPrefilter("json jsonp",function(t,e,n){var r,o,s,a=!1!==t.jsonp&&(Fe.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Fe.test(t.data)&&"data");if(a||"jsonp"===t.dataTypes[0])return r=t.jsonpCallback=gt.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,a?t[a]=t[a].replace(Fe,"$1"+r):!1!==t.jsonp&&(t.url+=(Se.test(t.url)?"&":"?")+t.jsonp+"="+r),t.converters["script json"]=function(){return s||gt.error(r+" was not called"),s[0]},t.dataTypes[0]="json",o=i[r],i[r]=function(){s=arguments},n.always(function(){void 0===o?gt(i).removeProp(r):i[r]=o,t[r]&&(t.jsonpCallback=e.jsonpCallback,Oe.push(r)),s&&gt.isFunction(o)&&o(s[0]),s=o=void 0}),"script"}),yt.createHTMLDocument=function(){var t=st.implementation.createHTMLDocument("").body;return t.innerHTML="<form></form><form></form>",2===t.childNodes.length}(),gt.parseHTML=function(t,e,i){if("string"!=typeof t)return[];"boolean"==typeof e&&(i=e,e=!1);var n,r,o;return e||(yt.createHTMLDocument?(e=st.implementation.createHTMLDocument(""),n=e.createElement("base"),n.href=st.location.href,e.head.appendChild(n)):e=st),r=St.exec(t),o=!i&&[],r?[e.createElement(r[1])]:(r=S([t],e,o),o&&o.length&&gt(o).remove(),gt.merge([],r.childNodes))},gt.fn.load=function(t,e,i){var n,r,o,s=this,a=t.indexOf(" ");return a>-1&&(n=Y(t.slice(a)),t=t.slice(0,a)),gt.isFunction(e)?(i=e,e=void 0):e&&"object"==typeof e&&(r="POST"),s.length>0&&gt.ajax({url:t,type:r||"GET",dataType:"html",data:e}).done(function(t){o=arguments,s.html(n?gt("<div>").append(gt.parseHTML(t)).find(n):t)}).always(i&&function(t,e){s.each(function(){i.apply(this,o||[t.responseText,e,t])})}),this},gt.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){gt.fn[e]=function(t){return this.on(e,t)}}),gt.expr.pseudos.animated=function(t){return gt.grep(gt.timers,function(e){return t===e.elem}).length},gt.offset={setOffset:function(t,e,i){var n,r,o,s,a,l,c,u=gt.css(t,"position"),h=gt(t),p={};"static"===u&&(t.style.position="relative"),a=h.offset(),o=gt.css(t,"top"),l=gt.css(t,"left"),c=("absolute"===u||"fixed"===u)&&(o+l).indexOf("auto")>-1,c?(n=h.position(),s=n.top,r=n.left):(s=parseFloat(o)||0,r=parseFloat(l)||0),gt.isFunction(e)&&(e=e.call(t,i,gt.extend({},a))),null!=e.top&&(p.top=e.top-a.top+s),null!=e.left&&(p.left=e.left-a.left+r),"using"in e?e.using.call(t,p):h.css(p)}},gt.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){gt.offset.setOffset(this,t,e)});var e,i,n,r,o=this[0];if(o)return o.getClientRects().length?(n=o.getBoundingClientRect(),e=o.ownerDocument,i=e.documentElement,r=e.defaultView,{top:n.top+r.pageYOffset-i.clientTop,left:n.left+r.pageXOffset-i.clientLeft}):{top:0,left:0}},position:function(){if(this[0]){var t,e,i=this[0],n={top:0,left:0};return"fixed"===gt.css(i,"position")?e=i.getBoundingClientRect():(t=this.offsetParent(),e=this.offset(),l(t[0],"html")||(n=t.offset()),n={top:n.top+gt.css(t[0],"borderTopWidth",!0),left:n.left+gt.css(t[0],"borderLeftWidth",!0)}),{top:e.top-n.top-gt.css(i,"marginTop",!0),left:e.left-n.left-gt.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent;t&&"static"===gt.css(t,"position");)t=t.offsetParent;return t||Xt})}}),gt.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,e){var i="pageYOffset"===e;gt.fn[t]=function(n){return Et(this,function(t,n,r){var o;if(gt.isWindow(t)?o=t:9===t.nodeType&&(o=t.defaultView),void 0===r)return o?o[e]:t[n];o?o.scrollTo(i?o.pageXOffset:r,i?r:o.pageYOffset):t[n]=r},t,n,arguments.length)}}),gt.each(["top","left"],function(t,e){gt.cssHooks[e]=O(yt.pixelPosition,function(t,i){if(i)return i=V(t,e),oe.test(i)?gt(t).position()[e]+"px":i})}),gt.each({Height:"height",Width:"width"},function(t,e){gt.each({padding:"inner"+t,content:e,"":"outer"+t},function(i,n){gt.fn[n]=function(r,o){var s=arguments.length&&(i||"boolean"!=typeof r),a=i||(!0===r||!0===o?"margin":"border");return Et(this,function(e,i,r){var o;return gt.isWindow(e)?0===n.indexOf("outer")?e["inner"+t]:e.document.documentElement["client"+t]:9===e.nodeType?(o=e.documentElement,Math.max(e.body["scroll"+t],o["scroll"+t],e.body["offset"+t],o["offset"+t],o["client"+t])):void 0===r?gt.css(e,i,a):gt.style(e,i,r,a)},e,s?r:void 0,s)}})}),gt.fn.extend({bind:function(t,e,i){return this.on(t,null,e,i)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,i,n){return this.on(e,t,i,n)},undelegate:function(t,e,i){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",i)}}),gt.holdReady=function(t){t?gt.readyWait++:gt.ready(!0)},gt.isArray=Array.isArray,gt.parseJSON=JSON.parse,gt.nodeName=l,n=[],void 0!==(r=function(){return gt}.apply(e,n))&&(t.exports=r);var Ne=i.jQuery,je=i.$;return gt.noConflict=function(t){return i.$===gt&&(i.$=je),t&&i.jQuery===gt&&(i.jQuery=Ne),gt},o||(i.jQuery=i.$=gt),gt})},function(t,e,i){var n,r;(function(){function i(t){function e(e,i,n,r,o,s){for(;o>=0&&o<s;o+=t){var a=r?r[o]:o;n=i(n,e[a],a,e)}return n}return function(i,n,r,o){n=C(n,o,4);var s=!I(i)&&w.keys(i),a=(s||i).length,l=t>0?0:a-1;return arguments.length<3&&(r=i[s?s[l]:l],l+=t),e(i,n,r,s,l,a)}}function o(t){return function(e,i,n){i=S(i,n);for(var r=k(e),o=t>0?0:r-1;o>=0&&o<r;o+=t)if(i(e[o],o,e))return o;return-1}}function s(t,e,i){return function(n,r,o){var s=0,a=k(n);if("number"==typeof o)t>0?s=o>=0?o:Math.max(o+a,s):a=o>=0?Math.min(o+1,a):o+a+1;else if(i&&o&&a)return o=i(n,r),n[o]===r?o:-1;if(r!==r)return o=e(f.call(n,s,a),w.isNaN),o>=0?o+s:-1;for(o=t>0?s:a-1;o>=0&&o<a;o+=t)if(n[o]===r)return o;return-1}}function a(t,e){var i=R.length,n=t.constructor,r=w.isFunction(n)&&n.prototype||h,o="constructor";for(w.has(t,o)&&!w.contains(e,o)&&e.push(o);i--;)(o=R[i])in t&&t[o]!==r[o]&&!w.contains(e,o)&&e.push(o)}var l=this,c=l._,u=Array.prototype,h=Object.prototype,p=Function.prototype,m=u.push,f=u.slice,_=h.toString,d=h.hasOwnProperty,y=Array.isArray,g=Object.keys,v=p.bind,x=Object.create,b=function(){},w=function(t){return t instanceof w?t:this instanceof w?void(this._wrapped=t):new w(t)};void 0!==t&&t.exports&&(e=t.exports=w),e._=w,w.VERSION="1.8.3";var C=function(t,e,i){if(void 0===e)return t;switch(null==i?3:i){case 1:return function(i){return t.call(e,i)};case 2:return function(i,n){return t.call(e,i,n)};case 3:return function(i,n,r){return t.call(e,i,n,r)};case 4:return function(i,n,r,o){return t.call(e,i,n,r,o)}}return function(){return t.apply(e,arguments)}},S=function(t,e,i){return null==t?w.identity:w.isFunction(t)?C(t,e,i):w.isObject(t)?w.matcher(t):w.property(t)};w.iteratee=function(t,e){return S(t,e,1/0)};var A=function(t,e){return function(i){var n=arguments.length;if(n<2||null==i)return i;for(var r=1;r<n;r++)for(var o=arguments[r],s=t(o),a=s.length,l=0;l<a;l++){var c=s[l];e&&void 0!==i[c]||(i[c]=o[c])}return i}},D=function(t){if(!w.isObject(t))return{};if(x)return x(t);b.prototype=t;var e=new b;return b.prototype=null,e},M=function(t){return function(e){return null==e?void 0:e[t]}},T=Math.pow(2,53)-1,k=M("length"),I=function(t){var e=k(t);return"number"==typeof e&&e>=0&&e<=T};w.each=w.forEach=function(t,e,i){e=C(e,i);var n,r;if(I(t))for(n=0,r=t.length;n<r;n++)e(t[n],n,t);else{var o=w.keys(t);for(n=0,r=o.length;n<r;n++)e(t[o[n]],o[n],t)}return t},w.map=w.collect=function(t,e,i){e=S(e,i);for(var n=!I(t)&&w.keys(t),r=(n||t).length,o=Array(r),s=0;s<r;s++){var a=n?n[s]:s;o[s]=e(t[a],a,t)}return o},w.reduce=w.foldl=w.inject=i(1),w.reduceRight=w.foldr=i(-1),w.find=w.detect=function(t,e,i){var n;if(void 0!==(n=I(t)?w.findIndex(t,e,i):w.findKey(t,e,i))&&-1!==n)return t[n]},w.filter=w.select=function(t,e,i){var n=[];return e=S(e,i),w.each(t,function(t,i,r){e(t,i,r)&&n.push(t)}),n},w.reject=function(t,e,i){return w.filter(t,w.negate(S(e)),i)},w.every=w.all=function(t,e,i){e=S(e,i);for(var n=!I(t)&&w.keys(t),r=(n||t).length,o=0;o<r;o++){var s=n?n[o]:o;if(!e(t[s],s,t))return!1}return!0},w.some=w.any=function(t,e,i){e=S(e,i);for(var n=!I(t)&&w.keys(t),r=(n||t).length,o=0;o<r;o++){var s=n?n[o]:o;if(e(t[s],s,t))return!0}return!1},w.contains=w.includes=w.include=function(t,e,i,n){return I(t)||(t=w.values(t)),("number"!=typeof i||n)&&(i=0),w.indexOf(t,e,i)>=0},w.invoke=function(t,e){var i=f.call(arguments,2),n=w.isFunction(e);return w.map(t,function(t){var r=n?e:t[e];return null==r?r:r.apply(t,i)})},w.pluck=function(t,e){return w.map(t,w.property(e))},w.where=function(t,e){return w.filter(t,w.matcher(e))},w.findWhere=function(t,e){return w.find(t,w.matcher(e))},w.max=function(t,e,i){var n,r,o=-1/0,s=-1/0;if(null==e&&null!=t){t=I(t)?t:w.values(t);for(var a=0,l=t.length;a<l;a++)(n=t[a])>o&&(o=n)}else e=S(e,i),w.each(t,function(t,i,n){((r=e(t,i,n))>s||r===-1/0&&o===-1/0)&&(o=t,s=r)});return o},w.min=function(t,e,i){var n,r,o=1/0,s=1/0;if(null==e&&null!=t){t=I(t)?t:w.values(t);for(var a=0,l=t.length;a<l;a++)(n=t[a])<o&&(o=n)}else e=S(e,i),w.each(t,function(t,i,n){((r=e(t,i,n))<s||r===1/0&&o===1/0)&&(o=t,s=r)});return o},w.shuffle=function(t){for(var e,i=I(t)?t:w.values(t),n=i.length,r=Array(n),o=0;o<n;o++)e=w.random(0,o),e!==o&&(r[o]=r[e]),r[e]=i[o];return r},w.sample=function(t,e,i){return null==e||i?(I(t)||(t=w.values(t)),t[w.random(t.length-1)]):w.shuffle(t).slice(0,Math.max(0,e))},w.sortBy=function(t,e,i){return e=S(e,i),w.pluck(w.map(t,function(t,i,n){return{value:t,index:i,criteria:e(t,i,n)}}).sort(function(t,e){var i=t.criteria,n=e.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(i<n||void 0===n)return-1}return t.index-e.index}),"value")};var P=function(t){return function(e,i,n){var r={};return i=S(i,n),w.each(e,function(n,o){var s=i(n,o,e);t(r,n,s)}),r}};w.groupBy=P(function(t,e,i){w.has(t,i)?t[i].push(e):t[i]=[e]}),w.indexBy=P(function(t,e,i){t[i]=e}),w.countBy=P(function(t,e,i){w.has(t,i)?t[i]++:t[i]=1}),w.toArray=function(t){return t?w.isArray(t)?f.call(t):I(t)?w.map(t,w.identity):w.values(t):[]},w.size=function(t){return null==t?0:I(t)?t.length:w.keys(t).length},w.partition=function(t,e,i){e=S(e,i);var n=[],r=[];return w.each(t,function(t,i,o){(e(t,i,o)?n:r).push(t)}),[n,r]},w.first=w.head=w.take=function(t,e,i){if(null!=t)return null==e||i?t[0]:w.initial(t,t.length-e)},w.initial=function(t,e,i){return f.call(t,0,Math.max(0,t.length-(null==e||i?1:e)))},w.last=function(t,e,i){if(null!=t)return null==e||i?t[t.length-1]:w.rest(t,Math.max(0,t.length-e))},w.rest=w.tail=w.drop=function(t,e,i){return f.call(t,null==e||i?1:e)},w.compact=function(t){return w.filter(t,w.identity)};var B=function(t,e,i,n){for(var r=[],o=0,s=n||0,a=k(t);s<a;s++){var l=t[s];if(I(l)&&(w.isArray(l)||w.isArguments(l))){e||(l=B(l,e,i));var c=0,u=l.length;for(r.length+=u;c<u;)r[o++]=l[c++]}else i||(r[o++]=l)}return r};w.flatten=function(t,e){return B(t,e,!1)},w.without=function(t){return w.difference(t,f.call(arguments,1))},w.uniq=w.unique=function(t,e,i,n){w.isBoolean(e)||(n=i,i=e,e=!1),null!=i&&(i=S(i,n));for(var r=[],o=[],s=0,a=k(t);s<a;s++){var l=t[s],c=i?i(l,s,t):l;e?(s&&o===c||r.push(l),o=c):i?w.contains(o,c)||(o.push(c),r.push(l)):w.contains(r,l)||r.push(l)}return r},w.union=function(){return w.uniq(B(arguments,!0,!0))},w.intersection=function(t){for(var e=[],i=arguments.length,n=0,r=k(t);n<r;n++){var o=t[n];if(!w.contains(e,o)){for(var s=1;s<i&&w.contains(arguments[s],o);s++);s===i&&e.push(o)}}return e},w.difference=function(t){var e=B(arguments,!0,!0,1);return w.filter(t,function(t){return!w.contains(e,t)})},w.zip=function(){return w.unzip(arguments)},w.unzip=function(t){for(var e=t&&w.max(t,k).length||0,i=Array(e),n=0;n<e;n++)i[n]=w.pluck(t,n);return i},w.object=function(t,e){for(var i={},n=0,r=k(t);n<r;n++)e?i[t[n]]=e[n]:i[t[n][0]]=t[n][1];return i},w.findIndex=o(1),w.findLastIndex=o(-1),w.sortedIndex=function(t,e,i,n){i=S(i,n,1);for(var r=i(e),o=0,s=k(t);o<s;){var a=Math.floor((o+s)/2);i(t[a])<r?o=a+1:s=a}return o},w.indexOf=s(1,w.findIndex,w.sortedIndex),w.lastIndexOf=s(-1,w.findLastIndex),w.range=function(t,e,i){null==e&&(e=t||0,t=0),i=i||1;for(var n=Math.max(Math.ceil((e-t)/i),0),r=Array(n),o=0;o<n;o++,t+=i)r[o]=t;return r};var E=function(t,e,i,n,r){if(!(n instanceof e))return t.apply(i,r);var o=D(t.prototype),s=t.apply(o,r);return w.isObject(s)?s:o};w.bind=function(t,e){if(v&&t.bind===v)return v.apply(t,f.call(arguments,1));if(!w.isFunction(t))throw new TypeError("Bind must be called on a function");var i=f.call(arguments,2),n=function(){return E(t,n,e,this,i.concat(f.call(arguments)))};return n},w.partial=function(t){var e=f.call(arguments,1),i=function(){for(var n=0,r=e.length,o=Array(r),s=0;s<r;s++)o[s]=e[s]===w?arguments[n++]:e[s];for(;n<arguments.length;)o.push(arguments[n++]);return E(t,i,this,this,o)};return i},w.bindAll=function(t){var e,i,n=arguments.length;if(n<=1)throw new Error("bindAll must be passed function names");for(e=1;e<n;e++)i=arguments[e],t[i]=w.bind(t[i],t);return t},w.memoize=function(t,e){var i=function(n){var r=i.cache,o=""+(e?e.apply(this,arguments):n);return w.has(r,o)||(r[o]=t.apply(this,arguments)),r[o]};return i.cache={},i},w.delay=function(t,e){var i=f.call(arguments,2);return setTimeout(function(){return t.apply(null,i)},e)},w.defer=w.partial(w.delay,w,1),w.throttle=function(t,e,i){var n,r,o,s=null,a=0;i||(i={});var l=function(){a=!1===i.leading?0:w.now(),s=null,o=t.apply(n,r),s||(n=r=null)};return function(){var c=w.now();a||!1!==i.leading||(a=c);var u=e-(c-a);return n=this,r=arguments,u<=0||u>e?(s&&(clearTimeout(s),s=null),a=c,o=t.apply(n,r),s||(n=r=null)):s||!1===i.trailing||(s=setTimeout(l,u)),o}},w.debounce=function(t,e,i){var n,r,o,s,a,l=function(){var c=w.now()-s;c<e&&c>=0?n=setTimeout(l,e-c):(n=null,i||(a=t.apply(o,r),n||(o=r=null)))};return function(){o=this,r=arguments,s=w.now();var c=i&&!n;return n||(n=setTimeout(l,e)),c&&(a=t.apply(o,r),o=r=null),a}},w.wrap=function(t,e){return w.partial(e,t)},w.negate=function(t){return function(){return!t.apply(this,arguments)}},w.compose=function(){var t=arguments,e=t.length-1;return function(){for(var i=e,n=t[e].apply(this,arguments);i--;)n=t[i].call(this,n);return n}},w.after=function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},w.before=function(t,e){var i;return function(){return--t>0&&(i=e.apply(this,arguments)),t<=1&&(e=null),i}},w.once=w.partial(w.before,2);var L=!{toString:null}.propertyIsEnumerable("toString"),R=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];w.keys=function(t){if(!w.isObject(t))return[];if(g)return g(t);var e=[];for(var i in t)w.has(t,i)&&e.push(i);return L&&a(t,e),e},w.allKeys=function(t){if(!w.isObject(t))return[];var e=[];for(var i in t)e.push(i);return L&&a(t,e),e},w.values=function(t){for(var e=w.keys(t),i=e.length,n=Array(i),r=0;r<i;r++)n[r]=t[e[r]];return n},w.mapObject=function(t,e,i){e=S(e,i);for(var n,r=w.keys(t),o=r.length,s={},a=0;a<o;a++)n=r[a],s[n]=e(t[n],n,t);return s},w.pairs=function(t){for(var e=w.keys(t),i=e.length,n=Array(i),r=0;r<i;r++)n[r]=[e[r],t[e[r]]];return n},w.invert=function(t){for(var e={},i=w.keys(t),n=0,r=i.length;n<r;n++)e[t[i[n]]]=i[n];return e},w.functions=w.methods=function(t){var e=[];for(var i in t)w.isFunction(t[i])&&e.push(i);return e.sort()},w.extend=A(w.allKeys),w.extendOwn=w.assign=A(w.keys),w.findKey=function(t,e,i){e=S(e,i);for(var n,r=w.keys(t),o=0,s=r.length;o<s;o++)if(n=r[o],e(t[n],n,t))return n},w.pick=function(t,e,i){var n,r,o={},s=t;if(null==s)return o;w.isFunction(e)?(r=w.allKeys(s),n=C(e,i)):(r=B(arguments,!1,!1,1),n=function(t,e,i){return e in i},s=Object(s));for(var a=0,l=r.length;a<l;a++){var c=r[a],u=s[c];n(u,c,s)&&(o[c]=u)}return o},w.omit=function(t,e,i){if(w.isFunction(e))e=w.negate(e);else{var n=w.map(B(arguments,!1,!1,1),String);e=function(t,e){return!w.contains(n,e)}}return w.pick(t,e,i)},w.defaults=A(w.allKeys,!0),w.create=function(t,e){var i=D(t);return e&&w.extendOwn(i,e),i},w.clone=function(t){return w.isObject(t)?w.isArray(t)?t.slice():w.extend({},t):t},w.tap=function(t,e){return e(t),t},w.isMatch=function(t,e){var i=w.keys(e),n=i.length;if(null==t)return!n;for(var r=Object(t),o=0;o<n;o++){var s=i[o];if(e[s]!==r[s]||!(s in r))return!1}return!0};var V=function(t,e,i,n){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof w&&(t=t._wrapped),e instanceof w&&(e=e._wrapped);var r=_.call(t);if(r!==_.call(e))return!1;switch(r){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!=+t?+e!=+e:0==+t?1/+t==1/e:+t==+e;case"[object Date]":case"[object Boolean]":return+t==+e}var o="[object Array]"===r;if(!o){if("object"!=typeof t||"object"!=typeof e)return!1;var s=t.constructor,a=e.constructor;if(s!==a&&!(w.isFunction(s)&&s instanceof s&&w.isFunction(a)&&a instanceof a)&&"constructor"in t&&"constructor"in e)return!1}i=i||[],n=n||[];for(var l=i.length;l--;)if(i[l]===t)return n[l]===e;if(i.push(t),n.push(e),o){if((l=t.length)!==e.length)return!1;for(;l--;)if(!V(t[l],e[l],i,n))return!1}else{var c,u=w.keys(t);if(l=u.length,w.keys(e).length!==l)return!1;for(;l--;)if(c=u[l],!w.has(e,c)||!V(t[c],e[c],i,n))return!1}return i.pop(),n.pop(),!0};w.isEqual=function(t,e){return V(t,e)},w.isEmpty=function(t){return null==t||(I(t)&&(w.isArray(t)||w.isString(t)||w.isArguments(t))?0===t.length:0===w.keys(t).length)},w.isElement=function(t){return!(!t||1!==t.nodeType)},w.isArray=y||function(t){return"[object Array]"===_.call(t)},w.isObject=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},w.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(t){w["is"+t]=function(e){return _.call(e)==="[object "+t+"]"}}),w.isArguments(arguments)||(w.isArguments=function(t){return w.has(t,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(w.isFunction=function(t){return"function"==typeof t||!1}),w.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},w.isNaN=function(t){return w.isNumber(t)&&t!==+t},w.isBoolean=function(t){return!0===t||!1===t||"[object Boolean]"===_.call(t)},w.isNull=function(t){return null===t},w.isUndefined=function(t){return void 0===t},w.has=function(t,e){return null!=t&&d.call(t,e)},w.noConflict=function(){return l._=c,this},w.identity=function(t){return t},w.constant=function(t){return function(){return t}},w.noop=function(){},w.property=M,w.propertyOf=function(t){return null==t?function(){}:function(e){return t[e]}},w.matcher=w.matches=function(t){return t=w.extendOwn({},t),function(e){return w.isMatch(e,t)}},w.times=function(t,e,i){var n=Array(Math.max(0,t));e=C(e,i,1);for(var r=0;r<t;r++)n[r]=e(r);return n},w.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},w.now=Date.now||function(){return(new Date).getTime()};var O={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},F=w.invert(O),N=function(t){var e=function(e){return t[e]},i="(?:"+w.keys(t).join("|")+")",n=RegExp(i),r=RegExp(i,"g");return function(t){return t=null==t?"":""+t,n.test(t)?t.replace(r,e):t}};w.escape=N(O),w.unescape=N(F),w.result=function(t,e,i){var n=null==t?void 0:t[e];return void 0===n&&(n=i),w.isFunction(n)?n.call(t):n};var j=0;w.uniqueId=function(t){var e=++j+"";return t?t+e:e},w.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var G={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},z=function(t){return"\\"+G[t]};w.template=function(t,e,i){!e&&i&&(e=i),e=w.defaults({},e,w.templateSettings);var n=RegExp([(e.escape||/(.)^/).source,(e.interpolate||/(.)^/).source,(e.evaluate||/(.)^/).source].join("|")+"|$","g"),r=0,o="__p+='";t.replace(n,function(e,i,n,s,a){return o+=t.slice(r,a).replace(/\\|'|\r|\n|\u2028|\u2029/g,z),r=a+e.length,i?o+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'":n?o+="'+\n((__t=("+n+"))==null?'':__t)+\n'":s&&(o+="';\n"+s+"\n__p+='"),e}),o+="';\n",e.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{var s=new Function(e.variable||"obj","_",o)}catch(t){throw t.source=o,t}var a=function(t){return s.call(this,t,w)},l=e.variable||"obj";return a.source="function("+l+"){\n"+o+"}",a},w.chain=function(t){var e=w(t);return e._chain=!0,e};var J=function(t,e){return t._chain?w(e).chain():e};w.mixin=function(t){w.each(w.functions(t),function(e){var i=w[e]=t[e];w.prototype[e]=function(){var t=[this._wrapped];return m.apply(t,arguments),J(this,i.apply(w,t))}})},w.mixin(w),w.each(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=u[t];w.prototype[t]=function(){var i=this._wrapped;return e.apply(i,arguments),"shift"!==t&&"splice"!==t||0!==i.length||delete i[0],J(this,i)}}),w.each(["concat","join","slice"],function(t){var e=u[t];w.prototype[t]=function(){return J(this,e.apply(this._wrapped,arguments))}}),w.prototype.value=function(){return this._wrapped},w.prototype.valueOf=w.prototype.toJSON=w.prototype.value,w.prototype.toString=function(){return""+this._wrapped},n=[],void 0!==(r=function(){return w}.apply(e,n))&&(t.exports=r)}).call(this)},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i.d(e,"IMG_BG_BAYOU",function(){return n}),i.d(e,"IMG_BG_PL_DIED",function(){return r}),i.d(e,"IMG_SPR_PLAYER_TEST",function(){return o}),i.d(e,"IMG_SPR_PLAYER_ZERO",function(){return s}),i.d(e,"IMG_SPR_NPC_SLIME",function(){return a}),i.d(e,"ICON_CROSSED_SWORDS",function(){return l}),i.d(e,"ICON_CHECKED_SHIELD",function(){return c});var n="/images/typewar/backgrounds/Fighting-Game-Background-GIFs-2.gif",r="/images/typewar/backgrounds/battle_over_lose.jpg",o="/images/typewar/sprites/player_test.png",s="/images/typewar/sprites/player_zero.png",a="/images/typewar/sprites/b_npc_slime.png",l="/typewar/icons/crossed-swords.svg",c="/typewar/icons/checked-shield.svg"},function(t,e){Crafty.c("BattleParticles",{init:function(){this._triggerParticles=!1,this._particleBuffer=[]},battleParticles:function(){return this},getParticleBuffer:function(){return this._particleBuffer},setParticleBuffer:function(t){this._particleBuffer=t},needTriggerParticles:function(){return this._triggerParticles},triggerParticles:function(){this._triggerParticles=!0}})},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r={blunt:0,slashing:0,piercing:0,fire:0,earth:0,water:0,air:0,light:0,dark:0,poison:0,life:0,death:0},o=function t(e){if(n(this,t),!opts.attacker)throw"Attempting to initialize AttackObject without an attacker";if(!opts.target)throw"Attempting to initialize AttackObject without a defender";this.properties=opts.properties||r,this.target=opts.target,this.attacker=opts.attacker,this.text_fragment=opts.text_fragment};e.default=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});i(13);Crafty.c("BattleNPCProjectile",{positionFunction:null,speed:1,init:function(){this.requires("2D, DOM")},battleNPCProjectile:function(t,e){return this.positionFunction=t,this.speed=e||this.speed,this}})},function(t,e,i){"use strict";function n(t,e){return{x:-1*e*t,y:0}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(24),o=i(5);i.d(e,"SlimeStandardAttack",function(){return s}),i.d(e,"SlimeGlobAttack",function(){return a}),i.d(e,"SlimeScatterAttack",function(){return l});var s={effects:[{klass:r.SpawnTextProjectile,positionFunction:n,speed:.03,textOptions:{minLength:7,maxLength:13},effects:[{klass:r.Damage,properties:{blunt:3,slashing:0,piercing:0,fire:0,earth:0,water:0,air:0,light:0,dark:0,poison:0,life:0,death:0}},{klass:r.TriggerAnimation,animation:o.ANIM_HIT},{klass:r.ScreenShake}]},{klass:r.TriggerAnimation,target:"self",animation:o.ANIM_LIGHT_ATTACK},{klass:r.SetCooldown,target:"self",cooldownLength:3400}],cost:0,name:"slime standard attack",startupDelay:1e3},a={effects:[{klass:r.SpawnTextProjectilePhysics,textOptions:{minLength:5,maxLength:8},box2d:{bodyType:"dynamic",density:.1,friction:2,restitution:.2},effects:[{klass:r.Damage,properties:{blunt:3,slashing:0,piercing:0,fire:0,earth:0,water:0,air:0,light:0,dark:0,poison:2,life:0,death:0}},{klass:r.TriggerAnimation,animation:o.ANIM_HIT},{klass:r.ScreenShake}]},{klass:r.TriggerAnimation,target:"self",animation:o.ANIM_HEAVY_ATTACK},{klass:r.SetCooldown,target:"self",cooldownLength:3e3}],cost:0,name:"glob",startupDelay:2e3},l={effects:[{klass:r.SpawnScatterTextProjectilePhysics,count:25,textOptions:{randomString:!0,minLength:1,maxLength:1},box2d:{bodyType:"dynamic",density:.1,friction:2,restitution:.32},effects:[{klass:r.Damage,properties:{blunt:2,slashing:0,piercing:0,fire:0,earth:0,water:0,air:0,light:0,dark:0,poison:0,life:0,death:0}},{klass:r.TriggerAnimation,animation:o.ANIM_HIT}]},{klass:r.TriggerAnimation,target:"self",animation:o.ANIM_HEAVY_ATTACK},{klass:r.SetCooldown,target:"self",cooldownLength:1e4}],cost:0,name:"glob",startupDelay:6e3}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i.d(e,"CMD_CHANGE_STANCE",function(){return n}),i.d(e,"COMMANDS",function(){return r});var n="change stance",r={tab:n}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i.d(e,"SND_TYPEWRITER",function(){return n}),i.d(e,"SND_SWORD_SWIPE",function(){return r});var n=["/audios/typewar/typewriter-key-1.mp3","/audios/typewar/typewriter-key-1.wav","/audios/typewar/typewriter-key-1.ogg"],r=["/audios/typewar/59999__qubodup__sword-or-bullet-swish-swosh-12.mp3","/audios/typewar/59999__qubodup__sword-or-bullet-swish-swosh-12.wav","/audios/typewar/59999__qubodup__sword-or-bullet-swish-swosh-12.ogg"]},function(t,e,i){"use strict";var n={};!function(t,e){function i(){}t.inherit=function(t,e){var n=t;i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=n},t.generateCallback=function(t,e){return function(){e.apply(t,arguments)}},t.NVector=function(t){void 0===t&&(t=0);for(var e=new Array(t||0),i=0;i<t;++i)e[i]=0;return e},t.is=function(t,e){return null!==t&&(e instanceof Function&&t instanceof e||!(void 0==t.constructor.__implements||!t.constructor.__implements[e]))},t.parseUInt=function(t){return Math.abs(parseInt(t))}}(n);var r=Array,o=n.NVector;void 0===n&&(n={}),void 0===n.Collision&&(n.Collision={}),void 0===n.Collision.Shapes&&(n.Collision.Shapes={}),void 0===n.Common&&(n.Common={}),void 0===n.Common.Math&&(n.Common.Math={}),void 0===n.Dynamics&&(n.Dynamics={}),void 0===n.Dynamics.Contacts&&(n.Dynamics.Contacts={}),void 0===n.Dynamics.Controllers&&(n.Dynamics.Controllers={}),void 0===n.Dynamics.Joints&&(n.Dynamics.Joints={}),function(){function t(){t.b2AABB.apply(this,arguments)}function e(){e.b2Bound.apply(this,arguments)}function i(){i.b2BoundValues.apply(this,arguments),this.constructor===i&&this.b2BoundValues.apply(this,arguments)}function r(){r.b2Collision.apply(this,arguments)}function o(){o.b2ContactID.apply(this,arguments),this.constructor===o&&this.b2ContactID.apply(this,arguments)}function s(){s.b2ContactPoint.apply(this,arguments)}function a(){a.b2Distance.apply(this,arguments)}function l(){l.b2DistanceInput.apply(this,arguments)}function c(){c.b2DistanceOutput.apply(this,arguments)}function u(){u.b2DistanceProxy.apply(this,arguments)}function h(){h.b2DynamicTree.apply(this,arguments),this.constructor===h&&this.b2DynamicTree.apply(this,arguments)}function p(){p.b2DynamicTreeBroadPhase.apply(this,arguments)}function m(){m.b2DynamicTreeNode.apply(this,arguments)}function f(){f.b2DynamicTreePair.apply(this,arguments)}function _(){_.b2Manifold.apply(this,arguments),this.constructor===_&&this.b2Manifold.apply(this,arguments)}function d(){d.b2ManifoldPoint.apply(this,arguments),this.constructor===d&&this.b2ManifoldPoint.apply(this,arguments)}function y(){y.b2Point.apply(this,arguments)}function g(){g.b2RayCastInput.apply(this,arguments),this.constructor===g&&this.b2RayCastInput.apply(this,arguments)}function v(){v.b2RayCastOutput.apply(this,arguments)}function x(){x.b2Segment.apply(this,arguments)}function b(){b.b2SeparationFunction.apply(this,arguments)}function w(){w.b2Simplex.apply(this,arguments),this.constructor===w&&this.b2Simplex.apply(this,arguments)}function C(){C.b2SimplexCache.apply(this,arguments)}function S(){S.b2SimplexVertex.apply(this,arguments)}function A(){A.b2TimeOfImpact.apply(this,arguments)}function D(){D.b2TOIInput.apply(this,arguments)}function M(){M.b2WorldManifold.apply(this,arguments),this.constructor===M&&this.b2WorldManifold.apply(this,arguments)}function T(){T.ClipVertex.apply(this,arguments)}function k(){k.Features.apply(this,arguments)}function I(){I.b2CircleShape.apply(this,arguments),this.constructor===I&&this.b2CircleShape.apply(this,arguments)}function P(){P.b2EdgeChainDef.apply(this,arguments),this.constructor===P&&this.b2EdgeChainDef.apply(this,arguments)}function B(){B.b2EdgeShape.apply(this,arguments),this.constructor===B&&this.b2EdgeShape.apply(this,arguments)}function E(){E.b2MassData.apply(this,arguments)}function L(){L.b2PolygonShape.apply(this,arguments),this.constructor===L&&this.b2PolygonShape.apply(this,arguments)}function R(){R.b2Shape.apply(this,arguments),this.constructor===R&&this.b2Shape.apply(this,arguments)}function V(){V.b2Color.apply(this,arguments),this.constructor===V&&this.b2Color.apply(this,arguments)}function O(){O.b2Settings.apply(this,arguments)}function F(){F.b2Mat22.apply(this,arguments),this.constructor===F&&this.b2Mat22.apply(this,arguments)}function N(){N.b2Mat33.apply(this,arguments),this.constructor===N&&this.b2Mat33.apply(this,arguments)}function j(){j.b2Math.apply(this,arguments)}function G(){G.b2Sweep.apply(this,arguments)}function z(){z.b2Transform.apply(this,arguments),this.constructor===z&&this.b2Transform.apply(this,arguments)}function J(){J.b2Vec2.apply(this,arguments),this.constructor===J&&this.b2Vec2.apply(this,arguments)}function H(){H.b2Vec3.apply(this,arguments),this.constructor===H&&this.b2Vec3.apply(this,arguments)}function U(){U.b2Body.apply(this,arguments),this.constructor===U&&this.b2Body.apply(this,arguments)}function q(){q.b2BodyDef.apply(this,arguments),this.constructor===q&&this.b2BodyDef.apply(this,arguments)}function W(){W.b2ContactFilter.apply(this,arguments)}function $(){$.b2ContactImpulse.apply(this,arguments)}function K(){K.b2ContactListener.apply(this,arguments)}function X(){X.b2ContactManager.apply(this,arguments),this.constructor===X&&this.b2ContactManager.apply(this,arguments)}function Y(){Y.b2DebugDraw.apply(this,arguments),this.constructor===Y&&this.b2DebugDraw.apply(this,arguments)}function Z(){Z.b2DestructionListener.apply(this,arguments)}function Q(){Q.b2FilterData.apply(this,arguments)}function tt(){tt.b2Fixture.apply(this,arguments),this.constructor===tt&&this.b2Fixture.apply(this,arguments)}function et(){et.b2FixtureDef.apply(this,arguments),this.constructor===et&&this.b2FixtureDef.apply(this,arguments)}function it(){it.b2Island.apply(this,arguments),this.constructor===it&&this.b2Island.apply(this,arguments)}function nt(){nt.b2TimeStep.apply(this,arguments)}function rt(){rt.b2World.apply(this,arguments),this.constructor===rt&&this.b2World.apply(this,arguments)}function ot(){ot.b2CircleContact.apply(this,arguments)}function st(){st.b2Contact.apply(this,arguments),this.constructor===st&&this.b2Contact.apply(this,arguments)}function at(){at.b2ContactConstraint.apply(this,arguments),this.constructor===at&&this.b2ContactConstraint.apply(this,arguments)}function lt(){lt.b2ContactConstraintPoint.apply(this,arguments)}function ct(){ct.b2ContactEdge.apply(this,arguments)}function ut(){ut.b2ContactFactory.apply(this,arguments),this.constructor===ut&&this.b2ContactFactory.apply(this,arguments)}function ht(){ht.b2ContactRegister.apply(this,arguments)}function pt(){pt.b2ContactResult.apply(this,arguments)}function mt(){mt.b2ContactSolver.apply(this,arguments),this.constructor===mt&&this.b2ContactSolver.apply(this,arguments)}function ft(){ft.b2EdgeAndCircleContact.apply(this,arguments)}function _t(){_t.b2NullContact.apply(this,arguments),this.constructor===_t&&this.b2NullContact.apply(this,arguments)}function dt(){dt.b2PolyAndCircleContact.apply(this,arguments)}function yt(){yt.b2PolyAndEdgeContact.apply(this,arguments)}function gt(){gt.b2PolygonContact.apply(this,arguments)}function vt(){vt.b2PositionSolverManifold.apply(this,arguments),this.constructor===vt&&this.b2PositionSolverManifold.apply(this,arguments)}function xt(){xt.b2BuoyancyController.apply(this,arguments)}function bt(){bt.b2ConstantAccelController.apply(this,arguments)}function wt(){wt.b2ConstantForceController.apply(this,arguments)}function Ct(){Ct.b2Controller.apply(this,arguments)}function St(){St.b2ControllerEdge.apply(this,arguments)}function At(){At.b2GravityController.apply(this,arguments)}function Dt(){Dt.b2TensorDampingController.apply(this,arguments)}function Mt(){Mt.b2DistanceJoint.apply(this,arguments),this.constructor===Mt&&this.b2DistanceJoint.apply(this,arguments)}function Tt(){Tt.b2DistanceJointDef.apply(this,arguments),this.constructor===Tt&&this.b2DistanceJointDef.apply(this,arguments)}function kt(){kt.b2FrictionJoint.apply(this,arguments),this.constructor===kt&&this.b2FrictionJoint.apply(this,arguments)}function It(){It.b2FrictionJointDef.apply(this,arguments),this.constructor===It&&this.b2FrictionJointDef.apply(this,arguments)}function Pt(){Pt.b2GearJoint.apply(this,arguments),this.constructor===Pt&&this.b2GearJoint.apply(this,arguments)}function Bt(){Bt.b2GearJointDef.apply(this,arguments),this.constructor===Bt&&this.b2GearJointDef.apply(this,arguments)}function Et(){Et.b2Jacobian.apply(this,arguments)}function Lt(){Lt.b2Joint.apply(this,arguments),this.constructor===Lt&&this.b2Joint.apply(this,arguments)}function Rt(){Rt.b2JointDef.apply(this,arguments),this.constructor===Rt&&this.b2JointDef.apply(this,arguments)}function Vt(){Vt.b2JointEdge.apply(this,arguments)}function Ot(){Ot.b2LineJoint.apply(this,arguments),this.constructor===Ot&&this.b2LineJoint.apply(this,arguments)}function Ft(){Ft.b2LineJointDef.apply(this,arguments),this.constructor===Ft&&this.b2LineJointDef.apply(this,arguments)}function Nt(){Nt.b2MouseJoint.apply(this,arguments),this.constructor===Nt&&this.b2MouseJoint.apply(this,arguments)}function jt(){jt.b2MouseJointDef.apply(this,arguments),this.constructor===jt&&this.b2MouseJointDef.apply(this,arguments)}function Gt(){Gt.b2PrismaticJoint.apply(this,arguments),this.constructor===Gt&&this.b2PrismaticJoint.apply(this,arguments)}function zt(){zt.b2PrismaticJointDef.apply(this,arguments),this.constructor===zt&&this.b2PrismaticJointDef.apply(this,arguments)}function Jt(){Jt.b2PulleyJoint.apply(this,arguments),this.constructor===Jt&&this.b2PulleyJoint.apply(this,arguments)}function Ht(){Ht.b2PulleyJointDef.apply(this,arguments),this.constructor===Ht&&this.b2PulleyJointDef.apply(this,arguments)}function Ut(){Ut.b2RevoluteJoint.apply(this,arguments),this.constructor===Ut&&this.b2RevoluteJoint.apply(this,arguments)}function qt(){qt.b2RevoluteJointDef.apply(this,arguments),this.constructor===qt&&this.b2RevoluteJointDef.apply(this,arguments)}function Wt(){Wt.b2WeldJoint.apply(this,arguments),this.constructor===Wt&&this.b2WeldJoint.apply(this,arguments)}function $t(){$t.b2WeldJointDef.apply(this,arguments),this.constructor===$t&&this.b2WeldJointDef.apply(this,arguments)}n.Collision.IBroadPhase="Box2D.Collision.IBroadPhase",n.Collision.b2AABB=t,n.Collision.b2Bound=e,n.Collision.b2BoundValues=i,n.Collision.b2Collision=r,n.Collision.b2ContactID=o,n.Collision.b2ContactPoint=s,n.Collision.b2Distance=a,n.Collision.b2DistanceInput=l,n.Collision.b2DistanceOutput=c,n.Collision.b2DistanceProxy=u,n.Collision.b2DynamicTree=h,n.Collision.b2DynamicTreeBroadPhase=p,n.Collision.b2DynamicTreeNode=m,n.Collision.b2DynamicTreePair=f,n.Collision.b2Manifold=_,n.Collision.b2ManifoldPoint=d,n.Collision.b2Point=y,n.Collision.b2RayCastInput=g,n.Collision.b2RayCastOutput=v,n.Collision.b2Segment=x,n.Collision.b2SeparationFunction=b,n.Collision.b2Simplex=w,n.Collision.b2SimplexCache=C,n.Collision.b2SimplexVertex=S,n.Collision.b2TimeOfImpact=A,n.Collision.b2TOIInput=D,n.Collision.b2WorldManifold=M,n.Collision.ClipVertex=T,n.Collision.Features=k,n.Collision.Shapes.b2CircleShape=I,n.Collision.Shapes.b2EdgeChainDef=P,n.Collision.Shapes.b2EdgeShape=B,n.Collision.Shapes.b2MassData=E,n.Collision.Shapes.b2PolygonShape=L,n.Collision.Shapes.b2Shape=R,n.Common.b2internal="Box2D.Common.b2internal",n.Common.b2Color=V,n.Common.b2Settings=O,n.Common.Math.b2Mat22=F,n.Common.Math.b2Mat33=N,n.Common.Math.b2Math=j,n.Common.Math.b2Sweep=G,n.Common.Math.b2Transform=z,n.Common.Math.b2Vec2=J,n.Common.Math.b2Vec3=H,n.Dynamics.b2Body=U,n.Dynamics.b2BodyDef=q,n.Dynamics.b2ContactFilter=W,n.Dynamics.b2ContactImpulse=$,n.Dynamics.b2ContactListener=K,n.Dynamics.b2ContactManager=X,n.Dynamics.b2DebugDraw=Y,n.Dynamics.b2DestructionListener=Z,n.Dynamics.b2FilterData=Q,n.Dynamics.b2Fixture=tt,n.Dynamics.b2FixtureDef=et,n.Dynamics.b2Island=it,n.Dynamics.b2TimeStep=nt,n.Dynamics.b2World=rt,n.Dynamics.Contacts.b2CircleContact=ot,n.Dynamics.Contacts.b2Contact=st,n.Dynamics.Contacts.b2ContactConstraint=at,n.Dynamics.Contacts.b2ContactConstraintPoint=lt,n.Dynamics.Contacts.b2ContactEdge=ct,n.Dynamics.Contacts.b2ContactFactory=ut,n.Dynamics.Contacts.b2ContactRegister=ht,n.Dynamics.Contacts.b2ContactResult=pt,n.Dynamics.Contacts.b2ContactSolver=mt,n.Dynamics.Contacts.b2EdgeAndCircleContact=ft,n.Dynamics.Contacts.b2NullContact=_t,n.Dynamics.Contacts.b2PolyAndCircleContact=dt,n.Dynamics.Contacts.b2PolyAndEdgeContact=yt,n.Dynamics.Contacts.b2PolygonContact=gt,n.Dynamics.Contacts.b2PositionSolverManifold=vt,n.Dynamics.Controllers.b2BuoyancyController=xt,n.Dynamics.Controllers.b2ConstantAccelController=bt,n.Dynamics.Controllers.b2ConstantForceController=wt,n.Dynamics.Controllers.b2Controller=Ct,n.Dynamics.Controllers.b2ControllerEdge=St,n.Dynamics.Controllers.b2GravityController=At,n.Dynamics.Controllers.b2TensorDampingController=Dt,n.Dynamics.Joints.b2DistanceJoint=Mt,n.Dynamics.Joints.b2DistanceJointDef=Tt,n.Dynamics.Joints.b2FrictionJoint=kt,n.Dynamics.Joints.b2FrictionJointDef=It,n.Dynamics.Joints.b2GearJoint=Pt,n.Dynamics.Joints.b2GearJointDef=Bt,n.Dynamics.Joints.b2Jacobian=Et,n.Dynamics.Joints.b2Joint=Lt,n.Dynamics.Joints.b2JointDef=Rt,n.Dynamics.Joints.b2JointEdge=Vt,n.Dynamics.Joints.b2LineJoint=Ot,n.Dynamics.Joints.b2LineJointDef=Ft,n.Dynamics.Joints.b2MouseJoint=Nt,n.Dynamics.Joints.b2MouseJointDef=jt,n.Dynamics.Joints.b2PrismaticJoint=Gt,n.Dynamics.Joints.b2PrismaticJointDef=zt,n.Dynamics.Joints.b2PulleyJoint=Jt,n.Dynamics.Joints.b2PulleyJointDef=Ht,n.Dynamics.Joints.b2RevoluteJoint=Ut,n.Dynamics.Joints.b2RevoluteJointDef=qt,n.Dynamics.Joints.b2WeldJoint=Wt,n.Dynamics.Joints.b2WeldJointDef=$t}(),n.postDefs=[],function(){var t=n.Collision.Shapes.b2CircleShape,e=(n.Collision.Shapes.b2EdgeChainDef,n.Collision.Shapes.b2EdgeShape,n.Collision.Shapes.b2MassData,n.Collision.Shapes.b2PolygonShape),i=n.Collision.Shapes.b2Shape,s=(n.Common.b2Color,n.Common.b2internal,n.Common.b2Settings),a=(n.Common.Math.b2Mat22,n.Common.Math.b2Mat33,n.Common.Math.b2Math),l=n.Common.Math.b2Sweep,c=n.Common.Math.b2Transform,u=n.Common.Math.b2Vec2,h=(n.Common.Math.b2Vec3,n.Collision.b2AABB),p=n.Collision.b2Bound,m=n.Collision.b2BoundValues,f=n.Collision.b2Collision,_=n.Collision.b2ContactID,d=n.Collision.b2ContactPoint,y=n.Collision.b2Distance,g=n.Collision.b2DistanceInput,v=n.Collision.b2DistanceOutput,x=n.Collision.b2DistanceProxy,b=n.Collision.b2DynamicTree,w=n.Collision.b2DynamicTreeBroadPhase,C=n.Collision.b2DynamicTreeNode,S=n.Collision.b2DynamicTreePair,A=n.Collision.b2Manifold,D=n.Collision.b2ManifoldPoint,M=n.Collision.b2Point,T=n.Collision.b2RayCastInput,k=n.Collision.b2RayCastOutput,I=n.Collision.b2Segment,P=n.Collision.b2SeparationFunction,B=n.Collision.b2Simplex,E=n.Collision.b2SimplexCache,L=n.Collision.b2SimplexVertex,R=n.Collision.b2TimeOfImpact,V=n.Collision.b2TOIInput,O=n.Collision.b2WorldManifold,F=n.Collision.ClipVertex,N=n.Collision.Features,j=n.Collision.IBroadPhase;h.b2AABB=function(){this.lowerBound=new u,this.upperBound=new u},h.prototype.IsValid=function(){var t=this.upperBound.x-this.lowerBound.x,e=this.upperBound.y-this.lowerBound.y,i=t>=0&&e>=0;return i=i&&this.lowerBound.IsValid()&&this.upperBound.IsValid()},h.prototype.GetCenter=function(){return new u((this.lowerBound.x+this.upperBound.x)/2,(this.lowerBound.y+this.upperBound.y)/2)},h.prototype.GetExtents=function(){return new u((this.upperBound.x-this.lowerBound.x)/2,(this.upperBound.y-this.lowerBound.y)/2)},h.prototype.Contains=function(t){var e=!0;return e=e&&this.lowerBound.x<=t.lowerBound.x,e=e&&this.lowerBound.y<=t.lowerBound.y,e=e&&t.upperBound.x<=this.upperBound.x,e=e&&t.upperBound.y<=this.upperBound.y},h.prototype.RayCast=function(t,e){var i=-Number.MAX_VALUE,n=Number.MAX_VALUE,r=e.p1.x,o=e.p1.y,s=e.p2.x-e.p1.x,a=e.p2.y-e.p1.y,l=Math.abs(s),c=Math.abs(a),u=t.normal,h=0,p=0,m=0,f=0,_=0;if(l<Number.MIN_VALUE){if(r<this.lowerBound.x||this.upperBound.x<r)return!1}else if(h=1/s,p=(this.lowerBound.x-r)*h,m=(this.upperBound.x-r)*h,_=-1,p>m&&(f=p,p=m,m=f,_=1),p>i&&(u.x=_,u.y=0,i=p),n=Math.min(n,m),i>n)return!1;if(c<Number.MIN_VALUE){if(o<this.lowerBound.y||this.upperBound.y<o)return!1}else if(h=1/a,p=(this.lowerBound.y-o)*h,m=(this.upperBound.y-o)*h,_=-1,p>m&&(f=p,p=m,m=f,_=1),p>i&&(u.y=_,u.x=0,i=p),n=Math.min(n,m),i>n)return!1;return t.fraction=i,!0},h.prototype.TestOverlap=function(t){var e=t.lowerBound.x-this.upperBound.x,i=t.lowerBound.y-this.upperBound.y,n=this.lowerBound.x-t.upperBound.x,r=this.lowerBound.y-t.upperBound.y;return!(e>0||i>0)&&!(n>0||r>0)},h.Combine=function(t,e){var i=new h;return i.Combine(t,e),i},h.prototype.Combine=function(t,e){this.lowerBound.x=Math.min(t.lowerBound.x,e.lowerBound.x),this.lowerBound.y=Math.min(t.lowerBound.y,e.lowerBound.y),this.upperBound.x=Math.max(t.upperBound.x,e.upperBound.x),this.upperBound.y=Math.max(t.upperBound.y,e.upperBound.y)},p.b2Bound=function(){},p.prototype.IsLower=function(){return 0==(1&this.value)},p.prototype.IsUpper=function(){return 1==(1&this.value)},p.prototype.Swap=function(t){var e=this.value,i=this.proxy,n=this.stabbingCount;this.value=t.value,this.proxy=t.proxy,this.stabbingCount=t.stabbingCount,t.value=e,t.proxy=i,t.stabbingCount=n},m.b2BoundValues=function(){},m.prototype.b2BoundValues=function(){this.lowerValues=new o,this.lowerValues[0]=0,this.lowerValues[1]=0,this.upperValues=new o,this.upperValues[0]=0,this.upperValues[1]=0},f.b2Collision=function(){},f.ClipSegmentToLine=function(t,e,i,n){void 0===n&&(n=0);var r,o=0;r=e[0];var s=r.v;r=e[1];var a=r.v,l=i.x*s.x+i.y*s.y-n,c=i.x*a.x+i.y*a.y-n;if(l<=0&&t[o++].Set(e[0]),c<=0&&t[o++].Set(e[1]),l*c<0){var u=l/(l-c);r=t[o];var h=r.v;h.x=s.x+u*(a.x-s.x),h.y=s.y+u*(a.y-s.y),r=t[o];var p;l>0?(p=e[0],r.id=p.id):(p=e[1],r.id=p.id),++o}return o},f.EdgeSeparation=function(t,e,i,n,r){void 0===i&&(i=0);var o,s,a=(parseInt(t.m_vertexCount),t.m_vertices),l=t.m_normals,c=parseInt(n.m_vertexCount),u=n.m_vertices;o=e.R,s=l[i];var h=o.col1.x*s.x+o.col2.x*s.y,p=o.col1.y*s.x+o.col2.y*s.y;o=r.R;for(var m=o.col1.x*h+o.col1.y*p,f=o.col2.x*h+o.col2.y*p,_=0,d=Number.MAX_VALUE,y=0;y<c;++y){s=u[y];var g=s.x*m+s.y*f;g<d&&(d=g,_=y)}s=a[i],o=e.R;var v=e.position.x+(o.col1.x*s.x+o.col2.x*s.y),x=e.position.y+(o.col1.y*s.x+o.col2.y*s.y);s=u[_],o=r.R;var b=r.position.x+(o.col1.x*s.x+o.col2.x*s.y),w=r.position.y+(o.col1.y*s.x+o.col2.y*s.y);return b-=v,w-=x,b*h+w*p},f.FindMaxSeparation=function(t,e,i,n,r){var o,s,a=parseInt(e.m_vertexCount),l=e.m_normals;s=r.R,o=n.m_centroid;var c=r.position.x+(s.col1.x*o.x+s.col2.x*o.y),u=r.position.y+(s.col1.y*o.x+s.col2.y*o.y);s=i.R,o=e.m_centroid,c-=i.position.x+(s.col1.x*o.x+s.col2.x*o.y),u-=i.position.y+(s.col1.y*o.x+s.col2.y*o.y);for(var h=c*i.R.col1.x+u*i.R.col1.y,p=c*i.R.col2.x+u*i.R.col2.y,m=0,_=-Number.MAX_VALUE,d=0;d<a;++d){o=l[d];var y=o.x*h+o.y*p;y>_&&(_=y,m=d)}var g=f.EdgeSeparation(e,i,m,n,r),v=parseInt(m-1>=0?m-1:a-1),x=f.EdgeSeparation(e,i,v,n,r),b=parseInt(m+1<a?m+1:0),w=f.EdgeSeparation(e,i,b,n,r),C=0,S=0,A=0;if(x>g&&x>w)A=-1,C=v,S=x;else{if(!(w>g))return t[0]=m,g;A=1,C=b,S=w}for(;;){if(m=-1==A?C-1>=0?C-1:a-1:C+1<a?C+1:0,!((g=f.EdgeSeparation(e,i,m,n,r))>S))break;C=m,S=g}return t[0]=C,S},f.FindIncidentEdge=function(t,e,i,n,r,o){void 0===n&&(n=0);var s,a,l=(parseInt(e.m_vertexCount),e.m_normals),c=parseInt(r.m_vertexCount),u=r.m_vertices,h=r.m_normals;s=i.R,a=l[n];var p=s.col1.x*a.x+s.col2.x*a.y,m=s.col1.y*a.x+s.col2.y*a.y;s=o.R;var f=s.col1.x*p+s.col1.y*m;m=s.col2.x*p+s.col2.y*m,p=f;for(var _=0,d=Number.MAX_VALUE,y=0;y<c;++y){a=h[y];var g=p*a.x+m*a.y;g<d&&(d=g,_=y)}var v,x=parseInt(_),b=parseInt(x+1<c?x+1:0);v=t[0],a=u[x],s=o.R,v.v.x=o.position.x+(s.col1.x*a.x+s.col2.x*a.y),v.v.y=o.position.y+(s.col1.y*a.x+s.col2.y*a.y),v.id.features.referenceEdge=n,v.id.features.incidentEdge=x,v.id.features.incidentVertex=0,v=t[1],a=u[b],s=o.R,v.v.x=o.position.x+(s.col1.x*a.x+s.col2.x*a.y),v.v.y=o.position.y+(s.col1.y*a.x+s.col2.y*a.y),v.id.features.referenceEdge=n,v.id.features.incidentEdge=b,v.id.features.incidentVertex=1},f.MakeClipPointVector=function(){var t=new r(2);return t[0]=new F,t[1]=new F,t},f.CollidePolygons=function(t,e,i,n,r){var o;t.m_pointCount=0;var a=e.m_radius+n.m_radius,l=0;f.s_edgeAO[0]=l;var c=f.FindMaxSeparation(f.s_edgeAO,e,i,n,r);if(l=f.s_edgeAO[0],!(c>a)){var u=0;f.s_edgeBO[0]=u;var h=f.FindMaxSeparation(f.s_edgeBO,n,r,e,i);if(u=f.s_edgeBO[0],!(h>a)){var p,m,_,d,y,g=0,v=0;h>.98*c+.001?(p=n,m=e,_=r,d=i,g=u,t.m_type=A.e_faceB,v=1):(p=e,m=n,_=i,d=r,g=l,t.m_type=A.e_faceA,v=0);var x=f.s_incidentEdge;f.FindIncidentEdge(x,p,_,g,m,d);var b,w=parseInt(p.m_vertexCount),C=p.m_vertices,S=C[g];b=g+1<w?C[parseInt(g+1)]:C[0];var D=f.s_localTangent;D.Set(b.x-S.x,b.y-S.y),D.Normalize();var M=f.s_localNormal;M.x=D.y,M.y=-D.x;var T=f.s_planePoint;T.Set(.5*(S.x+b.x),.5*(S.y+b.y));var k=f.s_tangent;y=_.R,k.x=y.col1.x*D.x+y.col2.x*D.y,k.y=y.col1.y*D.x+y.col2.y*D.y;var I=f.s_tangent2;I.x=-k.x,I.y=-k.y;var P=f.s_normal;P.x=k.y,P.y=-k.x;var B=f.s_v11,E=f.s_v12;B.x=_.position.x+(y.col1.x*S.x+y.col2.x*S.y),B.y=_.position.y+(y.col1.y*S.x+y.col2.y*S.y),E.x=_.position.x+(y.col1.x*b.x+y.col2.x*b.y),E.y=_.position.y+(y.col1.y*b.x+y.col2.y*b.y);var L=P.x*B.x+P.y*B.y,R=-k.x*B.x-k.y*B.y+a,V=k.x*E.x+k.y*E.y+a,O=f.s_clipPoints1,F=f.s_clipPoints2;if(!(f.ClipSegmentToLine(O,x,I,R)<2||f.ClipSegmentToLine(F,O,k,V)<2)){t.m_localPlaneNormal.SetV(M),t.m_localPoint.SetV(T);for(var N=0,j=0;j<s.b2_maxManifoldPoints;++j){o=F[j];if(P.x*o.v.x+P.y*o.v.y-L<=a){var G=t.m_points[N];y=d.R;var z=o.v.x-d.position.x,J=o.v.y-d.position.y;G.m_localPoint.x=z*y.col1.x+J*y.col1.y,G.m_localPoint.y=z*y.col2.x+J*y.col2.y,G.m_id.Set(o.id),G.m_id.features.flip=v,++N}}t.m_pointCount=N}}}},f.CollideCircles=function(t,e,i,n,r){t.m_pointCount=0;var o,s;o=i.R,s=e.m_p;var a=i.position.x+(o.col1.x*s.x+o.col2.x*s.y),l=i.position.y+(o.col1.y*s.x+o.col2.y*s.y);o=r.R,s=n.m_p;var c=r.position.x+(o.col1.x*s.x+o.col2.x*s.y),u=r.position.y+(o.col1.y*s.x+o.col2.y*s.y),h=c-a,p=u-l,m=h*h+p*p,f=e.m_radius+n.m_radius;m>f*f||(t.m_type=A.e_circles,t.m_localPoint.SetV(e.m_p),t.m_localPlaneNormal.SetZero(),t.m_pointCount=1,t.m_points[0].m_localPoint.SetV(n.m_p),t.m_points[0].m_id.key=0)},f.CollidePolygonAndCircle=function(t,e,i,n,r){t.m_pointCount=0;var o,s,a=0,l=0;s=r.R,o=n.m_p;var c=r.position.x+(s.col1.x*o.x+s.col2.x*o.y),u=r.position.y+(s.col1.y*o.x+s.col2.y*o.y);a=c-i.position.x,l=u-i.position.y,s=i.R;for(var h=a*s.col1.x+l*s.col1.y,p=a*s.col2.x+l*s.col2.y,m=0,f=-Number.MAX_VALUE,_=e.m_radius+n.m_radius,d=parseInt(e.m_vertexCount),y=e.m_vertices,g=e.m_normals,v=0;v<d;++v){o=y[v],a=h-o.x,l=p-o.y,o=g[v];var x=o.x*a+o.y*l;if(x>_)return;x>f&&(f=x,m=v)}var b=parseInt(m),w=parseInt(b+1<d?b+1:0),C=y[b],S=y[w];if(f<Number.MIN_VALUE)return t.m_pointCount=1,t.m_type=A.e_faceA,t.m_localPlaneNormal.SetV(g[m]),t.m_localPoint.x=.5*(C.x+S.x),t.m_localPoint.y=.5*(C.y+S.y),t.m_points[0].m_localPoint.SetV(n.m_p),void(t.m_points[0].m_id.key=0);var D=(h-C.x)*(S.x-C.x)+(p-C.y)*(S.y-C.y),M=(h-S.x)*(C.x-S.x)+(p-S.y)*(C.y-S.y);if(D<=0){if((h-C.x)*(h-C.x)+(p-C.y)*(p-C.y)>_*_)return;t.m_pointCount=1,t.m_type=A.e_faceA,t.m_localPlaneNormal.x=h-C.x,t.m_localPlaneNormal.y=p-C.y,t.m_localPlaneNormal.Normalize(),t.m_localPoint.SetV(C),t.m_points[0].m_localPoint.SetV(n.m_p),t.m_points[0].m_id.key=0}else if(M<=0){if((h-S.x)*(h-S.x)+(p-S.y)*(p-S.y)>_*_)return;t.m_pointCount=1,t.m_type=A.e_faceA,t.m_localPlaneNormal.x=h-S.x,t.m_localPlaneNormal.y=p-S.y,t.m_localPlaneNormal.Normalize(),t.m_localPoint.SetV(S),t.m_points[0].m_localPoint.SetV(n.m_p),t.m_points[0].m_id.key=0}else{var T=.5*(C.x+S.x),k=.5*(C.y+S.y);if((f=(h-T)*g[b].x+(p-k)*g[b].y)>_)return;t.m_pointCount=1,t.m_type=A.e_faceA,t.m_localPlaneNormal.x=g[b].x,t.m_localPlaneNormal.y=g[b].y,t.m_localPlaneNormal.Normalize(),t.m_localPoint.Set(T,k),t.m_points[0].m_localPoint.SetV(n.m_p),t.m_points[0].m_id.key=0}},f.TestOverlap=function(t,e){var i=e.lowerBound,n=t.upperBound,r=i.x-n.x,o=i.y-n.y;i=t.lowerBound,n=e.upperBound;var s=i.x-n.x,a=i.y-n.y;return!(r>0||o>0)&&!(s>0||a>0)},n.postDefs.push(function(){n.Collision.b2Collision.s_incidentEdge=f.MakeClipPointVector(),n.Collision.b2Collision.s_clipPoints1=f.MakeClipPointVector(),n.Collision.b2Collision.s_clipPoints2=f.MakeClipPointVector(),n.Collision.b2Collision.s_edgeAO=new o(1),n.Collision.b2Collision.s_edgeBO=new o(1),n.Collision.b2Collision.s_localTangent=new u,n.Collision.b2Collision.s_localNormal=new u,n.Collision.b2Collision.s_planePoint=new u,n.Collision.b2Collision.s_normal=new u,n.Collision.b2Collision.s_tangent=new u,n.Collision.b2Collision.s_tangent2=new u,n.Collision.b2Collision.s_v11=new u,n.Collision.b2Collision.s_v12=new u,n.Collision.b2Collision.b2CollidePolyTempVec=new u,n.Collision.b2Collision.b2_nullFeature=255}),_.b2ContactID=function(){this.features=new N},_.prototype.b2ContactID=function(){this.features._m_id=this},_.prototype.Set=function(t){this.key=t._key},_.prototype.Copy=function(){var t=new _;return t.key=this.key,t},Object.defineProperty(_.prototype,"key",{enumerable:!1,configurable:!0,get:function(){return this._key}}),Object.defineProperty(_.prototype,"key",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._key=t,this.features._referenceEdge=255&this._key,this.features._incidentEdge=(65280&this._key)>>8&255,this.features._incidentVertex=(16711680&this._key)>>16&255,this.features._flip=(4278190080&this._key)>>24&255}}),d.b2ContactPoint=function(){this.position=new u,this.velocity=new u,this.normal=new u,this.id=new _},y.b2Distance=function(){},y.Distance=function(t,e,i){++y.b2_gjkCalls;var n=i.proxyA,r=i.proxyB,o=i.transformA,l=i.transformB,c=y.s_simplex;c.ReadCache(e,n,o,r,l);for(var h,p=c.m_vertices,m=y.s_saveA,f=y.s_saveB,_=0,d=c.GetClosestPoint(),g=d.LengthSquared(),v=g,x=0,b=0;b<20;){for(_=c.m_count,x=0;x<_;x++)m[x]=p[x].indexA,f[x]=p[x].indexB;switch(c.m_count){case 1:break;case 2:c.Solve2();break;case 3:c.Solve3();break;default:s.b2Assert(!1)}if(3==c.m_count)break;h=c.GetClosestPoint(),v=h.LengthSquared(),g=v;var w=c.GetSearchDirection();if(w.LengthSquared()<Number.MIN_VALUE*Number.MIN_VALUE)break;var C=p[c.m_count];C.indexA=n.GetSupport(a.MulTMV(o.R,w.GetNegative())),C.wA=a.MulX(o,n.GetVertex(C.indexA)),C.indexB=r.GetSupport(a.MulTMV(l.R,w)),C.wB=a.MulX(l,r.GetVertex(C.indexB)),C.w=a.SubtractVV(C.wB,C.wA),++b,++y.b2_gjkIters;var S=!1;for(x=0;x<_;x++)if(C.indexA==m[x]&&C.indexB==f[x]){S=!0;break}if(S)break;++c.m_count}if(y.b2_gjkMaxIters=a.Max(y.b2_gjkMaxIters,b),c.GetWitnessPoints(t.pointA,t.pointB),t.distance=a.SubtractVV(t.pointA,t.pointB).Length(),t.iterations=b,c.WriteCache(e),i.useRadii){var A=n.m_radius,D=r.m_radius;if(t.distance>A+D&&t.distance>Number.MIN_VALUE){t.distance-=A+D;var M=a.SubtractVV(t.pointB,t.pointA);M.Normalize(),t.pointA.x+=A*M.x,t.pointA.y+=A*M.y,t.pointB.x-=D*M.x,t.pointB.y-=D*M.y}else h=new u,h.x=.5*(t.pointA.x+t.pointB.x),h.y=.5*(t.pointA.y+t.pointB.y),t.pointA.x=t.pointB.x=h.x,t.pointA.y=t.pointB.y=h.y,t.distance=0}},n.postDefs.push(function(){n.Collision.b2Distance.s_simplex=new B,n.Collision.b2Distance.s_saveA=new o(3),n.Collision.b2Distance.s_saveB=new o(3)}),g.b2DistanceInput=function(){},v.b2DistanceOutput=function(){this.pointA=new u,this.pointB=new u},x.b2DistanceProxy=function(){},x.prototype.Set=function(n){switch(n.GetType()){case i.e_circleShape:var o=n instanceof t?n:null;this.m_vertices=new r(1,!0),this.m_vertices[0]=o.m_p,this.m_count=1,this.m_radius=o.m_radius;break;case i.e_polygonShape:var a=n instanceof e?n:null;this.m_vertices=a.m_vertices,this.m_count=a.m_vertexCount,this.m_radius=a.m_radius;break;default:s.b2Assert(!1)}},x.prototype.GetSupport=function(t){for(var e=0,i=this.m_vertices[0].x*t.x+this.m_vertices[0].y*t.y,n=1;n<this.m_count;++n){var r=this.m_vertices[n].x*t.x+this.m_vertices[n].y*t.y;r>i&&(e=n,i=r)}return e},x.prototype.GetSupportVertex=function(t){for(var e=0,i=this.m_vertices[0].x*t.x+this.m_vertices[0].y*t.y,n=1;n<this.m_count;++n){var r=this.m_vertices[n].x*t.x+this.m_vertices[n].y*t.y;r>i&&(e=n,i=r)}return this.m_vertices[e]},x.prototype.GetVertexCount=function(){return this.m_count},x.prototype.GetVertex=function(t){return void 0===t&&(t=0),s.b2Assert(0<=t&&t<this.m_count),this.m_vertices[t]},b.b2DynamicTree=function(){},b.prototype.b2DynamicTree=function(){this.m_root=null,this.m_freeList=null,this.m_path=0,this.m_insertionCount=0},b.prototype.CreateProxy=function(t,e){var i=this.AllocateNode(),n=s.b2_aabbExtension,r=s.b2_aabbExtension;return i.aabb.lowerBound.x=t.lowerBound.x-n,i.aabb.lowerBound.y=t.lowerBound.y-r,i.aabb.upperBound.x=t.upperBound.x+n,i.aabb.upperBound.y=t.upperBound.y+r,i.userData=e,this.InsertLeaf(i),i},b.prototype.DestroyProxy=function(t){this.RemoveLeaf(t),this.FreeNode(t)},b.prototype.MoveProxy=function(t,e,i){if(s.b2Assert(t.IsLeaf()),t.aabb.Contains(e))return!1;this.RemoveLeaf(t);var n=s.b2_aabbExtension+s.b2_aabbMultiplier*(i.x>0?i.x:-i.x),r=s.b2_aabbExtension+s.b2_aabbMultiplier*(i.y>0?i.y:-i.y);return t.aabb.lowerBound.x=e.lowerBound.x-n,t.aabb.lowerBound.y=e.lowerBound.y-r,t.aabb.upperBound.x=e.upperBound.x+n,t.aabb.upperBound.y=e.upperBound.y+r,this.InsertLeaf(t),!0},b.prototype.Rebalance=function(t){if(void 0===t&&(t=0),null!=this.m_root)for(var e=0;e<t;e++){for(var i=this.m_root,n=0;0==i.IsLeaf();)i=this.m_path>>n&1?i.child2:i.child1,n=n+1&31;++this.m_path,this.RemoveLeaf(i),this.InsertLeaf(i)}},b.prototype.GetFatAABB=function(t){return t.aabb},b.prototype.GetUserData=function(t){return t.userData},b.prototype.Query=function(t,e){if(null!=this.m_root){var i=new r,n=0;for(i[n++]=this.m_root;n>0;){var o=i[--n];if(o.aabb.TestOverlap(e))if(o.IsLeaf()){var s=t(o);if(!s)return}else i[n++]=o.child1,i[n++]=o.child2}}},b.prototype.RayCast=function(t,e){if(null!=this.m_root){var i=e.p1,n=e.p2,o=a.SubtractVV(i,n);o.Normalize();var s=a.CrossFV(1,o),l=a.AbsV(s),c=e.maxFraction,u=new h,p=0,m=0;p=i.x+c*(n.x-i.x),m=i.y+c*(n.y-i.y),u.lowerBound.x=Math.min(i.x,p),u.lowerBound.y=Math.min(i.y,m),u.upperBound.x=Math.max(i.x,p),u.upperBound.y=Math.max(i.y,m);var f=new r,_=0;for(f[_++]=this.m_root;_>0;){var d=f[--_];if(0!=d.aabb.TestOverlap(u)){var y=d.aabb.GetCenter(),g=d.aabb.GetExtents();if(!(Math.abs(s.x*(i.x-y.x)+s.y*(i.y-y.y))-l.x*g.x-l.y*g.y>0))if(d.IsLeaf()){var v=new T;if(v.p1=e.p1,v.p2=e.p2,v.maxFraction=e.maxFraction,0==(c=t(v,d)))return;c>0&&(p=i.x+c*(n.x-i.x),m=i.y+c*(n.y-i.y),u.lowerBound.x=Math.min(i.x,p),u.lowerBound.y=Math.min(i.y,m),u.upperBound.x=Math.max(i.x,p),u.upperBound.y=Math.max(i.y,m))}else f[_++]=d.child1,f[_++]=d.child2}}}},b.prototype.AllocateNode=function(){if(this.m_freeList){var t=this.m_freeList;return this.m_freeList=t.parent,t.parent=null,t.child1=null,t.child2=null,t}return new C},b.prototype.FreeNode=function(t){t.parent=this.m_freeList,this.m_freeList=t},b.prototype.InsertLeaf=function(t){if(++this.m_insertionCount,null==this.m_root)return this.m_root=t,void(this.m_root.parent=null);var e=t.aabb.GetCenter(),i=this.m_root;if(0==i.IsLeaf())do{var n=i.child1,r=i.child2,o=Math.abs((n.aabb.lowerBound.x+n.aabb.upperBound.x)/2-e.x)+Math.abs((n.aabb.lowerBound.y+n.aabb.upperBound.y)/2-e.y),s=Math.abs((r.aabb.lowerBound.x+r.aabb.upperBound.x)/2-e.x)+Math.abs((r.aabb.lowerBound.y+r.aabb.upperBound.y)/2-e.y);i=o<s?n:r}while(0==i.IsLeaf());var a=i.parent,l=this.AllocateNode();if(l.parent=a,l.userData=null,l.aabb.Combine(t.aabb,i.aabb),a){i.parent.child1==i?a.child1=l:a.child2=l,l.child1=i,l.child2=t,i.parent=l,t.parent=l;do{if(a.aabb.Contains(l.aabb))break;a.aabb.Combine(a.child1.aabb,a.child2.aabb),l=a,a=a.parent}while(a)}else l.child1=i,l.child2=t,i.parent=l,t.parent=l,this.m_root=l},b.prototype.RemoveLeaf=function(t){if(t==this.m_root)return void(this.m_root=null);var e,i=t.parent,n=i.parent;if(e=i.child1==t?i.child2:i.child1,n)for(n.child1==i?n.child1=e:n.child2=e,e.parent=n,this.FreeNode(i);n;){var r=n.aabb;if(n.aabb=h.Combine(n.child1.aabb,n.child2.aabb),r.Contains(n.aabb))break;n=n.parent}else this.m_root=e,e.parent=null,this.FreeNode(i)},w.b2DynamicTreeBroadPhase=function(){this.m_tree=new b,this.m_moveBuffer=new r,this.m_pairBuffer=new r,this.m_pairCount=0},w.prototype.CreateProxy=function(t,e){var i=this.m_tree.CreateProxy(t,e);return++this.m_proxyCount,this.BufferMove(i),i},w.prototype.DestroyProxy=function(t){this.UnBufferMove(t),--this.m_proxyCount,this.m_tree.DestroyProxy(t)},w.prototype.MoveProxy=function(t,e,i){this.m_tree.MoveProxy(t,e,i)&&this.BufferMove(t)},w.prototype.TestOverlap=function(t,e){var i=this.m_tree.GetFatAABB(t),n=this.m_tree.GetFatAABB(e);return i.TestOverlap(n)},w.prototype.GetUserData=function(t){return this.m_tree.GetUserData(t)},w.prototype.GetFatAABB=function(t){return this.m_tree.GetFatAABB(t)},w.prototype.GetProxyCount=function(){return this.m_proxyCount},w.prototype.UpdatePairs=function(t){function e(t){if(t==n)return!0;i.m_pairCount==i.m_pairBuffer.length&&(i.m_pairBuffer[i.m_pairCount]=new S);var e=i.m_pairBuffer[i.m_pairCount];return e.proxyA=t<n?t:n,e.proxyB=t>=n?t:n,++i.m_pairCount,!0}var i=this;i.m_pairCount=0;var n,r=0;for(r=0;r<i.m_moveBuffer.length;++r){n=i.m_moveBuffer[r];var o=i.m_tree.GetFatAABB(n);i.m_tree.Query(e,o)}i.m_moveBuffer.length=0;for(var r=0;r<i.m_pairCount;){var s=i.m_pairBuffer[r],a=i.m_tree.GetUserData(s.proxyA),l=i.m_tree.GetUserData(s.proxyB);for(t(a,l),++r;r<i.m_pairCount;){var c=i.m_pairBuffer[r];if(c.proxyA!=s.proxyA||c.proxyB!=s.proxyB)break;++r}}},w.prototype.Query=function(t,e){this.m_tree.Query(t,e)},w.prototype.RayCast=function(t,e){this.m_tree.RayCast(t,e)},w.prototype.Validate=function(){},w.prototype.Rebalance=function(t){void 0===t&&(t=0),this.m_tree.Rebalance(t)},w.prototype.BufferMove=function(t){this.m_moveBuffer[this.m_moveBuffer.length]=t},w.prototype.UnBufferMove=function(t){var e=parseInt(this.m_moveBuffer.indexOf(t));this.m_moveBuffer.splice(e,1)},w.prototype.ComparePairs=function(t,e){return 0},w.__implements={},w.__implements[j]=!0,C.b2DynamicTreeNode=function(){this.aabb=new h},C.prototype.IsLeaf=function(){return null==this.child1},S.b2DynamicTreePair=function(){},A.b2Manifold=function(){this.m_pointCount=0},A.prototype.b2Manifold=function(){this.m_points=new r(s.b2_maxManifoldPoints);for(var t=0;t<s.b2_maxManifoldPoints;t++)this.m_points[t]=new D;this.m_localPlaneNormal=new u,this.m_localPoint=new u},A.prototype.Reset=function(){for(var t=0;t<s.b2_maxManifoldPoints;t++)(this.m_points[t]instanceof D?this.m_points[t]:null).Reset();this.m_localPlaneNormal.SetZero(),this.m_localPoint.SetZero(),this.m_type=0,this.m_pointCount=0},A.prototype.Set=function(t){this.m_pointCount=t.m_pointCount;for(var e=0;e<s.b2_maxManifoldPoints;e++)(this.m_points[e]instanceof D?this.m_points[e]:null).Set(t.m_points[e]);this.m_localPlaneNormal.SetV(t.m_localPlaneNormal),this.m_localPoint.SetV(t.m_localPoint),this.m_type=t.m_type},A.prototype.Copy=function(){var t=new A;return t.Set(this),t},n.postDefs.push(function(){n.Collision.b2Manifold.e_circles=1,n.Collision.b2Manifold.e_faceA=2,n.Collision.b2Manifold.e_faceB=4}),D.b2ManifoldPoint=function(){this.m_localPoint=new u,this.m_id=new _},D.prototype.b2ManifoldPoint=function(){this.Reset()},D.prototype.Reset=function(){this.m_localPoint.SetZero(),this.m_normalImpulse=0,this.m_tangentImpulse=0,this.m_id.key=0},D.prototype.Set=function(t){this.m_localPoint.SetV(t.m_localPoint),this.m_normalImpulse=t.m_normalImpulse,this.m_tangentImpulse=t.m_tangentImpulse,this.m_id.Set(t.m_id)},M.b2Point=function(){this.p=new u},M.prototype.Support=function(t,e,i){return void 0===e&&(e=0),void 0===i&&(i=0),this.p},M.prototype.GetFirstVertex=function(t){return this.p},T.b2RayCastInput=function(){this.p1=new u,this.p2=new u},T.prototype.b2RayCastInput=function(t,e,i){void 0===t&&(t=null),void 0===e&&(e=null),void 0===i&&(i=1),t&&this.p1.SetV(t),e&&this.p2.SetV(e),this.maxFraction=i},k.b2RayCastOutput=function(){this.normal=new u},I.b2Segment=function(){this.p1=new u,this.p2=new u},I.prototype.TestSegment=function(t,e,i,n){void 0===n&&(n=0);var r=i.p1,o=i.p2.x-r.x,s=i.p2.y-r.y,a=this.p2.x-this.p1.x,l=this.p2.y-this.p1.y,c=l,u=-a,h=100*Number.MIN_VALUE,p=-(o*c+s*u);if(p>h){var m=r.x-this.p1.x,f=r.y-this.p1.y,_=m*c+f*u;if(0<=_&&_<=n*p){var d=-o*f+s*m;if(-h*p<=d&&d<=p*(1+h)){_/=p;var y=Math.sqrt(c*c+u*u);return c/=y,u/=y,t[0]=_,e.Set(c,u),!0}}}return!1},I.prototype.Extend=function(t){this.ExtendForward(t),this.ExtendBackward(t)},I.prototype.ExtendForward=function(t){var e=this.p2.x-this.p1.x,i=this.p2.y-this.p1.y,n=Math.min(e>0?(t.upperBound.x-this.p1.x)/e:e<0?(t.lowerBound.x-this.p1.x)/e:Number.POSITIVE_INFINITY,i>0?(t.upperBound.y-this.p1.y)/i:i<0?(t.lowerBound.y-this.p1.y)/i:Number.POSITIVE_INFINITY);this.p2.x=this.p1.x+e*n,this.p2.y=this.p1.y+i*n},I.prototype.ExtendBackward=function(t){var e=-this.p2.x+this.p1.x,i=-this.p2.y+this.p1.y,n=Math.min(e>0?(t.upperBound.x-this.p2.x)/e:e<0?(t.lowerBound.x-this.p2.x)/e:Number.POSITIVE_INFINITY,i>0?(t.upperBound.y-this.p2.y)/i:i<0?(t.lowerBound.y-this.p2.y)/i:Number.POSITIVE_INFINITY);this.p1.x=this.p2.x+e*n,this.p1.y=this.p2.y+i*n},P.b2SeparationFunction=function(){this.m_localPoint=new u,this.m_axis=new u},P.prototype.Initialize=function(t,e,i,n,r){this.m_proxyA=e,this.m_proxyB=n;var o=parseInt(t.count);s.b2Assert(0<o&&o<3);var l,c,h,p,m,f,_,d,y=0,g=0,v=0,x=0,b=0,w=0,C=0;if(1==o)this.m_type=P.e_points,l=this.m_proxyA.GetVertex(t.indexA[0]),p=this.m_proxyB.GetVertex(t.indexB[0]),d=l,_=i.R,y=i.position.x+(_.col1.x*d.x+_.col2.x*d.y),g=i.position.y+(_.col1.y*d.x+_.col2.y*d.y),d=p,_=r.R,v=r.position.x+(_.col1.x*d.x+_.col2.x*d.y),x=r.position.y+(_.col1.y*d.x+_.col2.y*d.y),this.m_axis.x=v-y,this.m_axis.y=x-g,this.m_axis.Normalize();else if(t.indexB[0]==t.indexB[1])this.m_type=P.e_faceA,c=this.m_proxyA.GetVertex(t.indexA[0]),h=this.m_proxyA.GetVertex(t.indexA[1]),p=this.m_proxyB.GetVertex(t.indexB[0]),this.m_localPoint.x=.5*(c.x+h.x),this.m_localPoint.y=.5*(c.y+h.y),this.m_axis=a.CrossVF(a.SubtractVV(h,c),1),this.m_axis.Normalize(),d=this.m_axis,_=i.R,b=_.col1.x*d.x+_.col2.x*d.y,w=_.col1.y*d.x+_.col2.y*d.y,d=this.m_localPoint,_=i.R,y=i.position.x+(_.col1.x*d.x+_.col2.x*d.y),g=i.position.y+(_.col1.y*d.x+_.col2.y*d.y),d=p,_=r.R,v=r.position.x+(_.col1.x*d.x+_.col2.x*d.y),x=r.position.y+(_.col1.y*d.x+_.col2.y*d.y),(C=(v-y)*b+(x-g)*w)<0&&this.m_axis.NegativeSelf();else if(t.indexA[0]==t.indexA[0])this.m_type=P.e_faceB,m=this.m_proxyB.GetVertex(t.indexB[0]),f=this.m_proxyB.GetVertex(t.indexB[1]),l=this.m_proxyA.GetVertex(t.indexA[0]),this.m_localPoint.x=.5*(m.x+f.x),this.m_localPoint.y=.5*(m.y+f.y),this.m_axis=a.CrossVF(a.SubtractVV(f,m),1),this.m_axis.Normalize(),d=this.m_axis,_=r.R,b=_.col1.x*d.x+_.col2.x*d.y,w=_.col1.y*d.x+_.col2.y*d.y,d=this.m_localPoint,_=r.R,v=r.position.x+(_.col1.x*d.x+_.col2.x*d.y),x=r.position.y+(_.col1.y*d.x+_.col2.y*d.y),d=l,_=i.R,y=i.position.x+(_.col1.x*d.x+_.col2.x*d.y),g=i.position.y+(_.col1.y*d.x+_.col2.y*d.y),(C=(y-v)*b+(g-x)*w)<0&&this.m_axis.NegativeSelf();else{c=this.m_proxyA.GetVertex(t.indexA[0]),h=this.m_proxyA.GetVertex(t.indexA[1]),m=this.m_proxyB.GetVertex(t.indexB[0]),f=this.m_proxyB.GetVertex(t.indexB[1]);var S=(a.MulX(i,l),a.MulMV(i.R,a.SubtractVV(h,c))),A=(a.MulX(r,p),a.MulMV(r.R,a.SubtractVV(f,m))),D=S.x*S.x+S.y*S.y,M=A.x*A.x+A.y*A.y,T=a.SubtractVV(A,S),k=S.x*T.x+S.y*T.y,I=A.x*T.x+A.y*T.y,B=S.x*A.x+S.y*A.y,E=D*M-B*B;C=0,0!=E&&(C=a.Clamp((B*I-k*M)/E,0,1));var L=(B*C+I)/M;L<0&&(L=0,C=a.Clamp((B-k)/D,0,1)),l=new u,l.x=c.x+C*(h.x-c.x),l.y=c.y+C*(h.y-c.y),p=new u,p.x=m.x+C*(f.x-m.x),p.y=m.y+C*(f.y-m.y),0==C||1==C?(this.m_type=P.e_faceB,this.m_axis=a.CrossVF(a.SubtractVV(f,m),1),this.m_axis.Normalize(),this.m_localPoint=p,d=this.m_axis,_=r.R,b=_.col1.x*d.x+_.col2.x*d.y,w=_.col1.y*d.x+_.col2.y*d.y,d=this.m_localPoint,_=r.R,v=r.position.x+(_.col1.x*d.x+_.col2.x*d.y),x=r.position.y+(_.col1.y*d.x+_.col2.y*d.y),d=l,_=i.R,y=i.position.x+(_.col1.x*d.x+_.col2.x*d.y),g=i.position.y+(_.col1.y*d.x+_.col2.y*d.y),(y-v)*b+(g-x)*w,C<0&&this.m_axis.NegativeSelf()):(this.m_type=P.e_faceA,this.m_axis=a.CrossVF(a.SubtractVV(h,c),1),this.m_localPoint=l,d=this.m_axis,_=i.R,b=_.col1.x*d.x+_.col2.x*d.y,w=_.col1.y*d.x+_.col2.y*d.y,d=this.m_localPoint,_=i.R,y=i.position.x+(_.col1.x*d.x+_.col2.x*d.y),g=i.position.y+(_.col1.y*d.x+_.col2.y*d.y),d=p,_=r.R,v=r.position.x+(_.col1.x*d.x+_.col2.x*d.y),x=r.position.y+(_.col1.y*d.x+_.col2.y*d.y),(v-y)*b+(x-g)*w,C<0&&this.m_axis.NegativeSelf())}},P.prototype.Evaluate=function(t,e){var i,n,r,o,l,c,u;switch(this.m_type){case P.e_points:return i=a.MulTMV(t.R,this.m_axis),n=a.MulTMV(e.R,this.m_axis.GetNegative()),r=this.m_proxyA.GetSupportVertex(i),o=this.m_proxyB.GetSupportVertex(n),l=a.MulX(t,r),c=a.MulX(e,o),(c.x-l.x)*this.m_axis.x+(c.y-l.y)*this.m_axis.y;case P.e_faceA:return u=a.MulMV(t.R,this.m_axis),l=a.MulX(t,this.m_localPoint),n=a.MulTMV(e.R,u.GetNegative()),o=this.m_proxyB.GetSupportVertex(n),c=a.MulX(e,o),(c.x-l.x)*u.x+(c.y-l.y)*u.y;case P.e_faceB:return u=a.MulMV(e.R,this.m_axis),c=a.MulX(e,this.m_localPoint),i=a.MulTMV(t.R,u.GetNegative()),r=this.m_proxyA.GetSupportVertex(i),l=a.MulX(t,r),(l.x-c.x)*u.x+(l.y-c.y)*u.y;default:return s.b2Assert(!1),0}},n.postDefs.push(function(){n.Collision.b2SeparationFunction.e_points=1,n.Collision.b2SeparationFunction.e_faceA=2,n.Collision.b2SeparationFunction.e_faceB=4}),B.b2Simplex=function(){this.m_v1=new L,this.m_v2=new L,this.m_v3=new L,this.m_vertices=new r(3)},B.prototype.b2Simplex=function(){this.m_vertices[0]=this.m_v1,this.m_vertices[1]=this.m_v2,this.m_vertices[2]=this.m_v3},B.prototype.ReadCache=function(t,e,i,n,r){s.b2Assert(0<=t.count&&t.count<=3);var o,l;this.m_count=t.count;for(var c=this.m_vertices,u=0;u<this.m_count;u++){var h=c[u];h.indexA=t.indexA[u],h.indexB=t.indexB[u],o=e.GetVertex(h.indexA),l=n.GetVertex(h.indexB),h.wA=a.MulX(i,o),h.wB=a.MulX(r,l),h.w=a.SubtractVV(h.wB,h.wA),h.a=0}if(this.m_count>1){var p=t.metric,m=this.GetMetric();(m<.5*p||2*p<m||m<Number.MIN_VALUE)&&(this.m_count=0)}0==this.m_count&&(h=c[0],h.indexA=0,h.indexB=0,o=e.GetVertex(0),l=n.GetVertex(0),h.wA=a.MulX(i,o),h.wB=a.MulX(r,l),h.w=a.SubtractVV(h.wB,h.wA),this.m_count=1)},B.prototype.WriteCache=function(t){t.metric=this.GetMetric(),t.count=n.parseUInt(this.m_count);for(var e=this.m_vertices,i=0;i<this.m_count;i++)t.indexA[i]=n.parseUInt(e[i].indexA),t.indexB[i]=n.parseUInt(e[i].indexB)},B.prototype.GetSearchDirection=function(){switch(this.m_count){case 1:return this.m_v1.w.GetNegative();case 2:var t=a.SubtractVV(this.m_v2.w,this.m_v1.w);return a.CrossVV(t,this.m_v1.w.GetNegative())>0?a.CrossFV(1,t):a.CrossVF(t,1);default:return s.b2Assert(!1),new u}},B.prototype.GetClosestPoint=function(){switch(this.m_count){case 0:return s.b2Assert(!1),new u;case 1:return this.m_v1.w;case 2:return new u(this.m_v1.a*this.m_v1.w.x+this.m_v2.a*this.m_v2.w.x,this.m_v1.a*this.m_v1.w.y+this.m_v2.a*this.m_v2.w.y);default:return s.b2Assert(!1),new u}},B.prototype.GetWitnessPoints=function(t,e){switch(this.m_count){case 0:s.b2Assert(!1);break;case 1:t.SetV(this.m_v1.wA),e.SetV(this.m_v1.wB);break;case 2:t.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x,t.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y,e.x=this.m_v1.a*this.m_v1.wB.x+this.m_v2.a*this.m_v2.wB.x,e.y=this.m_v1.a*this.m_v1.wB.y+this.m_v2.a*this.m_v2.wB.y;break;case 3:e.x=t.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x+this.m_v3.a*this.m_v3.wA.x,e.y=t.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y+this.m_v3.a*this.m_v3.wA.y;break;default:s.b2Assert(!1)}},B.prototype.GetMetric=function(){switch(this.m_count){case 0:return s.b2Assert(!1),0;case 1:return 0;case 2:return a.SubtractVV(this.m_v1.w,this.m_v2.w).Length();case 3:return a.CrossVV(a.SubtractVV(this.m_v2.w,this.m_v1.w),a.SubtractVV(this.m_v3.w,this.m_v1.w));default:return s.b2Assert(!1),0}},B.prototype.Solve2=function(){var t=this.m_v1.w,e=this.m_v2.w,i=a.SubtractVV(e,t),n=-(t.x*i.x+t.y*i.y);if(n<=0)return this.m_v1.a=1,void(this.m_count=1);var r=e.x*i.x+e.y*i.y;if(r<=0)return this.m_v2.a=1,this.m_count=1,void this.m_v1.Set(this.m_v2);var o=1/(r+n);this.m_v1.a=r*o,this.m_v2.a=n*o,this.m_count=2},B.prototype.Solve3=function(){var t=this.m_v1.w,e=this.m_v2.w,i=this.m_v3.w,n=a.SubtractVV(e,t),r=a.Dot(t,n),o=a.Dot(e,n),s=o,l=-r,c=a.SubtractVV(i,t),u=a.Dot(t,c),h=a.Dot(i,c),p=h,m=-u,f=a.SubtractVV(i,e),_=a.Dot(e,f),d=a.Dot(i,f),y=d,g=-_,v=a.CrossVV(n,c),x=v*a.CrossVV(e,i),b=v*a.CrossVV(i,t),w=v*a.CrossVV(t,e);if(l<=0&&m<=0)return this.m_v1.a=1,void(this.m_count=1);if(s>0&&l>0&&w<=0){var C=1/(s+l);return this.m_v1.a=s*C,this.m_v2.a=l*C,void(this.m_count=2)}if(p>0&&m>0&&b<=0){var S=1/(p+m);return this.m_v1.a=p*S,this.m_v3.a=m*S,this.m_count=2,void this.m_v2.Set(this.m_v3)}if(s<=0&&g<=0)return this.m_v2.a=1,this.m_count=1,void this.m_v1.Set(this.m_v2);if(p<=0&&y<=0)return this.m_v3.a=1,this.m_count=1,void this.m_v1.Set(this.m_v3);if(y>0&&g>0&&x<=0){var A=1/(y+g);return this.m_v2.a=y*A,this.m_v3.a=g*A,this.m_count=2,void this.m_v1.Set(this.m_v3)}var D=1/(x+b+w);this.m_v1.a=x*D,this.m_v2.a=b*D,this.m_v3.a=w*D,this.m_count=3},E.b2SimplexCache=function(){this.indexA=new o(3),this.indexB=new o(3)},L.b2SimplexVertex=function(){},L.prototype.Set=function(t){this.wA.SetV(t.wA),this.wB.SetV(t.wB),this.w.SetV(t.w),this.a=t.a,this.indexA=t.indexA,this.indexB=t.indexB},R.b2TimeOfImpact=function(){},R.TimeOfImpact=function(t){++R.b2_toiCalls;var e=t.proxyA,i=t.proxyB,n=t.sweepA,r=t.sweepB;s.b2Assert(n.t0==r.t0),s.b2Assert(1-n.t0>Number.MIN_VALUE);var o=e.m_radius+i.m_radius,l=t.tolerance,c=0,u=0,h=0;for(R.s_cache.count=0,R.s_distanceInput.useRadii=!1;;){if(n.GetTransform(R.s_xfA,c),r.GetTransform(R.s_xfB,c),R.s_distanceInput.proxyA=e,R.s_distanceInput.proxyB=i,R.s_distanceInput.transformA=R.s_xfA,R.s_distanceInput.transformB=R.s_xfB,y.Distance(R.s_distanceOutput,R.s_cache,R.s_distanceInput),R.s_distanceOutput.distance<=0){c=1;break}R.s_fcn.Initialize(R.s_cache,e,R.s_xfA,i,R.s_xfB);var p=R.s_fcn.Evaluate(R.s_xfA,R.s_xfB);if(p<=0){c=1;break}if(0==u&&(h=p>o?a.Max(o-l,.75*o):a.Max(p-l,.02*o)),p-h<.5*l){if(0==u){c=1;break}break}var m=c,f=c,_=1,d=p;n.GetTransform(R.s_xfA,_),r.GetTransform(R.s_xfB,_);var g=R.s_fcn.Evaluate(R.s_xfA,R.s_xfB);if(g>=h){c=1;break}for(var v=0;;){var x=0;x=1&v?f+(h-d)*(_-f)/(g-d):.5*(f+_),n.GetTransform(R.s_xfA,x),r.GetTransform(R.s_xfB,x);var b=R.s_fcn.Evaluate(R.s_xfA,R.s_xfB);if(a.Abs(b-h)<.025*l){m=x;break}if(b>h?(f=x,d=b):(_=x,g=b),++v,++R.b2_toiRootIters,50==v)break}if(R.b2_toiMaxRootIters=a.Max(R.b2_toiMaxRootIters,v),m<(1+100*Number.MIN_VALUE)*c)break;if(c=m,u++,++R.b2_toiIters,1e3==u)break}return R.b2_toiMaxIters=a.Max(R.b2_toiMaxIters,u),c},n.postDefs.push(function(){n.Collision.b2TimeOfImpact.b2_toiCalls=0,n.Collision.b2TimeOfImpact.b2_toiIters=0,n.Collision.b2TimeOfImpact.b2_toiMaxIters=0,n.Collision.b2TimeOfImpact.b2_toiRootIters=0,n.Collision.b2TimeOfImpact.b2_toiMaxRootIters=0,n.Collision.b2TimeOfImpact.s_cache=new E,n.Collision.b2TimeOfImpact.s_distanceInput=new g,n.Collision.b2TimeOfImpact.s_xfA=new c,n.Collision.b2TimeOfImpact.s_xfB=new c,n.Collision.b2TimeOfImpact.s_fcn=new P,n.Collision.b2TimeOfImpact.s_distanceOutput=new v}),V.b2TOIInput=function(){this.proxyA=new x,this.proxyB=new x,this.sweepA=new l,this.sweepB=new l},O.b2WorldManifold=function(){this.m_normal=new u},O.prototype.b2WorldManifold=function(){this.m_points=new r(s.b2_maxManifoldPoints);for(var t=0;t<s.b2_maxManifoldPoints;t++)this.m_points[t]=new u},O.prototype.Initialize=function(t,e,i,n,r){if(void 0===i&&(i=0),void 0===r&&(r=0),0!=t.m_pointCount){var o,s,a=0,l=0,c=0,u=0,h=0,p=0,m=0;switch(t.m_type){case A.e_circles:s=e.R,o=t.m_localPoint;var f=e.position.x+s.col1.x*o.x+s.col2.x*o.y,_=e.position.y+s.col1.y*o.x+s.col2.y*o.y;s=n.R,o=t.m_points[0].m_localPoint;var d=n.position.x+s.col1.x*o.x+s.col2.x*o.y,y=n.position.y+s.col1.y*o.x+s.col2.y*o.y,g=d-f,v=y-_,x=g*g+v*v;if(x>Number.MIN_VALUE*Number.MIN_VALUE){var b=Math.sqrt(x);this.m_normal.x=g/b,this.m_normal.y=v/b}else this.m_normal.x=1,this.m_normal.y=0;var w=f+i*this.m_normal.x,C=_+i*this.m_normal.y,S=d-r*this.m_normal.x,D=y-r*this.m_normal.y;this.m_points[0].x=.5*(w+S),this.m_points[0].y=.5*(C+D);break;case A.e_faceA:for(s=e.R,o=t.m_localPlaneNormal,l=s.col1.x*o.x+s.col2.x*o.y,c=s.col1.y*o.x+s.col2.y*o.y,s=e.R,o=t.m_localPoint,u=e.position.x+s.col1.x*o.x+s.col2.x*o.y,h=e.position.y+s.col1.y*o.x+s.col2.y*o.y,this.m_normal.x=l,this.m_normal.y=c,a=0;a<t.m_pointCount;a++)s=n.R,o=t.m_points[a].m_localPoint,p=n.position.x+s.col1.x*o.x+s.col2.x*o.y,m=n.position.y+s.col1.y*o.x+s.col2.y*o.y,this.m_points[a].x=p+.5*(i-(p-u)*l-(m-h)*c-r)*l,this.m_points[a].y=m+.5*(i-(p-u)*l-(m-h)*c-r)*c;break;case A.e_faceB:for(s=n.R,o=t.m_localPlaneNormal,l=s.col1.x*o.x+s.col2.x*o.y,c=s.col1.y*o.x+s.col2.y*o.y,s=n.R,o=t.m_localPoint,u=n.position.x+s.col1.x*o.x+s.col2.x*o.y,h=n.position.y+s.col1.y*o.x+s.col2.y*o.y,this.m_normal.x=-l,this.m_normal.y=-c,a=0;a<t.m_pointCount;a++)s=e.R,o=t.m_points[a].m_localPoint,p=e.position.x+s.col1.x*o.x+s.col2.x*o.y,m=e.position.y+s.col1.y*o.x+s.col2.y*o.y,this.m_points[a].x=p+.5*(r-(p-u)*l-(m-h)*c-i)*l,this.m_points[a].y=m+.5*(r-(p-u)*l-(m-h)*c-i)*c}}},F.ClipVertex=function(){this.v=new u,this.id=new _},F.prototype.Set=function(t){this.v.SetV(t.v),this.id.Set(t.id)},N.Features=function(){},Object.defineProperty(N.prototype,"referenceEdge",{enumerable:!1,configurable:!0,get:function(){return this._referenceEdge}}),Object.defineProperty(N.prototype,"referenceEdge",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._referenceEdge=t,this._m_id._key=4294967040&this._m_id._key|255&this._referenceEdge}}),Object.defineProperty(N.prototype,"incidentEdge",{enumerable:!1,configurable:!0,get:function(){return this._incidentEdge}}),Object.defineProperty(N.prototype,"incidentEdge",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._incidentEdge=t,this._m_id._key=4294902015&this._m_id._key|this._incidentEdge<<8&65280}}),Object.defineProperty(N.prototype,"incidentVertex",{enumerable:!1,configurable:!0,get:function(){return this._incidentVertex}}),Object.defineProperty(N.prototype,"incidentVertex",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._incidentVertex=t,this._m_id._key=4278255615&this._m_id._key|this._incidentVertex<<16&16711680}}),Object.defineProperty(N.prototype,"flip",{enumerable:!1,configurable:!0,get:function(){return this._flip}}),Object.defineProperty(N.prototype,"flip",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._flip=t,this._m_id._key=16777215&this._m_id._key|this._flip<<24&4278190080}})}(),function(){var t=(n.Common.b2Color,n.Common.b2internal,n.Common.b2Settings),e=n.Collision.Shapes.b2CircleShape,i=n.Collision.Shapes.b2EdgeChainDef,s=n.Collision.Shapes.b2EdgeShape,a=n.Collision.Shapes.b2MassData,l=n.Collision.Shapes.b2PolygonShape,c=n.Collision.Shapes.b2Shape,u=n.Common.Math.b2Mat22,h=(n.Common.Math.b2Mat33,n.Common.Math.b2Math),p=(n.Common.Math.b2Sweep,n.Common.Math.b2Transform),m=n.Common.Math.b2Vec2,f=(n.Common.Math.b2Vec3,n.Dynamics.b2Body,n.Dynamics.b2BodyDef,n.Dynamics.b2ContactFilter,n.Dynamics.b2ContactImpulse,n.Dynamics.b2ContactListener,n.Dynamics.b2ContactManager,n.Dynamics.b2DebugDraw,n.Dynamics.b2DestructionListener,n.Dynamics.b2FilterData,n.Dynamics.b2Fixture,n.Dynamics.b2FixtureDef,n.Dynamics.b2Island,n.Dynamics.b2TimeStep,n.Dynamics.b2World,n.Collision.b2AABB,n.Collision.b2Bound,n.Collision.b2BoundValues,n.Collision.b2Collision,n.Collision.b2ContactID,n.Collision.b2ContactPoint,n.Collision.b2Distance),_=n.Collision.b2DistanceInput,d=n.Collision.b2DistanceOutput,y=n.Collision.b2DistanceProxy,g=(n.Collision.b2DynamicTree,n.Collision.b2DynamicTreeBroadPhase,n.Collision.b2DynamicTreeNode,n.Collision.b2DynamicTreePair,n.Collision.b2Manifold,n.Collision.b2ManifoldPoint,n.Collision.b2Point,n.Collision.b2RayCastInput,n.Collision.b2RayCastOutput,n.Collision.b2Segment,n.Collision.b2SeparationFunction,n.Collision.b2Simplex,n.Collision.b2SimplexCache);n.Collision.b2SimplexVertex,n.Collision.b2TimeOfImpact,n.Collision.b2TOIInput,n.Collision.b2WorldManifold,n.Collision.ClipVertex,n.Collision.Features,n.Collision.IBroadPhase;n.inherit(e,n.Collision.Shapes.b2Shape),e.prototype.__super=n.Collision.Shapes.b2Shape.prototype,e.b2CircleShape=function(){n.Collision.Shapes.b2Shape.b2Shape.apply(this,arguments),this.m_p=new m},e.prototype.Copy=function(){var t=new e;return t.Set(this),t},e.prototype.Set=function(t){if(this.__super.Set.call(this,t),n.is(t,e)){var i=t instanceof e?t:null;this.m_p.SetV(i.m_p)}},e.prototype.TestPoint=function(t,e){var i=t.R,n=t.position.x+(i.col1.x*this.m_p.x+i.col2.x*this.m_p.y),r=t.position.y+(i.col1.y*this.m_p.x+i.col2.y*this.m_p.y);return n=e.x-n,r=e.y-r,n*n+r*r<=this.m_radius*this.m_radius},e.prototype.RayCast=function(t,e,i){var n=i.R,r=i.position.x+(n.col1.x*this.m_p.x+n.col2.x*this.m_p.y),o=i.position.y+(n.col1.y*this.m_p.x+n.col2.y*this.m_p.y),s=e.p1.x-r,a=e.p1.y-o,l=s*s+a*a-this.m_radius*this.m_radius,c=e.p2.x-e.p1.x,u=e.p2.y-e.p1.y,h=s*c+a*u,p=c*c+u*u,m=h*h-p*l;if(m<0||p<Number.MIN_VALUE)return!1;var f=-(h+Math.sqrt(m));return 0<=f&&f<=e.maxFraction*p&&(f/=p,t.fraction=f,t.normal.x=s+f*c,t.normal.y=a+f*u,t.normal.Normalize(),!0)},e.prototype.ComputeAABB=function(t,e){var i=e.R,n=e.position.x+(i.col1.x*this.m_p.x+i.col2.x*this.m_p.y),r=e.position.y+(i.col1.y*this.m_p.x+i.col2.y*this.m_p.y);t.lowerBound.Set(n-this.m_radius,r-this.m_radius),t.upperBound.Set(n+this.m_radius,r+this.m_radius)},e.prototype.ComputeMass=function(e,i){void 0===i&&(i=0),e.mass=i*t.b2_pi*this.m_radius*this.m_radius,e.center.SetV(this.m_p),e.I=e.mass*(.5*this.m_radius*this.m_radius+(this.m_p.x*this.m_p.x+this.m_p.y*this.m_p.y))},e.prototype.ComputeSubmergedArea=function(t,e,i,n){void 0===e&&(e=0);var r=h.MulX(i,this.m_p),o=-(h.Dot(t,r)-e);if(o<-this.m_radius+Number.MIN_VALUE)return 0;if(o>this.m_radius)return n.SetV(r),Math.PI*this.m_radius*this.m_radius;var s=this.m_radius*this.m_radius,a=o*o,l=s*(Math.asin(o/this.m_radius)+Math.PI/2)+o*Math.sqrt(s-a),c=-2/3*Math.pow(s-a,1.5)/l;return n.x=r.x+t.x*c,n.y=r.y+t.y*c,l},e.prototype.GetLocalPosition=function(){return this.m_p},e.prototype.SetLocalPosition=function(t){this.m_p.SetV(t)},e.prototype.GetRadius=function(){return this.m_radius},e.prototype.SetRadius=function(t){void 0===t&&(t=0),this.m_radius=t},e.prototype.b2CircleShape=function(t){void 0===t&&(t=0),this.__super.b2Shape.call(this),this.m_type=c.e_circleShape,this.m_radius=t},i.b2EdgeChainDef=function(){},i.prototype.b2EdgeChainDef=function(){this.vertexCount=0,this.isALoop=!0,this.vertices=[]},n.inherit(s,n.Collision.Shapes.b2Shape),s.prototype.__super=n.Collision.Shapes.b2Shape.prototype,s.b2EdgeShape=function(){n.Collision.Shapes.b2Shape.b2Shape.apply(this,arguments),this.s_supportVec=new m,this.m_v1=new m,this.m_v2=new m,this.m_coreV1=new m,this.m_coreV2=new m,this.m_normal=new m,this.m_direction=new m,this.m_cornerDir1=new m,this.m_cornerDir2=new m},s.prototype.TestPoint=function(t,e){return!1},s.prototype.RayCast=function(t,e,i){var n,r=e.p2.x-e.p1.x,o=e.p2.y-e.p1.y;n=i.R;var s=i.position.x+(n.col1.x*this.m_v1.x+n.col2.x*this.m_v1.y),a=i.position.y+(n.col1.y*this.m_v1.x+n.col2.y*this.m_v1.y),l=i.position.y+(n.col1.y*this.m_v2.x+n.col2.y*this.m_v2.y)-a,c=-(i.position.x+(n.col1.x*this.m_v2.x+n.col2.x*this.m_v2.y)-s),u=100*Number.MIN_VALUE,h=-(r*l+o*c);if(h>u){var p=e.p1.x-s,m=e.p1.y-a,f=p*l+m*c;if(0<=f&&f<=e.maxFraction*h){var _=-r*m+o*p;if(-u*h<=_&&_<=h*(1+u)){f/=h,t.fraction=f;var d=Math.sqrt(l*l+c*c);return t.normal.x=l/d,t.normal.y=c/d,!0}}}return!1},s.prototype.ComputeAABB=function(t,e){var i=e.R,n=e.position.x+(i.col1.x*this.m_v1.x+i.col2.x*this.m_v1.y),r=e.position.y+(i.col1.y*this.m_v1.x+i.col2.y*this.m_v1.y),o=e.position.x+(i.col1.x*this.m_v2.x+i.col2.x*this.m_v2.y),s=e.position.y+(i.col1.y*this.m_v2.x+i.col2.y*this.m_v2.y);n<o?(t.lowerBound.x=n,t.upperBound.x=o):(t.lowerBound.x=o,t.upperBound.x=n),r<s?(t.lowerBound.y=r,t.upperBound.y=s):(t.lowerBound.y=s,t.upperBound.y=r)},s.prototype.ComputeMass=function(t,e){void 0===e&&(e=0),t.mass=0,t.center.SetV(this.m_v1),t.I=0},s.prototype.ComputeSubmergedArea=function(t,e,i,n){void 0===e&&(e=0);var r=new m(t.x*e,t.y*e),o=h.MulX(i,this.m_v1),s=h.MulX(i,this.m_v2),a=h.Dot(t,o)-e,l=h.Dot(t,s)-e;if(a>0){if(l>0)return 0;o.x=-l/(a-l)*o.x+a/(a-l)*s.x,o.y=-l/(a-l)*o.y+a/(a-l)*s.y}else l>0&&(s.x=-l/(a-l)*o.x+a/(a-l)*s.x,s.y=-l/(a-l)*o.y+a/(a-l)*s.y);return n.x=(r.x+o.x+s.x)/3,n.y=(r.y+o.y+s.y)/3,.5*((o.x-r.x)*(s.y-r.y)-(o.y-r.y)*(s.x-r.x))},s.prototype.GetLength=function(){return this.m_length},s.prototype.GetVertex1=function(){return this.m_v1},s.prototype.GetVertex2=function(){return this.m_v2},s.prototype.GetCoreVertex1=function(){return this.m_coreV1},s.prototype.GetCoreVertex2=function(){return this.m_coreV2},s.prototype.GetNormalVector=function(){return this.m_normal},s.prototype.GetDirectionVector=function(){return this.m_direction},s.prototype.GetCorner1Vector=function(){return this.m_cornerDir1},s.prototype.GetCorner2Vector=function(){return this.m_cornerDir2},s.prototype.Corner1IsConvex=function(){return this.m_cornerConvex1},s.prototype.Corner2IsConvex=function(){return this.m_cornerConvex2},s.prototype.GetFirstVertex=function(t){var e=t.R;return new m(t.position.x+(e.col1.x*this.m_coreV1.x+e.col2.x*this.m_coreV1.y),t.position.y+(e.col1.y*this.m_coreV1.x+e.col2.y*this.m_coreV1.y))},s.prototype.GetNextEdge=function(){return this.m_nextEdge},s.prototype.GetPrevEdge=function(){return this.m_prevEdge},s.prototype.Support=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0);var n=t.R,r=t.position.x+(n.col1.x*this.m_coreV1.x+n.col2.x*this.m_coreV1.y),o=t.position.y+(n.col1.y*this.m_coreV1.x+n.col2.y*this.m_coreV1.y),s=t.position.x+(n.col1.x*this.m_coreV2.x+n.col2.x*this.m_coreV2.y),a=t.position.y+(n.col1.y*this.m_coreV2.x+n.col2.y*this.m_coreV2.y);return r*e+o*i>s*e+a*i?(this.s_supportVec.x=r,this.s_supportVec.y=o):(this.s_supportVec.x=s,this.s_supportVec.y=a),this.s_supportVec},s.prototype.b2EdgeShape=function(e,i){this.__super.b2Shape.call(this),this.m_type=c.e_edgeShape,this.m_prevEdge=null,this.m_nextEdge=null,this.m_v1=e,this.m_v2=i,this.m_direction.Set(this.m_v2.x-this.m_v1.x,this.m_v2.y-this.m_v1.y),this.m_length=this.m_direction.Normalize(),this.m_normal.Set(this.m_direction.y,-this.m_direction.x),this.m_coreV1.Set(-t.b2_toiSlop*(this.m_normal.x-this.m_direction.x)+this.m_v1.x,-t.b2_toiSlop*(this.m_normal.y-this.m_direction.y)+this.m_v1.y),this.m_coreV2.Set(-t.b2_toiSlop*(this.m_normal.x+this.m_direction.x)+this.m_v2.x,-t.b2_toiSlop*(this.m_normal.y+this.m_direction.y)+this.m_v2.y),this.m_cornerDir1=this.m_normal,this.m_cornerDir2.Set(-this.m_normal.x,-this.m_normal.y)},s.prototype.SetPrevEdge=function(t,e,i,n){this.m_prevEdge=t,this.m_coreV1=e,this.m_cornerDir1=i,this.m_cornerConvex1=n},s.prototype.SetNextEdge=function(t,e,i,n){this.m_nextEdge=t,this.m_coreV2=e,this.m_cornerDir2=i,this.m_cornerConvex2=n},a.b2MassData=function(){this.mass=0,this.center=new m(0,0),this.I=0},n.inherit(l,n.Collision.Shapes.b2Shape),l.prototype.__super=n.Collision.Shapes.b2Shape.prototype,l.b2PolygonShape=function(){n.Collision.Shapes.b2Shape.b2Shape.apply(this,arguments)},l.prototype.Copy=function(){var t=new l;return t.Set(this),t},l.prototype.Set=function(t){if(this.__super.Set.call(this,t),n.is(t,l)){var e=t instanceof l?t:null;this.m_centroid.SetV(e.m_centroid),this.m_vertexCount=e.m_vertexCount,this.Reserve(this.m_vertexCount);for(var i=0;i<this.m_vertexCount;i++)this.m_vertices[i].SetV(e.m_vertices[i]),this.m_normals[i].SetV(e.m_normals[i])}},l.prototype.SetAsArray=function(t,e){void 0===e&&(e=0);var i,n=new r,o=0;for(o=0;o<t.length;++o)i=t[o],n.push(i);this.SetAsVector(n,e)},l.AsArray=function(t,e){void 0===e&&(e=0);var i=new l;return i.SetAsArray(t,e),i},l.prototype.SetAsVector=function(e,i){void 0===i&&(i=0),0==i&&(i=e.length),t.b2Assert(2<=i),this.m_vertexCount=i,this.Reserve(i);var n=0;for(n=0;n<this.m_vertexCount;n++)this.m_vertices[n].SetV(e[n]);for(n=0;n<this.m_vertexCount;++n){var r=parseInt(n),o=parseInt(n+1<this.m_vertexCount?n+1:0),s=h.SubtractVV(this.m_vertices[o],this.m_vertices[r]);t.b2Assert(s.LengthSquared()>Number.MIN_VALUE),this.m_normals[n].SetV(h.CrossVF(s,1)),this.m_normals[n].Normalize()}this.m_centroid=l.ComputeCentroid(this.m_vertices,this.m_vertexCount)},l.AsVector=function(t,e){void 0===e&&(e=0);var i=new l;return i.SetAsVector(t,e),i},l.prototype.SetAsBox=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.m_vertexCount=4,this.Reserve(4),this.m_vertices[0].Set(-t,-e),this.m_vertices[1].Set(t,-e),this.m_vertices[2].Set(t,e),this.m_vertices[3].Set(-t,e),this.m_normals[0].Set(0,-1),this.m_normals[1].Set(1,0),this.m_normals[2].Set(0,1),this.m_normals[3].Set(-1,0),this.m_centroid.SetZero()},l.AsBox=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var i=new l;return i.SetAsBox(t,e),i},l.prototype.SetAsOrientedBox=function(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=null),void 0===n&&(n=0),this.m_vertexCount=4,this.Reserve(4),this.m_vertices[0].Set(-t,-e),this.m_vertices[1].Set(t,-e),this.m_vertices[2].Set(t,e),this.m_vertices[3].Set(-t,e),this.m_normals[0].Set(0,-1),this.m_normals[1].Set(1,0),this.m_normals[2].Set(0,1),this.m_normals[3].Set(-1,0),this.m_centroid=i;var r=new p;r.position=i,r.R.Set(n);for(var o=0;o<this.m_vertexCount;++o)this.m_vertices[o]=h.MulX(r,this.m_vertices[o]),this.m_normals[o]=h.MulMV(r.R,this.m_normals[o])},l.AsOrientedBox=function(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=null),void 0===n&&(n=0);var r=new l;return r.SetAsOrientedBox(t,e,i,n),r},l.prototype.SetAsEdge=function(t,e){this.m_vertexCount=2,this.Reserve(2),this.m_vertices[0].SetV(t),this.m_vertices[1].SetV(e),this.m_centroid.x=.5*(t.x+e.x),this.m_centroid.y=.5*(t.y+e.y),this.m_normals[0]=h.CrossVF(h.SubtractVV(e,t),1),this.m_normals[0].Normalize(),this.m_normals[1].x=-this.m_normals[0].x,this.m_normals[1].y=-this.m_normals[0].y},l.AsEdge=function(t,e){var i=new l;return i.SetAsEdge(t,e),i},l.prototype.TestPoint=function(t,e){for(var i,n=t.R,r=e.x-t.position.x,o=e.y-t.position.y,s=r*n.col1.x+o*n.col1.y,a=r*n.col2.x+o*n.col2.y,l=0;l<this.m_vertexCount;++l){i=this.m_vertices[l],r=s-i.x,o=a-i.y,i=this.m_normals[l];if(i.x*r+i.y*o>0)return!1}return!0},l.prototype.RayCast=function(t,e,i){var n,r,o=0,s=e.maxFraction,a=0,l=0;a=e.p1.x-i.position.x,l=e.p1.y-i.position.y,n=i.R;var c=a*n.col1.x+l*n.col1.y,u=a*n.col2.x+l*n.col2.y;a=e.p2.x-i.position.x,l=e.p2.y-i.position.y,n=i.R;for(var h=a*n.col1.x+l*n.col1.y,p=a*n.col2.x+l*n.col2.y,m=h-c,f=p-u,_=parseInt(-1),d=0;d<this.m_vertexCount;++d){r=this.m_vertices[d],a=r.x-c,l=r.y-u,r=this.m_normals[d];var y=r.x*a+r.y*l,g=r.x*m+r.y*f;if(0==g){if(y<0)return!1}else g<0&&y<o*g?(o=y/g,_=d):g>0&&y<s*g&&(s=y/g);if(s<o-Number.MIN_VALUE)return!1}return _>=0&&(t.fraction=o,n=i.R,r=this.m_normals[_],t.normal.x=n.col1.x*r.x+n.col2.x*r.y,t.normal.y=n.col1.y*r.x+n.col2.y*r.y,!0)},l.prototype.ComputeAABB=function(t,e){for(var i=e.R,n=this.m_vertices[0],r=e.position.x+(i.col1.x*n.x+i.col2.x*n.y),o=e.position.y+(i.col1.y*n.x+i.col2.y*n.y),s=r,a=o,l=1;l<this.m_vertexCount;++l){n=this.m_vertices[l];var c=e.position.x+(i.col1.x*n.x+i.col2.x*n.y),u=e.position.y+(i.col1.y*n.x+i.col2.y*n.y);r=r<c?r:c,o=o<u?o:u,s=s>c?s:c,a=a>u?a:u}t.lowerBound.x=r-this.m_radius,t.lowerBound.y=o-this.m_radius,t.upperBound.x=s+this.m_radius,t.upperBound.y=a+this.m_radius},l.prototype.ComputeMass=function(t,e){if(void 0===e&&(e=0),2==this.m_vertexCount)return t.center.x=.5*(this.m_vertices[0].x+this.m_vertices[1].x),t.center.y=.5*(this.m_vertices[0].y+this.m_vertices[1].y),t.mass=0,void(t.I=0);for(var i=0,n=0,r=0,o=0,s=0;s<this.m_vertexCount;++s){var a=this.m_vertices[s],l=s+1<this.m_vertexCount?this.m_vertices[parseInt(s+1)]:this.m_vertices[0],c=a.x-0,u=a.y-0,h=l.x-0,p=l.y-0,m=c*p-u*h,f=.5*m;r+=f,i+=f*(1/3)*(0+a.x+l.x),n+=f*(1/3)*(0+a.y+l.y);var _=c,d=u,y=h,g=p;o+=m*(1/3*(.25*(_*_+y*_+y*y)+(0*_+0*y))+0+(1/3*(.25*(d*d+g*d+g*g)+(0*d+0*g))+0))}t.mass=e*r,i*=1/r,n*=1/r,t.center.Set(i,n),t.I=e*o},l.prototype.ComputeSubmergedArea=function(t,e,i,n){void 0===e&&(e=0);var r=h.MulTMV(i.R,t),s=e-h.Dot(t,i.position),l=new o,c=0,u=parseInt(-1),p=parseInt(-1),f=!1,_=0;for(_=0;_<this.m_vertexCount;++_){l[_]=h.Dot(r,this.m_vertices[_])-s;var d=l[_]<-Number.MIN_VALUE;_>0&&(d?f||(u=_-1,c++):f&&(p=_-1,c++)),f=d}switch(c){case 0:if(f){var y=new a;return this.ComputeMass(y,1),n.SetV(h.MulX(i,y.center)),y.mass}return 0;case 1:-1==u?u=this.m_vertexCount-1:p=this.m_vertexCount-1}var g,v=parseInt((u+1)%this.m_vertexCount),x=parseInt((p+1)%this.m_vertexCount),b=(0-l[u])/(l[v]-l[u]),w=(0-l[p])/(l[x]-l[p]),C=new m(this.m_vertices[u].x*(1-b)+this.m_vertices[v].x*b,this.m_vertices[u].y*(1-b)+this.m_vertices[v].y*b),S=new m(this.m_vertices[p].x*(1-w)+this.m_vertices[x].x*w,this.m_vertices[p].y*(1-w)+this.m_vertices[x].y*w),A=0,D=new m,M=this.m_vertices[v];for(_=v;_!=x;){_=(_+1)%this.m_vertexCount,g=_==x?S:this.m_vertices[_];var T=.5*((M.x-C.x)*(g.y-C.y)-(M.y-C.y)*(g.x-C.x));A+=T,D.x+=T*(C.x+M.x+g.x)/3,D.y+=T*(C.y+M.y+g.y)/3,M=g}return D.Multiply(1/A),n.SetV(h.MulX(i,D)),A},l.prototype.GetVertexCount=function(){return this.m_vertexCount},l.prototype.GetVertices=function(){return this.m_vertices},l.prototype.GetNormals=function(){return this.m_normals},l.prototype.GetSupport=function(t){for(var e=0,i=this.m_vertices[0].x*t.x+this.m_vertices[0].y*t.y,n=1;n<this.m_vertexCount;++n){var r=this.m_vertices[n].x*t.x+this.m_vertices[n].y*t.y;r>i&&(e=n,i=r)}return e},l.prototype.GetSupportVertex=function(t){for(var e=0,i=this.m_vertices[0].x*t.x+this.m_vertices[0].y*t.y,n=1;n<this.m_vertexCount;++n){var r=this.m_vertices[n].x*t.x+this.m_vertices[n].y*t.y;r>i&&(e=n,i=r)}return this.m_vertices[e]},l.prototype.Validate=function(){return!1},l.prototype.b2PolygonShape=function(){this.__super.b2Shape.call(this),this.m_type=c.e_polygonShape,this.m_centroid=new m,this.m_vertices=new r,this.m_normals=new r},l.prototype.Reserve=function(t){void 0===t&&(t=0);for(var e=parseInt(this.m_vertices.length);e<t;e++)this.m_vertices[e]=new m,this.m_normals[e]=new m},l.ComputeCentroid=function(t,e){void 0===e&&(e=0);for(var i=new m,n=0,r=0;r<e;++r){var o=t[r],s=r+1<e?t[parseInt(r+1)]:t[0],a=o.x-0,l=o.y-0,c=s.x-0,u=s.y-0,h=a*u-l*c,p=.5*h;n+=p,i.x+=p*(1/3)*(0+o.x+s.x),i.y+=p*(1/3)*(0+o.y+s.y)}return i.x*=1/n,i.y*=1/n,i},l.ComputeOBB=function(t,e,i){void 0===i&&(i=0);var n=0,o=new r(i+1);for(n=0;n<i;++n)o[n]=e[n];o[i]=o[0];var s=Number.MAX_VALUE;for(n=1;n<=i;++n){var a=o[parseInt(n-1)],l=o[n].x-a.x,c=o[n].y-a.y,u=Math.sqrt(l*l+c*c);l/=u,c/=u;for(var h=-c,p=l,m=Number.MAX_VALUE,f=Number.MAX_VALUE,_=-Number.MAX_VALUE,d=-Number.MAX_VALUE,y=0;y<i;++y){var g=o[y].x-a.x,v=o[y].y-a.y,x=l*g+c*v,b=h*g+p*v;x<m&&(m=x),b<f&&(f=b),x>_&&(_=x),b>d&&(d=b)}var w=(_-m)*(d-f);if(w<.95*s){s=w,t.R.col1.x=l,t.R.col1.y=c,t.R.col2.x=h,t.R.col2.y=p;var C=.5*(m+_),S=.5*(f+d),A=t.R;t.center.x=a.x+(A.col1.x*C+A.col2.x*S),t.center.y=a.y+(A.col1.y*C+A.col2.y*S),t.extents.x=.5*(_-m),t.extents.y=.5*(d-f)}}},n.postDefs.push(function(){n.Collision.Shapes.b2PolygonShape.s_mat=new u}),c.b2Shape=function(){},c.prototype.Copy=function(){return null},c.prototype.Set=function(t){this.m_radius=t.m_radius},c.prototype.GetType=function(){return this.m_type},c.prototype.TestPoint=function(t,e){return!1},c.prototype.RayCast=function(t,e,i){return!1},c.prototype.ComputeAABB=function(t,e){},c.prototype.ComputeMass=function(t,e){void 0===e&&(e=0)},c.prototype.ComputeSubmergedArea=function(t,e,i,n){return void 0===e&&(e=0),0},c.TestOverlap=function(t,e,i,n){var r=new _;r.proxyA=new y,r.proxyA.Set(t),r.proxyB=new y,r.proxyB.Set(i),r.transformA=e,r.transformB=n,r.useRadii=!0;var o=new g;o.count=0;var s=new d;return f.Distance(s,o,r),s.distance<10*Number.MIN_VALUE},c.prototype.b2Shape=function(){this.m_type=c.e_unknownShape,this.m_radius=t.b2_linearSlop},n.postDefs.push(function(){n.Collision.Shapes.b2Shape.e_unknownShape=parseInt(-1),n.Collision.Shapes.b2Shape.e_circleShape=0,n.Collision.Shapes.b2Shape.e_polygonShape=1,n.Collision.Shapes.b2Shape.e_edgeShape=2,n.Collision.Shapes.b2Shape.e_shapeTypeCount=3,n.Collision.Shapes.b2Shape.e_hitCollide=1,n.Collision.Shapes.b2Shape.e_missCollide=0,n.Collision.Shapes.b2Shape.e_startsInsideCollide=parseInt(-1)})}(),function(){var t=n.Common.b2Color,e=(n.Common.b2internal,n.Common.b2Settings),i=(n.Common.Math.b2Mat22,n.Common.Math.b2Mat33,n.Common.Math.b2Math);n.Common.Math.b2Sweep,n.Common.Math.b2Transform,n.Common.Math.b2Vec2,n.Common.Math.b2Vec3;t.b2Color=function(){this._r=0,this._g=0,this._b=0},t.prototype.b2Color=function(t,e,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),this._r=n.parseUInt(255*i.Clamp(t,0,1)),this._g=n.parseUInt(255*i.Clamp(e,0,1)),this._b=n.parseUInt(255*i.Clamp(r,0,1))},t.prototype.Set=function(t,e,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),this._r=n.parseUInt(255*i.Clamp(t,0,1)),this._g=n.parseUInt(255*i.Clamp(e,0,1)),this._b=n.parseUInt(255*i.Clamp(r,0,1))},Object.defineProperty(t.prototype,"r",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._r=n.parseUInt(255*i.Clamp(t,0,1))}}),Object.defineProperty(t.prototype,"g",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._g=n.parseUInt(255*i.Clamp(t,0,1))}}),Object.defineProperty(t.prototype,"b",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._b=n.parseUInt(255*i.Clamp(t,0,1))}}),Object.defineProperty(t.prototype,"color",{enumerable:!1,configurable:!0,get:function(){return this._r<<16|this._g<<8|this._b}}),e.b2Settings=function(){},e.b2MixFriction=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),Math.sqrt(t*e)},e.b2MixRestitution=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),t>e?t:e},e.b2Assert=function(t){if(!t)throw"Assertion Failed"},n.postDefs.push(function(){n.Common.b2Settings.VERSION="2.1alpha",n.Common.b2Settings.USHRT_MAX=65535,n.Common.b2Settings.b2_pi=Math.PI,n.Common.b2Settings.b2_maxManifoldPoints=2,n.Common.b2Settings.b2_aabbExtension=.1,n.Common.b2Settings.b2_aabbMultiplier=2,n.Common.b2Settings.b2_polygonRadius=2*e.b2_linearSlop,n.Common.b2Settings.b2_linearSlop=.005,n.Common.b2Settings.b2_angularSlop=2/180*e.b2_pi,n.Common.b2Settings.b2_toiSlop=8*e.b2_linearSlop,n.Common.b2Settings.b2_maxTOIContactsPerIsland=32,n.Common.b2Settings.b2_maxTOIJointsPerIsland=32,n.Common.b2Settings.b2_velocityThreshold=1,n.Common.b2Settings.b2_maxLinearCorrection=.2,n.Common.b2Settings.b2_maxAngularCorrection=8/180*e.b2_pi,n.Common.b2Settings.b2_maxTranslation=2,n.Common.b2Settings.b2_maxTranslationSquared=e.b2_maxTranslation*e.b2_maxTranslation,n.Common.b2Settings.b2_maxRotation=.5*e.b2_pi,n.Common.b2Settings.b2_maxRotationSquared=e.b2_maxRotation*e.b2_maxRotation,n.Common.b2Settings.b2_contactBaumgarte=.2,n.Common.b2Settings.b2_timeToSleep=.5,n.Common.b2Settings.b2_linearSleepTolerance=.01,n.Common.b2Settings.b2_angularSleepTolerance=2/180*e.b2_pi})}(),function(){var t=(n.Collision.b2AABB,n.Common.b2Color,n.Common.b2internal,n.Common.b2Settings,n.Common.Math.b2Mat22),e=n.Common.Math.b2Mat33,i=n.Common.Math.b2Math,r=n.Common.Math.b2Sweep,o=n.Common.Math.b2Transform,s=n.Common.Math.b2Vec2,a=n.Common.Math.b2Vec3;t.b2Mat22=function(){this.col1=new s,this.col2=new s},t.prototype.b2Mat22=function(){this.SetIdentity()},t.FromAngle=function(e){void 0===e&&(e=0);var i=new t;return i.Set(e),i},t.FromVV=function(e,i){var n=new t;return n.SetVV(e,i),n},t.prototype.Set=function(t){void 0===t&&(t=0);var e=Math.cos(t),i=Math.sin(t);this.col1.x=e,this.col2.x=-i,this.col1.y=i,this.col2.y=e},t.prototype.SetVV=function(t,e){this.col1.SetV(t),this.col2.SetV(e)},t.prototype.Copy=function(){var e=new t;return e.SetM(this),e},t.prototype.SetM=function(t){this.col1.SetV(t.col1),this.col2.SetV(t.col2)},t.prototype.AddM=function(t){this.col1.x+=t.col1.x,this.col1.y+=t.col1.y,this.col2.x+=t.col2.x,this.col2.y+=t.col2.y},t.prototype.SetIdentity=function(){this.col1.x=1,this.col2.x=0,this.col1.y=0,this.col2.y=1},t.prototype.SetZero=function(){this.col1.x=0,this.col2.x=0,this.col1.y=0,this.col2.y=0},t.prototype.GetAngle=function(){return Math.atan2(this.col1.y,this.col1.x)},t.prototype.GetInverse=function(t){var e=this.col1.x,i=this.col2.x,n=this.col1.y,r=this.col2.y,o=e*r-i*n;return 0!=o&&(o=1/o),t.col1.x=o*r,t.col2.x=-o*i,t.col1.y=-o*n,t.col2.y=o*e,t},t.prototype.Solve=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0);var n=this.col1.x,r=this.col2.x,o=this.col1.y,s=this.col2.y,a=n*s-r*o;return 0!=a&&(a=1/a),t.x=a*(s*e-r*i),t.y=a*(n*i-o*e),t},t.prototype.Abs=function(){this.col1.Abs(),this.col2.Abs()},e.b2Mat33=function(){this.col1=new a,this.col2=new a,this.col3=new a},e.prototype.b2Mat33=function(t,e,i){void 0===t&&(t=null),void 0===e&&(e=null),void 0===i&&(i=null),t||e||i?(this.col1.SetV(t),this.col2.SetV(e),this.col3.SetV(i)):(this.col1.SetZero(),this.col2.SetZero(),this.col3.SetZero())},e.prototype.SetVVV=function(t,e,i){this.col1.SetV(t),this.col2.SetV(e),this.col3.SetV(i)},e.prototype.Copy=function(){return new e(this.col1,this.col2,this.col3)},e.prototype.SetM=function(t){this.col1.SetV(t.col1),this.col2.SetV(t.col2),this.col3.SetV(t.col3)},e.prototype.AddM=function(t){this.col1.x+=t.col1.x,this.col1.y+=t.col1.y,this.col1.z+=t.col1.z,this.col2.x+=t.col2.x,this.col2.y+=t.col2.y,this.col2.z+=t.col2.z,this.col3.x+=t.col3.x,this.col3.y+=t.col3.y,this.col3.z+=t.col3.z},e.prototype.SetIdentity=function(){this.col1.x=1,this.col2.x=0,this.col3.x=0,this.col1.y=0,this.col2.y=1,this.col3.y=0,this.col1.z=0,this.col2.z=0,this.col3.z=1},e.prototype.SetZero=function(){this.col1.x=0,this.col2.x=0,this.col3.x=0,this.col1.y=0,this.col2.y=0,this.col3.y=0,this.col1.z=0,this.col2.z=0,this.col3.z=0},e.prototype.Solve22=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0);var n=this.col1.x,r=this.col2.x,o=this.col1.y,s=this.col2.y,a=n*s-r*o;return 0!=a&&(a=1/a),t.x=a*(s*e-r*i),t.y=a*(n*i-o*e),t},e.prototype.Solve33=function(t,e,i,n){void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0);var r=this.col1.x,o=this.col1.y,s=this.col1.z,a=this.col2.x,l=this.col2.y,c=this.col2.z,u=this.col3.x,h=this.col3.y,p=this.col3.z,m=r*(l*p-c*h)+o*(c*u-a*p)+s*(a*h-l*u);return 0!=m&&(m=1/m),t.x=m*(e*(l*p-c*h)+i*(c*u-a*p)+n*(a*h-l*u)),t.y=m*(r*(i*p-n*h)+o*(n*u-e*p)+s*(e*h-i*u)),t.z=m*(r*(l*n-c*i)+o*(c*e-a*n)+s*(a*i-l*e)),t},i.b2Math=function(){},i.IsValid=function(t){return void 0===t&&(t=0),isFinite(t)},i.Dot=function(t,e){return t.x*e.x+t.y*e.y},i.CrossVV=function(t,e){return t.x*e.y-t.y*e.x},i.CrossVF=function(t,e){return void 0===e&&(e=0),new s(e*t.y,-e*t.x)},i.CrossFV=function(t,e){return void 0===t&&(t=0),new s(-t*e.y,t*e.x)},i.MulMV=function(t,e){return new s(t.col1.x*e.x+t.col2.x*e.y,t.col1.y*e.x+t.col2.y*e.y)},i.MulTMV=function(t,e){return new s(i.Dot(e,t.col1),i.Dot(e,t.col2))},i.MulX=function(t,e){var n=i.MulMV(t.R,e);return n.x+=t.position.x,n.y+=t.position.y,n},i.MulXT=function(t,e){var n=i.SubtractVV(e,t.position),r=n.x*t.R.col1.x+n.y*t.R.col1.y;return n.y=n.x*t.R.col2.x+n.y*t.R.col2.y,n.x=r,n},i.AddVV=function(t,e){return new s(t.x+e.x,t.y+e.y)},i.SubtractVV=function(t,e){return new s(t.x-e.x,t.y-e.y)},i.Distance=function(t,e){var i=t.x-e.x,n=t.y-e.y;return Math.sqrt(i*i+n*n)},i.DistanceSquared=function(t,e){var i=t.x-e.x,n=t.y-e.y;return i*i+n*n},i.MulFV=function(t,e){return void 0===t&&(t=0),new s(t*e.x,t*e.y)},i.AddMM=function(e,n){return t.FromVV(i.AddVV(e.col1,n.col1),i.AddVV(e.col2,n.col2))},i.MulMM=function(e,n){return t.FromVV(i.MulMV(e,n.col1),i.MulMV(e,n.col2))},i.MulTMM=function(e,n){var r=new s(i.Dot(e.col1,n.col1),i.Dot(e.col2,n.col1)),o=new s(i.Dot(e.col1,n.col2),i.Dot(e.col2,n.col2));return t.FromVV(r,o)},i.Abs=function(t){return void 0===t&&(t=0),t>0?t:-t},i.AbsV=function(t){return new s(i.Abs(t.x),i.Abs(t.y))},i.AbsM=function(e){return t.FromVV(i.AbsV(e.col1),i.AbsV(e.col2))},i.Min=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),t<e?t:e},i.MinV=function(t,e){return new s(i.Min(t.x,e.x),i.Min(t.y,e.y))},i.Max=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),t>e?t:e},i.MaxV=function(t,e){return new s(i.Max(t.x,e.x),i.Max(t.y,e.y))},i.Clamp=function(t,e,i){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),t<e?e:t>i?i:t},i.ClampV=function(t,e,n){return i.MaxV(e,i.MinV(t,n))},i.Swap=function(t,e){var i=t[0];t[0]=e[0],e[0]=i},i.Random=function(){return 2*Math.random()-1},i.RandomRange=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var i=Math.random();return i=(e-t)*i+t},i.NextPowerOfTwo=function(t){return void 0===t&&(t=0),t|=t>>1&2147483647,t|=t>>2&1073741823,t|=t>>4&268435455,t|=t>>8&16777215,(t|=t>>16&65535)+1},i.IsPowerOfTwo=function(t){return void 0===t&&(t=0),t>0&&0==(t&t-1)},n.postDefs.push(function(){n.Common.Math.b2Math.b2Vec2_zero=new s(0,0),n.Common.Math.b2Math.b2Mat22_identity=t.FromVV(new s(1,0),new s(0,1)),n.Common.Math.b2Math.b2Transform_identity=new o(i.b2Vec2_zero,i.b2Mat22_identity)}),r.b2Sweep=function(){this.localCenter=new s,this.c0=new s,this.c=new s},r.prototype.Set=function(t){this.localCenter.SetV(t.localCenter),this.c0.SetV(t.c0),this.c.SetV(t.c),this.a0=t.a0,this.a=t.a,this.t0=t.t0},r.prototype.Copy=function(){var t=new r;return t.localCenter.SetV(this.localCenter),t.c0.SetV(this.c0),t.c.SetV(this.c),t.a0=this.a0,t.a=this.a,t.t0=this.t0,t},r.prototype.GetTransform=function(t,e){void 0===e&&(e=0),t.position.x=(1-e)*this.c0.x+e*this.c.x,t.position.y=(1-e)*this.c0.y+e*this.c.y;var i=(1-e)*this.a0+e*this.a;t.R.Set(i);var n=t.R;t.position.x-=n.col1.x*this.localCenter.x+n.col2.x*this.localCenter.y,t.position.y-=n.col1.y*this.localCenter.x+n.col2.y*this.localCenter.y},r.prototype.Advance=function(t){if(void 0===t&&(t=0),this.t0<t&&1-this.t0>Number.MIN_VALUE){var e=(t-this.t0)/(1-this.t0);this.c0.x=(1-e)*this.c0.x+e*this.c.x,this.c0.y=(1-e)*this.c0.y+e*this.c.y,this.a0=(1-e)*this.a0+e*this.a,this.t0=t}},o.b2Transform=function(){this.position=new s,this.R=new t},o.prototype.b2Transform=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),t&&(this.position.SetV(t),this.R.SetM(e))},o.prototype.Initialize=function(t,e){this.position.SetV(t),this.R.SetM(e)},o.prototype.SetIdentity=function(){this.position.SetZero(),this.R.SetIdentity()},o.prototype.Set=function(t){this.position.SetV(t.position),this.R.SetM(t.R)},o.prototype.GetAngle=function(){return Math.atan2(this.R.col1.y,this.R.col1.x)},s.b2Vec2=function(){},s.prototype.b2Vec2=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e},s.prototype.SetZero=function(){this.x=0,this.y=0},s.prototype.Set=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e},s.prototype.SetV=function(t){this.x=t.x,this.y=t.y},s.prototype.GetNegative=function(){return new s(-this.x,-this.y)},s.prototype.NegativeSelf=function(){this.x=-this.x,this.y=-this.y},s.Make=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),new s(t,e)},s.prototype.Copy=function(){return new s(this.x,this.y)},s.prototype.Add=function(t){this.x+=t.x,this.y+=t.y},s.prototype.Subtract=function(t){this.x-=t.x,this.y-=t.y},s.prototype.Multiply=function(t){void 0===t&&(t=0),this.x*=t,this.y*=t},s.prototype.MulM=function(t){var e=this.x;this.x=t.col1.x*e+t.col2.x*this.y,this.y=t.col1.y*e+t.col2.y*this.y},s.prototype.MulTM=function(t){var e=i.Dot(this,t.col1);this.y=i.Dot(this,t.col2),this.x=e},s.prototype.CrossVF=function(t){void 0===t&&(t=0);var e=this.x;this.x=t*this.y,this.y=-t*e},s.prototype.CrossFV=function(t){void 0===t&&(t=0);var e=this.x;this.x=-t*this.y,this.y=t*e},s.prototype.MinV=function(t){this.x=this.x<t.x?this.x:t.x,this.y=this.y<t.y?this.y:t.y},s.prototype.MaxV=function(t){this.x=this.x>t.x?this.x:t.x,this.y=this.y>t.y?this.y:t.y},s.prototype.Abs=function(){this.x<0&&(this.x=-this.x),this.y<0&&(this.y=-this.y)},s.prototype.Length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},s.prototype.LengthSquared=function(){return this.x*this.x+this.y*this.y},s.prototype.Normalize=function(){var t=Math.sqrt(this.x*this.x+this.y*this.y);if(t<Number.MIN_VALUE)return 0;var e=1/t;return this.x*=e,this.y*=e,t},s.prototype.IsValid=function(){return i.IsValid(this.x)&&i.IsValid(this.y)},a.b2Vec3=function(){},a.prototype.b2Vec3=function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.x=t,this.y=e,this.z=i},a.prototype.SetZero=function(){this.x=this.y=this.z=0},a.prototype.Set=function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.x=t,this.y=e,this.z=i},a.prototype.SetV=function(t){this.x=t.x,this.y=t.y,this.z=t.z},a.prototype.GetNegative=function(){return new a(-this.x,-this.y,-this.z)},a.prototype.NegativeSelf=function(){this.x=-this.x,this.y=-this.y,this.z=-this.z},a.prototype.Copy=function(){return new a(this.x,this.y,this.z)},a.prototype.Add=function(t){this.x+=t.x,this.y+=t.y,this.z+=t.z},a.prototype.Subtract=function(t){this.x-=t.x,this.y-=t.y,this.z-=t.z},a.prototype.Multiply=function(t){void 0===t&&(t=0),this.x*=t,this.y*=t,this.z*=t}}(),function(){var t=(n.Dynamics.Controllers.b2ControllerEdge,n.Common.Math.b2Mat22,n.Common.Math.b2Mat33,n.Common.Math.b2Math),e=n.Common.Math.b2Sweep,i=n.Common.Math.b2Transform,s=n.Common.Math.b2Vec2,a=(n.Common.Math.b2Vec3,n.Common.b2Color),l=(n.Common.b2internal,n.Common.b2Settings),c=n.Collision.b2AABB,u=(n.Collision.b2Bound,n.Collision.b2BoundValues,n.Collision.b2Collision,n.Collision.b2ContactID,n.Collision.b2ContactPoint),h=(n.Collision.b2Distance,n.Collision.b2DistanceInput,n.Collision.b2DistanceOutput,n.Collision.b2DistanceProxy,n.Collision.b2DynamicTree,n.Collision.b2DynamicTreeBroadPhase),p=(n.Collision.b2DynamicTreeNode,n.Collision.b2DynamicTreePair,n.Collision.b2Manifold,n.Collision.b2ManifoldPoint,n.Collision.b2Point,n.Collision.b2RayCastInput),m=n.Collision.b2RayCastOutput,f=(n.Collision.b2Segment,n.Collision.b2SeparationFunction,n.Collision.b2Simplex,n.Collision.b2SimplexCache,n.Collision.b2SimplexVertex,n.Collision.b2TimeOfImpact,n.Collision.b2TOIInput,n.Collision.b2WorldManifold,n.Collision.ClipVertex,n.Collision.Features,n.Collision.IBroadPhase,n.Collision.Shapes.b2CircleShape),_=(n.Collision.Shapes.b2EdgeChainDef,n.Collision.Shapes.b2EdgeShape),d=n.Collision.Shapes.b2MassData,y=n.Collision.Shapes.b2PolygonShape,g=n.Collision.Shapes.b2Shape,v=n.Dynamics.b2Body,x=n.Dynamics.b2BodyDef,b=n.Dynamics.b2ContactFilter,w=n.Dynamics.b2ContactImpulse,C=n.Dynamics.b2ContactListener,S=n.Dynamics.b2ContactManager,A=n.Dynamics.b2DebugDraw,D=n.Dynamics.b2DestructionListener,M=n.Dynamics.b2FilterData,T=n.Dynamics.b2Fixture,k=n.Dynamics.b2FixtureDef,I=n.Dynamics.b2Island,P=n.Dynamics.b2TimeStep,B=n.Dynamics.b2World,E=(n.Dynamics.Contacts.b2CircleContact,n.Dynamics.Contacts.b2Contact),L=(n.Dynamics.Contacts.b2ContactConstraint,n.Dynamics.Contacts.b2ContactConstraintPoint,n.Dynamics.Contacts.b2ContactEdge,n.Dynamics.Contacts.b2ContactFactory),R=(n.Dynamics.Contacts.b2ContactRegister,n.Dynamics.Contacts.b2ContactResult,n.Dynamics.Contacts.b2ContactSolver),V=(n.Dynamics.Contacts.b2EdgeAndCircleContact,n.Dynamics.Contacts.b2NullContact,n.Dynamics.Contacts.b2PolyAndCircleContact,n.Dynamics.Contacts.b2PolyAndEdgeContact,n.Dynamics.Contacts.b2PolygonContact,n.Dynamics.Contacts.b2PositionSolverManifold,n.Dynamics.Controllers.b2Controller,n.Dynamics.Joints.b2DistanceJoint,n.Dynamics.Joints.b2DistanceJointDef,n.Dynamics.Joints.b2FrictionJoint,n.Dynamics.Joints.b2FrictionJointDef,n.Dynamics.Joints.b2GearJoint,n.Dynamics.Joints.b2GearJointDef,n.Dynamics.Joints.b2Jacobian,n.Dynamics.Joints.b2Joint),O=(n.Dynamics.Joints.b2JointDef,n.Dynamics.Joints.b2JointEdge,n.Dynamics.Joints.b2LineJoint,n.Dynamics.Joints.b2LineJointDef,n.Dynamics.Joints.b2MouseJoint,n.Dynamics.Joints.b2MouseJointDef,n.Dynamics.Joints.b2PrismaticJoint,n.Dynamics.Joints.b2PrismaticJointDef,n.Dynamics.Joints.b2PulleyJoint);n.Dynamics.Joints.b2PulleyJointDef,n.Dynamics.Joints.b2RevoluteJoint,n.Dynamics.Joints.b2RevoluteJointDef,n.Dynamics.Joints.b2WeldJoint,n.Dynamics.Joints.b2WeldJointDef;v.b2Body=function(){this.m_xf=new i,this.m_sweep=new e,this.m_linearVelocity=new s,this.m_force=new s},v.prototype.connectEdges=function(e,i,n){void 0===n&&(n=0);var r=Math.atan2(i.GetDirectionVector().y,i.GetDirectionVector().x),o=Math.tan(.5*(r-n)),s=t.MulFV(o,i.GetDirectionVector());s=t.SubtractVV(s,i.GetNormalVector()),s=t.MulFV(l.b2_toiSlop,s),s=t.AddVV(s,i.GetVertex1());var a=t.AddVV(e.GetDirectionVector(),i.GetDirectionVector());a.Normalize();var c=t.Dot(e.GetDirectionVector(),i.GetNormalVector())>0;return e.SetNextEdge(i,s,a,c),i.SetPrevEdge(e,s,a,c),r},v.prototype.CreateFixture=function(t){if(1==this.m_world.IsLocked())return null;var e=new T;if(e.Create(this,this.m_xf,t),this.m_flags&v.e_activeFlag){var i=this.m_world.m_contactManager.m_broadPhase;e.CreateProxy(i,this.m_xf)}return e.m_next=this.m_fixtureList,this.m_fixtureList=e,++this.m_fixtureCount,e.m_body=this,e.m_density>0&&this.ResetMassData(),this.m_world.m_flags|=B.e_newFixture,e},v.prototype.CreateFixture2=function(t,e){void 0===e&&(e=0);var i=new k;return i.shape=t,i.density=e,this.CreateFixture(i)},v.prototype.DestroyFixture=function(t){if(1!=this.m_world.IsLocked()){for(var e=this.m_fixtureList,i=null;null!=e;){if(e==t){i?i.m_next=t.m_next:this.m_fixtureList=t.m_next,!0;break}i=e,e=e.m_next}for(var n=this.m_contactList;n;){var r=n.contact;n=n.next;var o=r.GetFixtureA(),s=r.GetFixtureB();t!=o&&t!=s||this.m_world.m_contactManager.Destroy(r)}if(this.m_flags&v.e_activeFlag){var a=this.m_world.m_contactManager.m_broadPhase;t.DestroyProxy(a)}t.Destroy(),t.m_body=null,t.m_next=null,--this.m_fixtureCount,this.ResetMassData()}},v.prototype.SetPositionAndAngle=function(t,e){void 0===e&&(e=0);var i;if(1!=this.m_world.IsLocked()){this.m_xf.R.Set(e),this.m_xf.position.SetV(t);var n=this.m_xf.R,r=this.m_sweep.localCenter;this.m_sweep.c.x=n.col1.x*r.x+n.col2.x*r.y,this.m_sweep.c.y=n.col1.y*r.x+n.col2.y*r.y,this.m_sweep.c.x+=this.m_xf.position.x,this.m_sweep.c.y+=this.m_xf.position.y,this.m_sweep.c0.SetV(this.m_sweep.c),this.m_sweep.a0=this.m_sweep.a=e;var o=this.m_world.m_contactManager.m_broadPhase;for(i=this.m_fixtureList;i;i=i.m_next)i.Synchronize(o,this.m_xf,this.m_xf);this.m_world.m_contactManager.FindNewContacts()}},v.prototype.SetTransform=function(t){this.SetPositionAndAngle(t.position,t.GetAngle())},v.prototype.GetTransform=function(){return this.m_xf},v.prototype.GetPosition=function(){return this.m_xf.position},v.prototype.SetPosition=function(t){this.SetPositionAndAngle(t,this.GetAngle())},v.prototype.GetAngle=function(){return this.m_sweep.a},v.prototype.SetAngle=function(t){void 0===t&&(t=0),this.SetPositionAndAngle(this.GetPosition(),t)},v.prototype.GetWorldCenter=function(){return this.m_sweep.c},v.prototype.GetLocalCenter=function(){return this.m_sweep.localCenter},v.prototype.SetLinearVelocity=function(t){this.m_type!=v.b2_staticBody&&this.m_linearVelocity.SetV(t)},v.prototype.GetLinearVelocity=function(){return this.m_linearVelocity},v.prototype.SetAngularVelocity=function(t){void 0===t&&(t=0),this.m_type!=v.b2_staticBody&&(this.m_angularVelocity=t)},v.prototype.GetAngularVelocity=function(){return this.m_angularVelocity},v.prototype.GetDefinition=function(){var t=new x;return t.type=this.GetType(),t.allowSleep=(this.m_flags&v.e_allowSleepFlag)==v.e_allowSleepFlag,t.angle=this.GetAngle(),t.angularDamping=this.m_angularDamping,t.angularVelocity=this.m_angularVelocity,t.fixedRotation=(this.m_flags&v.e_fixedRotationFlag)==v.e_fixedRotationFlag,t.bullet=(this.m_flags&v.e_bulletFlag)==v.e_bulletFlag,t.awake=(this.m_flags&v.e_awakeFlag)==v.e_awakeFlag,t.linearDamping=this.m_linearDamping,t.linearVelocity.SetV(this.GetLinearVelocity()),t.position=this.GetPosition(),t.userData=this.GetUserData(),t},v.prototype.ApplyForce=function(t,e){this.m_type==v.b2_dynamicBody&&(0==this.IsAwake()&&this.SetAwake(!0),this.m_force.x+=t.x,this.m_force.y+=t.y,this.m_torque+=(e.x-this.m_sweep.c.x)*t.y-(e.y-this.m_sweep.c.y)*t.x)},v.prototype.ApplyTorque=function(t){void 0===t&&(t=0),this.m_type==v.b2_dynamicBody&&(0==this.IsAwake()&&this.SetAwake(!0),this.m_torque+=t)},v.prototype.ApplyImpulse=function(t,e){this.m_type==v.b2_dynamicBody&&(0==this.IsAwake()&&this.SetAwake(!0),this.m_linearVelocity.x+=this.m_invMass*t.x,this.m_linearVelocity.y+=this.m_invMass*t.y,this.m_angularVelocity+=this.m_invI*((e.x-this.m_sweep.c.x)*t.y-(e.y-this.m_sweep.c.y)*t.x))},v.prototype.Split=function(e){for(var i,n=this.GetLinearVelocity().Copy(),r=this.GetAngularVelocity(),o=this.GetWorldCenter(),s=this,a=this.m_world.CreateBody(this.GetDefinition()),l=s.m_fixtureList;l;)if(e(l)){var c=l.m_next;i?i.m_next=c:s.m_fixtureList=c,s.m_fixtureCount--,l.m_next=a.m_fixtureList,a.m_fixtureList=l,a.m_fixtureCount++,l.m_body=a,l=c}else i=l,l=l.m_next;s.ResetMassData(),a.ResetMassData();var u=s.GetWorldCenter(),h=a.GetWorldCenter(),p=t.AddVV(n,t.CrossFV(r,t.SubtractVV(u,o))),m=t.AddVV(n,t.CrossFV(r,t.SubtractVV(h,o)));return s.SetLinearVelocity(p),a.SetLinearVelocity(m),s.SetAngularVelocity(r),a.SetAngularVelocity(r),s.SynchronizeFixtures(),a.SynchronizeFixtures(),a},v.prototype.Merge=function(t){var e;for(e=t.m_fixtureList;e;){var i=e.m_next;t.m_fixtureCount--,e.m_next=this.m_fixtureList,this.m_fixtureList=e,this.m_fixtureCount++,e.m_body=r,e=i}n.m_fixtureCount=0;var n=this,r=t;n.GetWorldCenter(),r.GetWorldCenter(),n.GetLinearVelocity().Copy(),r.GetLinearVelocity().Copy(),n.GetAngularVelocity(),r.GetAngularVelocity();n.ResetMassData(),this.SynchronizeFixtures()},v.prototype.GetMass=function(){return this.m_mass},v.prototype.GetInertia=function(){return this.m_I},v.prototype.GetMassData=function(t){t.mass=this.m_mass,t.I=this.m_I,t.center.SetV(this.m_sweep.localCenter)},v.prototype.SetMassData=function(e){if(l.b2Assert(0==this.m_world.IsLocked()),1!=this.m_world.IsLocked()&&this.m_type==v.b2_dynamicBody){this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_mass=e.mass,this.m_mass<=0&&(this.m_mass=1),this.m_invMass=1/this.m_mass,e.I>0&&0==(this.m_flags&v.e_fixedRotationFlag)&&(this.m_I=e.I-this.m_mass*(e.center.x*e.center.x+e.center.y*e.center.y),this.m_invI=1/this.m_I);var i=this.m_sweep.c.Copy();this.m_sweep.localCenter.SetV(e.center),this.m_sweep.c0.SetV(t.MulX(this.m_xf,this.m_sweep.localCenter)),this.m_sweep.c.SetV(this.m_sweep.c0),this.m_linearVelocity.x+=this.m_angularVelocity*-(this.m_sweep.c.y-i.y),this.m_linearVelocity.y+=this.m_angularVelocity*+(this.m_sweep.c.x-i.x)}},v.prototype.ResetMassData=function(){if(this.m_mass=0,this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_sweep.localCenter.SetZero(),this.m_type!=v.b2_staticBody&&this.m_type!=v.b2_kinematicBody){for(var e=s.Make(0,0),i=this.m_fixtureList;i;i=i.m_next)if(0!=i.m_density){var n=i.GetMassData();this.m_mass+=n.mass,e.x+=n.center.x*n.mass,e.y+=n.center.y*n.mass,this.m_I+=n.I}this.m_mass>0?(this.m_invMass=1/this.m_mass,e.x*=this.m_invMass,e.y*=this.m_invMass):(this.m_mass=1,this.m_invMass=1),this.m_I>0&&0==(this.m_flags&v.e_fixedRotationFlag)?(this.m_I-=this.m_mass*(e.x*e.x+e.y*e.y),this.m_I*=this.m_inertiaScale,l.b2Assert(this.m_I>0),this.m_invI=1/this.m_I):(this.m_I=0,this.m_invI=0);var r=this.m_sweep.c.Copy();this.m_sweep.localCenter.SetV(e),this.m_sweep.c0.SetV(t.MulX(this.m_xf,this.m_sweep.localCenter)),this.m_sweep.c.SetV(this.m_sweep.c0),this.m_linearVelocity.x+=this.m_angularVelocity*-(this.m_sweep.c.y-r.y),this.m_linearVelocity.y+=this.m_angularVelocity*+(this.m_sweep.c.x-r.x)}},v.prototype.GetWorldPoint=function(t){var e=this.m_xf.R,i=new s(e.col1.x*t.x+e.col2.x*t.y,e.col1.y*t.x+e.col2.y*t.y);return i.x+=this.m_xf.position.x,i.y+=this.m_xf.position.y,i},v.prototype.GetWorldVector=function(e){return t.MulMV(this.m_xf.R,e)},v.prototype.GetLocalPoint=function(e){return t.MulXT(this.m_xf,e)},v.prototype.GetLocalVector=function(e){return t.MulTMV(this.m_xf.R,e)},v.prototype.GetLinearVelocityFromWorldPoint=function(t){return new s(this.m_linearVelocity.x-this.m_angularVelocity*(t.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(t.x-this.m_sweep.c.x))},v.prototype.GetLinearVelocityFromLocalPoint=function(t){var e=this.m_xf.R,i=new s(e.col1.x*t.x+e.col2.x*t.y,e.col1.y*t.x+e.col2.y*t.y);return i.x+=this.m_xf.position.x,i.y+=this.m_xf.position.y,new s(this.m_linearVelocity.x-this.m_angularVelocity*(i.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(i.x-this.m_sweep.c.x))},v.prototype.GetLinearDamping=function(){return this.m_linearDamping},v.prototype.SetLinearDamping=function(t){void 0===t&&(t=0),this.m_linearDamping=t},v.prototype.GetAngularDamping=function(){return this.m_angularDamping},v.prototype.SetAngularDamping=function(t){void 0===t&&(t=0),this.m_angularDamping=t},v.prototype.SetType=function(t){if(void 0===t&&(t=0),this.m_type!=t){this.m_type=t,this.ResetMassData(),this.m_type==v.b2_staticBody&&(this.m_linearVelocity.SetZero(),this.m_angularVelocity=0),this.SetAwake(!0),this.m_force.SetZero(),this.m_torque=0;for(var e=this.m_contactList;e;e=e.next)e.contact.FlagForFiltering()}},v.prototype.GetType=function(){return this.m_type},v.prototype.SetBullet=function(t){t?this.m_flags|=v.e_bulletFlag:this.m_flags&=~v.e_bulletFlag},v.prototype.IsBullet=function(){return(this.m_flags&v.e_bulletFlag)==v.e_bulletFlag},v.prototype.SetSleepingAllowed=function(t){t?this.m_flags|=v.e_allowSleepFlag:(this.m_flags&=~v.e_allowSleepFlag,this.SetAwake(!0))},v.prototype.SetAwake=function(t){t?(this.m_flags|=v.e_awakeFlag,this.m_sleepTime=0):(this.m_flags&=~v.e_awakeFlag,this.m_sleepTime=0,this.m_linearVelocity.SetZero(),this.m_angularVelocity=0,this.m_force.SetZero(),this.m_torque=0)},v.prototype.IsAwake=function(){return(this.m_flags&v.e_awakeFlag)==v.e_awakeFlag},v.prototype.SetFixedRotation=function(t){t?this.m_flags|=v.e_fixedRotationFlag:this.m_flags&=~v.e_fixedRotationFlag,this.ResetMassData()},v.prototype.IsFixedRotation=function(){return(this.m_flags&v.e_fixedRotationFlag)==v.e_fixedRotationFlag},v.prototype.SetActive=function(t){if(t!=this.IsActive()){var e,i;if(t)for(this.m_flags|=v.e_activeFlag,e=this.m_world.m_contactManager.m_broadPhase,i=this.m_fixtureList;i;i=i.m_next)i.CreateProxy(e,this.m_xf);else{for(this.m_flags&=~v.e_activeFlag,e=this.m_world.m_contactManager.m_broadPhase,i=this.m_fixtureList;i;i=i.m_next)i.DestroyProxy(e);for(var n=this.m_contactList;n;){var r=n;n=n.next,this.m_world.m_contactManager.Destroy(r.contact)}this.m_contactList=null}}},v.prototype.IsActive=function(){return(this.m_flags&v.e_activeFlag)==v.e_activeFlag},v.prototype.IsSleepingAllowed=function(){return(this.m_flags&v.e_allowSleepFlag)==v.e_allowSleepFlag},v.prototype.GetFixtureList=function(){return this.m_fixtureList},v.prototype.GetJointList=function(){return this.m_jointList},v.prototype.GetControllerList=function(){return this.m_controllerList},v.prototype.GetContactList=function(){return this.m_contactList},v.prototype.GetNext=function(){return this.m_next},v.prototype.GetUserData=function(){return this.m_userData},v.prototype.SetUserData=function(t){this.m_userData=t},v.prototype.GetWorld=function(){return this.m_world},v.prototype.b2Body=function(t,e){this.m_flags=0,t.bullet&&(this.m_flags|=v.e_bulletFlag),t.fixedRotation&&(this.m_flags|=v.e_fixedRotationFlag),t.allowSleep&&(this.m_flags|=v.e_allowSleepFlag),t.awake&&(this.m_flags|=v.e_awakeFlag),t.active&&(this.m_flags|=v.e_activeFlag),this.m_world=e,this.m_xf.position.SetV(t.position),this.m_xf.R.Set(t.angle),this.m_sweep.localCenter.SetZero(),this.m_sweep.t0=1,this.m_sweep.a0=this.m_sweep.a=t.angle;var i=this.m_xf.R,n=this.m_sweep.localCenter;this.m_sweep.c.x=i.col1.x*n.x+i.col2.x*n.y,this.m_sweep.c.y=i.col1.y*n.x+i.col2.y*n.y,this.m_sweep.c.x+=this.m_xf.position.x,this.m_sweep.c.y+=this.m_xf.position.y,this.m_sweep.c0.SetV(this.m_sweep.c),this.m_jointList=null,this.m_controllerList=null,this.m_contactList=null,this.m_controllerCount=0,this.m_prev=null,this.m_next=null,this.m_linearVelocity.SetV(t.linearVelocity),this.m_angularVelocity=t.angularVelocity,this.m_linearDamping=t.linearDamping,this.m_angularDamping=t.angularDamping,this.m_force.Set(0,0),this.m_torque=0,this.m_sleepTime=0,this.m_type=t.type,this.m_type==v.b2_dynamicBody?(this.m_mass=1,this.m_invMass=1):(this.m_mass=0,this.m_invMass=0),this.m_I=0,this.m_invI=0,this.m_inertiaScale=t.inertiaScale,this.m_userData=t.userData,this.m_fixtureList=null,this.m_fixtureCount=0},v.prototype.SynchronizeFixtures=function(){var t=v.s_xf1;t.R.Set(this.m_sweep.a0);var e=t.R,i=this.m_sweep.localCenter;t.position.x=this.m_sweep.c0.x-(e.col1.x*i.x+e.col2.x*i.y),t.position.y=this.m_sweep.c0.y-(e.col1.y*i.x+e.col2.y*i.y);var n,r=this.m_world.m_contactManager.m_broadPhase;for(n=this.m_fixtureList;n;n=n.m_next)n.Synchronize(r,t,this.m_xf)},v.prototype.SynchronizeTransform=function(){this.m_xf.R.Set(this.m_sweep.a);var t=this.m_xf.R,e=this.m_sweep.localCenter;this.m_xf.position.x=this.m_sweep.c.x-(t.col1.x*e.x+t.col2.x*e.y),this.m_xf.position.y=this.m_sweep.c.y-(t.col1.y*e.x+t.col2.y*e.y)},v.prototype.ShouldCollide=function(t){if(this.m_type!=v.b2_dynamicBody&&t.m_type!=v.b2_dynamicBody)return!1;for(var e=this.m_jointList;e;e=e.next)if(e.other==t&&0==e.joint.m_collideConnected)return!1;return!0},v.prototype.Advance=function(t){void 0===t&&(t=0),this.m_sweep.Advance(t),this.m_sweep.c.SetV(this.m_sweep.c0),this.m_sweep.a=this.m_sweep.a0,this.SynchronizeTransform()},n.postDefs.push(function(){n.Dynamics.b2Body.s_xf1=new i,n.Dynamics.b2Body.e_islandFlag=1,n.Dynamics.b2Body.e_awakeFlag=2,n.Dynamics.b2Body.e_allowSleepFlag=4,n.Dynamics.b2Body.e_bulletFlag=8,n.Dynamics.b2Body.e_fixedRotationFlag=16,n.Dynamics.b2Body.e_activeFlag=32,n.Dynamics.b2Body.b2_staticBody=0,n.Dynamics.b2Body.b2_kinematicBody=1,n.Dynamics.b2Body.b2_dynamicBody=2}),x.b2BodyDef=function(){this.position=new s,this.linearVelocity=new s},x.prototype.b2BodyDef=function(){this.userData=null,this.position.Set(0,0),this.angle=0,this.linearVelocity.Set(0,0),this.angularVelocity=0,this.linearDamping=0,this.angularDamping=0,this.allowSleep=!0,this.awake=!0,this.fixedRotation=!1,this.bullet=!1,this.type=v.b2_staticBody,this.active=!0,this.inertiaScale=1},b.b2ContactFilter=function(){},b.prototype.ShouldCollide=function(t,e){var i=t.GetFilterData(),n=e.GetFilterData();return i.groupIndex==n.groupIndex&&0!=i.groupIndex?i.groupIndex>0:0!=(i.maskBits&n.categoryBits)&&0!=(i.categoryBits&n.maskBits)},b.prototype.RayCollide=function(t,e){return!t||this.ShouldCollide(t instanceof T?t:null,e)},n.postDefs.push(function(){n.Dynamics.b2ContactFilter.b2_defaultFilter=new b}),w.b2ContactImpulse=function(){this.normalImpulses=new o(l.b2_maxManifoldPoints),this.tangentImpulses=new o(l.b2_maxManifoldPoints)},C.b2ContactListener=function(){},C.prototype.BeginContact=function(t){},C.prototype.EndContact=function(t){},C.prototype.PreSolve=function(t,e){},C.prototype.PostSolve=function(t,e){},n.postDefs.push(function(){n.Dynamics.b2ContactListener.b2_defaultListener=new C}),S.b2ContactManager=function(){},S.prototype.b2ContactManager=function(){this.m_world=null,this.m_contactCount=0,this.m_contactFilter=b.b2_defaultFilter,this.m_contactListener=C.b2_defaultListener,this.m_contactFactory=new L(this.m_allocator),this.m_broadPhase=new h},S.prototype.AddPair=function(t,e){var i=t instanceof T?t:null,n=e instanceof T?e:null,r=i.GetBody(),o=n.GetBody();if(r!=o){for(var s=o.GetContactList();s;){if(s.other==r){var a=s.contact.GetFixtureA(),l=s.contact.GetFixtureB();if(a==i&&l==n)return;if(a==n&&l==i)return}s=s.next}if(0!=o.ShouldCollide(r)&&0!=this.m_contactFilter.ShouldCollide(i,n)){var c=this.m_contactFactory.Create(i,n);i=c.GetFixtureA(),n=c.GetFixtureB(),r=i.m_body,o=n.m_body,c.m_prev=null,c.m_next=this.m_world.m_contactList,null!=this.m_world.m_contactList&&(this.m_world.m_contactList.m_prev=c),this.m_world.m_contactList=c,c.m_nodeA.contact=c,c.m_nodeA.other=o,c.m_nodeA.prev=null,c.m_nodeA.next=r.m_contactList,null!=r.m_contactList&&(r.m_contactList.prev=c.m_nodeA),r.m_contactList=c.m_nodeA,c.m_nodeB.contact=c,c.m_nodeB.other=r,c.m_nodeB.prev=null,c.m_nodeB.next=o.m_contactList,null!=o.m_contactList&&(o.m_contactList.prev=c.m_nodeB),o.m_contactList=c.m_nodeB,++this.m_world.m_contactCount}}},S.prototype.FindNewContacts=function(){this.m_broadPhase.UpdatePairs(n.generateCallback(this,this.AddPair))},S.prototype.Destroy=function(t){var e=t.GetFixtureA(),i=t.GetFixtureB(),n=e.GetBody(),r=i.GetBody();t.IsTouching()&&this.m_contactListener.EndContact(t),t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_world.m_contactList&&(this.m_world.m_contactList=t.m_next),t.m_nodeA.prev&&(t.m_nodeA.prev.next=t.m_nodeA.next),t.m_nodeA.next&&(t.m_nodeA.next.prev=t.m_nodeA.prev),t.m_nodeA==n.m_contactList&&(n.m_contactList=t.m_nodeA.next),t.m_nodeB.prev&&(t.m_nodeB.prev.next=t.m_nodeB.next),t.m_nodeB.next&&(t.m_nodeB.next.prev=t.m_nodeB.prev),t.m_nodeB==r.m_contactList&&(r.m_contactList=t.m_nodeB.next),this.m_contactFactory.Destroy(t),--this.m_contactCount},S.prototype.Collide=function(){for(var t=this.m_world.m_contactList;t;){var e=t.GetFixtureA(),i=t.GetFixtureB(),n=e.GetBody(),r=i.GetBody();if(0!=n.IsAwake()||0!=r.IsAwake()){if(t.m_flags&E.e_filterFlag){if(0==r.ShouldCollide(n)){var o=t;t=o.GetNext(),this.Destroy(o);continue}if(0==this.m_contactFilter.ShouldCollide(e,i)){o=t,t=o.GetNext(),this.Destroy(o);continue}t.m_flags&=~E.e_filterFlag}var s=e.m_proxy,a=i.m_proxy;0!=this.m_broadPhase.TestOverlap(s,a)?(t.Update(this.m_contactListener),t=t.GetNext()):(o=t,t=o.GetNext(),this.Destroy(o))}else t=t.GetNext()}},n.postDefs.push(function(){n.Dynamics.b2ContactManager.s_evalCP=new u}),A.b2DebugDraw=function(){},A.prototype.b2DebugDraw=function(){},A.prototype.SetFlags=function(t){void 0===t&&(t=0)},A.prototype.GetFlags=function(){},A.prototype.AppendFlags=function(t){void 0===t&&(t=0)},A.prototype.ClearFlags=function(t){void 0===t&&(t=0)},A.prototype.SetSprite=function(t){},A.prototype.GetSprite=function(){},A.prototype.SetDrawScale=function(t){void 0===t&&(t=0)},A.prototype.GetDrawScale=function(){},A.prototype.SetLineThickness=function(t){void 0===t&&(t=0)},A.prototype.GetLineThickness=function(){},A.prototype.SetAlpha=function(t){void 0===t&&(t=0)},A.prototype.GetAlpha=function(){},A.prototype.SetFillAlpha=function(t){void 0===t&&(t=0)},A.prototype.GetFillAlpha=function(){},A.prototype.SetXFormScale=function(t){void 0===t&&(t=0)},A.prototype.GetXFormScale=function(){},A.prototype.DrawPolygon=function(t,e,i){void 0===e&&(e=0)},A.prototype.DrawSolidPolygon=function(t,e,i){void 0===e&&(e=0)},A.prototype.DrawCircle=function(t,e,i){void 0===e&&(e=0)},A.prototype.DrawSolidCircle=function(t,e,i,n){void 0===e&&(e=0)},A.prototype.DrawSegment=function(t,e,i){},A.prototype.DrawTransform=function(t){},n.postDefs.push(function(){n.Dynamics.b2DebugDraw.e_shapeBit=1,n.Dynamics.b2DebugDraw.e_jointBit=2,n.Dynamics.b2DebugDraw.e_aabbBit=4,n.Dynamics.b2DebugDraw.e_pairBit=8,n.Dynamics.b2DebugDraw.e_centerOfMassBit=16,n.Dynamics.b2DebugDraw.e_controllerBit=32}),D.b2DestructionListener=function(){},D.prototype.SayGoodbyeJoint=function(t){},D.prototype.SayGoodbyeFixture=function(t){},M.b2FilterData=function(){this.categoryBits=1,this.maskBits=65535,this.groupIndex=0},M.prototype.Copy=function(){var t=new M;return t.categoryBits=this.categoryBits,t.maskBits=this.maskBits,t.groupIndex=this.groupIndex,t},T.b2Fixture=function(){this.m_filter=new M},T.prototype.GetType=function(){return this.m_shape.GetType()},T.prototype.GetShape=function(){return this.m_shape},T.prototype.SetSensor=function(t){if(this.m_isSensor!=t&&(this.m_isSensor=t,null!=this.m_body))for(var e=this.m_body.GetContactList();e;){var i=e.contact,n=i.GetFixtureA(),r=i.GetFixtureB();n!=this&&r!=this||i.SetSensor(n.IsSensor()||r.IsSensor()),e=e.next}},T.prototype.IsSensor=function(){return this.m_isSensor},T.prototype.SetFilterData=function(t){if(this.m_filter=t.Copy(),!this.m_body)for(var e=this.m_body.GetContactList();e;){var i=e.contact,n=i.GetFixtureA(),r=i.GetFixtureB();n!=this&&r!=this||i.FlagForFiltering(),e=e.next}},T.prototype.GetFilterData=function(){return this.m_filter.Copy()},T.prototype.GetBody=function(){return this.m_body},T.prototype.GetNext=function(){return this.m_next},T.prototype.GetUserData=function(){return this.m_userData},T.prototype.SetUserData=function(t){this.m_userData=t},T.prototype.TestPoint=function(t){return this.m_shape.TestPoint(this.m_body.GetTransform(),t)},T.prototype.RayCast=function(t,e){return this.m_shape.RayCast(t,e,this.m_body.GetTransform())},T.prototype.GetMassData=function(t){return void 0===t&&(t=null),null==t&&(t=new d),this.m_shape.ComputeMass(t,this.m_density),t},T.prototype.SetDensity=function(t){void 0===t&&(t=0),this.m_density=t},T.prototype.GetDensity=function(){return this.m_density},T.prototype.GetFriction=function(){return this.m_friction},T.prototype.SetFriction=function(t){void 0===t&&(t=0),this.m_friction=t},T.prototype.GetRestitution=function(){return this.m_restitution},T.prototype.SetRestitution=function(t){void 0===t&&(t=0),this.m_restitution=t},T.prototype.GetAABB=function(){return this.m_aabb},T.prototype.b2Fixture=function(){this.m_aabb=new c,this.m_userData=null,this.m_body=null,this.m_next=null,this.m_shape=null,this.m_density=0,this.m_friction=0,this.m_restitution=0},T.prototype.Create=function(t,e,i){this.m_userData=i.userData,this.m_friction=i.friction,this.m_restitution=i.restitution,this.m_body=t,this.m_next=null,this.m_filter=i.filter.Copy(),this.m_isSensor=i.isSensor,this.m_shape=i.shape.Copy(),this.m_density=i.density},T.prototype.Destroy=function(){this.m_shape=null},T.prototype.CreateProxy=function(t,e){this.m_shape.ComputeAABB(this.m_aabb,e),this.m_proxy=t.CreateProxy(this.m_aabb,this)},T.prototype.DestroyProxy=function(t){null!=this.m_proxy&&(t.DestroyProxy(this.m_proxy),this.m_proxy=null)},T.prototype.Synchronize=function(e,i,n){if(this.m_proxy){var r=new c,o=new c;this.m_shape.ComputeAABB(r,i),this.m_shape.ComputeAABB(o,n),this.m_aabb.Combine(r,o);var s=t.SubtractVV(n.position,i.position);e.MoveProxy(this.m_proxy,this.m_aabb,s)}},k.b2FixtureDef=function(){this.filter=new M},k.prototype.b2FixtureDef=function(){this.shape=null,this.userData=null,this.friction=.2,this.restitution=0,this.density=0,this.filter.categoryBits=1,this.filter.maskBits=65535,this.filter.groupIndex=0,this.isSensor=!1},I.b2Island=function(){},I.prototype.b2Island=function(){this.m_bodies=new r,this.m_contacts=new r,this.m_joints=new r},I.prototype.Initialize=function(t,e,i,n,r,o){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0);var s=0;for(this.m_bodyCapacity=t,this.m_contactCapacity=e,this.m_jointCapacity=i,this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0,this.m_allocator=n,this.m_listener=r,this.m_contactSolver=o,s=this.m_bodies.length;s<t;s++)this.m_bodies[s]=null;for(s=this.m_contacts.length;s<e;s++)this.m_contacts[s]=null;for(s=this.m_joints.length;s<i;s++)this.m_joints[s]=null},I.prototype.Clear=function(){this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0},I.prototype.Solve=function(e,i,n){var r,o,s=0,a=0;for(s=0;s<this.m_bodyCount;++s)r=this.m_bodies[s],r.GetType()==v.b2_dynamicBody&&(r.m_linearVelocity.x+=e.dt*(i.x+r.m_invMass*r.m_force.x),r.m_linearVelocity.y+=e.dt*(i.y+r.m_invMass*r.m_force.y),r.m_angularVelocity+=e.dt*r.m_invI*r.m_torque,r.m_linearVelocity.Multiply(t.Clamp(1-e.dt*r.m_linearDamping,0,1)),r.m_angularVelocity*=t.Clamp(1-e.dt*r.m_angularDamping,0,1));this.m_contactSolver.Initialize(e,this.m_contacts,this.m_contactCount,this.m_allocator);var c=this.m_contactSolver;for(c.InitVelocityConstraints(e),s=0;s<this.m_jointCount;++s)o=this.m_joints[s],o.InitVelocityConstraints(e);for(s=0;s<e.velocityIterations;++s){for(a=0;a<this.m_jointCount;++a)o=this.m_joints[a],o.SolveVelocityConstraints(e);c.SolveVelocityConstraints()}for(s=0;s<this.m_jointCount;++s)o=this.m_joints[s],o.FinalizeVelocityConstraints();for(c.FinalizeVelocityConstraints(),s=0;s<this.m_bodyCount;++s)if(r=this.m_bodies[s],r.GetType()!=v.b2_staticBody){var u=e.dt*r.m_linearVelocity.x,h=e.dt*r.m_linearVelocity.y;u*u+h*h>l.b2_maxTranslationSquared&&(r.m_linearVelocity.Normalize(),r.m_linearVelocity.x*=l.b2_maxTranslation*e.inv_dt,r.m_linearVelocity.y*=l.b2_maxTranslation*e.inv_dt);var p=e.dt*r.m_angularVelocity;p*p>l.b2_maxRotationSquared&&(r.m_angularVelocity<0?r.m_angularVelocity=-l.b2_maxRotation*e.inv_dt:r.m_angularVelocity=l.b2_maxRotation*e.inv_dt),r.m_sweep.c0.SetV(r.m_sweep.c),r.m_sweep.a0=r.m_sweep.a,r.m_sweep.c.x+=e.dt*r.m_linearVelocity.x,r.m_sweep.c.y+=e.dt*r.m_linearVelocity.y,r.m_sweep.a+=e.dt*r.m_angularVelocity,r.SynchronizeTransform()}for(s=0;s<e.positionIterations;++s){var m=c.SolvePositionConstraints(l.b2_contactBaumgarte),f=!0;for(a=0;a<this.m_jointCount;++a){o=this.m_joints[a];var _=o.SolvePositionConstraints(l.b2_contactBaumgarte);f=f&&_}if(m&&f)break}if(this.Report(c.m_constraints),n){var d=Number.MAX_VALUE,y=l.b2_linearSleepTolerance*l.b2_linearSleepTolerance,g=l.b2_angularSleepTolerance*l.b2_angularSleepTolerance;for(s=0;s<this.m_bodyCount;++s)r=this.m_bodies[s],r.GetType()!=v.b2_staticBody&&(0==(r.m_flags&v.e_allowSleepFlag)&&(r.m_sleepTime=0,d=0),0==(r.m_flags&v.e_allowSleepFlag)||r.m_angularVelocity*r.m_angularVelocity>g||t.Dot(r.m_linearVelocity,r.m_linearVelocity)>y?(r.m_sleepTime=0,d=0):(r.m_sleepTime+=e.dt,d=t.Min(d,r.m_sleepTime)));if(d>=l.b2_timeToSleep)for(s=0;s<this.m_bodyCount;++s)r=this.m_bodies[s],r.SetAwake(!1)}},I.prototype.SolveTOI=function(t){var e=0,i=0;this.m_contactSolver.Initialize(t,this.m_contacts,this.m_contactCount,this.m_allocator);var n=this.m_contactSolver;for(e=0;e<this.m_jointCount;++e)this.m_joints[e].InitVelocityConstraints(t);for(e=0;e<t.velocityIterations;++e)for(n.SolveVelocityConstraints(),i=0;i<this.m_jointCount;++i)this.m_joints[i].SolveVelocityConstraints(t);for(e=0;e<this.m_bodyCount;++e){var r=this.m_bodies[e];if(r.GetType()!=v.b2_staticBody){var o=t.dt*r.m_linearVelocity.x,s=t.dt*r.m_linearVelocity.y;o*o+s*s>l.b2_maxTranslationSquared&&(r.m_linearVelocity.Normalize(),r.m_linearVelocity.x*=l.b2_maxTranslation*t.inv_dt,r.m_linearVelocity.y*=l.b2_maxTranslation*t.inv_dt);var a=t.dt*r.m_angularVelocity;a*a>l.b2_maxRotationSquared&&(r.m_angularVelocity<0?r.m_angularVelocity=-l.b2_maxRotation*t.inv_dt:r.m_angularVelocity=l.b2_maxRotation*t.inv_dt),r.m_sweep.c0.SetV(r.m_sweep.c),r.m_sweep.a0=r.m_sweep.a,r.m_sweep.c.x+=t.dt*r.m_linearVelocity.x,r.m_sweep.c.y+=t.dt*r.m_linearVelocity.y,r.m_sweep.a+=t.dt*r.m_angularVelocity,r.SynchronizeTransform()}}for(e=0;e<t.positionIterations;++e){var c=n.SolvePositionConstraints(.75),u=!0;for(i=0;i<this.m_jointCount;++i){var h=this.m_joints[i].SolvePositionConstraints(l.b2_contactBaumgarte);u=u&&h}if(c&&u)break}this.Report(n.m_constraints)},I.prototype.Report=function(t){if(null!=this.m_listener)for(var e=0;e<this.m_contactCount;++e){for(var i=this.m_contacts[e],n=t[e],r=0;r<n.pointCount;++r)I.s_impulse.normalImpulses[r]=n.points[r].normalImpulse,I.s_impulse.tangentImpulses[r]=n.points[r].tangentImpulse;this.m_listener.PostSolve(i,I.s_impulse)}},I.prototype.AddBody=function(t){t.m_islandIndex=this.m_bodyCount,this.m_bodies[this.m_bodyCount++]=t},I.prototype.AddContact=function(t){this.m_contacts[this.m_contactCount++]=t},I.prototype.AddJoint=function(t){this.m_joints[this.m_jointCount++]=t},n.postDefs.push(function(){n.Dynamics.b2Island.s_impulse=new w}),P.b2TimeStep=function(){},P.prototype.Set=function(t){this.dt=t.dt,this.inv_dt=t.inv_dt,this.positionIterations=t.positionIterations,this.velocityIterations=t.velocityIterations,this.warmStarting=t.warmStarting},B.b2World=function(){this.s_stack=new r,this.m_contactManager=new S,this.m_contactSolver=new R,this.m_island=new I},B.prototype.b2World=function(t,e){this.m_destructionListener=null,this.m_debugDraw=null,this.m_bodyList=null,this.m_contactList=null,this.m_jointList=null,this.m_controllerList=null,this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0,this.m_controllerCount=0,B.m_warmStarting=!0,B.m_continuousPhysics=!0,this.m_allowSleep=e,this.m_gravity=t,this.m_inv_dt0=0,this.m_contactManager.m_world=this;var i=new x;this.m_groundBody=this.CreateBody(i)},B.prototype.SetDestructionListener=function(t){this.m_destructionListener=t},B.prototype.SetContactFilter=function(t){this.m_contactManager.m_contactFilter=t},B.prototype.SetContactListener=function(t){this.m_contactManager.m_contactListener=t},B.prototype.SetDebugDraw=function(t){this.m_debugDraw=t},B.prototype.SetBroadPhase=function(t){var e=this.m_contactManager.m_broadPhase;this.m_contactManager.m_broadPhase=t;for(var i=this.m_bodyList;i;i=i.m_next)for(var n=i.m_fixtureList;n;n=n.m_next)n.m_proxy=t.CreateProxy(e.GetFatAABB(n.m_proxy),n)},B.prototype.Validate=function(){this.m_contactManager.m_broadPhase.Validate()},B.prototype.GetProxyCount=function(){return this.m_contactManager.m_broadPhase.GetProxyCount()},B.prototype.CreateBody=function(t){if(1==this.IsLocked())return null;var e=new v(t,this);return e.m_prev=null,e.m_next=this.m_bodyList,this.m_bodyList&&(this.m_bodyList.m_prev=e),this.m_bodyList=e,++this.m_bodyCount,e},B.prototype.DestroyBody=function(t){if(1!=this.IsLocked()){for(var e=t.m_jointList;e;){var i=e;e=e.next,this.m_destructionListener&&this.m_destructionListener.SayGoodbyeJoint(i.joint),this.DestroyJoint(i.joint)}for(var n=t.m_controllerList;n;){var r=n;n=n.nextController,r.controller.RemoveBody(t)}for(var o=t.m_contactList;o;){var s=o;o=o.next,this.m_contactManager.Destroy(s.contact)}t.m_contactList=null;for(var a=t.m_fixtureList;a;){var l=a;a=a.m_next,this.m_destructionListener&&this.m_destructionListener.SayGoodbyeFixture(l),l.DestroyProxy(this.m_contactManager.m_broadPhase),l.Destroy()}t.m_fixtureList=null,t.m_fixtureCount=0,t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_bodyList&&(this.m_bodyList=t.m_next),--this.m_bodyCount}},B.prototype.CreateJoint=function(t){var e=V.Create(t,null);e.m_prev=null,e.m_next=this.m_jointList,this.m_jointList&&(this.m_jointList.m_prev=e),this.m_jointList=e,++this.m_jointCount,e.m_edgeA.joint=e,e.m_edgeA.other=e.m_bodyB,e.m_edgeA.prev=null,e.m_edgeA.next=e.m_bodyA.m_jointList,e.m_bodyA.m_jointList&&(e.m_bodyA.m_jointList.prev=e.m_edgeA),e.m_bodyA.m_jointList=e.m_edgeA,e.m_edgeB.joint=e,e.m_edgeB.other=e.m_bodyA,e.m_edgeB.prev=null,e.m_edgeB.next=e.m_bodyB.m_jointList,e.m_bodyB.m_jointList&&(e.m_bodyB.m_jointList.prev=e.m_edgeB),e.m_bodyB.m_jointList=e.m_edgeB;var i=t.bodyA,n=t.bodyB;if(0==t.collideConnected)for(var r=n.GetContactList();r;)r.other==i&&r.contact.FlagForFiltering(),r=r.next;return e},B.prototype.DestroyJoint=function(t){var e=t.m_collideConnected;t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_jointList&&(this.m_jointList=t.m_next);var i=t.m_bodyA,n=t.m_bodyB;if(i.SetAwake(!0),n.SetAwake(!0),t.m_edgeA.prev&&(t.m_edgeA.prev.next=t.m_edgeA.next),t.m_edgeA.next&&(t.m_edgeA.next.prev=t.m_edgeA.prev),t.m_edgeA==i.m_jointList&&(i.m_jointList=t.m_edgeA.next),t.m_edgeA.prev=null,t.m_edgeA.next=null,t.m_edgeB.prev&&(t.m_edgeB.prev.next=t.m_edgeB.next),t.m_edgeB.next&&(t.m_edgeB.next.prev=t.m_edgeB.prev),t.m_edgeB==n.m_jointList&&(n.m_jointList=t.m_edgeB.next),t.m_edgeB.prev=null,t.m_edgeB.next=null,V.Destroy(t,null),--this.m_jointCount,0==e)for(var r=n.GetContactList();r;)r.other==i&&r.contact.FlagForFiltering(),r=r.next},B.prototype.AddController=function(t){return t.m_next=this.m_controllerList,t.m_prev=null,this.m_controllerList=t,t.m_world=this,this.m_controllerCount++,t},B.prototype.RemoveController=function(t){t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),this.m_controllerList==t&&(this.m_controllerList=t.m_next),this.m_controllerCount--},B.prototype.CreateController=function(t){if(t.m_world!=this)throw new Error("Controller can only be a member of one world");return t.m_next=this.m_controllerList,t.m_prev=null,this.m_controllerList&&(this.m_controllerList.m_prev=t),this.m_controllerList=t,++this.m_controllerCount,t.m_world=this,t},B.prototype.DestroyController=function(t){t.Clear(),t.m_next&&(t.m_next.m_prev=t.m_prev),t.m_prev&&(t.m_prev.m_next=t.m_next),t==this.m_controllerList&&(this.m_controllerList=t.m_next),--this.m_controllerCount},B.prototype.SetWarmStarting=function(t){B.m_warmStarting=t},B.prototype.SetContinuousPhysics=function(t){B.m_continuousPhysics=t},B.prototype.GetBodyCount=function(){return this.m_bodyCount},B.prototype.GetJointCount=function(){return this.m_jointCount},B.prototype.GetContactCount=function(){return this.m_contactCount},B.prototype.SetGravity=function(t){this.m_gravity=t},B.prototype.GetGravity=function(){return this.m_gravity},B.prototype.GetGroundBody=function(){return this.m_groundBody},B.prototype.Step=function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.m_flags&B.e_newFixture&&(this.m_contactManager.FindNewContacts(),this.m_flags&=~B.e_newFixture),this.m_flags|=B.e_locked;var n=B.s_timestep2;n.dt=t,n.velocityIterations=e,n.positionIterations=i,n.inv_dt=t>0?1/t:0,n.dtRatio=this.m_inv_dt0*t,n.warmStarting=B.m_warmStarting,this.m_contactManager.Collide(),n.dt>0&&this.Solve(n),B.m_continuousPhysics&&n.dt>0&&this.SolveTOI(n),n.dt>0&&(this.m_inv_dt0=n.inv_dt),this.m_flags&=~B.e_locked},B.prototype.ClearForces=function(){for(var t=this.m_bodyList;t;t=t.m_next)t.m_force.SetZero(),t.m_torque=0},B.prototype.DrawDebugData=function(){if(null!=this.m_debugDraw){this.m_debugDraw.m_sprite.graphics.clear();var t,e,i,n,r,o,l=this.m_debugDraw.GetFlags(),u=(new s,new s,new s,new c,new c,[new s,new s,new s,new s]),h=new a(0,0,0);if(l&A.e_shapeBit)for(t=this.m_bodyList;t;t=t.m_next)for(o=t.m_xf,e=t.GetFixtureList();e;e=e.m_next)i=e.GetShape(),0==t.IsActive()?(h.Set(.5,.5,.3),this.DrawShape(i,o,h)):t.GetType()==v.b2_staticBody?(h.Set(.5,.9,.5),this.DrawShape(i,o,h)):t.GetType()==v.b2_kinematicBody?(h.Set(.5,.5,.9),this.DrawShape(i,o,h)):0==t.IsAwake()?(h.Set(.6,.6,.6),this.DrawShape(i,o,h)):(h.Set(.9,.7,.7),this.DrawShape(i,o,h));if(l&A.e_jointBit)for(n=this.m_jointList;n;n=n.m_next)this.DrawJoint(n);if(l&A.e_controllerBit)for(var p=this.m_controllerList;p;p=p.m_next)p.Draw(this.m_debugDraw);if(l&A.e_pairBit){h.Set(.3,.9,.9);for(var m=this.m_contactManager.m_contactList;m;m=m.GetNext()){var f=m.GetFixtureA(),_=m.GetFixtureB(),d=f.GetAABB().GetCenter(),y=_.GetAABB().GetCenter();this.m_debugDraw.DrawSegment(d,y,h)}}if(l&A.e_aabbBit)for(r=this.m_contactManager.m_broadPhase,u=[new s,new s,new s,new s],t=this.m_bodyList;t;t=t.GetNext())if(0!=t.IsActive())for(e=t.GetFixtureList();e;e=e.GetNext()){var g=r.GetFatAABB(e.m_proxy);u[0].Set(g.lowerBound.x,g.lowerBound.y),u[1].Set(g.upperBound.x,g.lowerBound.y),u[2].Set(g.upperBound.x,g.upperBound.y),u[3].Set(g.lowerBound.x,g.upperBound.y),this.m_debugDraw.DrawPolygon(u,4,h)}if(l&A.e_centerOfMassBit)for(t=this.m_bodyList;t;t=t.m_next)o=B.s_xf,o.R=t.m_xf.R,o.position=t.GetWorldCenter(),this.m_debugDraw.DrawTransform(o)}},B.prototype.QueryAABB=function(t,e){function i(e){return t(r.GetUserData(e))}var n=this,r=n.m_contactManager.m_broadPhase;r.Query(i,e)},B.prototype.QueryShape=function(t,e,n){function r(i){var r=s.GetUserData(i)instanceof T?s.GetUserData(i):null;return!g.TestOverlap(e,n,r.GetShape(),r.GetBody().GetTransform())||t(r)}var o=this;void 0===n&&(n=null),null==n&&(n=new i,n.SetIdentity());var s=o.m_contactManager.m_broadPhase,a=new c;e.ComputeAABB(a,n),s.Query(r,a)},B.prototype.QueryPoint=function(t,e){function i(i){var n=r.GetUserData(i)instanceof T?r.GetUserData(i):null;return!n.TestPoint(e)||t(n)}var n=this,r=n.m_contactManager.m_broadPhase,o=new c;o.lowerBound.Set(e.x-l.b2_linearSlop,e.y-l.b2_linearSlop),o.upperBound.Set(e.x+l.b2_linearSlop,e.y+l.b2_linearSlop),r.Query(i,o)},B.prototype.RayCast=function(t,e,i){function n(n,r){var l=o.GetUserData(r),c=l instanceof T?l:null;if(c.RayCast(a,n)){var u=a.fraction,h=new s((1-u)*e.x+u*i.x,(1-u)*e.y+u*i.y);return t(c,h,a.normal,u)}return n.maxFraction}var r=this,o=r.m_contactManager.m_broadPhase,a=new m,l=new p(e,i);o.RayCast(n,l)},B.prototype.RayCastOne=function(t,e){function i(t,e,i,r){return void 0===r&&(r=0),n=t,r}var n,r=this;return r.RayCast(i,t,e),n},B.prototype.RayCastAll=function(t,e){function i(t,e,i,n){return void 0===n&&(n=0),o[o.length]=t,1}var n=this,o=new r;return n.RayCast(i,t,e),o},B.prototype.GetBodyList=function(){return this.m_bodyList},B.prototype.GetJointList=function(){return this.m_jointList},B.prototype.GetContactList=function(){return this.m_contactList},B.prototype.IsLocked=function(){return(this.m_flags&B.e_locked)>0},B.prototype.Solve=function(t){for(var e,i=this.m_controllerList;i;i=i.m_next)i.Step(t);var n=this.m_island;for(n.Initialize(this.m_bodyCount,this.m_contactCount,this.m_jointCount,null,this.m_contactManager.m_contactListener,this.m_contactSolver),e=this.m_bodyList;e;e=e.m_next)e.m_flags&=~v.e_islandFlag;for(var r=this.m_contactList;r;r=r.m_next)r.m_flags&=~E.e_islandFlag;for(var o=this.m_jointList;o;o=o.m_next)o.m_islandFlag=!1;for(var s=(parseInt(this.m_bodyCount),this.s_stack),a=this.m_bodyList;a;a=a.m_next)if(!(a.m_flags&v.e_islandFlag)&&0!=a.IsAwake()&&0!=a.IsActive()&&a.GetType()!=v.b2_staticBody){n.Clear();var l=0;for(s[l++]=a,a.m_flags|=v.e_islandFlag;l>0;)if(e=s[--l],n.AddBody(e),0==e.IsAwake()&&e.SetAwake(!0),e.GetType()!=v.b2_staticBody){for(var c,u=e.m_contactList;u;u=u.next)u.contact.m_flags&E.e_islandFlag||1!=u.contact.IsSensor()&&0!=u.contact.IsEnabled()&&0!=u.contact.IsTouching()&&(n.AddContact(u.contact),u.contact.m_flags|=E.e_islandFlag,c=u.other,c.m_flags&v.e_islandFlag||(s[l++]=c,c.m_flags|=v.e_islandFlag));for(var h=e.m_jointList;h;h=h.next)1!=h.joint.m_islandFlag&&(c=h.other,0!=c.IsActive()&&(n.AddJoint(h.joint),h.joint.m_islandFlag=!0,c.m_flags&v.e_islandFlag||(s[l++]=c,c.m_flags|=v.e_islandFlag)))}n.Solve(t,this.m_gravity,this.m_allowSleep);for(var p=0;p<n.m_bodyCount;++p)e=n.m_bodies[p],e.GetType()==v.b2_staticBody&&(e.m_flags&=~v.e_islandFlag)}for(p=0;p<s.length&&s[p];++p)s[p]=null;for(e=this.m_bodyList;e;e=e.m_next)0!=e.IsAwake()&&0!=e.IsActive()&&e.GetType()!=v.b2_staticBody&&e.SynchronizeFixtures();this.m_contactManager.FindNewContacts()},B.prototype.SolveTOI=function(t){var e,i,n,r,o,s,a,c=this.m_island;c.Initialize(this.m_bodyCount,l.b2_maxTOIContactsPerIsland,l.b2_maxTOIJointsPerIsland,null,this.m_contactManager.m_contactListener,this.m_contactSolver);var u=B.s_queue;for(e=this.m_bodyList;e;e=e.m_next)e.m_flags&=~v.e_islandFlag,e.m_sweep.t0=0;var h;for(h=this.m_contactList;h;h=h.m_next)h.m_flags&=~(E.e_toiFlag|E.e_islandFlag);for(a=this.m_jointList;a;a=a.m_next)a.m_islandFlag=!1;for(;;){var p=null,m=1;for(h=this.m_contactList;h;h=h.m_next)if(1!=h.IsSensor()&&0!=h.IsEnabled()&&0!=h.IsContinuous()){var f=1;if(h.m_flags&E.e_toiFlag)f=h.m_toi;else{if(i=h.m_fixtureA,n=h.m_fixtureB,r=i.m_body,o=n.m_body,!(r.GetType()==v.b2_dynamicBody&&0!=r.IsAwake()||o.GetType()==v.b2_dynamicBody&&0!=o.IsAwake()))continue;var _=r.m_sweep.t0;r.m_sweep.t0<o.m_sweep.t0?(_=o.m_sweep.t0,r.m_sweep.Advance(_)):o.m_sweep.t0<r.m_sweep.t0&&(_=r.m_sweep.t0,o.m_sweep.Advance(_)),f=h.ComputeTOI(r.m_sweep,o.m_sweep),l.b2Assert(0<=f&&f<=1),f>0&&f<1&&(f=(1-f)*_+f)>1&&(f=1),h.m_toi=f,h.m_flags|=E.e_toiFlag}Number.MIN_VALUE<f&&f<m&&(p=h,m=f)}if(null==p||1-100*Number.MIN_VALUE<m)break;if(i=p.m_fixtureA,n=p.m_fixtureB,r=i.m_body,o=n.m_body,B.s_backupA.Set(r.m_sweep),B.s_backupB.Set(o.m_sweep),r.Advance(m),o.Advance(m),p.Update(this.m_contactManager.m_contactListener),p.m_flags&=~E.e_toiFlag,1!=p.IsSensor()&&0!=p.IsEnabled()){if(0!=p.IsTouching()){var d=r;d.GetType()!=v.b2_dynamicBody&&(d=o),c.Clear();var y=0,g=0;for(u[y+g++]=d,d.m_flags|=v.e_islandFlag;g>0;)if(e=u[y++],--g,c.AddBody(e),0==e.IsAwake()&&e.SetAwake(!0),e.GetType()==v.b2_dynamicBody){for(s=e.m_contactList;s&&c.m_contactCount!=c.m_contactCapacity;s=s.next)if(!(s.contact.m_flags&E.e_islandFlag)&&1!=s.contact.IsSensor()&&0!=s.contact.IsEnabled()&&0!=s.contact.IsTouching()){c.AddContact(s.contact),s.contact.m_flags|=E.e_islandFlag;var x=s.other;x.m_flags&v.e_islandFlag||(x.GetType()!=v.b2_staticBody&&(x.Advance(m),x.SetAwake(!0)),u[y+g]=x,++g,x.m_flags|=v.e_islandFlag)}for(var b=e.m_jointList;b;b=b.next)c.m_jointCount!=c.m_jointCapacity&&1!=b.joint.m_islandFlag&&(x=b.other,0!=x.IsActive()&&(c.AddJoint(b.joint),b.joint.m_islandFlag=!0,x.m_flags&v.e_islandFlag||(x.GetType()!=v.b2_staticBody&&(x.Advance(m),x.SetAwake(!0)),u[y+g]=x,++g,x.m_flags|=v.e_islandFlag)))}var w=B.s_timestep;w.warmStarting=!1,w.dt=(1-m)*t.dt,w.inv_dt=1/w.dt,w.dtRatio=0,w.velocityIterations=t.velocityIterations,w.positionIterations=t.positionIterations,c.SolveTOI(w);var C=0;for(C=0;C<c.m_bodyCount;++C)if(e=c.m_bodies[C],e.m_flags&=~v.e_islandFlag,0!=e.IsAwake()&&e.GetType()==v.b2_dynamicBody)for(e.SynchronizeFixtures(),s=e.m_contactList;s;s=s.next)s.contact.m_flags&=~E.e_toiFlag;for(C=0;C<c.m_contactCount;++C)h=c.m_contacts[C],h.m_flags&=~(E.e_toiFlag|E.e_islandFlag);for(C=0;C<c.m_jointCount;++C)a=c.m_joints[C],a.m_islandFlag=!1;this.m_contactManager.FindNewContacts()}}else r.m_sweep.Set(B.s_backupA),o.m_sweep.Set(B.s_backupB),r.SynchronizeTransform(),o.SynchronizeTransform()}},B.prototype.DrawJoint=function(t){var e=t.GetBodyA(),i=t.GetBodyB(),n=e.m_xf,r=i.m_xf,o=n.position,s=r.position,a=t.GetAnchorA(),l=t.GetAnchorB(),c=B.s_jointColor;switch(t.m_type){case V.e_distanceJoint:this.m_debugDraw.DrawSegment(a,l,c);break;case V.e_pulleyJoint:var u=t instanceof O?t:null,h=u.GetGroundAnchorA(),p=u.GetGroundAnchorB();this.m_debugDraw.DrawSegment(h,a,c),this.m_debugDraw.DrawSegment(p,l,c),this.m_debugDraw.DrawSegment(h,p,c);break;case V.e_mouseJoint:this.m_debugDraw.DrawSegment(a,l,c);break;default:e!=this.m_groundBody&&this.m_debugDraw.DrawSegment(o,a,c),this.m_debugDraw.DrawSegment(a,l,c),i!=this.m_groundBody&&this.m_debugDraw.DrawSegment(s,l,c)}},B.prototype.DrawShape=function(e,i,n){switch(e.m_type){case g.e_circleShape:var o=e instanceof f?e:null,s=t.MulX(i,o.m_p),a=o.m_radius,l=i.R.col1;this.m_debugDraw.DrawSolidCircle(s,a,l,n);break;case g.e_polygonShape:var c=0,u=e instanceof y?e:null,h=parseInt(u.GetVertexCount()),p=u.GetVertices(),m=new r(h);for(c=0;c<h;++c)m[c]=t.MulX(i,p[c]);this.m_debugDraw.DrawSolidPolygon(m,h,n);break;case g.e_edgeShape:var d=e instanceof _?e:null;this.m_debugDraw.DrawSegment(t.MulX(i,d.GetVertex1()),t.MulX(i,d.GetVertex2()),n)}},n.postDefs.push(function(){n.Dynamics.b2World.s_timestep2=new P,n.Dynamics.b2World.s_xf=new i,n.Dynamics.b2World.s_backupA=new e,n.Dynamics.b2World.s_backupB=new e,n.Dynamics.b2World.s_timestep=new P,n.Dynamics.b2World.s_queue=new r,n.Dynamics.b2World.s_jointColor=new a(.5,.8,.8),n.Dynamics.b2World.e_newFixture=1,n.Dynamics.b2World.e_locked=2})}(),function(){var t=n.Collision.Shapes.b2CircleShape,e=(n.Collision.Shapes.b2EdgeChainDef,n.Collision.Shapes.b2EdgeShape),i=(n.Collision.Shapes.b2MassData,n.Collision.Shapes.b2PolygonShape),s=n.Collision.Shapes.b2Shape,a=n.Dynamics.Contacts.b2CircleContact,l=n.Dynamics.Contacts.b2Contact,c=n.Dynamics.Contacts.b2ContactConstraint,u=n.Dynamics.Contacts.b2ContactConstraintPoint,h=n.Dynamics.Contacts.b2ContactEdge,p=n.Dynamics.Contacts.b2ContactFactory,m=n.Dynamics.Contacts.b2ContactRegister,f=n.Dynamics.Contacts.b2ContactResult,_=n.Dynamics.Contacts.b2ContactSolver,d=n.Dynamics.Contacts.b2EdgeAndCircleContact,y=n.Dynamics.Contacts.b2NullContact,g=n.Dynamics.Contacts.b2PolyAndCircleContact,v=n.Dynamics.Contacts.b2PolyAndEdgeContact,x=n.Dynamics.Contacts.b2PolygonContact,b=n.Dynamics.Contacts.b2PositionSolverManifold,w=n.Dynamics.b2Body,C=(n.Dynamics.b2BodyDef,n.Dynamics.b2ContactFilter,n.Dynamics.b2ContactImpulse,n.Dynamics.b2ContactListener,n.Dynamics.b2ContactManager,n.Dynamics.b2DebugDraw,n.Dynamics.b2DestructionListener,n.Dynamics.b2FilterData,n.Dynamics.b2Fixture,n.Dynamics.b2FixtureDef,n.Dynamics.b2Island,n.Dynamics.b2TimeStep),S=(n.Dynamics.b2World,n.Common.b2Color,n.Common.b2internal,n.Common.b2Settings),A=n.Common.Math.b2Mat22,D=(n.Common.Math.b2Mat33,n.Common.Math.b2Math),M=(n.Common.Math.b2Sweep,n.Common.Math.b2Transform,n.Common.Math.b2Vec2),T=(n.Common.Math.b2Vec3,n.Collision.b2AABB,n.Collision.b2Bound,n.Collision.b2BoundValues,n.Collision.b2Collision),k=n.Collision.b2ContactID,I=(n.Collision.b2ContactPoint,n.Collision.b2Distance,n.Collision.b2DistanceInput,n.Collision.b2DistanceOutput,n.Collision.b2DistanceProxy,n.Collision.b2DynamicTree,n.Collision.b2DynamicTreeBroadPhase,n.Collision.b2DynamicTreeNode,n.Collision.b2DynamicTreePair,n.Collision.b2Manifold),P=(n.Collision.b2ManifoldPoint,n.Collision.b2Point,n.Collision.b2RayCastInput,n.Collision.b2RayCastOutput,n.Collision.b2Segment,n.Collision.b2SeparationFunction,n.Collision.b2Simplex,n.Collision.b2SimplexCache,n.Collision.b2SimplexVertex,n.Collision.b2TimeOfImpact),B=n.Collision.b2TOIInput,E=n.Collision.b2WorldManifold;n.Collision.ClipVertex,n.Collision.Features,n.Collision.IBroadPhase;n.inherit(a,n.Dynamics.Contacts.b2Contact),a.prototype.__super=n.Dynamics.Contacts.b2Contact.prototype,a.b2CircleContact=function(){n.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)},a.Create=function(t){return new a},a.Destroy=function(t,e){},a.prototype.Reset=function(t,e){this.__super.Reset.call(this,t,e)},a.prototype.Evaluate=function(){var e=this.m_fixtureA.GetBody(),i=this.m_fixtureB.GetBody();T.CollideCircles(this.m_manifold,this.m_fixtureA.GetShape()instanceof t?this.m_fixtureA.GetShape():null,e.m_xf,this.m_fixtureB.GetShape()instanceof t?this.m_fixtureB.GetShape():null,i.m_xf)},l.b2Contact=function(){this.m_nodeA=new h,this.m_nodeB=new h,this.m_manifold=new I,this.m_oldManifold=new I},l.prototype.GetManifold=function(){return this.m_manifold},l.prototype.GetWorldManifold=function(t){var e=this.m_fixtureA.GetBody(),i=this.m_fixtureB.GetBody(),n=this.m_fixtureA.GetShape(),r=this.m_fixtureB.GetShape();t.Initialize(this.m_manifold,e.GetTransform(),n.m_radius,i.GetTransform(),r.m_radius)},l.prototype.IsTouching=function(){return(this.m_flags&l.e_touchingFlag)==l.e_touchingFlag},l.prototype.IsContinuous=function(){return(this.m_flags&l.e_continuousFlag)==l.e_continuousFlag},l.prototype.SetSensor=function(t){t?this.m_flags|=l.e_sensorFlag:this.m_flags&=~l.e_sensorFlag},l.prototype.IsSensor=function(){return(this.m_flags&l.e_sensorFlag)==l.e_sensorFlag},l.prototype.SetEnabled=function(t){t?this.m_flags|=l.e_enabledFlag:this.m_flags&=~l.e_enabledFlag},l.prototype.IsEnabled=function(){return(this.m_flags&l.e_enabledFlag)==l.e_enabledFlag},l.prototype.GetNext=function(){return this.m_next},l.prototype.GetFixtureA=function(){return this.m_fixtureA},l.prototype.GetFixtureB=function(){return this.m_fixtureB},l.prototype.FlagForFiltering=function(){this.m_flags|=l.e_filterFlag},l.prototype.b2Contact=function(){},l.prototype.Reset=function(t,e){if(void 0===t&&(t=null),void 0===e&&(e=null),this.m_flags=l.e_enabledFlag,!t||!e)return this.m_fixtureA=null,void(this.m_fixtureB=null);(t.IsSensor()||e.IsSensor())&&(this.m_flags|=l.e_sensorFlag);var i=t.GetBody(),n=e.GetBody();(i.GetType()!=w.b2_dynamicBody||i.IsBullet()||n.GetType()!=w.b2_dynamicBody||n.IsBullet())&&(this.m_flags|=l.e_continuousFlag),this.m_fixtureA=t,this.m_fixtureB=e,this.m_manifold.m_pointCount=0,this.m_prev=null,this.m_next=null,this.m_nodeA.contact=null,this.m_nodeA.prev=null,this.m_nodeA.next=null,this.m_nodeA.other=null,this.m_nodeB.contact=null,this.m_nodeB.prev=null,this.m_nodeB.next=null,this.m_nodeB.other=null},l.prototype.Update=function(t){var e=this.m_oldManifold;this.m_oldManifold=this.m_manifold,this.m_manifold=e,this.m_flags|=l.e_enabledFlag;var i=!1,n=(this.m_flags&l.e_touchingFlag)==l.e_touchingFlag,r=this.m_fixtureA.m_body,o=this.m_fixtureB.m_body,a=this.m_fixtureA.m_aabb.TestOverlap(this.m_fixtureB.m_aabb);if(this.m_flags&l.e_sensorFlag){if(a){var c=this.m_fixtureA.GetShape(),u=this.m_fixtureB.GetShape(),h=r.GetTransform(),p=o.GetTransform();i=s.TestOverlap(c,h,u,p)}this.m_manifold.m_pointCount=0}else{if(r.GetType()!=w.b2_dynamicBody||r.IsBullet()||o.GetType()!=w.b2_dynamicBody||o.IsBullet()?this.m_flags|=l.e_continuousFlag:this.m_flags&=~l.e_continuousFlag,a){this.Evaluate(),i=this.m_manifold.m_pointCount>0;for(var m=0;m<this.m_manifold.m_pointCount;++m){var f=this.m_manifold.m_points[m];f.m_normalImpulse=0,f.m_tangentImpulse=0;for(var _=f.m_id,d=0;d<this.m_oldManifold.m_pointCount;++d){var y=this.m_oldManifold.m_points[d];if(y.m_id.key==_.key){f.m_normalImpulse=y.m_normalImpulse,f.m_tangentImpulse=y.m_tangentImpulse;break}}}}else this.m_manifold.m_pointCount=0;i!=n&&(r.SetAwake(!0),o.SetAwake(!0))}i?this.m_flags|=l.e_touchingFlag:this.m_flags&=~l.e_touchingFlag,0==n&&1==i&&t.BeginContact(this),1==n&&0==i&&t.EndContact(this),0==(this.m_flags&l.e_sensorFlag)&&t.PreSolve(this,this.m_oldManifold)},l.prototype.Evaluate=function(){},l.prototype.ComputeTOI=function(t,e){return l.s_input.proxyA.Set(this.m_fixtureA.GetShape()),l.s_input.proxyB.Set(this.m_fixtureB.GetShape()),l.s_input.sweepA=t,l.s_input.sweepB=e,l.s_input.tolerance=S.b2_linearSlop,P.TimeOfImpact(l.s_input)},n.postDefs.push(function(){n.Dynamics.Contacts.b2Contact.e_sensorFlag=1,n.Dynamics.Contacts.b2Contact.e_continuousFlag=2,n.Dynamics.Contacts.b2Contact.e_islandFlag=4,n.Dynamics.Contacts.b2Contact.e_toiFlag=8,n.Dynamics.Contacts.b2Contact.e_touchingFlag=16,n.Dynamics.Contacts.b2Contact.e_enabledFlag=32,n.Dynamics.Contacts.b2Contact.e_filterFlag=64,n.Dynamics.Contacts.b2Contact.s_input=new B}),c.b2ContactConstraint=function(){this.localPlaneNormal=new M,this.localPoint=new M,this.normal=new M,this.normalMass=new A,this.K=new A},c.prototype.b2ContactConstraint=function(){this.points=new r(S.b2_maxManifoldPoints);for(var t=0;t<S.b2_maxManifoldPoints;t++)this.points[t]=new u},u.b2ContactConstraintPoint=function(){this.localPoint=new M,this.rA=new M,this.rB=new M},h.b2ContactEdge=function(){},p.b2ContactFactory=function(){},p.prototype.b2ContactFactory=function(t){this.m_allocator=t,this.InitializeRegisters()},p.prototype.AddType=function(t,e,i,n){void 0===i&&(i=0),void 0===n&&(n=0),this.m_registers[i][n].createFcn=t,this.m_registers[i][n].destroyFcn=e,this.m_registers[i][n].primary=!0,i!=n&&(this.m_registers[n][i].createFcn=t,this.m_registers[n][i].destroyFcn=e,this.m_registers[n][i].primary=!1)},p.prototype.InitializeRegisters=function(){this.m_registers=new r(s.e_shapeTypeCount);for(var t=0;t<s.e_shapeTypeCount;t++){this.m_registers[t]=new r(s.e_shapeTypeCount);for(var e=0;e<s.e_shapeTypeCount;e++)this.m_registers[t][e]=new m}this.AddType(a.Create,a.Destroy,s.e_circleShape,s.e_circleShape),this.AddType(g.Create,g.Destroy,s.e_polygonShape,s.e_circleShape),this.AddType(x.Create,x.Destroy,s.e_polygonShape,s.e_polygonShape),this.AddType(d.Create,d.Destroy,s.e_edgeShape,s.e_circleShape),this.AddType(v.Create,v.Destroy,s.e_polygonShape,s.e_edgeShape)},p.prototype.Create=function(t,e){var i,n=parseInt(t.GetType()),r=parseInt(e.GetType()),o=this.m_registers[n][r];if(o.pool)return i=o.pool,o.pool=i.m_next,o.poolCount--,i.Reset(t,e),i;var s=o.createFcn;return null!=s?o.primary?(i=s(this.m_allocator),i.Reset(t,e),i):(i=s(this.m_allocator),i.Reset(e,t),i):null},p.prototype.Destroy=function(t){t.m_manifold.m_pointCount>0&&(t.m_fixtureA.m_body.SetAwake(!0),t.m_fixtureB.m_body.SetAwake(!0));var e=parseInt(t.m_fixtureA.GetType()),i=parseInt(t.m_fixtureB.GetType()),n=this.m_registers[e][i];n.poolCount++,t.m_next=n.pool,n.pool=t,(0,n.destroyFcn)(t,this.m_allocator)},m.b2ContactRegister=function(){},f.b2ContactResult=function(){this.position=new M,this.normal=new M,this.id=new k},_.b2ContactSolver=function(){this.m_step=new C,this.m_constraints=new r},_.prototype.b2ContactSolver=function(){},_.prototype.Initialize=function(t,e,i,n){void 0===i&&(i=0);var r;this.m_step.Set(t),this.m_allocator=n;var o=0;for(this.m_constraintCount=i;this.m_constraints.length<this.m_constraintCount;)this.m_constraints[this.m_constraints.length]=new c;for(o=0;o<i;++o){r=e[o];var s=r.m_fixtureA,a=r.m_fixtureB,l=s.m_shape,u=a.m_shape,h=l.m_radius,p=u.m_radius,m=s.m_body,f=a.m_body,d=r.GetManifold(),y=S.b2MixFriction(s.GetFriction(),a.GetFriction()),g=S.b2MixRestitution(s.GetRestitution(),a.GetRestitution()),v=m.m_linearVelocity.x,x=m.m_linearVelocity.y,b=f.m_linearVelocity.x,w=f.m_linearVelocity.y,C=m.m_angularVelocity,A=f.m_angularVelocity;S.b2Assert(d.m_pointCount>0),_.s_worldManifold.Initialize(d,m.m_xf,h,f.m_xf,p);var D=_.s_worldManifold.m_normal.x,M=_.s_worldManifold.m_normal.y,T=this.m_constraints[o];T.bodyA=m,T.bodyB=f,T.manifold=d,T.normal.x=D,T.normal.y=M,T.pointCount=d.m_pointCount,T.friction=y,T.restitution=g,T.localPlaneNormal.x=d.m_localPlaneNormal.x,T.localPlaneNormal.y=d.m_localPlaneNormal.y,T.localPoint.x=d.m_localPoint.x,T.localPoint.y=d.m_localPoint.y,T.radius=h+p,T.type=d.m_type;for(var k=0;k<T.pointCount;++k){var I=d.m_points[k],P=T.points[k];P.normalImpulse=I.m_normalImpulse,P.tangentImpulse=I.m_tangentImpulse,P.localPoint.SetV(I.m_localPoint);var B=P.rA.x=_.s_worldManifold.m_points[k].x-m.m_sweep.c.x,E=P.rA.y=_.s_worldManifold.m_points[k].y-m.m_sweep.c.y,L=P.rB.x=_.s_worldManifold.m_points[k].x-f.m_sweep.c.x,R=P.rB.y=_.s_worldManifold.m_points[k].y-f.m_sweep.c.y,V=B*M-E*D,O=L*M-R*D;V*=V,O*=O;var F=m.m_invMass+f.m_invMass+m.m_invI*V+f.m_invI*O;P.normalMass=1/F;var N=m.m_mass*m.m_invMass+f.m_mass*f.m_invMass;N+=m.m_mass*m.m_invI*V+f.m_mass*f.m_invI*O,P.equalizedMass=1/N;var j=M,G=-D,z=B*G-E*j,J=L*G-R*j;z*=z,J*=J;var H=m.m_invMass+f.m_invMass+m.m_invI*z+f.m_invI*J;P.tangentMass=1/H,P.velocityBias=0;var U=b+-A*R-v- -C*E,q=w+A*L-x-C*B,W=T.normal.x*U+T.normal.y*q;W<-S.b2_velocityThreshold&&(P.velocityBias+=-T.restitution*W)}if(2==T.pointCount){var $=T.points[0],K=T.points[1],X=m.m_invMass,Y=m.m_invI,Z=f.m_invMass,Q=f.m_invI,tt=$.rA.x*M-$.rA.y*D,et=$.rB.x*M-$.rB.y*D,it=K.rA.x*M-K.rA.y*D,nt=K.rB.x*M-K.rB.y*D,rt=X+Z+Y*tt*tt+Q*et*et,ot=X+Z+Y*it*it+Q*nt*nt,st=X+Z+Y*tt*it+Q*et*nt;rt*rt<100*(rt*ot-st*st)?(T.K.col1.Set(rt,st),T.K.col2.Set(st,ot),T.K.GetInverse(T.normalMass)):T.pointCount=1}}},_.prototype.InitVelocityConstraints=function(t){for(var e=0;e<this.m_constraintCount;++e){var i=this.m_constraints[e],n=i.bodyA,r=i.bodyB,o=n.m_invMass,s=n.m_invI,a=r.m_invMass,l=r.m_invI,c=i.normal.x,u=i.normal.y,h=u,p=-c,m=0,f=0;if(t.warmStarting)for(f=i.pointCount,m=0;m<f;++m){var _=i.points[m];_.normalImpulse*=t.dtRatio,_.tangentImpulse*=t.dtRatio;var d=_.normalImpulse*c+_.tangentImpulse*h,y=_.normalImpulse*u+_.tangentImpulse*p;n.m_angularVelocity-=s*(_.rA.x*y-_.rA.y*d),n.m_linearVelocity.x-=o*d,n.m_linearVelocity.y-=o*y,r.m_angularVelocity+=l*(_.rB.x*y-_.rB.y*d),r.m_linearVelocity.x+=a*d,r.m_linearVelocity.y+=a*y}else for(f=i.pointCount,m=0;m<f;++m){var g=i.points[m];g.normalImpulse=0,g.tangentImpulse=0}}},_.prototype.SolveVelocityConstraints=function(){for(var t,e,i=0,n=0,r=0,o=0,s=0,a=0,l=0,c=0,u=0,h=0,p=0,m=0,f=0,_=0,d=0,y=0,g=0;g<this.m_constraintCount;++g){var v=this.m_constraints[g],x=v.bodyA,b=v.bodyB,w=x.m_angularVelocity,C=b.m_angularVelocity,S=x.m_linearVelocity,A=b.m_linearVelocity,M=x.m_invMass,T=x.m_invI,k=b.m_invMass,I=b.m_invI,P=v.normal.x,B=v.normal.y,E=B,L=-P,R=v.friction;for(i=0;i<v.pointCount;i++)t=v.points[i],n=A.x-C*t.rB.y-S.x+w*t.rA.y,r=A.y+C*t.rB.x-S.y-w*t.rA.x,s=n*E+r*L,a=t.tangentMass*-s,l=R*t.normalImpulse,c=D.Clamp(t.tangentImpulse+a,-l,l),a=c-t.tangentImpulse,u=a*E,h=a*L,S.x-=M*u,S.y-=M*h,w-=T*(t.rA.x*h-t.rA.y*u),A.x+=k*u,A.y+=k*h,C+=I*(t.rB.x*h-t.rB.y*u),t.tangentImpulse=c;parseInt(v.pointCount);if(1==v.pointCount)t=v.points[0],n=A.x+-C*t.rB.y-S.x- -w*t.rA.y,r=A.y+C*t.rB.x-S.y-w*t.rA.x,o=n*P+r*B,a=-t.normalMass*(o-t.velocityBias),c=t.normalImpulse+a,c=c>0?c:0,a=c-t.normalImpulse,u=a*P,h=a*B,S.x-=M*u,S.y-=M*h,w-=T*(t.rA.x*h-t.rA.y*u),A.x+=k*u,A.y+=k*h,C+=I*(t.rB.x*h-t.rB.y*u),t.normalImpulse=c;else{var V=v.points[0],O=v.points[1],F=V.normalImpulse,N=O.normalImpulse,j=A.x-C*V.rB.y-S.x+w*V.rA.y,G=A.y+C*V.rB.x-S.y-w*V.rA.x,z=A.x-C*O.rB.y-S.x+w*O.rA.y,J=A.y+C*O.rB.x-S.y-w*O.rA.x,H=j*P+G*B,U=z*P+J*B,q=H-V.velocityBias,W=U-O.velocityBias;e=v.K,q-=e.col1.x*F+e.col2.x*N,W-=e.col1.y*F+e.col2.y*N;for(;;){e=v.normalMass;var $=-(e.col1.x*q+e.col2.x*W),K=-(e.col1.y*q+e.col2.y*W);if($>=0&&K>=0){p=$-F,m=K-N,f=p*P,_=p*B,d=m*P,y=m*B,S.x-=M*(f+d),S.y-=M*(_+y),w-=T*(V.rA.x*_-V.rA.y*f+O.rA.x*y-O.rA.y*d),A.x+=k*(f+d),A.y+=k*(_+y),C+=I*(V.rB.x*_-V.rB.y*f+O.rB.x*y-O.rB.y*d),V.normalImpulse=$,O.normalImpulse=K;break}if($=-V.normalMass*q,K=0,H=0,U=v.K.col1.y*$+W,$>=0&&U>=0){p=$-F,m=K-N,f=p*P,_=p*B,d=m*P,y=m*B,S.x-=M*(f+d),S.y-=M*(_+y),w-=T*(V.rA.x*_-V.rA.y*f+O.rA.x*y-O.rA.y*d),A.x+=k*(f+d),A.y+=k*(_+y),C+=I*(V.rB.x*_-V.rB.y*f+O.rB.x*y-O.rB.y*d),V.normalImpulse=$,O.normalImpulse=K;break}if($=0,K=-O.normalMass*W,H=v.K.col2.x*K+q,U=0,K>=0&&H>=0){p=$-F,m=K-N,f=p*P,_=p*B,d=m*P,y=m*B,S.x-=M*(f+d),S.y-=M*(_+y),w-=T*(V.rA.x*_-V.rA.y*f+O.rA.x*y-O.rA.y*d),A.x+=k*(f+d),A.y+=k*(_+y),C+=I*(V.rB.x*_-V.rB.y*f+O.rB.x*y-O.rB.y*d),V.normalImpulse=$,O.normalImpulse=K;break}if($=0,K=0,H=q,U=W,H>=0&&U>=0){p=$-F,m=K-N,f=p*P,_=p*B,d=m*P,y=m*B,S.x-=M*(f+d),S.y-=M*(_+y),w-=T*(V.rA.x*_-V.rA.y*f+O.rA.x*y-O.rA.y*d),A.x+=k*(f+d),A.y+=k*(_+y),C+=I*(V.rB.x*_-V.rB.y*f+O.rB.x*y-O.rB.y*d),V.normalImpulse=$,O.normalImpulse=K;break}break}}x.m_angularVelocity=w,b.m_angularVelocity=C}},_.prototype.FinalizeVelocityConstraints=function(){for(var t=0;t<this.m_constraintCount;++t)for(var e=this.m_constraints[t],i=e.manifold,n=0;n<e.pointCount;++n){var r=i.m_points[n],o=e.points[n];r.m_normalImpulse=o.normalImpulse,r.m_tangentImpulse=o.tangentImpulse}},_.prototype.SolvePositionConstraints=function(t){void 0===t&&(t=0);for(var e=0,i=0;i<this.m_constraintCount;i++){var n=this.m_constraints[i],r=n.bodyA,o=n.bodyB,s=r.m_mass*r.m_invMass,a=r.m_mass*r.m_invI,l=o.m_mass*o.m_invMass,c=o.m_mass*o.m_invI;_.s_psm.Initialize(n);for(var u=_.s_psm.m_normal,h=0;h<n.pointCount;h++){var p=n.points[h],m=_.s_psm.m_points[h],f=_.s_psm.m_separations[h],d=m.x-r.m_sweep.c.x,y=m.y-r.m_sweep.c.y,g=m.x-o.m_sweep.c.x,v=m.y-o.m_sweep.c.y;e=e<f?e:f;var x=D.Clamp(t*(f+S.b2_linearSlop),-S.b2_maxLinearCorrection,0),b=-p.equalizedMass*x,w=b*u.x,C=b*u.y;r.m_sweep.c.x-=s*w,r.m_sweep.c.y-=s*C,r.m_sweep.a-=a*(d*C-y*w),r.SynchronizeTransform(),o.m_sweep.c.x+=l*w,o.m_sweep.c.y+=l*C,o.m_sweep.a+=c*(g*C-v*w),o.SynchronizeTransform()}}return e>-1.5*S.b2_linearSlop},n.postDefs.push(function(){n.Dynamics.Contacts.b2ContactSolver.s_worldManifold=new E,n.Dynamics.Contacts.b2ContactSolver.s_psm=new b}),n.inherit(d,n.Dynamics.Contacts.b2Contact),d.prototype.__super=n.Dynamics.Contacts.b2Contact.prototype,d.b2EdgeAndCircleContact=function(){n.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)},d.Create=function(t){return new d},d.Destroy=function(t,e){},d.prototype.Reset=function(t,e){this.__super.Reset.call(this,t,e)},d.prototype.Evaluate=function(){var i=this.m_fixtureA.GetBody(),n=this.m_fixtureB.GetBody();this.b2CollideEdgeAndCircle(this.m_manifold,this.m_fixtureA.GetShape()instanceof e?this.m_fixtureA.GetShape():null,i.m_xf,this.m_fixtureB.GetShape()instanceof t?this.m_fixtureB.GetShape():null,n.m_xf)},d.prototype.b2CollideEdgeAndCircle=function(t,e,i,n,r){},n.inherit(y,n.Dynamics.Contacts.b2Contact),y.prototype.__super=n.Dynamics.Contacts.b2Contact.prototype,y.b2NullContact=function(){n.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)},y.prototype.b2NullContact=function(){this.__super.b2Contact.call(this)},y.prototype.Evaluate=function(){},n.inherit(g,n.Dynamics.Contacts.b2Contact),g.prototype.__super=n.Dynamics.Contacts.b2Contact.prototype,g.b2PolyAndCircleContact=function(){n.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)},g.Create=function(t){return new g},g.Destroy=function(t,e){},g.prototype.Reset=function(t,e){this.__super.Reset.call(this,t,e),S.b2Assert(t.GetType()==s.e_polygonShape),S.b2Assert(e.GetType()==s.e_circleShape)},g.prototype.Evaluate=function(){var e=this.m_fixtureA.m_body,n=this.m_fixtureB.m_body;T.CollidePolygonAndCircle(this.m_manifold,this.m_fixtureA.GetShape()instanceof i?this.m_fixtureA.GetShape():null,e.m_xf,this.m_fixtureB.GetShape()instanceof t?this.m_fixtureB.GetShape():null,n.m_xf)},n.inherit(v,n.Dynamics.Contacts.b2Contact),v.prototype.__super=n.Dynamics.Contacts.b2Contact.prototype,v.b2PolyAndEdgeContact=function(){n.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)},v.Create=function(t){return new v},v.Destroy=function(t,e){},v.prototype.Reset=function(t,e){this.__super.Reset.call(this,t,e),S.b2Assert(t.GetType()==s.e_polygonShape),S.b2Assert(e.GetType()==s.e_edgeShape)},v.prototype.Evaluate=function(){var t=this.m_fixtureA.GetBody(),n=this.m_fixtureB.GetBody();this.b2CollidePolyAndEdge(this.m_manifold,this.m_fixtureA.GetShape()instanceof i?this.m_fixtureA.GetShape():null,t.m_xf,this.m_fixtureB.GetShape()instanceof e?this.m_fixtureB.GetShape():null,n.m_xf)},v.prototype.b2CollidePolyAndEdge=function(t,e,i,n,r){},n.inherit(x,n.Dynamics.Contacts.b2Contact),x.prototype.__super=n.Dynamics.Contacts.b2Contact.prototype,x.b2PolygonContact=function(){n.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)},x.Create=function(t){return new x},x.Destroy=function(t,e){},x.prototype.Reset=function(t,e){this.__super.Reset.call(this,t,e)},x.prototype.Evaluate=function(){var t=this.m_fixtureA.GetBody(),e=this.m_fixtureB.GetBody();T.CollidePolygons(this.m_manifold,this.m_fixtureA.GetShape()instanceof i?this.m_fixtureA.GetShape():null,t.m_xf,this.m_fixtureB.GetShape()instanceof i?this.m_fixtureB.GetShape():null,e.m_xf)},b.b2PositionSolverManifold=function(){},b.prototype.b2PositionSolverManifold=function(){this.m_normal=new M,this.m_separations=new o(S.b2_maxManifoldPoints),this.m_points=new r(S.b2_maxManifoldPoints);for(var t=0;t<S.b2_maxManifoldPoints;t++)this.m_points[t]=new M},b.prototype.Initialize=function(t){S.b2Assert(t.pointCount>0);var e,i,n=0,r=0,o=0,s=0,a=0;switch(t.type){case I.e_circles:e=t.bodyA.m_xf.R,i=t.localPoint;var l=t.bodyA.m_xf.position.x+(e.col1.x*i.x+e.col2.x*i.y),c=t.bodyA.m_xf.position.y+(e.col1.y*i.x+e.col2.y*i.y);e=t.bodyB.m_xf.R,i=t.points[0].localPoint;var u=t.bodyB.m_xf.position.x+(e.col1.x*i.x+e.col2.x*i.y),h=t.bodyB.m_xf.position.y+(e.col1.y*i.x+e.col2.y*i.y),p=u-l,m=h-c,f=p*p+m*m;if(f>Number.MIN_VALUE*Number.MIN_VALUE){var _=Math.sqrt(f);this.m_normal.x=p/_,this.m_normal.y=m/_}else this.m_normal.x=1,this.m_normal.y=0;this.m_points[0].x=.5*(l+u),this.m_points[0].y=.5*(c+h),this.m_separations[0]=p*this.m_normal.x+m*this.m_normal.y-t.radius;break;case I.e_faceA:for(e=t.bodyA.m_xf.R,i=t.localPlaneNormal,this.m_normal.x=e.col1.x*i.x+e.col2.x*i.y,this.m_normal.y=e.col1.y*i.x+e.col2.y*i.y,e=t.bodyA.m_xf.R,i=t.localPoint,s=t.bodyA.m_xf.position.x+(e.col1.x*i.x+e.col2.x*i.y),a=t.bodyA.m_xf.position.y+(e.col1.y*i.x+e.col2.y*i.y),e=t.bodyB.m_xf.R,n=0;n<t.pointCount;++n)i=t.points[n].localPoint,r=t.bodyB.m_xf.position.x+(e.col1.x*i.x+e.col2.x*i.y),o=t.bodyB.m_xf.position.y+(e.col1.y*i.x+e.col2.y*i.y),this.m_separations[n]=(r-s)*this.m_normal.x+(o-a)*this.m_normal.y-t.radius,this.m_points[n].x=r,this.m_points[n].y=o;break;case I.e_faceB:for(e=t.bodyB.m_xf.R,i=t.localPlaneNormal,this.m_normal.x=e.col1.x*i.x+e.col2.x*i.y,this.m_normal.y=e.col1.y*i.x+e.col2.y*i.y,e=t.bodyB.m_xf.R,i=t.localPoint,s=t.bodyB.m_xf.position.x+(e.col1.x*i.x+e.col2.x*i.y),a=t.bodyB.m_xf.position.y+(e.col1.y*i.x+e.col2.y*i.y),e=t.bodyA.m_xf.R,n=0;n<t.pointCount;++n)i=t.points[n].localPoint,r=t.bodyA.m_xf.position.x+(e.col1.x*i.x+e.col2.x*i.y),o=t.bodyA.m_xf.position.y+(e.col1.y*i.x+e.col2.y*i.y),this.m_separations[n]=(r-s)*this.m_normal.x+(o-a)*this.m_normal.y-t.radius,this.m_points[n].Set(r,o);this.m_normal.x*=-1,this.m_normal.y*=-1}},n.postDefs.push(function(){n.Dynamics.Contacts.b2PositionSolverManifold.circlePointA=new M,n.Dynamics.Contacts.b2PositionSolverManifold.circlePointB=new M})}(),function(){var t=(n.Dynamics.b2Body,n.Dynamics.b2BodyDef,n.Dynamics.b2ContactFilter,n.Dynamics.b2ContactImpulse,n.Dynamics.b2ContactListener,n.Dynamics.b2ContactManager,n.Dynamics.b2DebugDraw,n.Dynamics.b2DestructionListener,n.Dynamics.b2FilterData,n.Dynamics.b2Fixture,n.Dynamics.b2FixtureDef,n.Dynamics.b2Island,n.Dynamics.b2TimeStep,n.Dynamics.b2World,n.Common.Math.b2Mat22),e=(n.Common.Math.b2Mat33,n.Common.Math.b2Math),i=(n.Common.Math.b2Sweep,n.Common.Math.b2Transform,n.Common.Math.b2Vec2),r=(n.Common.Math.b2Vec3,n.Common.b2Color),o=(n.Common.b2internal,n.Common.b2Settings,n.Collision.Shapes.b2CircleShape,n.Collision.Shapes.b2EdgeChainDef,n.Collision.Shapes.b2EdgeShape,n.Collision.Shapes.b2MassData,n.Collision.Shapes.b2PolygonShape,n.Collision.Shapes.b2Shape,n.Dynamics.Controllers.b2BuoyancyController),s=n.Dynamics.Controllers.b2ConstantAccelController,a=n.Dynamics.Controllers.b2ConstantForceController,l=n.Dynamics.Controllers.b2Controller,c=n.Dynamics.Controllers.b2ControllerEdge,u=n.Dynamics.Controllers.b2GravityController,h=n.Dynamics.Controllers.b2TensorDampingController;n.inherit(o,n.Dynamics.Controllers.b2Controller),o.prototype.__super=n.Dynamics.Controllers.b2Controller.prototype,o.b2BuoyancyController=function(){n.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments),this.normal=new i(0,-1),this.offset=0,this.density=0,this.velocity=new i(0,0),this.linearDrag=2,this.angularDrag=1,this.useDensity=!1,this.useWorldGravity=!0,this.gravity=null},o.prototype.Step=function(t){if(this.m_bodyList){this.useWorldGravity&&(this.gravity=this.GetWorld().GetGravity().Copy());for(var e=this.m_bodyList;e;e=e.nextBody){var n=e.body;if(0!=n.IsAwake()){for(var r=new i,o=new i,s=0,a=0,l=n.GetFixtureList();l;l=l.GetNext()){var c=new i,u=l.GetShape().ComputeSubmergedArea(this.normal,this.offset,n.GetTransform(),c);s+=u,r.x+=u*c.x,r.y+=u*c.y;var h=0;h=(this.useDensity,1),a+=u*h,o.x+=u*c.x*h,o.y+=u*c.y*h}if(r.x/=s,r.y/=s,o.x/=a,o.y/=a,!(s<Number.MIN_VALUE)){var p=this.gravity.GetNegative();p.Multiply(this.density*s),n.ApplyForce(p,o);var m=n.GetLinearVelocityFromWorldPoint(r);m.Subtract(this.velocity),m.Multiply(-this.linearDrag*s),n.ApplyForce(m,r),n.ApplyTorque(-n.GetInertia()/n.GetMass()*s*n.GetAngularVelocity()*this.angularDrag)}}}}},o.prototype.Draw=function(t){var e=1e3,n=new i,o=new i;n.x=this.normal.x*this.offset+this.normal.y*e,n.y=this.normal.y*this.offset-this.normal.x*e,o.x=this.normal.x*this.offset-this.normal.y*e,o.y=this.normal.y*this.offset+this.normal.x*e;var s=new r(0,0,1);t.DrawSegment(n,o,s)},n.inherit(s,n.Dynamics.Controllers.b2Controller),s.prototype.__super=n.Dynamics.Controllers.b2Controller.prototype,s.b2ConstantAccelController=function(){n.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments),this.A=new i(0,0)},s.prototype.Step=function(t){for(var e=new i(this.A.x*t.dt,this.A.y*t.dt),n=this.m_bodyList;n;n=n.nextBody){var r=n.body;r.IsAwake()&&r.SetLinearVelocity(new i(r.GetLinearVelocity().x+e.x,r.GetLinearVelocity().y+e.y))}},n.inherit(a,n.Dynamics.Controllers.b2Controller),a.prototype.__super=n.Dynamics.Controllers.b2Controller.prototype,a.b2ConstantForceController=function(){n.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments),this.F=new i(0,0)},a.prototype.Step=function(t){for(var e=this.m_bodyList;e;e=e.nextBody){var i=e.body;i.IsAwake()&&i.ApplyForce(this.F,i.GetWorldCenter())}},l.b2Controller=function(){},l.prototype.Step=function(t){},l.prototype.Draw=function(t){},l.prototype.AddBody=function(t){var e=new c;e.controller=this,e.body=t,e.nextBody=this.m_bodyList,e.prevBody=null,this.m_bodyList=e,e.nextBody&&(e.nextBody.prevBody=e),this.m_bodyCount++,e.nextController=t.m_controllerList,e.prevController=null,t.m_controllerList=e,e.nextController&&(e.nextController.prevController=e),t.m_controllerCount++},l.prototype.RemoveBody=function(t){for(var e=t.m_controllerList;e&&e.controller!=this;)e=e.nextController;e.prevBody&&(e.prevBody.nextBody=e.nextBody),e.nextBody&&(e.nextBody.prevBody=e.prevBody),e.nextController&&(e.nextController.prevController=e.prevController),e.prevController&&(e.prevController.nextController=e.nextController),this.m_bodyList==e&&(this.m_bodyList=e.nextBody),t.m_controllerList==e&&(t.m_controllerList=e.nextController),t.m_controllerCount--,this.m_bodyCount--},l.prototype.Clear=function(){for(;this.m_bodyList;)this.RemoveBody(this.m_bodyList.body)},l.prototype.GetNext=function(){return this.m_next},l.prototype.GetWorld=function(){return this.m_world},l.prototype.GetBodyList=function(){return this.m_bodyList},c.b2ControllerEdge=function(){},n.inherit(u,n.Dynamics.Controllers.b2Controller),u.prototype.__super=n.Dynamics.Controllers.b2Controller.prototype,u.b2GravityController=function(){n.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments),this.G=1,this.invSqr=!0},u.prototype.Step=function(t){var e=null,n=null,r=null,o=0,s=null,a=null,l=null,c=0,u=0,h=0,p=null;if(this.invSqr)for(e=this.m_bodyList;e;e=e.nextBody)for(n=e.body,r=n.GetWorldCenter(),o=n.GetMass(),s=this.m_bodyList;s!=e;s=s.nextBody)a=s.body,l=a.GetWorldCenter(),c=l.x-r.x,u=l.y-r.y,(h=c*c+u*u)<Number.MIN_VALUE||(p=new i(c,u),p.Multiply(this.G/h/Math.sqrt(h)*o*a.GetMass()),n.IsAwake()&&n.ApplyForce(p,r),p.Multiply(-1),a.IsAwake()&&a.ApplyForce(p,l));else for(e=this.m_bodyList;e;e=e.nextBody)for(n=e.body,r=n.GetWorldCenter(),o=n.GetMass(),s=this.m_bodyList;s!=e;s=s.nextBody)a=s.body,l=a.GetWorldCenter(),c=l.x-r.x,u=l.y-r.y,(h=c*c+u*u)<Number.MIN_VALUE||(p=new i(c,u),p.Multiply(this.G/h*o*a.GetMass()),n.IsAwake()&&n.ApplyForce(p,r),p.Multiply(-1),a.IsAwake()&&a.ApplyForce(p,l))},n.inherit(h,n.Dynamics.Controllers.b2Controller),h.prototype.__super=n.Dynamics.Controllers.b2Controller.prototype,h.b2TensorDampingController=function(){n.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments),this.T=new t,this.maxTimestep=0},h.prototype.SetAxisAligned=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.T.col1.x=-t,this.T.col1.y=0,this.T.col2.x=0,this.T.col2.y=-e,this.maxTimestep=t>0||e>0?1/Math.max(t,e):0},h.prototype.Step=function(t){var n=t.dt;if(!(n<=Number.MIN_VALUE)){n>this.maxTimestep&&this.maxTimestep>0&&(n=this.maxTimestep);for(var r=this.m_bodyList;r;r=r.nextBody){var o=r.body;if(o.IsAwake()){var s=o.GetWorldVector(e.MulMV(this.T,o.GetLocalVector(o.GetLinearVelocity())));o.SetLinearVelocity(new i(o.GetLinearVelocity().x+s.x*n,o.GetLinearVelocity().y+s.y*n))}}}}}(),function(){var t=(n.Common.b2Color,n.Common.b2internal,n.Common.b2Settings),e=n.Common.Math.b2Mat22,i=n.Common.Math.b2Mat33,r=n.Common.Math.b2Math,o=(n.Common.Math.b2Sweep,n.Common.Math.b2Transform,n.Common.Math.b2Vec2),s=n.Common.Math.b2Vec3,a=n.Dynamics.Joints.b2DistanceJoint,l=n.Dynamics.Joints.b2DistanceJointDef,c=n.Dynamics.Joints.b2FrictionJoint,u=n.Dynamics.Joints.b2FrictionJointDef,h=n.Dynamics.Joints.b2GearJoint,p=n.Dynamics.Joints.b2GearJointDef,m=n.Dynamics.Joints.b2Jacobian,f=n.Dynamics.Joints.b2Joint,_=n.Dynamics.Joints.b2JointDef,d=n.Dynamics.Joints.b2JointEdge,y=n.Dynamics.Joints.b2LineJoint,g=n.Dynamics.Joints.b2LineJointDef,v=n.Dynamics.Joints.b2MouseJoint,x=n.Dynamics.Joints.b2MouseJointDef,b=n.Dynamics.Joints.b2PrismaticJoint,w=n.Dynamics.Joints.b2PrismaticJointDef,C=n.Dynamics.Joints.b2PulleyJoint,S=n.Dynamics.Joints.b2PulleyJointDef,A=n.Dynamics.Joints.b2RevoluteJoint,D=n.Dynamics.Joints.b2RevoluteJointDef,M=n.Dynamics.Joints.b2WeldJoint,T=n.Dynamics.Joints.b2WeldJointDef;n.Dynamics.b2Body,n.Dynamics.b2BodyDef,n.Dynamics.b2ContactFilter,n.Dynamics.b2ContactImpulse,n.Dynamics.b2ContactListener,n.Dynamics.b2ContactManager,n.Dynamics.b2DebugDraw,n.Dynamics.b2DestructionListener,n.Dynamics.b2FilterData,n.Dynamics.b2Fixture,n.Dynamics.b2FixtureDef,n.Dynamics.b2Island,n.Dynamics.b2TimeStep,n.Dynamics.b2World;n.inherit(a,n.Dynamics.Joints.b2Joint),a.prototype.__super=n.Dynamics.Joints.b2Joint.prototype,a.b2DistanceJoint=function(){n.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_localAnchor1=new o,this.m_localAnchor2=new o,this.m_u=new o},a.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},a.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},a.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new o(t*this.m_impulse*this.m_u.x,t*this.m_impulse*this.m_u.y)},a.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),0},a.prototype.GetLength=function(){return this.m_length},a.prototype.SetLength=function(t){void 0===t&&(t=0),this.m_length=t},a.prototype.GetFrequency=function(){return this.m_frequencyHz},a.prototype.SetFrequency=function(t){void 0===t&&(t=0),this.m_frequencyHz=t},a.prototype.GetDampingRatio=function(){return this.m_dampingRatio},a.prototype.SetDampingRatio=function(t){void 0===t&&(t=0),this.m_dampingRatio=t},a.prototype.b2DistanceJoint=function(t){this.__super.b2Joint.call(this,t);this.m_localAnchor1.SetV(t.localAnchorA),this.m_localAnchor2.SetV(t.localAnchorB),this.m_length=t.length,this.m_frequencyHz=t.frequencyHz,this.m_dampingRatio=t.dampingRatio,this.m_impulse=0,this.m_gamma=0,this.m_bias=0},a.prototype.InitVelocityConstraints=function(e){var i,n=0,r=this.m_bodyA,o=this.m_bodyB;i=r.m_xf.R;var s=this.m_localAnchor1.x-r.m_sweep.localCenter.x,a=this.m_localAnchor1.y-r.m_sweep.localCenter.y;n=i.col1.x*s+i.col2.x*a,a=i.col1.y*s+i.col2.y*a,s=n,i=o.m_xf.R;var l=this.m_localAnchor2.x-o.m_sweep.localCenter.x,c=this.m_localAnchor2.y-o.m_sweep.localCenter.y;n=i.col1.x*l+i.col2.x*c,c=i.col1.y*l+i.col2.y*c,l=n,this.m_u.x=o.m_sweep.c.x+l-r.m_sweep.c.x-s,this.m_u.y=o.m_sweep.c.y+c-r.m_sweep.c.y-a;var u=Math.sqrt(this.m_u.x*this.m_u.x+this.m_u.y*this.m_u.y);u>t.b2_linearSlop?this.m_u.Multiply(1/u):this.m_u.SetZero();var h=s*this.m_u.y-a*this.m_u.x,p=l*this.m_u.y-c*this.m_u.x,m=r.m_invMass+r.m_invI*h*h+o.m_invMass+o.m_invI*p*p;if(this.m_mass=0!=m?1/m:0,this.m_frequencyHz>0){var f=u-this.m_length,_=2*Math.PI*this.m_frequencyHz,d=2*this.m_mass*this.m_dampingRatio*_,y=this.m_mass*_*_;this.m_gamma=e.dt*(d+e.dt*y),this.m_gamma=0!=this.m_gamma?1/this.m_gamma:0,this.m_bias=f*e.dt*y*this.m_gamma,this.m_mass=m+this.m_gamma,this.m_mass=0!=this.m_mass?1/this.m_mass:0}if(e.warmStarting){this.m_impulse*=e.dtRatio;var g=this.m_impulse*this.m_u.x,v=this.m_impulse*this.m_u.y;r.m_linearVelocity.x-=r.m_invMass*g,r.m_linearVelocity.y-=r.m_invMass*v,r.m_angularVelocity-=r.m_invI*(s*v-a*g),o.m_linearVelocity.x+=o.m_invMass*g,o.m_linearVelocity.y+=o.m_invMass*v,o.m_angularVelocity+=o.m_invI*(l*v-c*g)}else this.m_impulse=0},a.prototype.SolveVelocityConstraints=function(t){var e,i=this.m_bodyA,n=this.m_bodyB;e=i.m_xf.R;var r=this.m_localAnchor1.x-i.m_sweep.localCenter.x,o=this.m_localAnchor1.y-i.m_sweep.localCenter.y,s=e.col1.x*r+e.col2.x*o;o=e.col1.y*r+e.col2.y*o,r=s,e=n.m_xf.R;var a=this.m_localAnchor2.x-n.m_sweep.localCenter.x,l=this.m_localAnchor2.y-n.m_sweep.localCenter.y;s=e.col1.x*a+e.col2.x*l,l=e.col1.y*a+e.col2.y*l,a=s;var c=i.m_linearVelocity.x+-i.m_angularVelocity*o,u=i.m_linearVelocity.y+i.m_angularVelocity*r,h=n.m_linearVelocity.x+-n.m_angularVelocity*l,p=n.m_linearVelocity.y+n.m_angularVelocity*a,m=this.m_u.x*(h-c)+this.m_u.y*(p-u),f=-this.m_mass*(m+this.m_bias+this.m_gamma*this.m_impulse);this.m_impulse+=f;var _=f*this.m_u.x,d=f*this.m_u.y;i.m_linearVelocity.x-=i.m_invMass*_,i.m_linearVelocity.y-=i.m_invMass*d,i.m_angularVelocity-=i.m_invI*(r*d-o*_),n.m_linearVelocity.x+=n.m_invMass*_,n.m_linearVelocity.y+=n.m_invMass*d,n.m_angularVelocity+=n.m_invI*(a*d-l*_)},a.prototype.SolvePositionConstraints=function(e){void 0===e&&(e=0);var i;if(this.m_frequencyHz>0)return!0;var n=this.m_bodyA,o=this.m_bodyB;i=n.m_xf.R;var s=this.m_localAnchor1.x-n.m_sweep.localCenter.x,a=this.m_localAnchor1.y-n.m_sweep.localCenter.y,l=i.col1.x*s+i.col2.x*a;a=i.col1.y*s+i.col2.y*a,s=l,i=o.m_xf.R;var c=this.m_localAnchor2.x-o.m_sweep.localCenter.x,u=this.m_localAnchor2.y-o.m_sweep.localCenter.y;l=i.col1.x*c+i.col2.x*u,u=i.col1.y*c+i.col2.y*u,c=l;var h=o.m_sweep.c.x+c-n.m_sweep.c.x-s,p=o.m_sweep.c.y+u-n.m_sweep.c.y-a,m=Math.sqrt(h*h+p*p);h/=m,p/=m;var f=m-this.m_length;f=r.Clamp(f,-t.b2_maxLinearCorrection,t.b2_maxLinearCorrection);var _=-this.m_mass*f;this.m_u.Set(h,p);var d=_*this.m_u.x,y=_*this.m_u.y;return n.m_sweep.c.x-=n.m_invMass*d,n.m_sweep.c.y-=n.m_invMass*y,n.m_sweep.a-=n.m_invI*(s*y-a*d),o.m_sweep.c.x+=o.m_invMass*d,o.m_sweep.c.y+=o.m_invMass*y,o.m_sweep.a+=o.m_invI*(c*y-u*d),n.SynchronizeTransform(),o.SynchronizeTransform(),r.Abs(f)<t.b2_linearSlop},n.inherit(l,n.Dynamics.Joints.b2JointDef),l.prototype.__super=n.Dynamics.Joints.b2JointDef.prototype,l.b2DistanceJointDef=function(){n.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.localAnchorA=new o,this.localAnchorB=new o},l.prototype.b2DistanceJointDef=function(){this.__super.b2JointDef.call(this),this.type=f.e_distanceJoint,this.length=1,this.frequencyHz=0,this.dampingRatio=0},l.prototype.Initialize=function(t,e,i,n){this.bodyA=t,this.bodyB=e,this.localAnchorA.SetV(this.bodyA.GetLocalPoint(i)),this.localAnchorB.SetV(this.bodyB.GetLocalPoint(n));var r=n.x-i.x,o=n.y-i.y;this.length=Math.sqrt(r*r+o*o),this.frequencyHz=0,this.dampingRatio=0},n.inherit(c,n.Dynamics.Joints.b2Joint),c.prototype.__super=n.Dynamics.Joints.b2Joint.prototype,c.b2FrictionJoint=function(){n.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_localAnchorA=new o,this.m_localAnchorB=new o,this.m_linearMass=new e,this.m_linearImpulse=new o},c.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA)},c.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB)},c.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new o(t*this.m_linearImpulse.x,t*this.m_linearImpulse.y)},c.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),t*this.m_angularImpulse},c.prototype.SetMaxForce=function(t){void 0===t&&(t=0),this.m_maxForce=t},c.prototype.GetMaxForce=function(){return this.m_maxForce},c.prototype.SetMaxTorque=function(t){void 0===t&&(t=0),this.m_maxTorque=t},c.prototype.GetMaxTorque=function(){return this.m_maxTorque},c.prototype.b2FrictionJoint=function(t){this.__super.b2Joint.call(this,t),this.m_localAnchorA.SetV(t.localAnchorA),this.m_localAnchorB.SetV(t.localAnchorB),this.m_linearMass.SetZero(),this.m_angularMass=0,this.m_linearImpulse.SetZero(),this.m_angularImpulse=0,this.m_maxForce=t.maxForce,this.m_maxTorque=t.maxTorque},c.prototype.InitVelocityConstraints=function(t){var i,n=0,r=this.m_bodyA,o=this.m_bodyB;i=r.m_xf.R;var s=this.m_localAnchorA.x-r.m_sweep.localCenter.x,a=this.m_localAnchorA.y-r.m_sweep.localCenter.y;n=i.col1.x*s+i.col2.x*a,a=i.col1.y*s+i.col2.y*a,s=n,i=o.m_xf.R;var l=this.m_localAnchorB.x-o.m_sweep.localCenter.x,c=this.m_localAnchorB.y-o.m_sweep.localCenter.y;n=i.col1.x*l+i.col2.x*c,c=i.col1.y*l+i.col2.y*c,l=n;var u=r.m_invMass,h=o.m_invMass,p=r.m_invI,m=o.m_invI,f=new e;if(f.col1.x=u+h,f.col2.x=0,f.col1.y=0,f.col2.y=u+h,f.col1.x+=p*a*a,f.col2.x+=-p*s*a,f.col1.y+=-p*s*a,f.col2.y+=p*s*s,f.col1.x+=m*c*c,f.col2.x+=-m*l*c,f.col1.y+=-m*l*c,f.col2.y+=m*l*l,f.GetInverse(this.m_linearMass),this.m_angularMass=p+m,this.m_angularMass>0&&(this.m_angularMass=1/this.m_angularMass),t.warmStarting){this.m_linearImpulse.x*=t.dtRatio,this.m_linearImpulse.y*=t.dtRatio,this.m_angularImpulse*=t.dtRatio;var _=this.m_linearImpulse;r.m_linearVelocity.x-=u*_.x,r.m_linearVelocity.y-=u*_.y,r.m_angularVelocity-=p*(s*_.y-a*_.x+this.m_angularImpulse),o.m_linearVelocity.x+=h*_.x,o.m_linearVelocity.y+=h*_.y,o.m_angularVelocity+=m*(l*_.y-c*_.x+this.m_angularImpulse)}else this.m_linearImpulse.SetZero(),this.m_angularImpulse=0},c.prototype.SolveVelocityConstraints=function(t){var e,i=0,n=this.m_bodyA,s=this.m_bodyB,a=n.m_linearVelocity,l=n.m_angularVelocity,c=s.m_linearVelocity,u=s.m_angularVelocity,h=n.m_invMass,p=s.m_invMass,m=n.m_invI,f=s.m_invI;e=n.m_xf.R;var _=this.m_localAnchorA.x-n.m_sweep.localCenter.x,d=this.m_localAnchorA.y-n.m_sweep.localCenter.y;i=e.col1.x*_+e.col2.x*d,d=e.col1.y*_+e.col2.y*d,_=i,e=s.m_xf.R;var y=this.m_localAnchorB.x-s.m_sweep.localCenter.x,g=this.m_localAnchorB.y-s.m_sweep.localCenter.y;i=e.col1.x*y+e.col2.x*g,g=e.col1.y*y+e.col2.y*g,y=i;var v=0,x=u-l,b=-this.m_angularMass*x,w=this.m_angularImpulse;v=t.dt*this.m_maxTorque,this.m_angularImpulse=r.Clamp(this.m_angularImpulse+b,-v,v),b=this.m_angularImpulse-w,l-=m*b,u+=f*b;var C=c.x-u*g-a.x+l*d,S=c.y+u*y-a.y-l*_,A=r.MulMV(this.m_linearMass,new o(-C,-S)),D=this.m_linearImpulse.Copy();this.m_linearImpulse.Add(A),v=t.dt*this.m_maxForce,this.m_linearImpulse.LengthSquared()>v*v&&(this.m_linearImpulse.Normalize(),this.m_linearImpulse.Multiply(v)),A=r.SubtractVV(this.m_linearImpulse,D),a.x-=h*A.x,a.y-=h*A.y,l-=m*(_*A.y-d*A.x),c.x+=p*A.x,c.y+=p*A.y,u+=f*(y*A.y-g*A.x),n.m_angularVelocity=l,s.m_angularVelocity=u},c.prototype.SolvePositionConstraints=function(t){return void 0===t&&(t=0),!0},n.inherit(u,n.Dynamics.Joints.b2JointDef),u.prototype.__super=n.Dynamics.Joints.b2JointDef.prototype,u.b2FrictionJointDef=function(){n.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.localAnchorA=new o,this.localAnchorB=new o},u.prototype.b2FrictionJointDef=function(){this.__super.b2JointDef.call(this),this.type=f.e_frictionJoint,this.maxForce=0,this.maxTorque=0},u.prototype.Initialize=function(t,e,i){this.bodyA=t,this.bodyB=e,this.localAnchorA.SetV(this.bodyA.GetLocalPoint(i)),this.localAnchorB.SetV(this.bodyB.GetLocalPoint(i))},n.inherit(h,n.Dynamics.Joints.b2Joint),h.prototype.__super=n.Dynamics.Joints.b2Joint.prototype,h.b2GearJoint=function(){n.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_groundAnchor1=new o,this.m_groundAnchor2=new o,this.m_localAnchor1=new o,this.m_localAnchor2=new o,this.m_J=new m},h.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},h.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},h.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new o(t*this.m_impulse*this.m_J.linearB.x,t*this.m_impulse*this.m_J.linearB.y)},h.prototype.GetReactionTorque=function(t){void 0===t&&(t=0);var e=this.m_bodyB.m_xf.R,i=this.m_localAnchor1.x-this.m_bodyB.m_sweep.localCenter.x,n=this.m_localAnchor1.y-this.m_bodyB.m_sweep.localCenter.y,r=e.col1.x*i+e.col2.x*n;n=e.col1.y*i+e.col2.y*n,i=r;var o=this.m_impulse*this.m_J.linearB.x,s=this.m_impulse*this.m_J.linearB.y;return t*(this.m_impulse*this.m_J.angularB-i*s+n*o)},h.prototype.GetRatio=function(){return this.m_ratio},h.prototype.SetRatio=function(t){void 0===t&&(t=0),this.m_ratio=t},h.prototype.b2GearJoint=function(t){this.__super.b2Joint.call(this,t);var e=parseInt(t.joint1.m_type),i=parseInt(t.joint2.m_type);this.m_revolute1=null,this.m_prismatic1=null,this.m_revolute2=null,this.m_prismatic2=null;var n=0,r=0;this.m_ground1=t.joint1.GetBodyA(),this.m_bodyA=t.joint1.GetBodyB(),e==f.e_revoluteJoint?(this.m_revolute1=t.joint1 instanceof A?t.joint1:null,this.m_groundAnchor1.SetV(this.m_revolute1.m_localAnchor1),this.m_localAnchor1.SetV(this.m_revolute1.m_localAnchor2),n=this.m_revolute1.GetJointAngle()):(this.m_prismatic1=t.joint1 instanceof b?t.joint1:null,this.m_groundAnchor1.SetV(this.m_prismatic1.m_localAnchor1),this.m_localAnchor1.SetV(this.m_prismatic1.m_localAnchor2),n=this.m_prismatic1.GetJointTranslation()),this.m_ground2=t.joint2.GetBodyA(),this.m_bodyB=t.joint2.GetBodyB(),i==f.e_revoluteJoint?(this.m_revolute2=t.joint2 instanceof A?t.joint2:null,this.m_groundAnchor2.SetV(this.m_revolute2.m_localAnchor1),this.m_localAnchor2.SetV(this.m_revolute2.m_localAnchor2),r=this.m_revolute2.GetJointAngle()):(this.m_prismatic2=t.joint2 instanceof b?t.joint2:null,this.m_groundAnchor2.SetV(this.m_prismatic2.m_localAnchor1),this.m_localAnchor2.SetV(this.m_prismatic2.m_localAnchor2),r=this.m_prismatic2.GetJointTranslation()),this.m_ratio=t.ratio,this.m_constant=n+this.m_ratio*r,this.m_impulse=0},h.prototype.InitVelocityConstraints=function(t){var e,i,n=this.m_ground1,r=this.m_ground2,o=this.m_bodyA,s=this.m_bodyB,a=0,l=0,c=0,u=0,h=0,p=0,m=0;this.m_J.SetZero(),this.m_revolute1?(this.m_J.angularA=-1,m+=o.m_invI):(e=n.m_xf.R,i=this.m_prismatic1.m_localXAxis1,a=e.col1.x*i.x+e.col2.x*i.y,l=e.col1.y*i.x+e.col2.y*i.y,e=o.m_xf.R,c=this.m_localAnchor1.x-o.m_sweep.localCenter.x,u=this.m_localAnchor1.y-o.m_sweep.localCenter.y,p=e.col1.x*c+e.col2.x*u,u=e.col1.y*c+e.col2.y*u,c=p,h=c*l-u*a,this.m_J.linearA.Set(-a,-l),this.m_J.angularA=-h,m+=o.m_invMass+o.m_invI*h*h),this.m_revolute2?(this.m_J.angularB=-this.m_ratio,m+=this.m_ratio*this.m_ratio*s.m_invI):(e=r.m_xf.R,i=this.m_prismatic2.m_localXAxis1,a=e.col1.x*i.x+e.col2.x*i.y,l=e.col1.y*i.x+e.col2.y*i.y,e=s.m_xf.R,c=this.m_localAnchor2.x-s.m_sweep.localCenter.x,u=this.m_localAnchor2.y-s.m_sweep.localCenter.y,p=e.col1.x*c+e.col2.x*u,u=e.col1.y*c+e.col2.y*u,c=p,h=c*l-u*a,this.m_J.linearB.Set(-this.m_ratio*a,-this.m_ratio*l),this.m_J.angularB=-this.m_ratio*h,m+=this.m_ratio*this.m_ratio*(s.m_invMass+s.m_invI*h*h)),this.m_mass=m>0?1/m:0,t.warmStarting?(o.m_linearVelocity.x+=o.m_invMass*this.m_impulse*this.m_J.linearA.x,o.m_linearVelocity.y+=o.m_invMass*this.m_impulse*this.m_J.linearA.y,o.m_angularVelocity+=o.m_invI*this.m_impulse*this.m_J.angularA,s.m_linearVelocity.x+=s.m_invMass*this.m_impulse*this.m_J.linearB.x,s.m_linearVelocity.y+=s.m_invMass*this.m_impulse*this.m_J.linearB.y,s.m_angularVelocity+=s.m_invI*this.m_impulse*this.m_J.angularB):this.m_impulse=0},h.prototype.SolveVelocityConstraints=function(t){var e=this.m_bodyA,i=this.m_bodyB,n=this.m_J.Compute(e.m_linearVelocity,e.m_angularVelocity,i.m_linearVelocity,i.m_angularVelocity),r=-this.m_mass*n;this.m_impulse+=r,e.m_linearVelocity.x+=e.m_invMass*r*this.m_J.linearA.x,e.m_linearVelocity.y+=e.m_invMass*r*this.m_J.linearA.y,e.m_angularVelocity+=e.m_invI*r*this.m_J.angularA,i.m_linearVelocity.x+=i.m_invMass*r*this.m_J.linearB.x,i.m_linearVelocity.y+=i.m_invMass*r*this.m_J.linearB.y,i.m_angularVelocity+=i.m_invI*r*this.m_J.angularB},h.prototype.SolvePositionConstraints=function(e){void 0===e&&(e=0);var i=this.m_bodyA,n=this.m_bodyB,r=0,o=0;r=this.m_revolute1?this.m_revolute1.GetJointAngle():this.m_prismatic1.GetJointTranslation(),o=this.m_revolute2?this.m_revolute2.GetJointAngle():this.m_prismatic2.GetJointTranslation();var s=this.m_constant-(r+this.m_ratio*o),a=-this.m_mass*s;return i.m_sweep.c.x+=i.m_invMass*a*this.m_J.linearA.x,i.m_sweep.c.y+=i.m_invMass*a*this.m_J.linearA.y,i.m_sweep.a+=i.m_invI*a*this.m_J.angularA,n.m_sweep.c.x+=n.m_invMass*a*this.m_J.linearB.x,n.m_sweep.c.y+=n.m_invMass*a*this.m_J.linearB.y,n.m_sweep.a+=n.m_invI*a*this.m_J.angularB,i.SynchronizeTransform(),n.SynchronizeTransform(),0<t.b2_linearSlop},n.inherit(p,n.Dynamics.Joints.b2JointDef),p.prototype.__super=n.Dynamics.Joints.b2JointDef.prototype,p.b2GearJointDef=function(){n.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments)},p.prototype.b2GearJointDef=function(){this.__super.b2JointDef.call(this),this.type=f.e_gearJoint,this.joint1=null,this.joint2=null,this.ratio=1},m.b2Jacobian=function(){this.linearA=new o,this.linearB=new o},m.prototype.SetZero=function(){this.linearA.SetZero(),this.angularA=0,this.linearB.SetZero(),this.angularB=0},m.prototype.Set=function(t,e,i,n){void 0===e&&(e=0),void 0===n&&(n=0),this.linearA.SetV(t),this.angularA=e,this.linearB.SetV(i),this.angularB=n},m.prototype.Compute=function(t,e,i,n){return void 0===e&&(e=0),void 0===n&&(n=0),this.linearA.x*t.x+this.linearA.y*t.y+this.angularA*e+(this.linearB.x*i.x+this.linearB.y*i.y)+this.angularB*n},f.b2Joint=function(){this.m_edgeA=new d,this.m_edgeB=new d,this.m_localCenterA=new o,this.m_localCenterB=new o},f.prototype.GetType=function(){return this.m_type},f.prototype.GetAnchorA=function(){return null},f.prototype.GetAnchorB=function(){return null},f.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),null},f.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),0},f.prototype.GetBodyA=function(){return this.m_bodyA},f.prototype.GetBodyB=function(){return this.m_bodyB},f.prototype.GetNext=function(){return this.m_next},f.prototype.GetUserData=function(){return this.m_userData},f.prototype.SetUserData=function(t){this.m_userData=t},f.prototype.IsActive=function(){return this.m_bodyA.IsActive()&&this.m_bodyB.IsActive()},f.Create=function(t,e){var i=null;switch(t.type){case f.e_distanceJoint:i=new a(t instanceof l?t:null);break;case f.e_mouseJoint:i=new v(t instanceof x?t:null);break;case f.e_prismaticJoint:i=new b(t instanceof w?t:null);break;case f.e_revoluteJoint:i=new A(t instanceof D?t:null);break;case f.e_pulleyJoint:i=new C(t instanceof S?t:null);break;case f.e_gearJoint:i=new h(t instanceof p?t:null);break;case f.e_lineJoint:i=new y(t instanceof g?t:null);break;case f.e_weldJoint:i=new M(t instanceof T?t:null);break;case f.e_frictionJoint:i=new c(t instanceof u?t:null)}return i},f.Destroy=function(t,e){},f.prototype.b2Joint=function(e){t.b2Assert(e.bodyA!=e.bodyB),this.m_type=e.type,this.m_prev=null,this.m_next=null,this.m_bodyA=e.bodyA,this.m_bodyB=e.bodyB,this.m_collideConnected=e.collideConnected,this.m_islandFlag=!1,this.m_userData=e.userData},f.prototype.InitVelocityConstraints=function(t){},f.prototype.SolveVelocityConstraints=function(t){},f.prototype.FinalizeVelocityConstraints=function(){},f.prototype.SolvePositionConstraints=function(t){return void 0===t&&(t=0),!1},n.postDefs.push(function(){n.Dynamics.Joints.b2Joint.e_unknownJoint=0,n.Dynamics.Joints.b2Joint.e_revoluteJoint=1,n.Dynamics.Joints.b2Joint.e_prismaticJoint=2,n.Dynamics.Joints.b2Joint.e_distanceJoint=3,n.Dynamics.Joints.b2Joint.e_pulleyJoint=4,n.Dynamics.Joints.b2Joint.e_mouseJoint=5,n.Dynamics.Joints.b2Joint.e_gearJoint=6,n.Dynamics.Joints.b2Joint.e_lineJoint=7,n.Dynamics.Joints.b2Joint.e_weldJoint=8,n.Dynamics.Joints.b2Joint.e_frictionJoint=9,n.Dynamics.Joints.b2Joint.e_inactiveLimit=0,n.Dynamics.Joints.b2Joint.e_atLowerLimit=1,n.Dynamics.Joints.b2Joint.e_atUpperLimit=2,n.Dynamics.Joints.b2Joint.e_equalLimits=3}),_.b2JointDef=function(){},_.prototype.b2JointDef=function(){this.type=f.e_unknownJoint,this.userData=null,this.bodyA=null,this.bodyB=null,this.collideConnected=!1},d.b2JointEdge=function(){},n.inherit(y,n.Dynamics.Joints.b2Joint),y.prototype.__super=n.Dynamics.Joints.b2Joint.prototype,y.b2LineJoint=function(){n.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_localAnchor1=new o,this.m_localAnchor2=new o,this.m_localXAxis1=new o,this.m_localYAxis1=new o,this.m_axis=new o,this.m_perp=new o,this.m_K=new e,this.m_impulse=new o},y.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},y.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},y.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new o(t*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.x),t*(this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.y))},y.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),t*this.m_impulse.y},y.prototype.GetJointTranslation=function(){var t=this.m_bodyA,e=this.m_bodyB,i=t.GetWorldPoint(this.m_localAnchor1),n=e.GetWorldPoint(this.m_localAnchor2),r=n.x-i.x,o=n.y-i.y,s=t.GetWorldVector(this.m_localXAxis1);return s.x*r+s.y*o},y.prototype.GetJointSpeed=function(){var t,e=this.m_bodyA,i=this.m_bodyB;t=e.m_xf.R;var n=this.m_localAnchor1.x-e.m_sweep.localCenter.x,r=this.m_localAnchor1.y-e.m_sweep.localCenter.y,o=t.col1.x*n+t.col2.x*r;r=t.col1.y*n+t.col2.y*r,n=o,t=i.m_xf.R;var s=this.m_localAnchor2.x-i.m_sweep.localCenter.x,a=this.m_localAnchor2.y-i.m_sweep.localCenter.y;o=t.col1.x*s+t.col2.x*a,a=t.col1.y*s+t.col2.y*a,s=o;var l=e.m_sweep.c.x+n,c=e.m_sweep.c.y+r,u=i.m_sweep.c.x+s,h=i.m_sweep.c.y+a,p=u-l,m=h-c,f=e.GetWorldVector(this.m_localXAxis1),_=e.m_linearVelocity,d=i.m_linearVelocity,y=e.m_angularVelocity,g=i.m_angularVelocity;return p*(-y*f.y)+m*(y*f.x)+(f.x*(d.x+-g*a-_.x- -y*r)+f.y*(d.y+g*s-_.y-y*n))},y.prototype.IsLimitEnabled=function(){return this.m_enableLimit},y.prototype.EnableLimit=function(t){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableLimit=t},y.prototype.GetLowerLimit=function(){return this.m_lowerTranslation},y.prototype.GetUpperLimit=function(){return this.m_upperTranslation},y.prototype.SetLimits=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_lowerTranslation=t,this.m_upperTranslation=e},y.prototype.IsMotorEnabled=function(){return this.m_enableMotor},y.prototype.EnableMotor=function(t){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor=t},y.prototype.SetMotorSpeed=function(t){void 0===t&&(t=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=t},y.prototype.GetMotorSpeed=function(){return this.m_motorSpeed},y.prototype.SetMaxMotorForce=function(t){void 0===t&&(t=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_maxMotorForce=t},y.prototype.GetMaxMotorForce=function(){return this.m_maxMotorForce},y.prototype.GetMotorForce=function(){return this.m_motorImpulse},y.prototype.b2LineJoint=function(t){this.__super.b2Joint.call(this,t);this.m_localAnchor1.SetV(t.localAnchorA),this.m_localAnchor2.SetV(t.localAnchorB),this.m_localXAxis1.SetV(t.localAxisA),this.m_localYAxis1.x=-this.m_localXAxis1.y,this.m_localYAxis1.y=this.m_localXAxis1.x,this.m_impulse.SetZero(),this.m_motorMass=0,this.m_motorImpulse=0,this.m_lowerTranslation=t.lowerTranslation,this.m_upperTranslation=t.upperTranslation,this.m_maxMotorForce=t.maxMotorForce,this.m_motorSpeed=t.motorSpeed,this.m_enableLimit=t.enableLimit,this.m_enableMotor=t.enableMotor,this.m_limitState=f.e_inactiveLimit,this.m_axis.SetZero(),this.m_perp.SetZero()},y.prototype.InitVelocityConstraints=function(e){var i,n=this.m_bodyA,o=this.m_bodyB,s=0;this.m_localCenterA.SetV(n.GetLocalCenter()),this.m_localCenterB.SetV(o.GetLocalCenter());var a=n.GetTransform();o.GetTransform();i=n.m_xf.R;var l=this.m_localAnchor1.x-this.m_localCenterA.x,c=this.m_localAnchor1.y-this.m_localCenterA.y;s=i.col1.x*l+i.col2.x*c,c=i.col1.y*l+i.col2.y*c,l=s,i=o.m_xf.R;var u=this.m_localAnchor2.x-this.m_localCenterB.x,h=this.m_localAnchor2.y-this.m_localCenterB.y;s=i.col1.x*u+i.col2.x*h,h=i.col1.y*u+i.col2.y*h,u=s;var p=o.m_sweep.c.x+u-n.m_sweep.c.x-l,m=o.m_sweep.c.y+h-n.m_sweep.c.y-c;this.m_invMassA=n.m_invMass,this.m_invMassB=o.m_invMass,this.m_invIA=n.m_invI,this.m_invIB=o.m_invI,this.m_axis.SetV(r.MulMV(a.R,this.m_localXAxis1)),this.m_a1=(p+l)*this.m_axis.y-(m+c)*this.m_axis.x,this.m_a2=u*this.m_axis.y-h*this.m_axis.x,this.m_motorMass=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_a1*this.m_a1+this.m_invIB*this.m_a2*this.m_a2,this.m_motorMass=this.m_motorMass>Number.MIN_VALUE?1/this.m_motorMass:0,this.m_perp.SetV(r.MulMV(a.R,this.m_localYAxis1)),this.m_s1=(p+l)*this.m_perp.y-(m+c)*this.m_perp.x,this.m_s2=u*this.m_perp.y-h*this.m_perp.x;var _=this.m_invMassA,d=this.m_invMassB,y=this.m_invIA,g=this.m_invIB;if(this.m_K.col1.x=_+d+y*this.m_s1*this.m_s1+g*this.m_s2*this.m_s2,this.m_K.col1.y=y*this.m_s1*this.m_a1+g*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=_+d+y*this.m_a1*this.m_a1+g*this.m_a2*this.m_a2,this.m_enableLimit){var v=this.m_axis.x*p+this.m_axis.y*m;r.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*t.b2_linearSlop?this.m_limitState=f.e_equalLimits:v<=this.m_lowerTranslation?this.m_limitState!=f.e_atLowerLimit&&(this.m_limitState=f.e_atLowerLimit,this.m_impulse.y=0):v>=this.m_upperTranslation?this.m_limitState!=f.e_atUpperLimit&&(this.m_limitState=f.e_atUpperLimit,this.m_impulse.y=0):(this.m_limitState=f.e_inactiveLimit,this.m_impulse.y=0)}else this.m_limitState=f.e_inactiveLimit;if(0==this.m_enableMotor&&(this.m_motorImpulse=0),e.warmStarting){this.m_impulse.x*=e.dtRatio,this.m_impulse.y*=e.dtRatio,this.m_motorImpulse*=e.dtRatio;var x=this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.x,b=this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.y,w=this.m_impulse.x*this.m_s1+(this.m_motorImpulse+this.m_impulse.y)*this.m_a1,C=this.m_impulse.x*this.m_s2+(this.m_motorImpulse+this.m_impulse.y)*this.m_a2;n.m_linearVelocity.x-=this.m_invMassA*x,n.m_linearVelocity.y-=this.m_invMassA*b,n.m_angularVelocity-=this.m_invIA*w,o.m_linearVelocity.x+=this.m_invMassB*x,o.m_linearVelocity.y+=this.m_invMassB*b,o.m_angularVelocity+=this.m_invIB*C}else this.m_impulse.SetZero(),this.m_motorImpulse=0},y.prototype.SolveVelocityConstraints=function(t){var e=this.m_bodyA,i=this.m_bodyB,n=e.m_linearVelocity,s=e.m_angularVelocity,a=i.m_linearVelocity,l=i.m_angularVelocity,c=0,u=0,h=0,p=0;if(this.m_enableMotor&&this.m_limitState!=f.e_equalLimits){var m=this.m_axis.x*(a.x-n.x)+this.m_axis.y*(a.y-n.y)+this.m_a2*l-this.m_a1*s,_=this.m_motorMass*(this.m_motorSpeed-m),d=this.m_motorImpulse,y=t.dt*this.m_maxMotorForce;this.m_motorImpulse=r.Clamp(this.m_motorImpulse+_,-y,y),_=this.m_motorImpulse-d,c=_*this.m_axis.x,u=_*this.m_axis.y,h=_*this.m_a1,p=_*this.m_a2,n.x-=this.m_invMassA*c,n.y-=this.m_invMassA*u,s-=this.m_invIA*h,a.x+=this.m_invMassB*c,a.y+=this.m_invMassB*u,l+=this.m_invIB*p}var g=this.m_perp.x*(a.x-n.x)+this.m_perp.y*(a.y-n.y)+this.m_s2*l-this.m_s1*s;if(this.m_enableLimit&&this.m_limitState!=f.e_inactiveLimit){var v=this.m_axis.x*(a.x-n.x)+this.m_axis.y*(a.y-n.y)+this.m_a2*l-this.m_a1*s,x=this.m_impulse.Copy(),b=this.m_K.Solve(new o,-g,-v);this.m_impulse.Add(b),this.m_limitState==f.e_atLowerLimit?this.m_impulse.y=r.Max(this.m_impulse.y,0):this.m_limitState==f.e_atUpperLimit&&(this.m_impulse.y=r.Min(this.m_impulse.y,0));var w=-g-(this.m_impulse.y-x.y)*this.m_K.col2.x,C=0;C=0!=this.m_K.col1.x?w/this.m_K.col1.x+x.x:x.x,this.m_impulse.x=C,b.x=this.m_impulse.x-x.x,b.y=this.m_impulse.y-x.y,c=b.x*this.m_perp.x+b.y*this.m_axis.x,u=b.x*this.m_perp.y+b.y*this.m_axis.y,h=b.x*this.m_s1+b.y*this.m_a1,p=b.x*this.m_s2+b.y*this.m_a2,n.x-=this.m_invMassA*c,n.y-=this.m_invMassA*u,s-=this.m_invIA*h,a.x+=this.m_invMassB*c,a.y+=this.m_invMassB*u,l+=this.m_invIB*p}else{var S=0;S=0!=this.m_K.col1.x?-g/this.m_K.col1.x:0,this.m_impulse.x+=S,c=S*this.m_perp.x,u=S*this.m_perp.y,h=S*this.m_s1,p=S*this.m_s2,n.x-=this.m_invMassA*c,n.y-=this.m_invMassA*u,s-=this.m_invIA*h,a.x+=this.m_invMassB*c,a.y+=this.m_invMassB*u,l+=this.m_invIB*p}e.m_linearVelocity.SetV(n),e.m_angularVelocity=s,i.m_linearVelocity.SetV(a),i.m_angularVelocity=l},y.prototype.SolvePositionConstraints=function(i){void 0===i&&(i=0);var n,s=this.m_bodyA,a=this.m_bodyB,l=s.m_sweep.c,c=s.m_sweep.a,u=a.m_sweep.c,h=a.m_sweep.a,p=0,m=0,f=0,_=0,d=0,y=0,g=0,v=!1,x=0,b=e.FromAngle(c),w=e.FromAngle(h);n=b;var C=this.m_localAnchor1.x-this.m_localCenterA.x,S=this.m_localAnchor1.y-this.m_localCenterA.y;p=n.col1.x*C+n.col2.x*S,S=n.col1.y*C+n.col2.y*S,C=p,n=w;var A=this.m_localAnchor2.x-this.m_localCenterB.x,D=this.m_localAnchor2.y-this.m_localCenterB.y;p=n.col1.x*A+n.col2.x*D,D=n.col1.y*A+n.col2.y*D,A=p;var M=u.x+A-l.x-C,T=u.y+D-l.y-S;if(this.m_enableLimit){this.m_axis=r.MulMV(b,this.m_localXAxis1),this.m_a1=(M+C)*this.m_axis.y-(T+S)*this.m_axis.x,this.m_a2=A*this.m_axis.y-D*this.m_axis.x;var k=this.m_axis.x*M+this.m_axis.y*T;r.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*t.b2_linearSlop?(x=r.Clamp(k,-t.b2_maxLinearCorrection,t.b2_maxLinearCorrection),y=r.Abs(k),v=!0):k<=this.m_lowerTranslation?(x=r.Clamp(k-this.m_lowerTranslation+t.b2_linearSlop,-t.b2_maxLinearCorrection,0),y=this.m_lowerTranslation-k,v=!0):k>=this.m_upperTranslation&&(x=r.Clamp(k-this.m_upperTranslation+t.b2_linearSlop,0,t.b2_maxLinearCorrection),y=k-this.m_upperTranslation,v=!0)}this.m_perp=r.MulMV(b,this.m_localYAxis1),this.m_s1=(M+C)*this.m_perp.y-(T+S)*this.m_perp.x,this.m_s2=A*this.m_perp.y-D*this.m_perp.x;var I=new o,P=this.m_perp.x*M+this.m_perp.y*T;if(y=r.Max(y,r.Abs(P)),g=0,v)m=this.m_invMassA,f=this.m_invMassB,_=this.m_invIA,d=this.m_invIB,this.m_K.col1.x=m+f+_*this.m_s1*this.m_s1+d*this.m_s2*this.m_s2,this.m_K.col1.y=_*this.m_s1*this.m_a1+d*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=m+f+_*this.m_a1*this.m_a1+d*this.m_a2*this.m_a2,this.m_K.Solve(I,-P,-x);else{m=this.m_invMassA,f=this.m_invMassB,_=this.m_invIA,d=this.m_invIB;var B=m+f+_*this.m_s1*this.m_s1+d*this.m_s2*this.m_s2,E=0;E=0!=B?-P/B:0,I.x=E,I.y=0}var L=I.x*this.m_perp.x+I.y*this.m_axis.x,R=I.x*this.m_perp.y+I.y*this.m_axis.y,V=I.x*this.m_s1+I.y*this.m_a1,O=I.x*this.m_s2+I.y*this.m_a2;return l.x-=this.m_invMassA*L,l.y-=this.m_invMassA*R,c-=this.m_invIA*V,u.x+=this.m_invMassB*L,u.y+=this.m_invMassB*R,h+=this.m_invIB*O,s.m_sweep.a=c,a.m_sweep.a=h,s.SynchronizeTransform(),a.SynchronizeTransform(),y<=t.b2_linearSlop&&g<=t.b2_angularSlop},n.inherit(g,n.Dynamics.Joints.b2JointDef),g.prototype.__super=n.Dynamics.Joints.b2JointDef.prototype,g.b2LineJointDef=function(){n.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.localAnchorA=new o,this.localAnchorB=new o,this.localAxisA=new o},g.prototype.b2LineJointDef=function(){this.__super.b2JointDef.call(this),this.type=f.e_lineJoint,this.localAxisA.Set(1,0),this.enableLimit=!1,this.lowerTranslation=0,this.upperTranslation=0,this.enableMotor=!1,this.maxMotorForce=0,this.motorSpeed=0},g.prototype.Initialize=function(t,e,i,n){this.bodyA=t,this.bodyB=e,this.localAnchorA=this.bodyA.GetLocalPoint(i),this.localAnchorB=this.bodyB.GetLocalPoint(i),this.localAxisA=this.bodyA.GetLocalVector(n)},n.inherit(v,n.Dynamics.Joints.b2Joint),v.prototype.__super=n.Dynamics.Joints.b2Joint.prototype,v.b2MouseJoint=function(){n.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.K=new e,this.K1=new e,this.K2=new e,this.m_localAnchor=new o,this.m_target=new o,this.m_impulse=new o,this.m_mass=new e,this.m_C=new o},v.prototype.GetAnchorA=function(){return this.m_target},v.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor)},v.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new o(t*this.m_impulse.x,t*this.m_impulse.y)},v.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),0},v.prototype.GetTarget=function(){return this.m_target},v.prototype.SetTarget=function(t){0==this.m_bodyB.IsAwake()&&this.m_bodyB.SetAwake(!0),this.m_target=t},v.prototype.GetMaxForce=function(){return this.m_maxForce},v.prototype.SetMaxForce=function(t){void 0===t&&(t=0),this.m_maxForce=t},v.prototype.GetFrequency=function(){return this.m_frequencyHz},v.prototype.SetFrequency=function(t){void 0===t&&(t=0),this.m_frequencyHz=t},v.prototype.GetDampingRatio=function(){return this.m_dampingRatio},v.prototype.SetDampingRatio=function(t){void 0===t&&(t=0),this.m_dampingRatio=t},v.prototype.b2MouseJoint=function(t){this.__super.b2Joint.call(this,t),this.m_target.SetV(t.target);var e=this.m_target.x-this.m_bodyB.m_xf.position.x,i=this.m_target.y-this.m_bodyB.m_xf.position.y,n=this.m_bodyB.m_xf.R;this.m_localAnchor.x=e*n.col1.x+i*n.col1.y,this.m_localAnchor.y=e*n.col2.x+i*n.col2.y,this.m_maxForce=t.maxForce,this.m_impulse.SetZero(),this.m_frequencyHz=t.frequencyHz,this.m_dampingRatio=t.dampingRatio,this.m_beta=0,this.m_gamma=0},v.prototype.InitVelocityConstraints=function(t){var e=this.m_bodyB,i=e.GetMass(),n=2*Math.PI*this.m_frequencyHz,r=2*i*this.m_dampingRatio*n,o=i*n*n;this.m_gamma=t.dt*(r+t.dt*o),this.m_gamma=0!=this.m_gamma?1/this.m_gamma:0,this.m_beta=t.dt*o*this.m_gamma;var s;s=e.m_xf.R;var a=this.m_localAnchor.x-e.m_sweep.localCenter.x,l=this.m_localAnchor.y-e.m_sweep.localCenter.y,c=s.col1.x*a+s.col2.x*l;l=s.col1.y*a+s.col2.y*l,a=c;var u=e.m_invMass,h=e.m_invI;this.K1.col1.x=u,this.K1.col2.x=0,this.K1.col1.y=0,this.K1.col2.y=u,this.K2.col1.x=h*l*l,this.K2.col2.x=-h*a*l,this.K2.col1.y=-h*a*l,this.K2.col2.y=h*a*a,this.K.SetM(this.K1),this.K.AddM(this.K2),this.K.col1.x+=this.m_gamma,this.K.col2.y+=this.m_gamma,this.K.GetInverse(this.m_mass),this.m_C.x=e.m_sweep.c.x+a-this.m_target.x,this.m_C.y=e.m_sweep.c.y+l-this.m_target.y,e.m_angularVelocity*=.98,this.m_impulse.x*=t.dtRatio,this.m_impulse.y*=t.dtRatio,e.m_linearVelocity.x+=u*this.m_impulse.x,e.m_linearVelocity.y+=u*this.m_impulse.y,e.m_angularVelocity+=h*(a*this.m_impulse.y-l*this.m_impulse.x)},v.prototype.SolveVelocityConstraints=function(t){var e,i=this.m_bodyB,n=0,r=0;e=i.m_xf.R;var o=this.m_localAnchor.x-i.m_sweep.localCenter.x,s=this.m_localAnchor.y-i.m_sweep.localCenter.y;n=e.col1.x*o+e.col2.x*s,s=e.col1.y*o+e.col2.y*s,o=n;var a=i.m_linearVelocity.x+-i.m_angularVelocity*s,l=i.m_linearVelocity.y+i.m_angularVelocity*o;e=this.m_mass,n=a+this.m_beta*this.m_C.x+this.m_gamma*this.m_impulse.x,r=l+this.m_beta*this.m_C.y+this.m_gamma*this.m_impulse.y;var c=-(e.col1.x*n+e.col2.x*r),u=-(e.col1.y*n+e.col2.y*r),h=this.m_impulse.x,p=this.m_impulse.y;this.m_impulse.x+=c,this.m_impulse.y+=u;var m=t.dt*this.m_maxForce;this.m_impulse.LengthSquared()>m*m&&this.m_impulse.Multiply(m/this.m_impulse.Length()),c=this.m_impulse.x-h,u=this.m_impulse.y-p,i.m_linearVelocity.x+=i.m_invMass*c,i.m_linearVelocity.y+=i.m_invMass*u,i.m_angularVelocity+=i.m_invI*(o*u-s*c)},v.prototype.SolvePositionConstraints=function(t){return void 0===t&&(t=0),!0},n.inherit(x,n.Dynamics.Joints.b2JointDef),x.prototype.__super=n.Dynamics.Joints.b2JointDef.prototype,x.b2MouseJointDef=function(){n.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.target=new o},x.prototype.b2MouseJointDef=function(){this.__super.b2JointDef.call(this),this.type=f.e_mouseJoint,this.maxForce=0,this.frequencyHz=5,this.dampingRatio=.7},n.inherit(b,n.Dynamics.Joints.b2Joint),b.prototype.__super=n.Dynamics.Joints.b2Joint.prototype,b.b2PrismaticJoint=function(){n.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_localAnchor1=new o,this.m_localAnchor2=new o,this.m_localXAxis1=new o,this.m_localYAxis1=new o,this.m_axis=new o,this.m_perp=new o,this.m_K=new i,this.m_impulse=new s},b.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},b.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},b.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new o(t*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.x),t*(this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.y))},b.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),t*this.m_impulse.y},b.prototype.GetJointTranslation=function(){var t=this.m_bodyA,e=this.m_bodyB,i=t.GetWorldPoint(this.m_localAnchor1),n=e.GetWorldPoint(this.m_localAnchor2),r=n.x-i.x,o=n.y-i.y,s=t.GetWorldVector(this.m_localXAxis1);return s.x*r+s.y*o},b.prototype.GetJointSpeed=function(){var t,e=this.m_bodyA,i=this.m_bodyB;t=e.m_xf.R;var n=this.m_localAnchor1.x-e.m_sweep.localCenter.x,r=this.m_localAnchor1.y-e.m_sweep.localCenter.y,o=t.col1.x*n+t.col2.x*r;r=t.col1.y*n+t.col2.y*r,n=o,t=i.m_xf.R;var s=this.m_localAnchor2.x-i.m_sweep.localCenter.x,a=this.m_localAnchor2.y-i.m_sweep.localCenter.y;o=t.col1.x*s+t.col2.x*a,a=t.col1.y*s+t.col2.y*a,s=o;var l=e.m_sweep.c.x+n,c=e.m_sweep.c.y+r,u=i.m_sweep.c.x+s,h=i.m_sweep.c.y+a,p=u-l,m=h-c,f=e.GetWorldVector(this.m_localXAxis1),_=e.m_linearVelocity,d=i.m_linearVelocity,y=e.m_angularVelocity,g=i.m_angularVelocity;return p*(-y*f.y)+m*(y*f.x)+(f.x*(d.x+-g*a-_.x- -y*r)+f.y*(d.y+g*s-_.y-y*n))},b.prototype.IsLimitEnabled=function(){return this.m_enableLimit},b.prototype.EnableLimit=function(t){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableLimit=t},b.prototype.GetLowerLimit=function(){return this.m_lowerTranslation},b.prototype.GetUpperLimit=function(){return this.m_upperTranslation},b.prototype.SetLimits=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_lowerTranslation=t,this.m_upperTranslation=e},b.prototype.IsMotorEnabled=function(){return this.m_enableMotor},b.prototype.EnableMotor=function(t){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor=t},b.prototype.SetMotorSpeed=function(t){void 0===t&&(t=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=t},b.prototype.GetMotorSpeed=function(){return this.m_motorSpeed},b.prototype.SetMaxMotorForce=function(t){void 0===t&&(t=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_maxMotorForce=t},b.prototype.GetMotorForce=function(){return this.m_motorImpulse},b.prototype.b2PrismaticJoint=function(t){this.__super.b2Joint.call(this,t);this.m_localAnchor1.SetV(t.localAnchorA),this.m_localAnchor2.SetV(t.localAnchorB),this.m_localXAxis1.SetV(t.localAxisA),this.m_localYAxis1.x=-this.m_localXAxis1.y,this.m_localYAxis1.y=this.m_localXAxis1.x,this.m_refAngle=t.referenceAngle,this.m_impulse.SetZero(),this.m_motorMass=0,this.m_motorImpulse=0,this.m_lowerTranslation=t.lowerTranslation,this.m_upperTranslation=t.upperTranslation,this.m_maxMotorForce=t.maxMotorForce,this.m_motorSpeed=t.motorSpeed,this.m_enableLimit=t.enableLimit,this.m_enableMotor=t.enableMotor,this.m_limitState=f.e_inactiveLimit,this.m_axis.SetZero(),this.m_perp.SetZero()},b.prototype.InitVelocityConstraints=function(e){var i,n=this.m_bodyA,o=this.m_bodyB,s=0;this.m_localCenterA.SetV(n.GetLocalCenter()),this.m_localCenterB.SetV(o.GetLocalCenter());var a=n.GetTransform();o.GetTransform();i=n.m_xf.R;var l=this.m_localAnchor1.x-this.m_localCenterA.x,c=this.m_localAnchor1.y-this.m_localCenterA.y;s=i.col1.x*l+i.col2.x*c,c=i.col1.y*l+i.col2.y*c,l=s,i=o.m_xf.R;var u=this.m_localAnchor2.x-this.m_localCenterB.x,h=this.m_localAnchor2.y-this.m_localCenterB.y;s=i.col1.x*u+i.col2.x*h,h=i.col1.y*u+i.col2.y*h,u=s;var p=o.m_sweep.c.x+u-n.m_sweep.c.x-l,m=o.m_sweep.c.y+h-n.m_sweep.c.y-c;this.m_invMassA=n.m_invMass,this.m_invMassB=o.m_invMass,this.m_invIA=n.m_invI,this.m_invIB=o.m_invI,this.m_axis.SetV(r.MulMV(a.R,this.m_localXAxis1)),this.m_a1=(p+l)*this.m_axis.y-(m+c)*this.m_axis.x,this.m_a2=u*this.m_axis.y-h*this.m_axis.x,this.m_motorMass=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_a1*this.m_a1+this.m_invIB*this.m_a2*this.m_a2,this.m_motorMass>Number.MIN_VALUE&&(this.m_motorMass=1/this.m_motorMass),this.m_perp.SetV(r.MulMV(a.R,this.m_localYAxis1)),this.m_s1=(p+l)*this.m_perp.y-(m+c)*this.m_perp.x,this.m_s2=u*this.m_perp.y-h*this.m_perp.x;var _=this.m_invMassA,d=this.m_invMassB,y=this.m_invIA,g=this.m_invIB;if(this.m_K.col1.x=_+d+y*this.m_s1*this.m_s1+g*this.m_s2*this.m_s2,this.m_K.col1.y=y*this.m_s1+g*this.m_s2,this.m_K.col1.z=y*this.m_s1*this.m_a1+g*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=y+g,this.m_K.col2.z=y*this.m_a1+g*this.m_a2,this.m_K.col3.x=this.m_K.col1.z,this.m_K.col3.y=this.m_K.col2.z,this.m_K.col3.z=_+d+y*this.m_a1*this.m_a1+g*this.m_a2*this.m_a2,this.m_enableLimit){var v=this.m_axis.x*p+this.m_axis.y*m;r.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*t.b2_linearSlop?this.m_limitState=f.e_equalLimits:v<=this.m_lowerTranslation?this.m_limitState!=f.e_atLowerLimit&&(this.m_limitState=f.e_atLowerLimit,this.m_impulse.z=0):v>=this.m_upperTranslation?this.m_limitState!=f.e_atUpperLimit&&(this.m_limitState=f.e_atUpperLimit,this.m_impulse.z=0):(this.m_limitState=f.e_inactiveLimit,this.m_impulse.z=0)}else this.m_limitState=f.e_inactiveLimit;if(0==this.m_enableMotor&&(this.m_motorImpulse=0),e.warmStarting){this.m_impulse.x*=e.dtRatio,this.m_impulse.y*=e.dtRatio,this.m_motorImpulse*=e.dtRatio;var x=this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.x,b=this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.y,w=this.m_impulse.x*this.m_s1+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a1,C=this.m_impulse.x*this.m_s2+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a2;n.m_linearVelocity.x-=this.m_invMassA*x,n.m_linearVelocity.y-=this.m_invMassA*b,n.m_angularVelocity-=this.m_invIA*w,o.m_linearVelocity.x+=this.m_invMassB*x,o.m_linearVelocity.y+=this.m_invMassB*b,o.m_angularVelocity+=this.m_invIB*C}else this.m_impulse.SetZero(),this.m_motorImpulse=0},b.prototype.SolveVelocityConstraints=function(t){var e=this.m_bodyA,i=this.m_bodyB,n=e.m_linearVelocity,a=e.m_angularVelocity,l=i.m_linearVelocity,c=i.m_angularVelocity,u=0,h=0,p=0,m=0;if(this.m_enableMotor&&this.m_limitState!=f.e_equalLimits){var _=this.m_axis.x*(l.x-n.x)+this.m_axis.y*(l.y-n.y)+this.m_a2*c-this.m_a1*a,d=this.m_motorMass*(this.m_motorSpeed-_),y=this.m_motorImpulse,g=t.dt*this.m_maxMotorForce;this.m_motorImpulse=r.Clamp(this.m_motorImpulse+d,-g,g),d=this.m_motorImpulse-y,u=d*this.m_axis.x,h=d*this.m_axis.y,p=d*this.m_a1,m=d*this.m_a2,n.x-=this.m_invMassA*u,n.y-=this.m_invMassA*h,a-=this.m_invIA*p,l.x+=this.m_invMassB*u,l.y+=this.m_invMassB*h,c+=this.m_invIB*m}var v=this.m_perp.x*(l.x-n.x)+this.m_perp.y*(l.y-n.y)+this.m_s2*c-this.m_s1*a,x=c-a;if(this.m_enableLimit&&this.m_limitState!=f.e_inactiveLimit){var b=this.m_axis.x*(l.x-n.x)+this.m_axis.y*(l.y-n.y)+this.m_a2*c-this.m_a1*a,w=this.m_impulse.Copy(),C=this.m_K.Solve33(new s,-v,-x,-b);this.m_impulse.Add(C),this.m_limitState==f.e_atLowerLimit?this.m_impulse.z=r.Max(this.m_impulse.z,0):this.m_limitState==f.e_atUpperLimit&&(this.m_impulse.z=r.Min(this.m_impulse.z,0));var S=-v-(this.m_impulse.z-w.z)*this.m_K.col3.x,A=-x-(this.m_impulse.z-w.z)*this.m_K.col3.y,D=this.m_K.Solve22(new o,S,A);D.x+=w.x,D.y+=w.y,this.m_impulse.x=D.x,this.m_impulse.y=D.y,C.x=this.m_impulse.x-w.x,C.y=this.m_impulse.y-w.y,C.z=this.m_impulse.z-w.z,u=C.x*this.m_perp.x+C.z*this.m_axis.x,h=C.x*this.m_perp.y+C.z*this.m_axis.y,p=C.x*this.m_s1+C.y+C.z*this.m_a1,m=C.x*this.m_s2+C.y+C.z*this.m_a2,n.x-=this.m_invMassA*u,n.y-=this.m_invMassA*h,a-=this.m_invIA*p,l.x+=this.m_invMassB*u,l.y+=this.m_invMassB*h,c+=this.m_invIB*m}else{var M=this.m_K.Solve22(new o,-v,-x);this.m_impulse.x+=M.x,this.m_impulse.y+=M.y,u=M.x*this.m_perp.x,h=M.x*this.m_perp.y,p=M.x*this.m_s1+M.y,m=M.x*this.m_s2+M.y,n.x-=this.m_invMassA*u,n.y-=this.m_invMassA*h,a-=this.m_invIA*p,l.x+=this.m_invMassB*u,l.y+=this.m_invMassB*h,c+=this.m_invIB*m}e.m_linearVelocity.SetV(n),e.m_angularVelocity=a,i.m_linearVelocity.SetV(l),i.m_angularVelocity=c},b.prototype.SolvePositionConstraints=function(i){void 0===i&&(i=0);var n,a=this.m_bodyA,l=this.m_bodyB,c=a.m_sweep.c,u=a.m_sweep.a,h=l.m_sweep.c,p=l.m_sweep.a,m=0,f=0,_=0,d=0,y=0,g=0,v=0,x=!1,b=0,w=e.FromAngle(u),C=e.FromAngle(p);n=w;var S=this.m_localAnchor1.x-this.m_localCenterA.x,A=this.m_localAnchor1.y-this.m_localCenterA.y;m=n.col1.x*S+n.col2.x*A,A=n.col1.y*S+n.col2.y*A,S=m,n=C;var D=this.m_localAnchor2.x-this.m_localCenterB.x,M=this.m_localAnchor2.y-this.m_localCenterB.y;m=n.col1.x*D+n.col2.x*M,M=n.col1.y*D+n.col2.y*M,D=m;var T=h.x+D-c.x-S,k=h.y+M-c.y-A;if(this.m_enableLimit){this.m_axis=r.MulMV(w,this.m_localXAxis1),this.m_a1=(T+S)*this.m_axis.y-(k+A)*this.m_axis.x,this.m_a2=D*this.m_axis.y-M*this.m_axis.x;var I=this.m_axis.x*T+this.m_axis.y*k;r.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*t.b2_linearSlop?(b=r.Clamp(I,-t.b2_maxLinearCorrection,t.b2_maxLinearCorrection),g=r.Abs(I),x=!0):I<=this.m_lowerTranslation?(b=r.Clamp(I-this.m_lowerTranslation+t.b2_linearSlop,-t.b2_maxLinearCorrection,0),g=this.m_lowerTranslation-I,x=!0):I>=this.m_upperTranslation&&(b=r.Clamp(I-this.m_upperTranslation+t.b2_linearSlop,0,t.b2_maxLinearCorrection),g=I-this.m_upperTranslation,x=!0)}this.m_perp=r.MulMV(w,this.m_localYAxis1),this.m_s1=(T+S)*this.m_perp.y-(k+A)*this.m_perp.x,this.m_s2=D*this.m_perp.y-M*this.m_perp.x;var P=new s,B=this.m_perp.x*T+this.m_perp.y*k,E=p-u-this.m_refAngle;if(g=r.Max(g,r.Abs(B)),v=r.Abs(E),x)f=this.m_invMassA,_=this.m_invMassB,d=this.m_invIA,y=this.m_invIB,this.m_K.col1.x=f+_+d*this.m_s1*this.m_s1+y*this.m_s2*this.m_s2,this.m_K.col1.y=d*this.m_s1+y*this.m_s2,this.m_K.col1.z=d*this.m_s1*this.m_a1+y*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=d+y,this.m_K.col2.z=d*this.m_a1+y*this.m_a2,this.m_K.col3.x=this.m_K.col1.z,this.m_K.col3.y=this.m_K.col2.z,this.m_K.col3.z=f+_+d*this.m_a1*this.m_a1+y*this.m_a2*this.m_a2,this.m_K.Solve33(P,-B,-E,-b);else{f=this.m_invMassA,_=this.m_invMassB,d=this.m_invIA,y=this.m_invIB;var L=f+_+d*this.m_s1*this.m_s1+y*this.m_s2*this.m_s2,R=d*this.m_s1+y*this.m_s2,V=d+y;this.m_K.col1.Set(L,R,0),this.m_K.col2.Set(R,V,0);var O=this.m_K.Solve22(new o,-B,-E);P.x=O.x,P.y=O.y,P.z=0}var F=P.x*this.m_perp.x+P.z*this.m_axis.x,N=P.x*this.m_perp.y+P.z*this.m_axis.y,j=P.x*this.m_s1+P.y+P.z*this.m_a1,G=P.x*this.m_s2+P.y+P.z*this.m_a2;return c.x-=this.m_invMassA*F,c.y-=this.m_invMassA*N,u-=this.m_invIA*j,h.x+=this.m_invMassB*F,h.y+=this.m_invMassB*N,p+=this.m_invIB*G,a.m_sweep.a=u,l.m_sweep.a=p,a.SynchronizeTransform(),l.SynchronizeTransform(),g<=t.b2_linearSlop&&v<=t.b2_angularSlop},n.inherit(w,n.Dynamics.Joints.b2JointDef),w.prototype.__super=n.Dynamics.Joints.b2JointDef.prototype,w.b2PrismaticJointDef=function(){n.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.localAnchorA=new o,this.localAnchorB=new o,this.localAxisA=new o},w.prototype.b2PrismaticJointDef=function(){this.__super.b2JointDef.call(this),this.type=f.e_prismaticJoint,this.localAxisA.Set(1,0),this.referenceAngle=0,this.enableLimit=!1,this.lowerTranslation=0,this.upperTranslation=0,this.enableMotor=!1,this.maxMotorForce=0,this.motorSpeed=0},w.prototype.Initialize=function(t,e,i,n){this.bodyA=t,this.bodyB=e,this.localAnchorA=this.bodyA.GetLocalPoint(i),this.localAnchorB=this.bodyB.GetLocalPoint(i),this.localAxisA=this.bodyA.GetLocalVector(n),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()},n.inherit(C,n.Dynamics.Joints.b2Joint),C.prototype.__super=n.Dynamics.Joints.b2Joint.prototype,C.b2PulleyJoint=function(){n.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_groundAnchor1=new o,this.m_groundAnchor2=new o,this.m_localAnchor1=new o,this.m_localAnchor2=new o,this.m_u1=new o,this.m_u2=new o},C.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},C.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},C.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new o(t*this.m_impulse*this.m_u2.x,t*this.m_impulse*this.m_u2.y)},C.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),0},C.prototype.GetGroundAnchorA=function(){var t=this.m_ground.m_xf.position.Copy();return t.Add(this.m_groundAnchor1),t},C.prototype.GetGroundAnchorB=function(){var t=this.m_ground.m_xf.position.Copy();return t.Add(this.m_groundAnchor2),t},C.prototype.GetLength1=function(){var t=this.m_bodyA.GetWorldPoint(this.m_localAnchor1),e=this.m_ground.m_xf.position.x+this.m_groundAnchor1.x,i=this.m_ground.m_xf.position.y+this.m_groundAnchor1.y,n=t.x-e,r=t.y-i;return Math.sqrt(n*n+r*r)},C.prototype.GetLength2=function(){var t=this.m_bodyB.GetWorldPoint(this.m_localAnchor2),e=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x,i=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y,n=t.x-e,r=t.y-i;return Math.sqrt(n*n+r*r)},C.prototype.GetRatio=function(){return this.m_ratio},C.prototype.b2PulleyJoint=function(t){this.__super.b2Joint.call(this,t);this.m_ground=this.m_bodyA.m_world.m_groundBody,this.m_groundAnchor1.x=t.groundAnchorA.x-this.m_ground.m_xf.position.x,this.m_groundAnchor1.y=t.groundAnchorA.y-this.m_ground.m_xf.position.y,this.m_groundAnchor2.x=t.groundAnchorB.x-this.m_ground.m_xf.position.x,this.m_groundAnchor2.y=t.groundAnchorB.y-this.m_ground.m_xf.position.y,this.m_localAnchor1.SetV(t.localAnchorA),this.m_localAnchor2.SetV(t.localAnchorB),this.m_ratio=t.ratio,this.m_constant=t.lengthA+this.m_ratio*t.lengthB,this.m_maxLength1=r.Min(t.maxLengthA,this.m_constant-this.m_ratio*C.b2_minPulleyLength),this.m_maxLength2=r.Min(t.maxLengthB,(this.m_constant-C.b2_minPulleyLength)/this.m_ratio),this.m_impulse=0,this.m_limitImpulse1=0,this.m_limitImpulse2=0},C.prototype.InitVelocityConstraints=function(e){var i,n=this.m_bodyA,r=this.m_bodyB;i=n.m_xf.R;var o=this.m_localAnchor1.x-n.m_sweep.localCenter.x,s=this.m_localAnchor1.y-n.m_sweep.localCenter.y,a=i.col1.x*o+i.col2.x*s;s=i.col1.y*o+i.col2.y*s,o=a,i=r.m_xf.R;var l=this.m_localAnchor2.x-r.m_sweep.localCenter.x,c=this.m_localAnchor2.y-r.m_sweep.localCenter.y;a=i.col1.x*l+i.col2.x*c,c=i.col1.y*l+i.col2.y*c,l=a;var u=n.m_sweep.c.x+o,h=n.m_sweep.c.y+s,p=r.m_sweep.c.x+l,m=r.m_sweep.c.y+c,_=this.m_ground.m_xf.position.x+this.m_groundAnchor1.x,d=this.m_ground.m_xf.position.y+this.m_groundAnchor1.y,y=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x,g=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y;this.m_u1.Set(u-_,h-d),this.m_u2.Set(p-y,m-g);var v=this.m_u1.Length(),x=this.m_u2.Length();v>t.b2_linearSlop?this.m_u1.Multiply(1/v):this.m_u1.SetZero(),x>t.b2_linearSlop?this.m_u2.Multiply(1/x):this.m_u2.SetZero(),this.m_constant-v-this.m_ratio*x>0?(this.m_state=f.e_inactiveLimit,this.m_impulse=0):this.m_state=f.e_atUpperLimit,v<this.m_maxLength1?(this.m_limitState1=f.e_inactiveLimit,this.m_limitImpulse1=0):this.m_limitState1=f.e_atUpperLimit,x<this.m_maxLength2?(this.m_limitState2=f.e_inactiveLimit,this.m_limitImpulse2=0):this.m_limitState2=f.e_atUpperLimit;var b=o*this.m_u1.y-s*this.m_u1.x,w=l*this.m_u2.y-c*this.m_u2.x;if(this.m_limitMass1=n.m_invMass+n.m_invI*b*b,this.m_limitMass2=r.m_invMass+r.m_invI*w*w,this.m_pulleyMass=this.m_limitMass1+this.m_ratio*this.m_ratio*this.m_limitMass2,this.m_limitMass1=1/this.m_limitMass1,this.m_limitMass2=1/this.m_limitMass2,this.m_pulleyMass=1/this.m_pulleyMass,e.warmStarting){this.m_impulse*=e.dtRatio,this.m_limitImpulse1*=e.dtRatio,this.m_limitImpulse2*=e.dtRatio;var C=(-this.m_impulse-this.m_limitImpulse1)*this.m_u1.x,S=(-this.m_impulse-this.m_limitImpulse1)*this.m_u1.y,A=(-this.m_ratio*this.m_impulse-this.m_limitImpulse2)*this.m_u2.x,D=(-this.m_ratio*this.m_impulse-this.m_limitImpulse2)*this.m_u2.y;n.m_linearVelocity.x+=n.m_invMass*C,n.m_linearVelocity.y+=n.m_invMass*S,n.m_angularVelocity+=n.m_invI*(o*S-s*C),r.m_linearVelocity.x+=r.m_invMass*A,r.m_linearVelocity.y+=r.m_invMass*D,r.m_angularVelocity+=r.m_invI*(l*D-c*A)}else this.m_impulse=0,this.m_limitImpulse1=0,this.m_limitImpulse2=0},C.prototype.SolveVelocityConstraints=function(t){var e,i=this.m_bodyA,n=this.m_bodyB;e=i.m_xf.R;var o=this.m_localAnchor1.x-i.m_sweep.localCenter.x,s=this.m_localAnchor1.y-i.m_sweep.localCenter.y,a=e.col1.x*o+e.col2.x*s;s=e.col1.y*o+e.col2.y*s,o=a,e=n.m_xf.R;var l=this.m_localAnchor2.x-n.m_sweep.localCenter.x,c=this.m_localAnchor2.y-n.m_sweep.localCenter.y;a=e.col1.x*l+e.col2.x*c,c=e.col1.y*l+e.col2.y*c,l=a;var u=0,h=0,p=0,m=0,_=0,d=0,y=0,g=0,v=0,x=0,b=0;this.m_state==f.e_atUpperLimit&&(u=i.m_linearVelocity.x+-i.m_angularVelocity*s,h=i.m_linearVelocity.y+i.m_angularVelocity*o,p=n.m_linearVelocity.x+-n.m_angularVelocity*c,m=n.m_linearVelocity.y+n.m_angularVelocity*l,v=-(this.m_u1.x*u+this.m_u1.y*h)-this.m_ratio*(this.m_u2.x*p+this.m_u2.y*m),x=this.m_pulleyMass*-v,b=this.m_impulse,this.m_impulse=r.Max(0,this.m_impulse+x),x=this.m_impulse-b,_=-x*this.m_u1.x,d=-x*this.m_u1.y,y=-this.m_ratio*x*this.m_u2.x,g=-this.m_ratio*x*this.m_u2.y,i.m_linearVelocity.x+=i.m_invMass*_,i.m_linearVelocity.y+=i.m_invMass*d,i.m_angularVelocity+=i.m_invI*(o*d-s*_),n.m_linearVelocity.x+=n.m_invMass*y,n.m_linearVelocity.y+=n.m_invMass*g,n.m_angularVelocity+=n.m_invI*(l*g-c*y)),this.m_limitState1==f.e_atUpperLimit&&(u=i.m_linearVelocity.x+-i.m_angularVelocity*s,h=i.m_linearVelocity.y+i.m_angularVelocity*o,v=-(this.m_u1.x*u+this.m_u1.y*h),x=-this.m_limitMass1*v,b=this.m_limitImpulse1,this.m_limitImpulse1=r.Max(0,this.m_limitImpulse1+x),x=this.m_limitImpulse1-b,_=-x*this.m_u1.x,d=-x*this.m_u1.y,i.m_linearVelocity.x+=i.m_invMass*_,i.m_linearVelocity.y+=i.m_invMass*d,i.m_angularVelocity+=i.m_invI*(o*d-s*_)),this.m_limitState2==f.e_atUpperLimit&&(p=n.m_linearVelocity.x+-n.m_angularVelocity*c,m=n.m_linearVelocity.y+n.m_angularVelocity*l,v=-(this.m_u2.x*p+this.m_u2.y*m),x=-this.m_limitMass2*v,b=this.m_limitImpulse2,this.m_limitImpulse2=r.Max(0,this.m_limitImpulse2+x),x=this.m_limitImpulse2-b,y=-x*this.m_u2.x,g=-x*this.m_u2.y,n.m_linearVelocity.x+=n.m_invMass*y,n.m_linearVelocity.y+=n.m_invMass*g,n.m_angularVelocity+=n.m_invI*(l*g-c*y))},C.prototype.SolvePositionConstraints=function(e){void 0===e&&(e=0);var i,n=this.m_bodyA,o=this.m_bodyB,s=this.m_ground.m_xf.position.x+this.m_groundAnchor1.x,a=this.m_ground.m_xf.position.y+this.m_groundAnchor1.y,l=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x,c=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y,u=0,h=0,p=0,m=0,_=0,d=0,y=0,g=0,v=0,x=0,b=0,w=0,C=0,S=0;return this.m_state==f.e_atUpperLimit&&(i=n.m_xf.R,u=this.m_localAnchor1.x-n.m_sweep.localCenter.x,h=this.m_localAnchor1.y-n.m_sweep.localCenter.y,C=i.col1.x*u+i.col2.x*h,h=i.col1.y*u+i.col2.y*h,u=C,i=o.m_xf.R,p=this.m_localAnchor2.x-o.m_sweep.localCenter.x,m=this.m_localAnchor2.y-o.m_sweep.localCenter.y,C=i.col1.x*p+i.col2.x*m,m=i.col1.y*p+i.col2.y*m,p=C,_=n.m_sweep.c.x+u,d=n.m_sweep.c.y+h,y=o.m_sweep.c.x+p,g=o.m_sweep.c.y+m,this.m_u1.Set(_-s,d-a),this.m_u2.Set(y-l,g-c),v=this.m_u1.Length(),x=this.m_u2.Length(),v>t.b2_linearSlop?this.m_u1.Multiply(1/v):this.m_u1.SetZero(),x>t.b2_linearSlop?this.m_u2.Multiply(1/x):this.m_u2.SetZero(),b=this.m_constant-v-this.m_ratio*x,S=r.Max(S,-b),b=r.Clamp(b+t.b2_linearSlop,-t.b2_maxLinearCorrection,0),w=-this.m_pulleyMass*b,_=-w*this.m_u1.x,d=-w*this.m_u1.y,y=-this.m_ratio*w*this.m_u2.x,g=-this.m_ratio*w*this.m_u2.y,n.m_sweep.c.x+=n.m_invMass*_,n.m_sweep.c.y+=n.m_invMass*d,n.m_sweep.a+=n.m_invI*(u*d-h*_),o.m_sweep.c.x+=o.m_invMass*y,o.m_sweep.c.y+=o.m_invMass*g,o.m_sweep.a+=o.m_invI*(p*g-m*y),n.SynchronizeTransform(),o.SynchronizeTransform()),this.m_limitState1==f.e_atUpperLimit&&(i=n.m_xf.R,u=this.m_localAnchor1.x-n.m_sweep.localCenter.x,h=this.m_localAnchor1.y-n.m_sweep.localCenter.y,C=i.col1.x*u+i.col2.x*h,h=i.col1.y*u+i.col2.y*h,u=C,_=n.m_sweep.c.x+u,d=n.m_sweep.c.y+h,this.m_u1.Set(_-s,d-a),v=this.m_u1.Length(),v>t.b2_linearSlop?(this.m_u1.x*=1/v,this.m_u1.y*=1/v):this.m_u1.SetZero(),b=this.m_maxLength1-v,S=r.Max(S,-b),b=r.Clamp(b+t.b2_linearSlop,-t.b2_maxLinearCorrection,0),w=-this.m_limitMass1*b,_=-w*this.m_u1.x,d=-w*this.m_u1.y,n.m_sweep.c.x+=n.m_invMass*_,n.m_sweep.c.y+=n.m_invMass*d,n.m_sweep.a+=n.m_invI*(u*d-h*_),n.SynchronizeTransform()),this.m_limitState2==f.e_atUpperLimit&&(i=o.m_xf.R,p=this.m_localAnchor2.x-o.m_sweep.localCenter.x,m=this.m_localAnchor2.y-o.m_sweep.localCenter.y,C=i.col1.x*p+i.col2.x*m,m=i.col1.y*p+i.col2.y*m,p=C,y=o.m_sweep.c.x+p,g=o.m_sweep.c.y+m,this.m_u2.Set(y-l,g-c),x=this.m_u2.Length(),x>t.b2_linearSlop?(this.m_u2.x*=1/x,this.m_u2.y*=1/x):this.m_u2.SetZero(),b=this.m_maxLength2-x,S=r.Max(S,-b),b=r.Clamp(b+t.b2_linearSlop,-t.b2_maxLinearCorrection,0),w=-this.m_limitMass2*b,y=-w*this.m_u2.x,g=-w*this.m_u2.y,o.m_sweep.c.x+=o.m_invMass*y,o.m_sweep.c.y+=o.m_invMass*g,o.m_sweep.a+=o.m_invI*(p*g-m*y),o.SynchronizeTransform()),S<t.b2_linearSlop},n.postDefs.push(function(){n.Dynamics.Joints.b2PulleyJoint.b2_minPulleyLength=2}),n.inherit(S,n.Dynamics.Joints.b2JointDef),S.prototype.__super=n.Dynamics.Joints.b2JointDef.prototype,S.b2PulleyJointDef=function(){n.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.groundAnchorA=new o,this.groundAnchorB=new o,this.localAnchorA=new o,this.localAnchorB=new o},S.prototype.b2PulleyJointDef=function(){this.__super.b2JointDef.call(this),this.type=f.e_pulleyJoint,this.groundAnchorA.Set(-1,1),this.groundAnchorB.Set(1,1),this.localAnchorA.Set(-1,0),this.localAnchorB.Set(1,0),this.lengthA=0,this.maxLengthA=0,this.lengthB=0,this.maxLengthB=0,this.ratio=1,this.collideConnected=!0},S.prototype.Initialize=function(t,e,i,n,r,o,s){void 0===s&&(s=0),this.bodyA=t,this.bodyB=e,this.groundAnchorA.SetV(i),this.groundAnchorB.SetV(n),this.localAnchorA=this.bodyA.GetLocalPoint(r),this.localAnchorB=this.bodyB.GetLocalPoint(o);var a=r.x-i.x,l=r.y-i.y;this.lengthA=Math.sqrt(a*a+l*l);var c=o.x-n.x,u=o.y-n.y;this.lengthB=Math.sqrt(c*c+u*u),this.ratio=s;var h=this.lengthA+this.ratio*this.lengthB;this.maxLengthA=h-this.ratio*C.b2_minPulleyLength,this.maxLengthB=(h-C.b2_minPulleyLength)/this.ratio},n.inherit(A,n.Dynamics.Joints.b2Joint),A.prototype.__super=n.Dynamics.Joints.b2Joint.prototype,A.b2RevoluteJoint=function(){n.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.K=new e,this.K1=new e,this.K2=new e,this.K3=new e,this.impulse3=new s,this.impulse2=new o,this.reduced=new o,this.m_localAnchor1=new o,this.m_localAnchor2=new o,this.m_impulse=new s,this.m_mass=new i},A.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},A.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},A.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new o(t*this.m_impulse.x,t*this.m_impulse.y)},A.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),t*this.m_impulse.z},A.prototype.GetJointAngle=function(){return this.m_bodyB.m_sweep.a-this.m_bodyA.m_sweep.a-this.m_referenceAngle},A.prototype.GetJointSpeed=function(){return this.m_bodyB.m_angularVelocity-this.m_bodyA.m_angularVelocity},A.prototype.IsLimitEnabled=function(){return this.m_enableLimit};A.prototype.EnableLimit=function(t){this.m_enableLimit=t},A.prototype.GetLowerLimit=function(){return this.m_lowerAngle},A.prototype.GetUpperLimit=function(){return this.m_upperAngle},A.prototype.SetLimits=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.m_lowerAngle=t,this.m_upperAngle=e},A.prototype.IsMotorEnabled=function(){return this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor},A.prototype.EnableMotor=function(t){this.m_enableMotor=t},A.prototype.SetMotorSpeed=function(t){void 0===t&&(t=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=t},A.prototype.GetMotorSpeed=function(){return this.m_motorSpeed},A.prototype.SetMaxMotorTorque=function(t){void 0===t&&(t=0),this.m_maxMotorTorque=t},A.prototype.GetMotorTorque=function(){return this.m_maxMotorTorque},A.prototype.b2RevoluteJoint=function(t){this.__super.b2Joint.call(this,t),this.m_localAnchor1.SetV(t.localAnchorA),this.m_localAnchor2.SetV(t.localAnchorB),this.m_referenceAngle=t.referenceAngle,this.m_impulse.SetZero(),this.m_motorImpulse=0,this.m_lowerAngle=t.lowerAngle,this.m_upperAngle=t.upperAngle,this.m_maxMotorTorque=t.maxMotorTorque,this.m_motorSpeed=t.motorSpeed,this.m_enableLimit=t.enableLimit,this.m_enableMotor=t.enableMotor,this.m_limitState=f.e_inactiveLimit},A.prototype.InitVelocityConstraints=function(e){var i,n=this.m_bodyA,o=this.m_bodyB,s=0;this.m_enableMotor||this.m_enableLimit,i=n.m_xf.R;var a=this.m_localAnchor1.x-n.m_sweep.localCenter.x,l=this.m_localAnchor1.y-n.m_sweep.localCenter.y;s=i.col1.x*a+i.col2.x*l,l=i.col1.y*a+i.col2.y*l,a=s,i=o.m_xf.R;var c=this.m_localAnchor2.x-o.m_sweep.localCenter.x,u=this.m_localAnchor2.y-o.m_sweep.localCenter.y;s=i.col1.x*c+i.col2.x*u,u=i.col1.y*c+i.col2.y*u,c=s;var h=n.m_invMass,p=o.m_invMass,m=n.m_invI,_=o.m_invI;if(this.m_mass.col1.x=h+p+l*l*m+u*u*_,this.m_mass.col2.x=-l*a*m-u*c*_,this.m_mass.col3.x=-l*m-u*_,this.m_mass.col1.y=this.m_mass.col2.x,this.m_mass.col2.y=h+p+a*a*m+c*c*_,this.m_mass.col3.y=a*m+c*_,this.m_mass.col1.z=this.m_mass.col3.x,this.m_mass.col2.z=this.m_mass.col3.y,this.m_mass.col3.z=m+_,this.m_motorMass=1/(m+_),0==this.m_enableMotor&&(this.m_motorImpulse=0),this.m_enableLimit){var d=o.m_sweep.a-n.m_sweep.a-this.m_referenceAngle;r.Abs(this.m_upperAngle-this.m_lowerAngle)<2*t.b2_angularSlop?this.m_limitState=f.e_equalLimits:d<=this.m_lowerAngle?(this.m_limitState!=f.e_atLowerLimit&&(this.m_impulse.z=0),this.m_limitState=f.e_atLowerLimit):d>=this.m_upperAngle?(this.m_limitState!=f.e_atUpperLimit&&(this.m_impulse.z=0),this.m_limitState=f.e_atUpperLimit):(this.m_limitState=f.e_inactiveLimit,this.m_impulse.z=0)}else this.m_limitState=f.e_inactiveLimit;if(e.warmStarting){this.m_impulse.x*=e.dtRatio,this.m_impulse.y*=e.dtRatio,this.m_motorImpulse*=e.dtRatio;var y=this.m_impulse.x,g=this.m_impulse.y;n.m_linearVelocity.x-=h*y,n.m_linearVelocity.y-=h*g,n.m_angularVelocity-=m*(a*g-l*y+this.m_motorImpulse+this.m_impulse.z),o.m_linearVelocity.x+=p*y,o.m_linearVelocity.y+=p*g,o.m_angularVelocity+=_*(c*g-u*y+this.m_motorImpulse+this.m_impulse.z)}else this.m_impulse.SetZero(),this.m_motorImpulse=0},A.prototype.SolveVelocityConstraints=function(t){var e,i=this.m_bodyA,n=this.m_bodyB,o=0,s=0,a=0,l=0,c=0,u=i.m_linearVelocity,h=i.m_angularVelocity,p=n.m_linearVelocity,m=n.m_angularVelocity,_=i.m_invMass,d=n.m_invMass,y=i.m_invI,g=n.m_invI;if(this.m_enableMotor&&this.m_limitState!=f.e_equalLimits){var v=m-h-this.m_motorSpeed,x=this.m_motorMass*-v,b=this.m_motorImpulse,w=t.dt*this.m_maxMotorTorque;this.m_motorImpulse=r.Clamp(this.m_motorImpulse+x,-w,w),x=this.m_motorImpulse-b,h-=y*x,m+=g*x}if(this.m_enableLimit&&this.m_limitState!=f.e_inactiveLimit){e=i.m_xf.R,s=this.m_localAnchor1.x-i.m_sweep.localCenter.x,a=this.m_localAnchor1.y-i.m_sweep.localCenter.y,o=e.col1.x*s+e.col2.x*a,a=e.col1.y*s+e.col2.y*a,s=o,e=n.m_xf.R,l=this.m_localAnchor2.x-n.m_sweep.localCenter.x,c=this.m_localAnchor2.y-n.m_sweep.localCenter.y,o=e.col1.x*l+e.col2.x*c,c=e.col1.y*l+e.col2.y*c,l=o;var C=p.x+-m*c-u.x- -h*a,S=p.y+m*l-u.y-h*s,A=m-h;this.m_mass.Solve33(this.impulse3,-C,-S,-A),this.m_limitState==f.e_equalLimits?this.m_impulse.Add(this.impulse3):this.m_limitState==f.e_atLowerLimit?this.m_impulse.z+this.impulse3.z<0&&(this.m_mass.Solve22(this.reduced,-C,-S),this.impulse3.x=this.reduced.x,this.impulse3.y=this.reduced.y,this.impulse3.z=-this.m_impulse.z,this.m_impulse.x+=this.reduced.x,this.m_impulse.y+=this.reduced.y,this.m_impulse.z=0):this.m_limitState==f.e_atUpperLimit&&this.m_impulse.z+this.impulse3.z>0&&(this.m_mass.Solve22(this.reduced,-C,-S),this.impulse3.x=this.reduced.x,this.impulse3.y=this.reduced.y,this.impulse3.z=-this.m_impulse.z,this.m_impulse.x+=this.reduced.x,this.m_impulse.y+=this.reduced.y,this.m_impulse.z=0),u.x-=_*this.impulse3.x,u.y-=_*this.impulse3.y,h-=y*(s*this.impulse3.y-a*this.impulse3.x+this.impulse3.z),p.x+=d*this.impulse3.x,p.y+=d*this.impulse3.y,m+=g*(l*this.impulse3.y-c*this.impulse3.x+this.impulse3.z)}else{e=i.m_xf.R,s=this.m_localAnchor1.x-i.m_sweep.localCenter.x,a=this.m_localAnchor1.y-i.m_sweep.localCenter.y,o=e.col1.x*s+e.col2.x*a,a=e.col1.y*s+e.col2.y*a,s=o,e=n.m_xf.R,l=this.m_localAnchor2.x-n.m_sweep.localCenter.x,c=this.m_localAnchor2.y-n.m_sweep.localCenter.y,o=e.col1.x*l+e.col2.x*c,c=e.col1.y*l+e.col2.y*c,l=o;var D=p.x+-m*c-u.x- -h*a,M=p.y+m*l-u.y-h*s;this.m_mass.Solve22(this.impulse2,-D,-M),this.m_impulse.x+=this.impulse2.x,this.m_impulse.y+=this.impulse2.y,u.x-=_*this.impulse2.x,u.y-=_*this.impulse2.y,h-=y*(s*this.impulse2.y-a*this.impulse2.x),p.x+=d*this.impulse2.x,p.y+=d*this.impulse2.y,m+=g*(l*this.impulse2.y-c*this.impulse2.x)}i.m_linearVelocity.SetV(u),i.m_angularVelocity=h,n.m_linearVelocity.SetV(p),n.m_angularVelocity=m},A.prototype.SolvePositionConstraints=function(e){void 0===e&&(e=0);var i,n=0,o=this.m_bodyA,s=this.m_bodyB,a=0,l=0,c=0,u=0,h=0;if(this.m_enableLimit&&this.m_limitState!=f.e_inactiveLimit){var p=s.m_sweep.a-o.m_sweep.a-this.m_referenceAngle,m=0;this.m_limitState==f.e_equalLimits?(n=r.Clamp(p-this.m_lowerAngle,-t.b2_maxAngularCorrection,t.b2_maxAngularCorrection),m=-this.m_motorMass*n,a=r.Abs(n)):this.m_limitState==f.e_atLowerLimit?(n=p-this.m_lowerAngle,a=-n,n=r.Clamp(n+t.b2_angularSlop,-t.b2_maxAngularCorrection,0),m=-this.m_motorMass*n):this.m_limitState==f.e_atUpperLimit&&(n=p-this.m_upperAngle,a=n,n=r.Clamp(n-t.b2_angularSlop,0,t.b2_maxAngularCorrection),m=-this.m_motorMass*n),o.m_sweep.a-=o.m_invI*m,s.m_sweep.a+=s.m_invI*m,o.SynchronizeTransform(),s.SynchronizeTransform()}i=o.m_xf.R;var _=this.m_localAnchor1.x-o.m_sweep.localCenter.x,d=this.m_localAnchor1.y-o.m_sweep.localCenter.y;c=i.col1.x*_+i.col2.x*d,d=i.col1.y*_+i.col2.y*d,_=c,i=s.m_xf.R;var y=this.m_localAnchor2.x-s.m_sweep.localCenter.x,g=this.m_localAnchor2.y-s.m_sweep.localCenter.y;c=i.col1.x*y+i.col2.x*g,g=i.col1.y*y+i.col2.y*g,y=c;var v=s.m_sweep.c.x+y-o.m_sweep.c.x-_,x=s.m_sweep.c.y+g-o.m_sweep.c.y-d,b=v*v+x*x,w=Math.sqrt(b);l=w;var C=o.m_invMass,S=s.m_invMass,D=o.m_invI,M=s.m_invI,T=10*t.b2_linearSlop;if(b>T*T){var k=C+S,I=1/k;u=I*-v,h=I*-x;o.m_sweep.c.x-=.5*C*u,o.m_sweep.c.y-=.5*C*h,s.m_sweep.c.x+=.5*S*u,s.m_sweep.c.y+=.5*S*h,v=s.m_sweep.c.x+y-o.m_sweep.c.x-_,x=s.m_sweep.c.y+g-o.m_sweep.c.y-d}return this.K1.col1.x=C+S,this.K1.col2.x=0,this.K1.col1.y=0,this.K1.col2.y=C+S,this.K2.col1.x=D*d*d,this.K2.col2.x=-D*_*d,this.K2.col1.y=-D*_*d,this.K2.col2.y=D*_*_,this.K3.col1.x=M*g*g,this.K3.col2.x=-M*y*g,this.K3.col1.y=-M*y*g,this.K3.col2.y=M*y*y,this.K.SetM(this.K1),this.K.AddM(this.K2),this.K.AddM(this.K3),this.K.Solve(A.tImpulse,-v,-x),u=A.tImpulse.x,h=A.tImpulse.y,o.m_sweep.c.x-=o.m_invMass*u,o.m_sweep.c.y-=o.m_invMass*h,o.m_sweep.a-=o.m_invI*(_*h-d*u),s.m_sweep.c.x+=s.m_invMass*u,s.m_sweep.c.y+=s.m_invMass*h,s.m_sweep.a+=s.m_invI*(y*h-g*u),o.SynchronizeTransform(),s.SynchronizeTransform(),l<=t.b2_linearSlop&&a<=t.b2_angularSlop},n.postDefs.push(function(){n.Dynamics.Joints.b2RevoluteJoint.tImpulse=new o}),n.inherit(D,n.Dynamics.Joints.b2JointDef),D.prototype.__super=n.Dynamics.Joints.b2JointDef.prototype,D.b2RevoluteJointDef=function(){n.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.localAnchorA=new o,this.localAnchorB=new o},D.prototype.b2RevoluteJointDef=function(){this.__super.b2JointDef.call(this),this.type=f.e_revoluteJoint,this.localAnchorA.Set(0,0),this.localAnchorB.Set(0,0),this.referenceAngle=0,this.lowerAngle=0,this.upperAngle=0,this.maxMotorTorque=0,this.motorSpeed=0,this.enableLimit=!1,this.enableMotor=!1},D.prototype.Initialize=function(t,e,i){this.bodyA=t,this.bodyB=e,this.localAnchorA=this.bodyA.GetLocalPoint(i),this.localAnchorB=this.bodyB.GetLocalPoint(i),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()},n.inherit(M,n.Dynamics.Joints.b2Joint),M.prototype.__super=n.Dynamics.Joints.b2Joint.prototype,M.b2WeldJoint=function(){n.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_localAnchorA=new o,this.m_localAnchorB=new o,this.m_impulse=new s,this.m_mass=new i},M.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA)},M.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB)},M.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new o(t*this.m_impulse.x,t*this.m_impulse.y)},M.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),t*this.m_impulse.z},M.prototype.b2WeldJoint=function(t){this.__super.b2Joint.call(this,t),this.m_localAnchorA.SetV(t.localAnchorA),this.m_localAnchorB.SetV(t.localAnchorB),this.m_referenceAngle=t.referenceAngle,this.m_impulse.SetZero(),this.m_mass=new i},M.prototype.InitVelocityConstraints=function(t){var e,i=0,n=this.m_bodyA,r=this.m_bodyB;e=n.m_xf.R;var o=this.m_localAnchorA.x-n.m_sweep.localCenter.x,s=this.m_localAnchorA.y-n.m_sweep.localCenter.y;i=e.col1.x*o+e.col2.x*s,s=e.col1.y*o+e.col2.y*s,o=i,e=r.m_xf.R;var a=this.m_localAnchorB.x-r.m_sweep.localCenter.x,l=this.m_localAnchorB.y-r.m_sweep.localCenter.y;i=e.col1.x*a+e.col2.x*l,l=e.col1.y*a+e.col2.y*l,a=i;var c=n.m_invMass,u=r.m_invMass,h=n.m_invI,p=r.m_invI;this.m_mass.col1.x=c+u+s*s*h+l*l*p,this.m_mass.col2.x=-s*o*h-l*a*p,this.m_mass.col3.x=-s*h-l*p,this.m_mass.col1.y=this.m_mass.col2.x,this.m_mass.col2.y=c+u+o*o*h+a*a*p,this.m_mass.col3.y=o*h+a*p,this.m_mass.col1.z=this.m_mass.col3.x,this.m_mass.col2.z=this.m_mass.col3.y,this.m_mass.col3.z=h+p,t.warmStarting?(this.m_impulse.x*=t.dtRatio,this.m_impulse.y*=t.dtRatio,this.m_impulse.z*=t.dtRatio,n.m_linearVelocity.x-=c*this.m_impulse.x,n.m_linearVelocity.y-=c*this.m_impulse.y,n.m_angularVelocity-=h*(o*this.m_impulse.y-s*this.m_impulse.x+this.m_impulse.z),r.m_linearVelocity.x+=u*this.m_impulse.x,r.m_linearVelocity.y+=u*this.m_impulse.y,r.m_angularVelocity+=p*(a*this.m_impulse.y-l*this.m_impulse.x+this.m_impulse.z)):this.m_impulse.SetZero()},M.prototype.SolveVelocityConstraints=function(t){var e,i=0,n=this.m_bodyA,r=this.m_bodyB,o=n.m_linearVelocity,a=n.m_angularVelocity,l=r.m_linearVelocity,c=r.m_angularVelocity,u=n.m_invMass,h=r.m_invMass,p=n.m_invI,m=r.m_invI;e=n.m_xf.R;var f=this.m_localAnchorA.x-n.m_sweep.localCenter.x,_=this.m_localAnchorA.y-n.m_sweep.localCenter.y;i=e.col1.x*f+e.col2.x*_,_=e.col1.y*f+e.col2.y*_,f=i,e=r.m_xf.R;var d=this.m_localAnchorB.x-r.m_sweep.localCenter.x,y=this.m_localAnchorB.y-r.m_sweep.localCenter.y;i=e.col1.x*d+e.col2.x*y,y=e.col1.y*d+e.col2.y*y,d=i;var g=l.x-c*y-o.x+a*_,v=l.y+c*d-o.y-a*f,x=c-a,b=new s;this.m_mass.Solve33(b,-g,-v,-x),this.m_impulse.Add(b),o.x-=u*b.x,o.y-=u*b.y,a-=p*(f*b.y-_*b.x+b.z),l.x+=h*b.x,l.y+=h*b.y,c+=m*(d*b.y-y*b.x+b.z),n.m_angularVelocity=a,r.m_angularVelocity=c},M.prototype.SolvePositionConstraints=function(e){void 0===e&&(e=0);var i,n=0,o=this.m_bodyA,a=this.m_bodyB;i=o.m_xf.R;var l=this.m_localAnchorA.x-o.m_sweep.localCenter.x,c=this.m_localAnchorA.y-o.m_sweep.localCenter.y;n=i.col1.x*l+i.col2.x*c,c=i.col1.y*l+i.col2.y*c,l=n,i=a.m_xf.R;var u=this.m_localAnchorB.x-a.m_sweep.localCenter.x,h=this.m_localAnchorB.y-a.m_sweep.localCenter.y;n=i.col1.x*u+i.col2.x*h,h=i.col1.y*u+i.col2.y*h,u=n;var p=o.m_invMass,m=a.m_invMass,f=o.m_invI,_=a.m_invI,d=a.m_sweep.c.x+u-o.m_sweep.c.x-l,y=a.m_sweep.c.y+h-o.m_sweep.c.y-c,g=a.m_sweep.a-o.m_sweep.a-this.m_referenceAngle,v=10*t.b2_linearSlop,x=Math.sqrt(d*d+y*y),b=r.Abs(g);x>v&&(f*=1,_*=1),this.m_mass.col1.x=p+m+c*c*f+h*h*_,this.m_mass.col2.x=-c*l*f-h*u*_,this.m_mass.col3.x=-c*f-h*_,this.m_mass.col1.y=this.m_mass.col2.x,this.m_mass.col2.y=p+m+l*l*f+u*u*_,this.m_mass.col3.y=l*f+u*_,this.m_mass.col1.z=this.m_mass.col3.x,this.m_mass.col2.z=this.m_mass.col3.y,this.m_mass.col3.z=f+_;var w=new s;return this.m_mass.Solve33(w,-d,-y,-g),o.m_sweep.c.x-=p*w.x,o.m_sweep.c.y-=p*w.y,o.m_sweep.a-=f*(l*w.y-c*w.x+w.z),a.m_sweep.c.x+=m*w.x,a.m_sweep.c.y+=m*w.y,a.m_sweep.a+=_*(u*w.y-h*w.x+w.z),o.SynchronizeTransform(),a.SynchronizeTransform(),x<=t.b2_linearSlop&&b<=t.b2_angularSlop},n.inherit(T,n.Dynamics.Joints.b2JointDef),T.prototype.__super=n.Dynamics.Joints.b2JointDef.prototype,T.b2WeldJointDef=function(){n.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.localAnchorA=new o,this.localAnchorB=new o},T.prototype.b2WeldJointDef=function(){this.__super.b2JointDef.call(this),this.type=f.e_weldJoint,this.referenceAngle=0},T.prototype.Initialize=function(t,e,i){this.bodyA=t,this.bodyB=e,this.localAnchorA.SetV(this.bodyA.GetLocalPoint(i)),this.localAnchorB.SetV(this.bodyB.GetLocalPoint(i)),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()}}(),function(){var t=n.Dynamics.b2DebugDraw;t.b2DebugDraw=function(){this.m_drawScale=1,this.m_lineThickness=1,this.m_alpha=1,this.m_fillAlpha=1,this.m_xformScale=1;var t=this;this.m_sprite={graphics:{clear:function(){t.m_ctx.clearRect(0,0,t.m_ctx.canvas.width,t.m_ctx.canvas.height)}}}},t.prototype._color=function(t,e){return"rgba("+((16711680&t)>>16)+","+((65280&t)>>8)+","+(255&t)+","+e+")"},t.prototype.b2DebugDraw=function(){this.m_drawFlags=0},t.prototype.SetFlags=function(t){void 0===t&&(t=0),this.m_drawFlags=t},t.prototype.GetFlags=function(){return this.m_drawFlags},t.prototype.AppendFlags=function(t){void 0===t&&(t=0),this.m_drawFlags|=t},t.prototype.ClearFlags=function(t){void 0===t&&(t=0),this.m_drawFlags&=~t},t.prototype.SetSprite=function(t){this.m_ctx=t},t.prototype.GetSprite=function(){return this.m_ctx},t.prototype.SetDrawScale=function(t){void 0===t&&(t=0),this.m_drawScale=t},t.prototype.GetDrawScale=function(){return this.m_drawScale},t.prototype.SetLineThickness=function(t){void 0===t&&(t=0),this.m_lineThickness=t,this.m_ctx.strokeWidth=t},t.prototype.GetLineThickness=function(){return this.m_lineThickness},t.prototype.SetAlpha=function(t){void 0===t&&(t=0),this.m_alpha=t},t.prototype.GetAlpha=function(){return this.m_alpha},t.prototype.SetFillAlpha=function(t){void 0===t&&(t=0),this.m_fillAlpha=t},t.prototype.GetFillAlpha=function(){return this.m_fillAlpha},t.prototype.SetXFormScale=function(t){void 0===t&&(t=0),this.m_xformScale=t},t.prototype.GetXFormScale=function(){return this.m_xformScale},t.prototype.DrawPolygon=function(t,e,i){if(e){var n=this.m_ctx,r=this.m_drawScale;n.beginPath(),n.strokeStyle=this._color(i.color,this.m_alpha),n.moveTo(t[0].x*r,t[0].y*r);for(var o=1;o<e;o++)n.lineTo(t[o].x*r,t[o].y*r);n.lineTo(t[0].x*r,t[0].y*r),n.closePath(),n.stroke()}},t.prototype.DrawSolidPolygon=function(t,e,i){if(e){var n=this.m_ctx,r=this.m_drawScale;n.beginPath(),n.strokeStyle=this._color(i.color,this.m_alpha),n.fillStyle=this._color(i.color,this.m_fillAlpha),n.moveTo(t[0].x*r,t[0].y*r);for(var o=1;o<e;o++)n.lineTo(t[o].x*r,t[o].y*r);n.lineTo(t[0].x*r,t[0].y*r),n.closePath(),n.fill(),n.stroke()}},t.prototype.DrawCircle=function(t,e,i){if(e){var n=this.m_ctx,r=this.m_drawScale;n.beginPath(),n.strokeStyle=this._color(i.color,this.m_alpha),n.arc(t.x*r,t.y*r,e*r,0,2*Math.PI,!0),n.closePath(),n.stroke()}},t.prototype.DrawSolidCircle=function(t,e,i,n){if(e){var r=this.m_ctx,o=this.m_drawScale,s=t.x*o,a=t.y*o;r.moveTo(0,0),r.beginPath(),r.strokeStyle=this._color(n.color,this.m_alpha),r.fillStyle=this._color(n.color,this.m_fillAlpha),r.arc(s,a,e*o,0,2*Math.PI,!0),r.moveTo(s,a),r.lineTo((t.x+i.x*e)*o,(t.y+i.y*e)*o),r.closePath(),r.fill(),r.stroke()}},t.prototype.DrawSegment=function(t,e,i){var n=this.m_ctx,r=this.m_drawScale;n.strokeStyle=this._color(i.color,this.m_alpha),n.beginPath(),n.moveTo(t.x*r,t.y*r),n.lineTo(e.x*r,e.y*r),n.closePath(),n.stroke()},t.prototype.DrawTransform=function(t){var e=this.m_ctx,i=this.m_drawScale;e.beginPath(),e.strokeStyle=this._color(16711680,this.m_alpha),e.moveTo(t.position.x*i,t.position.y*i),e.lineTo((t.position.x+this.m_xformScale*t.R.col1.x)*i,(t.position.y+this.m_xformScale*t.R.col1.y)*i),e.strokeStyle=this._color(65280,this.m_alpha),e.moveTo(t.position.x*i,t.position.y*i),e.lineTo((t.position.x+this.m_xformScale*t.R.col2.x)*i,(t.position.y+this.m_xformScale*t.R.col2.y)*i),e.closePath(),e.stroke()}}();var s;for(s=0;s<n.postDefs.length;++s)n.postDefs[s]();t.exports=n},function(t,e,i){i(12),Crafty.c("PlayerParticles",{init:function(){this.requires("BattleParticles")},playerParticles:function(){return this}})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(11),r={name:"bayou",filepath:n.IMG_BG_BAYOU,width:800,height:336,css:"url("+n.IMG_BG_BAYOU+") center center / 110% no-repeat rgb(255, 255, 255)",offsetX:"center",offsetY:"center",size:"110%",color:"rgb(255,255,255)"};e.default=r},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(22),r={spriteId:"player_zero",spriteFrame:"plz_st0",animationComponent:"BattlePlayerZeroAnimation",width:80,height:72,hitbox:[20,0,45,0,45,75,20,75],charSheet:{name:"player 1",properties:{blunt:1,slashing:1,piercing:1,fire:1,earth:1,water:1,air:1,light:1,dark:1,poison:1,life:1,death:1},stats:{level:1,str:1,spd:1,sta:1,dex:1,int:1,cha:1,wis:1},skills:[n.ZeroLightSlash,n.ZeroMedSlash,n.ZeroHardSlash,n.ZeroUpperSlash]}};e.default=r},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(24),r=i(5),o=i(3);i.d(e,"ZeroLightSlash",function(){return s}),i.d(e,"ZeroMedSlash",function(){return a}),i.d(e,"ZeroHardSlash",function(){return l}),i.d(e,"ZeroUpperSlash",function(){return c});var s={effects:[{klass:n.Damage,properties:{blunt:0,slashing:2,piercing:0,fire:0,earth:0,water:0,air:0,light:0,dark:0,poison:0,life:0,death:0}},{klass:n.TriggerAnimation,target:"self",animation:r.ANIM_LIGHT_ATTACK},{klass:n.TriggerAnimation,animation:r.ANIM_HIT},{klass:n.SetCooldown,target:"self",cooldownLength:700},{klass:n.PlaySound,soundId:o.SOUND_SWORD_SLASH}],cost:0,name:"light slash",textOptions:{minLength:4,maxLength:7}},a={effects:[{klass:n.Damage,properties:{blunt:0,slashing:3,piercing:0,fire:0,earth:0,water:0,air:0,light:0,dark:0,poison:0,life:0,death:0}},{klass:n.TriggerAnimation,target:"self",animation:r.ANIM_MED_ATTACK},{klass:n.TriggerAnimation,animation:r.ANIM_HIT},{klass:n.SetCooldown,target:"self",cooldownLength:2e3},{klass:n.PlaySound,soundId:o.SOUND_SWORD_SLASH}],cost:0,name:"medium slash",textOptions:{minLength:6,maxLength:9}},l={effects:[{klass:n.Damage,properties:{blunt:0,slashing:4,piercing:0,fire:0,earth:0,water:0,air:0,light:0,dark:0,poison:0,life:0,death:0}},{klass:n.TriggerAnimation,target:"self",animation:r.ANIM_HEAVY_ATTACK},{klass:n.TriggerAnimation,animation:r.ANIM_HIT},{klass:n.SetCooldown,target:"self",cooldownLength:5e3},{klass:n.PlaySound,soundId:o.SOUND_SWORD_SLASH}],cost:0,name:"heavy slash",textOptions:{minLength:8,maxLength:20}},c={effects:[{klass:n.Damage,properties:{blunt:0,slashing:3,piercing:0,fire:0,earth:0,water:0,air:0,light:0,dark:0,poison:0,life:0,death:0}},{klass:n.TriggerAnimation,target:"self",animation:r.ANIM_SPECIAL_ATTACK},{klass:n.TriggerAnimation,animation:r.ANIM_HIT},{klass:n.SetCooldown,target:"self",cooldownLength:2200},{klass:n.PlaySound,soundId:o.SOUND_SWORD_SLASH}],cost:0,name:"upper slash",textOptions:{minLength:5,maxLength:13}}},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),o={id:null,name:"please enter a name",status:{hp:20,maxHp:20},stats:{level:0,str:0,spd:0,sta:0,dex:0,int:0,cha:0,wis:0},properties:{blunt:0,slashing:0,piercing:0,fire:0,earth:0,water:0,air:0,light:0,dark:0,poison:0,life:0,death:0},skills:[],vocabulary:""},s=function(){function t(e){n(this,t),this._data=_.merge({},o,e)}return r(t,[{key:"packaged",value:function(){return{id:this.get("id"),name:this.get("name"),status:this.get("status"),stats:this.get("stats"),skills:this.get("skills")}}},{key:"data",get:function(){return this._data},set:function(t){this._data=t}}]),t}();e.default=s},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){var i,n;i=_.reduce(e,function(t,e,i){return t+e},0),t.hp=t.hp-i,n=new Function("entity","let new_health, old_health;old_health = entity.getHP();new_health = old_health - "+i+";entity.setHP(new_health);"),t.getEffectQueue().push(n)}function o(t,e){var i;i=t.body.GetWorldCenter(),t.body.ApplyForce(e,i)}function s(t,e){var i={};if(t.charSheet)return _.each(t.charSheet.data.properties,function(t,n){var r=void 0;r=e[n]-t,i[n]=r<0?0:r}),i}function a(t,e){return Crafty.e("2D, DOM, Collision, TextFragment, TextFragmentAttackDisplay, DefendableAttack, Box2D, TriggerableEffectOnCollide, BattleProjectile, BattlePhysicsProjectile").attr({x:e.source._x,y:e.source._y-20,z:e.source._z+1,h:20,w:20}).textFragment(t).textFragmentAttackDisplay().defendableAttack({source:e.source,target:e.target,effects:e.effects}).collision().battleProjectile().box2d(e.box2d).triggerableEffectOnCollide({source:e.source,target:e.target,effects:e.effects,targetComponent:"BattlePlayer"})}function l(t){var e,i,n;for(t.minLength&&t.maxLength?i=t.minLength==t.maxLength?t.minLength:_.random(t.minLength,t.maxLength):t.minLength?i=_.random(t.minLength,100):t.maxLength&&(i=_.random(1,t.maxLength)),n="",e=0;e<i;e++)n+=_.sample(y);return n}function c(t,e){return m.default.retrieve(t.getVocabulary(),e)}function u(t){return"self"==t.target&&(t.target=t.source),t}function h(t){t.has("BattleParticles")&&t.triggerParticles()}function p(t,e){if(!e)throw new Error(t+" being executed without a target")}Object.defineProperty(e,"__esModule",{value:!0});var m=i(6);i.d(e,"Damage",function(){return g}),i.d(e,"PlaySound",function(){return v}),i.d(e,"ScreenShake",function(){return b}),i.d(e,"SetCooldown",function(){return x}),i.d(e,"SpawnTextProjectile",function(){return S}),i.d(e,"SpawnScatterTextProjectilePhysics",function(){return w}),i.d(e,"SpawnTextProjectilePhysics",function(){return C}),i.d(e,"TriggerAnimation",function(){return A});var f=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),d=i(18);i(7),i(41),i(40),i(39),i(14),i(42),i(38),i(43),i(19);var y=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],g=function(){function t(){n(this,t)}return f(t,null,[{key:"execute",value:function(t){var e;if(p("EffectDamage",t.target),!t.target.has("BattleCharacter"))throw new Error("EffectDamage being executed without a valid target");t=u(t),e=s(t.target,t.properties),r(t.target,e),h(t.target)}}]),t}(),v=function(){function t(){n(this,t)}return f(t,null,[{key:"execute",value:function(t){t.soundId&&(t.delay||Crafty.trigger("PlaySound",t.soundId))}}]),t}(),x=function(){function t(){n(this,t)}return f(t,null,[{key:"execute",value:function(t){var e;p("EffectSetCooldown",t.target),t=u(t),e=_.merge({},t),setTimeout(function(){e.skill.prepare()},t.cooldownLength)}}]),t}(),b=function(){function t(){n(this,t)}return f(t,null,[{key:"execute",value:function(t){window.camera.shake(t)}}]),t}(),w=function(){function t(){n(this,t)}return f(t,null,[{key:"execute",value:function(t){var e,i,n;if(!t.count)throw new Error("Error, attempting to SpawnScatterTextProjectilePhysics without a count");for(p("SpawnScatterTextProjectilePhysics",t.target),e=0;e<t.count;e++)n=t.textOptions.randomString?l(t.textOptions):c(t.source,t.textOptions),i=a(n,t),o(i,this.getRandomForceVectorToHit())}},{key:"getRandomForceVectorToHit",value:function(){var t,e;return t=_.random(-9300,-15e3),e=_.random(-12e3,-26e3),new d.Common.Math.b2Vec2(t,e)}}]),t}(),C=function(){function t(){n(this,t)}return f(t,null,[{key:"execute",value:function(t){var e,i;return p("EffectSpawnTextProjectilePhysics",t.target),e=c(t.source,t.textOptions),i=a(e,t),o(i,this.getRandomForceVectorToHit()),i}},{key:"getRandomForceVectorToHit",value:function(){var t,e;return t=_.random(-9300,-15e3),e=_.random(-12e3,-26e3),new d.Common.Math.b2Vec2(t,e)}}]),t}(),S=function(){function t(){n(this,t)}return f(t,null,[{key:"execute",value:function(t){var e;return p("EffectSpawnTextProjectile",t.target),e=c(t.source,t.textOptions),Crafty.e("2D, DOM, Collision, TextFragment, TextFragmentAttackDisplay, DefendableAttack, BattleProjectile, BattleNPCProjectile, TriggerableEffectOnCollide").attr({x:t.source._x,y:t.source._y-20,z:t.source._z+1,h:10,w:10}).textFragment(e).textFragmentAttackDisplay().defendableAttack().collision().battleProjectile().battleNPCProjectile(t.positionFunction,t.speed).triggerableEffectOnCollide({source:t.source,target:t.target,effects:t.effects,targetComponent:"BattlePlayer"})}}]),t}(),A=function(){function t(){n(this,t)}return f(t,null,[{key:"execute",value:function(t){if(p("EffectTriggerAnimation",t.target),t=u(t),!t.target.has("SpriteAnimation"))throw new Error("EffectTriggerAnimation being executed without a valid target");t.target.playAnim(t.animation)}}]),t}()},function(t,e,i){"use strict";function n(t,e){var i,n=e.audioData;i=t.e("AudioManager").audioManager(),i.getAudioQueue(),a(n.sounds),s(i)}function r(t){var e,i,n;e=t("AudioManager"),0!=e.length&&(i=e.getAudioQueue(),0!=i.length&&(n=i.pop(),t.audio.play(n)))}function o(t){t("AudioManager").destroy()}function s(t){Crafty.bind("PlaySound",l.bind(t.getAudioQueue()))}function a(t){_.each(t,function(t){Crafty.audio.add(t,c.SOUNDS[t])})}function l(t){this.push(t)}Object.defineProperty(e,"__esModule",{value:!0});var c=i(3);e.initAudioSystem=n,e.audioSystem=r,e.teardownAudioSystem=o,i(45)},function(t,e,i){"use strict";function n(t){}function r(t){var e;e=t("BattleEffectable").get(),_.each(e,function(t){o(t)})}function o(t){var e;for(e=t.getEffectQueue();;){var i=void 0;if(_.isEmpty(e)||e.length<1)return;i=e.pop(),i(t),t.setStatusDirty()}}Object.defineProperty(e,"__esModule",{value:!0}),e.initBattleEffectSystem=n,e.battleEffectSystem=r},function(t,e,i){"use strict";function n(t){var e,i;i=t.e("BattleStatusBarView").battleStatusBarView(),e=t("BattleStatus").get(),_.each(e,function(e){var n;e.renderStatus(),i.getView().insertChild(e.getStatusView()),n=t.e("ModeIcon, 2D, DOM").attr({x:e._x+16,y:e._y+u,w:32,h:32}),e.attach(n),s(e),e.bind("Remove",function(){this.getStatusView().remove()})}),i.render()}function r(t){var e;e=t("BattleStatus").get(),_.each(e,function(t){t.isStatusDirty()&&(t.renderStatus(),s(t),t.resetStatusDirty())})}function o(t){var e,i;e=t("BattleStatusBarView"),i=e.getView(),i.cleanupChildViews(),i.remove(),e._view=null,e.destroy()}function s(t){var e,i,n;(e=_.find(t._children,function(t){return t.has&&t.has("ModeIcon")}))&&(i=l(t.getStance()),n=a(i),$(e._element).html(n))}function a(t){return'<img class="battle-status-icon battle-character-stance" src="'+t+'"></img>'}function l(t){switch(t){case"offense":return c.ICON_CROSSED_SWORDS;case"defense":default:return c.ICON_CHECKED_SHIELD}}Object.defineProperty(e,"__esModule",{value:!0});var c=i(11);e.initBattleStatusSystem=n,e.battleStatusSystem=r,e.teardownBattleStatusSystem=o,i(47);var u=-40},function(t,e,i){"use strict";function n(){}function r(t){var e,i;e=t("TextFragment DefendableAttack").get(),i=_.filter(e,function(t){return t.isComplete()}),_.each(i,function(t){o(t.getTarget()),s(t)})}function o(t){t.has("SpriteAnimation")&&t.playAnim(a.ANIM_GUARD)}function s(t){t.destroy()}Object.defineProperty(e,"__esModule",{value:!0});var a=i(5);e.initDefendableSkillSystem=n,e.defendableSkillSystem=r},function(t,e,i){"use strict";function n(t){t("BattlePlayer").addComponent("BattleInput").battleInput()}function r(t){var e,i,n,r;e=t("BattleInput BattleStance").get(),e.length<1||(i=e[0],n=i.getInputQueue(),0!=n.length&&(n.forEach(function(t){f(t,i)||(r=c(i),r=h(r),r=p(r),r=m(r),d(t,r))}),i.clearInputQueue()))}function o(){var t;t=u(Crafty("TextFragment").get()),t.forEach(function(t){t.cancel()})}function s(t){o(),t.toggleStance(),t.setStatusDirty()}function a(){return Crafty("TextFragment BattlePCSkill").get()}function l(){return Crafty("TextFragment DefendableAttack").get()}function c(t){if(t.isStance("offense"))return a();if(t.isStance("defense"))return l();throw new Error("Input entity is in an invalid stance")}function u(t){return _.filter(t,function(t){return t.isActive()})}function h(t){return _.filter(t,function(t){return!t.isComplete()})}function p(t){return _.filter(t,function(t){return!t.isCooling()})}function m(t){return _.filter(t,function(t){return!t.isProcessed()})}function f(t,e){switch(t){case y.CMD_CHANGE_STANCE:return s(e),!0;default:return!1}}function d(t,e){var i,n,r;if(i=u(e),_.isEmpty(i))return r=_.filter(e,function(e){return e.matchFirstChar(t)}),void r.forEach(function(e){e.activate(),e.acceptInput(t)});if(1==i.length)return void i[0].acceptInput(t);if(n=_.filter(i,function(e){return e.matchNextChar(t)}),0==n.length);else{if(!(n.length>=1))throw new Error("Error, something funky is going on here....");i.forEach(function(e){e.matchNextChar(t)?e.acceptInput(t):e.cancel()})}}Object.defineProperty(e,"__esModule",{value:!0});var y=i(16);e.initInputSystem=n,e.inputSystem=r,i(46)},function(t,e,i){"use strict";function n(t){var e;e=t("BattleNPCSkill").get(),_.each(e,function(t){t.activate(),setTimeout(function(){t.prepare()},t.getSkillDef().startupDelay)})}function r(t){var e;e=t("BattleNPCBrain BattleNPCSkillManager").get(),_.each(e,function(t){var e;e=o(t),e.length<1||_.each(e,function(e){t.getSkillQueue().push(e)})})}function o(t){return _.filter(t.getSkills(),function(t){return t.isReady()})}Object.defineProperty(e,"__esModule",{value:!0}),e.initNPCAISystem=n,e.nPCAISystem=r},function(t,e,i){"use strict";function n(t){var e;e=t("BattleNPCSkillManager").get(),_.each(e,function(t){c(t),l(t),u(t)}),o(e)}function r(t){var e=t("BattleNPCSkillManager").get();_.each(e,function(t){var e;e=t.getSkillQueue(),e.length<1||(_.each(e,function(e){e.activate(),a(t,e)}),t.setSkillQueue([]))})}function o(t){_.each(t,function(t){t.bind("Remove",function(){console.log("DEBUG: IN THE REMOVE CALLBACK OF NPCSKLL MANAGER...."),_.each(t.getSkills(),function(t){t.destroy()}),t._skills=null,t._skillset=null,t._skillQueue=null})})}function s(t){return Crafty.e("BattleNPCSkill").battleNPCSkill(t)}function a(t,e){var i;i=t.getTarget(),_.each(e.getSkillDef().effects,function(n){var r,o,s;r=n.klass,o=n,s={target:i,source:t,skill:e},s=_.merge(s,o),r.execute(s)})}function l(t){var e,i;e=t.getSkillset(),i=[],_.each(e,function(t){i.push(s(t))}),t.setSkills(i)}function c(t){var e=t.charSheet.data.skills;!e||e.length<1||t.setSkillset(e)}function u(t){t.setSkillQueue([])}Object.defineProperty(e,"__esModule",{value:!0}),e.initNPCSkillSystem=n,e.npcSkillSystem=r},function(t,e,i){"use strict";function n(t){var e,i;e=t("BattlePlayer"),e.addComponent("PlayerParticles").playerParticles(),i=t("BattleNPC"),i.addComponent("NPCParticles").nPCParticles(),o()}function r(t){var e;e=t("BattleParticles").get(),_.each(e,function(t){t.needTriggerParticles()&&l(t),s(t)})}function o(){Crafty("BattleParticles").bind("Remove",function(){_.each(this.getParticleBuffer(),function(t){t.destroy()}),this._particleBuffer=null})}function s(t){var e;e=t.getParticleBuffer(),_.each(e,function(t){Crafty.frame()-t.getStartFrame()>=p&&(t.destroy(),t.setDestroyFlag(!0))}),_.remove(e,function(t){return t.getDestroyFlag()}),t.setParticleBuffer(e)}function a(t){return t.e("2D, Canvas, ParticleSource, Particles").particleSource(t.frame())}function l(t){var e;if(t._triggerParticles=!1,e=a(Crafty),e.attr({x:t._x,y:t._y,w:10,h:10}),t.attach(e),t.getParticleBuffer().push(e),t.has("PlayerParticles"))e.particles(c);else{if(!t.has("NPCParticles"))return void console.log("DEBUG: ERROR: some unknown entity has BattleParticles attached");e.particles(u)}}Object.defineProperty(e,"__esModule",{value:!0});i(51);e.initParticleSystem=n,e.particleSystem=r,i(19),i(48),i(49);var c,u,h={maxParticles:150,size:18,sizeRandom:4,speed:3,speedRandom:1.2,lifeSpan:29,lifeSpanRandom:25,angle:270,angleRandom:34,startColour:[255,131,0,1],startColourRandom:[48,50,45,0],endColour:[245,35,0,0],endColourRandom:[60,60,60,0],sharpness:20,sharpnessRandom:10,spread:10,duration:5,fastMode:!1,gravity:{x:0,y:.1},jitter:3,originOffset:{x:0,y:0}},p=300;c=_.cloneDeep(h),u=_.cloneDeep(h),c.originOffset.x=10,c.originOffset.y=30,u.angle=65,u.originOffset.x=10,u.originOffset.y=20},function(t,e,i){"use strict";function n(t){var e;e=t("PlayerSkillManager").get(),_.each(e,function(t){t.playerSkillManager(),l(t),t.renderSkillManager()}),r(e)}function r(t){_.each(t,function(t){t.bind("Remove",function(){var e;_.each(t.getSkills(),function(t){t.destroy()}),e=t.getSkillManagerView(),e.cleanupSkillViews(),e.remove(),t._skills=null})})}function o(t){var e,i;e=t("BattlePCSkill TextFragment").get(),i=_.filter(e,function(t){return t.isComplete()}),_.each(i,function(t){t.processed(),a(t)})}function s(t,e){return Crafty.e("BattlePCSkill, TextFragment").textFragment(c.default.retrieve(t.getVocabulary(),e.textOptions)).battlePCSkill(t,e)}function a(t){var e;e=t.getTarget(),_.each(t.skill.effects,function(i){var n,r,o;n=i.klass,r=i,o={target:e,source:t.getOwner(),skill:t},o=_.merge(t.getSkillDef(),o,r),n.execute(o)})}function l(t){var e;_.each(t.getSkillset(),function(i){e=s(t,i),t.getSkills().push(e)})}Object.defineProperty(e,"__esModule",{value:!0});var c=i(6);i.d(e,"initPlayerSkillSystem",function(){return n}),i.d(e,"playerSkillSystem",function(){return o}),i(50)},function(t,e,i){"use strict";function n(t){}function r(t,e){var i,n;e.frame,n=e.dt,i=t("BattleNPCProjectile").get(),_.each(i,function(t){l(t,n)}),i=t("BattleProjectile BattleProjectileOutOfBounds").get(),_.each(i,function(t){t.destroy()}),i=t("BattlePhysicsProjectile").get(),_.each(i,function(t){s(t),o(t)})}function o(t){t.getDeadCounter()>=c&&t.destroy()}function s(t){a(t)&&t.setDeadCounter(t.getDeadCounter()+1)}function a(t){var e;return e=t.body.GetLinearVelocity(),0==e.x&&0==e.y}function l(t,e){var i;i=t.positionFunction(e,t.speed),t.x=t.x+i.x,t.y=t.y+i.y}Object.defineProperty(e,"__esModule",{value:!0}),e.initProjectileSystem=n,e.projectileSystem=r;var c=20},function(t,e,i){"use strict";function n(t){}function r(t){var e,i;e=t("TextFragment TextFragmentAttackDisplay").get(),i=_.filter(e,function(t){return t.isComplete()}),_.each(i,function(t){t.cleanupView()})}Object.defineProperty(e,"__esModule",{value:!0}),e.initTextFragmentAttackDisplaySystem=n,e.textFragmentAttackDisplaySystem=r},function(t,e,i){"use strict";function n(t){}function r(t){var e;e=t("TriggerableEffectOnCollide TriggerableEffectOnCollideHit").get(),_.each(e,function(t){o(t),t.destroy()})}function o(t){var e,i,n;e=t.getSource(),i=t.getTarget(),n=t.getEffects(),_.each(n,function(t){var n,r;n=t.klass,r=t,r=_.merge({source:e,target:i},r),n.execute(r)})}Object.defineProperty(e,"__esModule",{value:!0}),e.initTriggerEffectOnCollideSystem=n,e.triggerEffectOnCollideSystem=r},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(23);Crafty.c("BattleCharacter",{charSheet:null,_currentTarget:null,_model:null,init:function(){this.requires("2D")},battleCharacter:function(t){return t&&(this.charSheet=new n.default(t)),this.z=5,this},remove:function(t){this.z=-9999},getHP:function(){return this.getStatus().hp},getName:function(){return this.charSheet.data.name},getStatus:function(){return this.charSheet.data.status},getTarget:function(){return this._currentTarget},getVocabulary:function(){return this.charSheet.data.vocabulary},setHP:function(t){this.getStatus().hp=t},getPercentHP:function(){return this.getStatus().hp/this.getStatus().maxHp*100},setTarget:function(t){this._currentTarget=t},updateStatus:function(){this.trigger("UpdateStatus")}})},function(t,e){Crafty.c("BattlePhysicsProjectile",{_deadCount:null,init:function(){this._deadCount=0},battlePhysicsProjectile:function(){return this},getDeadCounter:function(){return this._deadCount},setDeadCounter:function(t){this._deadCount=t}})},function(t,e){Crafty.c("BattleProjectile",{init:function(){this.requires("2D, Collision")},battleProjectile:function(){return this.onHit("BattleStageBoundary",this._handleBattleBoundaryHit.bind(this)),this},_handleBattleBoundaryHit:function(t){this.addComponent("BattleProjectileOutOfBounds")}})},function(t,e){Crafty.c("DefendableAttack",{init:function(){},defendableAttack:function(t){return this},acceptInput:function(t){return this.takeInput(t)},cancel:function(){this._textFragFsm.cancel()}})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(0),r=i.n(n);i(7),i(14);var o=i(1),s=r.a.View.extend({tagName:"div",className:"text-fragment-attack",_templateId:"#text_fragment_attack_template",initialize:function(t){if(this._entity=t.entity,!this._entity)throw new Error("Attempting to initialize TextFragmentAttackDisplayView without an entity");this._template=o.compile($(this._templateId).html())},render:function(){var t,e;e=this._prepareTemplateOptions(),0===$(this.id).length?(this.id=this._generateId(this._entity),this.$el.html(this._template(e)),t=this._entity.getDomId(),$("#"+t).append(this.$el)):this.$el.html(this._template(e))},_generateId:function(t){return"text_fragment_"+t.getId()},_prepareTemplateOptions:function(){var t=this._entity;return{typed:t.getCorrectCharacters(),missed:t.getIncorrectCharacters(),rest:t.getRemainingCharacters(),activeClass:t.isActive()?"active":"inactive"}}});Crafty.c("TextFragmentAttackDisplay",{_view:null,init:function(){this.requires("2D, DOM, Collision, TextFragment")},textFragmentAttackDisplay:function(t){return this._initView(),this._bindRerenderOnRedraw(),this.render(),this},cleanupView:function(){this._view.undelegateEvents(),this._view.remove()},render:function(){this._view.render()},_bindRerenderOnRedraw:function(){this.bind("TextFragmentRedraw",this.render.bind(this))},_initView:function(){this._view=new s({entity:this})}})},function(t,e){Crafty.c("TriggerableEffectOnCollide",{init:function(){this.requires("2D, Collision")},triggerableEffectOnCollide:function(t){return this._source=t.source,this._target=t.target,this._effects=t.effects,this._targetComponent=t.targetComponent,this.onHit(this._targetComponent,this._handleTargetHit.bind(this)),this},getEffects:function(){return this._effects},getSource:function(){return this._source},getTarget:function(){return this._target},getTargetComponent:function(){return this._targetComponent},_handleTargetHit:function(t){console.log("DEBUG: the player was hit by a projectile.!!!!!!"),this.addComponent("TriggerableEffectOnCollideHit")}})},function(t,e,i){var n=i(18),r=n.Common.Math.b2Vec2,o=n.Dynamics.b2BodyDef,s=n.Dynamics.b2Body,a=n.Dynamics.b2FixtureDef,l=(n.Dynamics.b2Fixture,n.Dynamics.b2World),c=(n.Collision.Shapes.b2MassData,n.Collision.Shapes.b2PolygonShape),u=n.Collision.Shapes.b2CircleShape,h=n.Dynamics.b2DebugDraw,p=(n.Dynamics.Joints.b2MouseJointDef,n.Dynamics.Joints.b2PrismaticJointDef,n.Dynamics.b2ContactListener),m=n.Dynamics.b2FilterData;Crafty.c("Box2D",{body:null,fixtures:null,init:function(){this.requires("2D"),Crafty.box2D.world||Crafty.box2D.init(0,10,55,!0)},box2d:function(t){var e,i=Crafty.box2D.world,n=Crafty.box2D.PTM_RATIO;if(this.fixtures=[],t.bodyDef)var e=t.bodyDef;else{var e=new o;"dynamic"===t.bodyType?e.type=s.b2_dynamicBody:"static"===t.bodyType?e.type=s.b2_staticBody:e.type=s.b2_kinematicBody,e.position.Set(this._x/n,this._y/n)}return e.userData=this,this.body=i.CreateBody(e),this.addFixture(t),this.bind("Remove",this.box2dRemoved),this.bind("RemoveComponent",this.box2dRemoved),this},box2dRemoved:function(t){void 0!==t&&"Box2D"!==t||Crafty.box2D.world.DestroyBody(this.body)},addFixture:function(t){var e={};return t.fixDef?(e=t.fixDef,e.shape=this._addShapeToFixture(e.shape)):(e=new a,e.density=isNaN(t.density)?1:t.density,e.friction=isNaN(t.friction)?.5:t.friction,e.restitution=isNaN(t.restitution)?.2:t.restitution,e.isSensor=Boolean(t.isSensor),e.filter=this._addFilterToFixture(t),e.shape=this._addShapeToFixture(t.shape)),Object.keys(e).length&&this.fixtures.push(this.body.CreateFixture(e)),this},_addFilterToFixture:function(t){var e=new m;return e.categoryBits=isNaN(t.categoryBits)?1:t.categoryBits,e.maskBits=isNaN(t.maskBits)?65535:t.maskBits,e.groupIndex=isNaN(t.groupIndex)?0:t.groupIndex,e},_addShapeToFixture:function(t){var e,i=Crafty.box2D.PTM_RATIO;if("string"==typeof t&&"circle"===t)e=new u(this._w/i/2),e.SetLocalPosition(new r(this._w/i/2,this._h/i/2));else if("[object Array]"===Object.prototype.toString.call(t)){e=new c;for(var n=t.length,o=[],s=0;s<n;s++){var a=t[s];o.push(new r(a[0]/i,a[1]/i))}e.SetAsArray(o,n)}else e=new c,e.SetAsOrientedBox(this.w/2/i,this.h/2/i,new r(this.w/2/i,this.h/2/i));return e||null},contact:function(t){if(0===Crafty.box2D.contacts.length)return!1;for(var e=Crafty(t),i=[],n=0;n<Crafty.box2D.contacts.length;n++)for(var r=Crafty.box2D.contacts[n],o=0;o<e.length;o++){var s=e.get(o);if(!s.__c.Box2D)return!1;for(var a=0;a<this.fixtures.length;a++)for(var l=0;l<this.fixtures.length;l++)(r.fixtureA===this.fixtures[a]&&r.fixtureB===s.fixtures[l]||r.fixtureA===s.fixtures[l]&&r.fixtureB===this.fixtures[a])&&i.push({obj:s,contact:r})}return!!i.length&&i},onContact:function(t,e){return this.bind("EnterFrame",function(){var i=this.contact(t);i&&e.call(this,i)}),this}}),Crafty.extend({box2D:{ShowBox2DDebug:!1,contacts:null,world:null,PTM_RATIO:null,init:function(t,e,i,n){var o=new l(new r(t,e),n),s=i,a=[],c=new p;c.BeginContact=function(t){var e={fixtureA:t.GetFixtureA(),fixtureB:t.GetFixtureB()};for(t in a)if(a[t].fixtureA==e.fixtureA&&a[t].fixtureB==e.fixtureB)return;a.push(e)},c.EndContact=function(t){var e={fixtureA:t.GetFixtureA(),fixtureB:t.GetFixtureB()};for(t in a)if(a[t].fixtureA==e.fixtureA&&a[t].fixtureB==e.fixtureB)return void a.splice(t,1)},o.SetContactListener(c),Crafty.bind("EnterFrame",function(t){o.Step(t.dt/1e3,8,3);for(var e=o.GetBodyList();e;e=e.GetNext())if(e.GetUserData()){var i=e.GetUserData();0!==e.GetType()?(i.attr({x:e.GetPosition().x*s,y:e.GetPosition().y*s}),i.rotation=Crafty.math.radToDeg(e.GetAngle())):e.SetPosition({x:i.x/s,y:i.y/s})}Crafty.box2D.ShowBox2DDebug&&o.DrawDebugData(),o.ClearForces()}),Crafty.box2D.world=o,Crafty.box2D.PTM_RATIO=s,Crafty.box2D.contacts=a},showDebugInfo:function(){var t=Crafty.box2D.world,e=Crafty.box2D.PTM_RATIO;if(Crafty.support.canvas){var i=document.createElement("canvas");i.id="Box2DCanvasDebug",i.width=Crafty.viewport.width,i.height=Crafty.viewport.height,i.style.position="absolute",i.style.left="0px",i.style.top="0px",Crafty.stage.elem.appendChild(i);var n=new h;n.SetSprite(i.getContext("2d")),n.SetDrawScale(e),n.SetFillAlpha(.7),n.SetLineThickness(1),n.SetFlags(h.e_shapeBit|h.e_jointBit),t.SetDebugDraw(n),Crafty.box2D.ShowBox2DDebug=!0}else Crafty.box2D.ShowBox2DDebug=!1}}})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(0),r=i.n(n),o=i(6),s=i(1),a=i(4);i(7);var l=r.a.View.extend({tagName:"div",className:"battle-skill",_template_id:"#battle_skill_template",initialize:function(t){if(!t.entity)throw"ERROR: Battle Skill View initialized without an entity";this._entity=t.entity,this.text_fragment=t.text_fragment,this.id="battle-skill-"+this._entity[0],this._template=s.compile($(this._template_id).html())},render:function(t){var e,i;return i=this._buildViewOptions(t),e=this._template(i),this.$el.html(e),this.$el.html()},setTextFragment:function(t){this.text_fragment=t},_buildViewOptions:function(t){var e,i;return i={},e={name:this._entity.skill.name,css_classes:this._entity._battlePCFsm.current,skill_slot_num:this._entity.getSkillSlotNum()},_.extend(i,this._entity,e,this._getTextFragmentOptions(),t)},_defaultTextFragmentOptions:function(){return{typed:"",missed:"",rest:""}},_getTextFragmentOptions:function(){return this._entity.getTextStatus()}});Crafty.c("BattlePCSkill",{skill:null,text_fragment:null,text_fragment_graveyard:null,_battlePCFsm:null,_owner:null,_view:null,init:function(){},battlePCSkill:function(t,e){return this._owner=t,this.skill=e,this._setupStateMachine(),this._initializeView(),this._battlePCFsm.initialize(),this},remove:function(){this._view.remove()},cancel:function(){this._battlePCFsm.cancel()},canTakeInput:function(t){return this._battlePCFsm.is("ready")||this._battlePCFsm.is("active")},currentText:function(){return this.getText()},getOwner:function(){return this._owner},getSkillDef:function(){return this.skill},getTarget:function(){return this._owner.getTarget()},getView:function(){return this._view},prepare:function(){this._battlePCFsm.prepared()},ready:function(){this._battlePCFsm.initialize()},render:function(){this._view&&this._view.render()},getSkillSlotNum:function(){return this._owner.getSlotNum(this.skill)},acceptInput:function(t){return this.canTakeInput()?!!this.takeInput(t)&&(this._battlePCFsm.is("ready")&&this._battlePCFsm.start(),this.isComplete()&&this._battlePCFsm.complete(),!0):null},_bindRedrawOnTextFragmentUpdate:function(){this.bind("TextFragmentRedraw",_.bind(this.render,this))},_cycleTextFragment:function(){this._generateNewText()},_generateNewText:function(){this.setText(o.default.retrieve(this._owner.getVocabulary(),this.skill.textOptions))},_getTextFromVocabulary:function(t){return o.default.retrieve(this.getVocabulary(),this.skill.textOptions)},_initializeView:function(){this._view=new l({entity:this,text_fragment:this})},_setupStateMachine:function(){var t=this;this._battlePCFsm=a.create({initial:"inactive",events:[{name:"initialize",from:"inactive",to:"ready"},{name:"start",from:"ready",to:"active"},{name:"complete",from:"active",to:"cooling"},{name:"complete",from:"ready",to:"cooling"},{name:"cancel",from:"active",to:"ready"},{name:"prepared",from:"cooling",to:"ready"}],callbacks:{onbeforeinitialize:function(e,i,n){t._bindRedrawOnTextFragmentUpdate()},onready:function(t,e,i){},onstart:function(t,e,i){},onbeforecancel:function(e,i,n){t._textFragFsm.cancel()},onaftercomplete:function(e,i,n){t._cycleTextFragment()},onafterevent:function(e,i,n){t.render()},onprepared:function(e,i,n){t.restart()}}})},_unbindCombatModeSwitch:function(){this.unbind("SwitchedCombatMode")},_unbindRedrawOnTextFragmentUpdate:function(){this.text_fragment.unbind("TextFragmentRedraw")}})},function(t,e){Crafty.c("AudioManager",{_audioQueue:null,init:function(){},audioManager:function(t){return this._audioQueue=[],this},getAudioQueue:function(){return this._audioQueue},setAudioQueue:function(t){this._audioQueue=t}})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(16);Crafty.c("BattleInput",{init:function(){this._inputQueue=[],this.is_shift_key_down=!1},battleInput:function(){return this._attachKeyboardHandler(),this},clearInputQueue:function(){this._inputQueue=[]},getInputQueue:function(){return this._inputQueue},remove:function(t){this._detachKeyboardHandler()},_attachKeyboardHandler:function(){this.bind("KeyDown",this._handleKeyPress),this.bind("KeyUp",this._handleKeyRelease),this._handleBrowserKeyOverrides()},_detachKeyboardHandler:function(){this.unbind("KeyDown",this._handleKeyPress),this.unbind("KeyUp",this._handleKeyRelease),this._unbindBrowserKeyOverrides()},_handleBrowserKeyOverrides:function(){this._preventBackspaceNavigation(),this._preventTabFieldSwitch(),this._preventSpacebarScroll()},_handleKeyPress:function(t){var e;if(!Crafty.isPaused()){if(e=this._translateKeyToLetter(t.key),this._isModifierKey(e))return this._handleModifierKeyPressed(e);this._inputQueue.push(e)}},_handleKeyRelease:function(t){var e;Crafty.isPaused()||(e=this._translateKeyToLetter(t.key),this._isModifierKey(e)&&this._handleModifierKeyReleased(e))},_handleModifierKeyPressed:function(t){switch(t){case"shift":this.is_shift_key_down=!0;default:return!1}},_handleModifierKeyReleased:function(t){switch(t){case"shift":this.is_shift_key_down=!1;default:return!1}},_isModifierKey:function(t){switch(t){case"shift":return!0;default:return!1}},_preventBackspaceNavigation:function(){$(document).on("keydown",function(t){8!==t.which||$(t.target).is("input, textarea")||t.preventDefault()})},_preventTabFieldSwitch:function(){$(document).on("keydown",function(t){9!==t.which||$(t.target).is("input, textarea")||t.preventDefault()})},_preventSpacebarScroll:function(){$(document).on("keydown",function(t){32!==t.which||$(t.target).is("input, textarea")||t.preventDefault()})},_translateKeyToLetter:function(t){switch(t){case Crafty.keys.BACKSPACE:return"";case Crafty.keys.TAB:return n.COMMANDS.tab;case Crafty.keys.ENTER:return"";case Crafty.keys.SPACE:return" ";case Crafty.keys[0]:return"0";case Crafty.keys[1]:return this.is_shift_key_down?"!":"1";case Crafty.keys[2]:return"2";case Crafty.keys[3]:return"3";case Crafty.keys[4]:return"4";case Crafty.keys[5]:return"5";case Crafty.keys[6]:return"6";case Crafty.keys[7]:return"7";case Crafty.keys[8]:return"8";case Crafty.keys[9]:return"9";case Crafty.keys.A:return this.is_shift_key_down?"A":"a";case Crafty.keys.B:return this.is_shift_key_down?"B":"b";case Crafty.keys.C:return this.is_shift_key_down?"C":"c";case Crafty.keys.D:return this.is_shift_key_down?"D":"d";case Crafty.keys.E:return this.is_shift_key_down?"E":"e";case Crafty.keys.F:return this.is_shift_key_down?"F":"f";case Crafty.keys.G:return this.is_shift_key_down?"G":"g";case Crafty.keys.H:return this.is_shift_key_down?"H":"h";case Crafty.keys.I:return this.is_shift_key_down?"I":"i";case Crafty.keys.J:return this.is_shift_key_down?"J":"j";case Crafty.keys.K:return this.is_shift_key_down?"K":"k";case Crafty.keys.L:return this.is_shift_key_down?"L":"l";case Crafty.keys.M:return this.is_shift_key_down?"M":"m";case Crafty.keys.N:return this.is_shift_key_down?"N":"n";case Crafty.keys.O:return this.is_shift_key_down?"O":"o";case Crafty.keys.P:return this.is_shift_key_down?"P":"p";case Crafty.keys.Q:return this.is_shift_key_down?"Q":"q";case Crafty.keys.R:return this.is_shift_key_down?"R":"r";case Crafty.keys.S:return this.is_shift_key_down?"S":"s";case Crafty.keys.T:return this.is_shift_key_down?"T":"t";case Crafty.keys.U:return this.is_shift_key_down?"U":"u";case Crafty.keys.V:return this.is_shift_key_down?"V":"v";case Crafty.keys.W:return this.is_shift_key_down?"W":"w";case Crafty.keys.X:return this.is_shift_key_down?"X":"x";case Crafty.keys.Y:return this.is_shift_key_down?"Y":"y";case Crafty.keys.Z:return this.is_shift_key_down?"Z":"z";case Crafty.keys.DECIMAL:return".";case Crafty.keys.SHIFT:return"shift";case Crafty.keys.COMMA:return",";case Crafty.keys.MINUS:return"-";case 186:return this.is_shift_key_down?":":";";case 190:return".";case 191:return"?";case 222:return"'";default:return""}},_unbindBrowserKeyOverrides:function(){$(document).off("keydown")}})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,r=i(0),o=i.n(r),s=i(1);n=o.a.View.extend({tagName:"div",className:"status-bar",_templateId:"#status-bar-template",initialize:function(){this._childViews=[],this._template=s.compile($(this._templateId).html())},insertChild:function(t){this._childViews.push(t)},cleanupChildViews:function(){_.each(this._childViews,function(t){t.remove()}),this._childViews=null},render:function(t){return this._existsOnPage()||this._insertIntoPage(),this.$el.html(this._template()),this._renderChildViews(),this},_existsOnPage:function(){return _.some($(this.id))},_insertIntoPage:function(){$("#typewar-status-bar-wrap").append(this.$el)},_renderChildViews:function(){var t=this;_.each(this._childViews,function(e){t.$el.append(e.render())})}}),Crafty.c("BattleStatusBarView",{init:function(){},battleStatusBarView:function(){return this._view=new n,this},getView:function(){return this._view},render:function(){this._view.render()}})},function(t,e,i){i(12),Crafty.c("NPCParticles",{init:function(){this.requires("BattleParticles")},nPCParticles:function(){return this}})},function(t,e){Crafty.c("ParticleSource",{init:function(){this._startFrame=null,this._deleteMe=!1},particleSource:function(t){return this._startFrame=t,this},getStartFrame:function(){return this._startFrame},getDestroyFlag:function(){return this._deleteMe},setDestroyFlag:function(t){this._deleteMe=t}})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(0),r=i.n(n);i(13),i(6);i(44);var o=i(1),s=r.a.View.extend({tagName:"div",className:"skill-manager",_template_id:"#skill_manager_template",initialize:function(){this._template=o.compile($(this._template_id).html())},render:function(){var t;t=this,this.$el.html(this._template()),this._existsOnPage()||this._insertIntoPage(),_.each(this._skill_views,function(e,i){e.render({number:i}),t.$el.find(".skill-manager-wrapper").append(e.$el)})},cleanupSkillViews:function(){_.each(this._skill_views,function(t){t.remove()}),this._skill_views=null},registerSkillViews:function(t){this._skill_views=t},_existsOnPage:function(){return _.some($(this.id))},_insertIntoPage:function(){$("#typewar-skill-manager-wrap").append(this.$el)}});Crafty.c("PlayerSkillManager",{_skills:null,_view:null,init:function(){this._skills=[]},playerSkillManager:function(){return this},getSkillManagerView:function(){return this._view},getSkills:function(){return this._skills},getSkillset:function(){return this.charSheet.data.skills},renderSkillManager:function(){this._view||this._initializeView(),this._view.render()},getSlotNum:function(t){return this.getSkillset().indexOf(t)+1},_initializeView:function(){var t;this._view=new s({id:"battle-skillset"}),t=_.map(this._skills,function(t){return t.render(),t.getView()}),this._view.registerSkillViews(t)}})},function(t,e,i){"use strict";function n(t,e){return[t*Crafty.viewport._scale+Crafty.viewport.x,e*Crafty.viewport._scale+Crafty.viewport.y]}Object.defineProperty(e,"__esModule",{value:!0}),e.viewportConvert=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(15),r={spriteId:"slime",spriteFrame:"slime_st0",animationComponent:"BattleSlimeAnimation",width:42,height:42,hitbox:[0,0,0,50,50,60,0,60],charSheet:{name:"Slime",properties:{blunt:1,slashing:1,piercing:1,fire:1,earth:1,water:1,air:1,light:1,dark:1,poison:1,life:1,death:1},status:{hp:10,maxHp:10},stats:{level:0,str:0,spd:0,sta:0,dex:0,int:0,cha:0,wis:0},skills:[n.SlimeStandardAttack]}};e.default=r},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n={spriteId:"slime",spriteFrame:"slime_st0",animationComponent:"BattleSlimeAnimation",width:42,height:42,hitbox:[0,0,0,50,50,60,0,60],charSheet:{name:"Training dummy",properties:{blunt:1,slashing:1,piercing:1,fire:1,earth:1,water:1,air:1,light:1,dark:1,poison:1,life:1,death:1},status:{hp:10,maxHp:10},stats:{level:0,str:0,spd:0,sta:0,dex:0,int:0,cha:0,wis:0},skills:[]}};e.default=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(26),r=i(27),o=i(29),s=i(33),a=i(31),l=i(30),c=i(34),u=i(36),h=i(28),p=i(35),m=i(25),f=i(64),_=i(65),d=i(32),y={initializers:[{system:m.initAudioSystem,options:{audioData:["audio"]}},{system:r.initBattleStatusSystem},{system:o.initInputSystem},{system:s.initPlayerSkillSystem},{system:a.initNPCSkillSystem},{system:l.initNPCAISystem},{system:d.initParticleSystem}],runners:[{system:o.inputSystem},{system:s.playerSkillSystem},{system:a.npcSkillSystem},{system:l.nPCAISystem},{system:p.textFragmentAttackDisplaySystem},{system:h.defendableSkillSystem},{system:c.projectileSystem},{system:u.triggerEffectOnCollideSystem},{system:n.battleEffectSystem},{system:r.battleStatusSystem},{system:d.particleSystem},{system:m.audioSystem},{system:f.npcDiedPlayerWinSystem},{system:_.playerDieLoseSystem}],cleanup:[{system:r.teardownBattleStatusSystem},{system:m.teardownAudioSystem}]};e.default=y},function(t,e,i){"use strict";function n(t,e){var i;i=l(t,e.tutorialData),c(i,t)}function r(t){}function o(t){var e;e=t("Tutorial"),e.length>0&&e.destroy()}function s(t){_.each(t("UICallout").get(),function(t){t.cleanup(),t.destroy()})}function a(t,e){t.e("UICallout").uiCallout().render(e)}function l(t,e){return t.e("Tutorial, Delay").tutorial(e)}function c(t,e){t.getCurrTutorialStep();if(!t.getCurrTutorialStep())return void t.destroy();switch(t.getCurrTutorialStep().type){case"modal":return void m(t,e);case"wait":return void f(t,e);case"wait_input":return void y(t,e);case"wait_event":return void d(t,e);case"end":return t.destroy(),void e.trigger(x.SCENE_TRANSITION_EVT,x.BATTLE_VICTORY_COND);default:return void t.destroy()}}function u(t){var e,i,n;e=this.Crafty,n=this.entity,i=n.getCurrTutorialStep(),this.boundFunc,e.keydown[e.keys[i.input]]&&(e("UICallout").removeComponent("Keyboard",!1),n.incrementTutorialStep(),s(e),g(),v(),e.pause(),c(n,e))}function h(t){t&&"string"==typeof t&&_.each(Crafty(t).get(),function(t){t.addComponent("TWHighlight").tWHighlight()})}function p(t){t&&("string"==typeof t?$(t).addClass("ui-callout-target"):_.each(t,function(t){$(t).addClass("ui-callout-target")}))}function m(t,e){var i;i=t.getCurrTutorialStep(),a(e,i.modalData),p(i.highlightSelectors),h(i.highlightEntities),t.incrementTutorialStep(),c(t,e)}function f(t,e){var i;i=t.getCurrTutorialStep(),e.pause(),window.setTimeout(function(){t.incrementTutorialStep(),e.pause(),c(t,e)},i.duration)}function d(t,e){var i=t.getCurrTutorialStep();e.one(i.eventTarget,function(){t.incrementTutorialStep(),c(t,e)})}function y(t,e){e.pause(),e("UICallout").addComponent("Keyboard").bind("KeyDown",u.bind({Crafty:e,entity:t,boundFunc:u}))}function g(){_.each(Crafty("TWHighlight").get(),function(t){t.removeTWHighlight(),t.removeComponent("TWHighlight")})}function v(){_.each($(".ui-callout-target"),function(t){$(t).removeClass("ui-callout-target")})}Object.defineProperty(e,"__esModule",{value:!0});var x=i(2);e.initTutorialSystem=n,e.tutorialSystem=r,e.teardownTutorialSystem=o,i(61),i(63),i(60)},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(0),r=i.n(n),o=i(1),s=r.a.View.extend({tagName:"div",className:"entity-status",_templateId:"#entity-status-template",entity:null,initialize:function(t){this.entity=t.entity,this._template=o.compile($(this._templateId).html())},render:function(){var t;return t={name:this.entity.getName()||"Unnamed",className:_.kebabCase(this.entity.getName())||"Unnamed",percentHP:this.entity.getPercentHP(),statusHP:this.getStatusHP()},this.$el.html(this._template(t)),this.$el},getStatusHP:function(){var t;return t=this.entity.getPercentHP(),t<30?"health-bar-danger":t<70?"health-bar-warning":"health-bar-success"}});Crafty.c("BattleStatus",{_battleStatusDirty:!1,_statusView:null,init:function(){this.requires("BattleCharacter")},battleStatus:function(){return this},getStatusView:function(){return this._statusView},renderStatus:function(){this._statusView||(this._statusView=new s({entity:this,id:"entity-status-"+this[0]})),this._statusView.render()},isStatusDirty:function(){return this._battleStatusDirty},resetStatusDirty:function(){this._battleStatusDirty=!1},setStatusDirty:function(){this._battleStatusDirty=!0}})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i.d(e,"DUMMY_TEXT_LIBRARY",function(){return n});var n=["Literally"]},function(t,e,i){"use strict";function n(t){var e,i;return e="2D, DOM, BattleEffectable, BattleCharacter, BattleNPC, BattleNPCSlime, NPCBrain, Collision, BattleStatus, BattleNPCBrain, BattleNPCSkillManager",e+=", "+t.spriteFrame,e+=", "+t.animationComponent,i=Crafty.e(e),i.battleCharacter(t.charSheet).battleNPCEnemy().battleStatus().battleNPCBrain().collision(new Crafty.polygon(t.hitbox)),i[_.lowerFirst(t.animationComponent)].call(i),r(i)}function r(t){return o(t)}function o(t){return window.serverCaller?serverCaller.getVocabulariesPromise().then(function(e,i,n){return t.charSheet.data.vocabulary=e,t}):new Promise(function(e,i){t.charSheet.data.vocabulary=s.DUMMY_TEXT_LIBRARY,e(t)})}Object.defineProperty(e,"__esModule",{value:!0});var s=i(57);e.default=n,i(37),i(73),i(72),i(71),i(56)},function(t,e,i){"use strict";function n(t){var e;e=t("BattleNPC"),0!=e.length&&e.getHP()<=0&&t.trigger(r.TRAINING_TUTORIAL_COMPLETED_EVT)}Object.defineProperty(e,"__esModule",{value:!0});var r=i(2);e.npcDiedTutorialSystem=n},function(t,e){function i(t,e,i,n){var r,o;return'<div class="typewar-entity-highlight"></div>',r="position: fixed; z-index: 9999999; left: "+t+"px; top: "+e+"px; width: "+i+"px; height: "+n+"px;",o=document.createElement("div"),$(o).prop("style",r),$(o).addClass("typewar-entity-highlight"),$("body").prepend(o),o}Crafty.c("TWHighlight",{init:function(){this.requires("2D, DOM")},tWHighlight:function(){var t;if(t=$(this._element).offset(),this.has("ModeIcon")){var e=$(this._element).children().first();this._highlightElement=i(t.left,t.top,e.width()*Crafty.viewport._scale,e.height()*Crafty.viewport._scale)}else this._highlightElement=i(t.left,t.top,this.w,this.h);return this},removeTWHighlight:function(){$(this._highlightElement).remove()}})},function(t,e,i){i(4);Crafty.c("Tutorial",{init:function(){this._isListeningForInput=!1},tutorial:function(t){return this.setTutorialData(t),this.setTutorialStepNum(0),this},getTutorialData:function(){return this._tutorialData},setTutorialData:function(t){this._tutorialData=t},getTutorialSteps:function(){return this._tutorialData.steps},getTutorialStepNum:function(){return this._tutorialStep},setTutorialStepNum:function(t){this._tutorialStep=t},getCurrTutorialStep:function(){return this._tutorialData.steps[this._tutorialStep]},incrementTutorialStep:function(){this._tutorialStep+=1},listenForInput:function(){this._isListeningForInput=!0},isListeningForInput:function(){return this._isListeningForInput},stopListeningForInput:function(){return this._isListeningForInput=!1},getCallback:function(){return this._callback},setCallback:function(t){this._callback=t}})},function(t,e){Crafty.c("BattlePlayerAnim",{_ATTACK_ANIM_SPEED:8,_BLOCK_ANIM_SPEED:18,_HIT_ANIM_SPEED:16,_READY_ANIM_SPEED:29,init:function(){this.requires("SpriteAnimation")},battlePlayerAnim:function(){var t=this;return this.reel("ready",this._READY_ANIM_SPEED,0,0,6).reel("hit",this._HIT_ANIM_SPEED,0,1,6).reel("attack1",this._ATTACK_ANIM_SPEED,0,2,6).reel("block",this._BLOCK_ANIM_SPEED,0,3,6).bind("EnterFrame",function(e){t.isPlaying()||t.animReady()}),this},animAttack:function(){this.animate("attack1",0)},animBlock:function(){this.animate("block",0)},animHit:function(){this.animate("hit",0)},animReady:function(){this.animate("ready",-1)}})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(0),r=i.n(n),o=i(1),s=r.a.View.extend({tagName:"div",className:"typewar-ui-modal",_templateId:"#modal-template",initialize:function(t){this._template=o.compile($(this._templateId).html())},render:function(t){var e;e=t||{},this.$el.html(this._template(e)),$("body").prepend(this.$el)}});Crafty.c("UICallout",{init:function(){},uiCallout:function(t){return this._view=new s,this},render:function(t){this._view.render(t)},cleanup:function(){this._view.remove()}})},function(t,e,i){"use strict";function n(t){var e;e=t("BattleNPC"),0!=e.length&&e.getHP()<=0&&t.trigger(r.SCENE_TRANSITION_EVT,r.BATTLE_VICTORY_COND)}Object.defineProperty(e,"__esModule",{value:!0});var r=i(2);e.npcDiedPlayerWinSystem=n},function(t,e,i){"use strict";function n(t){var e;e=t("BattlePlayer"),0!=e.length&&e.getHP()<=0&&(console.log("DEBUG: PLAYER DIED> GAME LOST!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!"),t.trigger(r.SCENE_TRANSITION_EVT,r.BATTLE_DEFEAT_COND))}Object.defineProperty(e,"__esModule",{value:!0});var r=i(2);e.playerDieLoseSystem=n},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),i.d(e,"Fadeout",function(){return o}),i.d(e,"Fadein",function(){return s});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();Crafty.c("FadeoutTransition",{init:function(){this.requires("2D, DOM")},fadeoutTransition:function(){return this},fadeout:function(){var t;t=$(this._element),t.addClass("transition-end-state")}}),Crafty.c("FadeinTransition",{init:function(){this.requires("2D, DOM")},fadeinTransition:function(){return this},fadein:function(){$(this._element).addClass("transition-end-state")}});var o=function(){function t(){n(this,t)}return r(t,null,[{key:"execute",value:function(t){var e=t.fulfill;t.reject;window.setTimeout(function(){e&&e()},3e3),Crafty.e("FadeoutTransition, 2D, DOM").attr({x:0,y:0,z:9999999,w:Crafty.stage.elem.offsetWidth,h:Crafty.stage.elem.offsetHeight}).fadeoutTransition().fadeout()}}]),t}(),s=function(){function t(){n(this,t)}return r(t,null,[{key:"execute",value:function(t){var e=t.fulfill;t.reject;window.setTimeout(function(){e&&e()},3e3),Crafty.e("FadeinTransition, 2D, DOM").attr({x:0,y:0,z:9999999,w:Crafty.stage.elem.offsetWidth,h:Crafty.stage.elem.offsetHeight}).fadeinTransition().fadein()}}]),t}()},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=i(75),o=i(80),s=i(81),a=i(58),l=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();i(76),i(77),i(78);var c=function(){function t(e,i){n(this,t),this._sceneId=e,this._sceneData=i,Crafty.scene(this._sceneId,this.init.bind(this),this.stop.bind(this))}return l(t,[{key:"play",value:function(){Crafty.scene(this._sceneId)}},{key:"clearBG",value:function(){Crafty.background("")}},{key:"deallocateStageEdges",value:function(){this._stageBorders.leftEdge=null,this._stageBorders.rightEdge=null,this._stageBorders.bottomEdge=null}},{key:"init",value:function(){var t;t=this,t.initBox2d(),t.initSprites(),t.initBackground(),t.initStageEdges(),t.initCombatants().then(function(e){t.initSystems(),t.registerSystems(),t.initCamera()},function(t){throw t}).catch(function(t){throw t})}},{key:"initBackground",value:function(){var t,e;t=this._sceneData.background,e="url("+t.filepath+") "+t.offsetX+" "+t.offsetY+" / "+t.size+" no-repeat "+t.color,Crafty.background(e)}},{key:"initBox2d",value:function(){Crafty.box2D.init(0,10,2,!0)}},{key:"initCamera",value:function(){var t;t={background:this._sceneData.background},t=_.merge(t,{scale:2.4,offsetX:-10,offsetY:-70}),window.camera=new o.default(t)}},{key:"initCombatants",value:function(){var t,e,i;return i=this,new Promise(function(n,r){i.initPC().then(function(t){return e=t,i.initEnemyNPC()},function(t){console.log("ERROR: there was an error initializing the player character",t)}).then(function(r){t=r,i._combatants={player:e,npc:t},e.setTarget(t),t.setTarget(e),n()},function(t){console.log("ERROR: there was an error initializing the npc",t)}).catch(function(t){console.log("ERROR: there was an error initializing the player or NPC and adding them to the battle manager",t)})})}},{key:"initEnemyNPC",value:function(){var t;return t=i.i(a.default)(this._sceneData.combatants.npc),t.then(function(t){return t.x=390,t.y=210,t})}},{key:"initPC",value:function(){var t;return t=i.i(s.default)(this._sceneData.combatants.player),t.then(function(t){return t.x=20,t.y=180,t})}},{key:"initSprites",value:function(){r.default.create(this._sceneData.combatants.player.spriteId),r.default.create(this._sceneData.combatants.npc.spriteId)}},{key:"initStageEdges",value:function(){this._stageBorders={leftEdge:Crafty.e("2D, DOM, Collision, BattleStageEdge, BattleStageBoundary").attr({x:this._sceneData.borders.left,y:0,w:5,h:9e3}).collision(),rightEdge:Crafty.e("2D, DOM, Collision, BattleStageEdge, BattleStageBoundary").attr({x:this._sceneData.borders.right,y:0,w:5,h:9e3}).collision(),bottomEdge:Crafty.e("2D, DOM, Collision, BattleStageEdge, Box2D").attr({x:0,y:this._sceneData.borders.floor,w:9e3,h:5}).collision().box2d({bodyType:"rigid"})}}},{key:"initSystems",value:function(){var t=this;_.each(this._sceneData.systems.initializers,function(e){if(e.options&&Object.keys(e.options).length>0){var i={};_.each(e.options,function(e,n){i[n]=t._sceneData[e[0]]}),e.system.call(t,Crafty,i)}else e.system.call(t,Crafty)})}},{key:"registerSystems",value:function(){Crafty.settings.register("systemRunners",function(){}),Crafty.settings.modify("systemRunners",this._sceneData.systems.runners),Crafty.bind("EnterFrame",this.runSystems)}},{key:"resetCamera",value:function(){Crafty.viewport.scale(1),Crafty.viewport.x-=-10,Crafty.viewport.y-=-70}},{key:"runSystems",value:function(t){var e=this,i=Crafty.settings.get("systemRunners");_.each(i,function(i){i.system.call(e,Crafty,t)})}},{key:"stop",value:function(){this.teardownSystems(),this.clearBG(),this.deallocateStageEdges(),delete window.camera,window.camera=null}},{key:"teardownSystems",value:function(){var t=this;Crafty.settings.modify("systemRunners",null),Crafty.unbind("EnterFrame",this.runSystems),_.each(this._sceneData.systems.cleanup,function(e){e.system.call(t,Crafty)})}},{key:"sceneId",get:function(){return this._sceneId}}]),t}();e.default=c},function(t,e,i){var n=i(4);Crafty.c("BattleNPCSkill",{_nPCSkillFsm:null,_skill:null,init:function(){},battleNPCSkill:function(t){if(!t)throw"ERROR: attempting to initialize NPCSkill component without any skill data";return this._skill=t,this._setupStateMachine(),this},activate:function(){this._nPCSkillFsm.activate()},getSkillDef:function(){return this._skill},isReady:function(){return this._nPCSkillFsm.is("ready")},prepare:function(){this._nPCSkillFsm.prepare()},_setupStateMachine:function(){this._nPCSkillFsm=n.create({initial:"ready",events:[{name:"activate",from:"ready",to:"cooling"},{name:"prepare",from:"cooling",to:"ready"}],callbacks:{onafteractivate:function(t,e,i){},onbeforeready:function(t,e,i){}}})}})},function(t,e,i){var n=i(4);Crafty.c("BattleStance",{init:function(){},battleStance:function(t){return this._setupModeFSM(t),this},getStance:function(){return this._stance.current},isStance:function(t){return this._stance.is(t)},toggleStance:function(){return this._stance.toggle(),this.getStance()},_setupModeFSM:function(t){var e;e=t||"defense",this._stance=n.create({initial:e,events:[{name:"toggle",from:"defense",to:"offense"},{name:"toggle",from:"offense",to:"defense"}],callbacks:{}})}})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(5),r={ANIM_READY:"ZERO_READY",ANIM_LIGHT_ATTACK:"ZERO_LIGHT_SLASH",ANIM_MED_ATTACK:"ZERO_MED_SLASH",ANIM_HEAVY_ATTACK:"ZERO_HEAVY_SLASH",ANIM_SPECIAL_ATTACK:"ZERO_UPPER_SLASH",ANIM_GUARD:"ZERO_BLOCK",ANIM_DASH:"ZERO_DASH",ANIM_JUMP:"ZERO_JUMP",ANIM_ENTER:"ZERO_ENTER",ANIM_CHARGE:"ZERO_CHARGE",ANIM_HIT:"ZERO_HIT"};Crafty.c("BattlePlayerZeroAnimation",{init:function(){this.requires("SpriteAnimation")},battlePlayerZeroAnimation:function(){var t=this;return this.reel("ZERO_READY",900,0,0,4).reel("ZERO_LIGHT_SLASH",380,0,1,8).reel("ZERO_MED_SLASH",380,0,2,6).reel("ZERO_HEAVY_SLASH",380,0,3,8).reel("ZERO_UPPER_SLASH",380,0,4,8).reel("ZERO_BLOCK",480,0,5,7).reel("ZERO_DASH",700,0,8,3).reel("ZERO_JUMP",700,9,6).reel("ZERO_ENTER",700,10,13).reel("ZERO_CHARGE",700,11,7)._setupHitAnim().bind("EnterFrame",function(e){t.isPlaying()||t.playAnim(n.ANIM_READY)}),this},animAttack:function(t){var e,i;t?e=t:(i=["ZERO_LIGHT_SLASH",ZERO_ANIM_MED_SLASH_ZERO_ANIM_HEAVY_SLASH,"ZERO_UPPER_SLASH"],e=i[Math.floor(i.length*Math.random())]),this.animate(e,0)},playAnim:function(t){this._playAnim(r[t])},_playAnim:function(t){if(!t)throw"ERROR: No reel id passed to play animation";this.animate(t,0)},_setupHitAnim:function(){var t;return t=[[0,6],[1,6],[0,7],[1,7],[0,6],[1,6],[0,7],[1,7],[0,6],[1,6],[0,7],[1,7],[0,6],[1,6],[0,7],[1,7],[0,6],[1,6],[0,7],[1,7]],this.reel("ZERO_HIT",320,t),this}})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(5),r={ANIM_READY:"SLIME_READY",ANIM_LIGHT_ATTACK:"SLIME_SLASH",ANIM_MED_ATTACK:"SLIME_SLASH",ANIM_HEAVY_ATTACK:"SLIME_THROW",ANIM_SPECIAL_ATTACK:"SLIME_THROW",ANIM_GUARD:"SLIME_BLOCK",ANIM_DASH:"",ANIM_JUMP:"",ANIM_ENTER:"",ANIM_CHARGE:"",ANIM_HIT:"SLIME_HIT"};Crafty.c("BattleSlimeAnimation",{init:function(){this.requires("SpriteAnimation")},battleSlimeAnimation:function(){var t=this;return this.reel("SLIME_READY",600,0,0,4).reel("SLIME_HIT",420,0,1,7).reel("SLIME_SLASH",500,0,2,7).reel("SLIME_THROW",500,0,4,8).reel("SLIME_BLOCK",270,0,3,7).bind("EnterFrame",function(e){t.isPlaying()||t.playAnim(n.ANIM_READY)}),this},playAnim:function(t){this._playAnim(r[t])},_playAnim:function(t){if(!t)throw new Error("ERROR: No reel id passed to play animation");this.animate(t,0)}})},function(t,e){Crafty.c("BattleNPCBrain",{init:function(){this.requires("BattleNPCEnemy")},battleNPCBrain:function(){return this}})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(23);Crafty.c("BattleNPCSlime",{_ANIM_HIT_DELAY:430,_ANIM_ATTACK_DELAY:200,init:function(){this.requires("2D, SpriteAnimation, BattleCharacter")},battleNPCEnemy:function(t){return this.charSheet||(this.charSheet=new n.default({name:"Slime"})),this._fragment_timers=[],this},getStance:function(){return"offense"},isPlayer:function(){return!1},isNPC:function(){return!0}})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});i(23);i(37),i(62),Crafty.c("BattlePlayer",{_ANIM_HIT_DELAY:410,_fragment_spawner:null,init:function(){this.requires("2D, BattlePlayerAnimation, BattleCharacter")},battlePlayer:function(t){return console.log("DEBUG: ~~~~~~~~~~~~~~~~~~~~~~~~~~~ battlePlayer second initializer"),this},die:function(){Crafty.trigger("PlayerDied",{target:this})},getStance:function(){return this.stance},isPlayer:function(){return!0},isNPC:function(){return!1},_unbindChangeStance:function(){this.unbind("SwitchedCombatMode")}})},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}Object.defineProperty(e,"__esModule",{value:!0});var o,s=i(11),a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l={player:{file:s.IMG_SPR_PLAYER_TEST,tile:108,tileh:76,elements:{pl_st0:[0,0],pl_st1:[1,0],pl_st2:[2,0],pl_st3:[3,0],pl_st4:[4,0],pl_st5:[5,0],pl_st6:[6,0],pl_hit0:[0,1],pl_hit1:[1,1],pl_hit2:[2,1],pl_hit3:[3,1],pl_hit4:[4,1],pl_hit5:[5,1],pl_hit6:[6,1],pl_att00:[0,2],pl_att01:[1,2],pl_att02:[2,2],pl_att03:[3,2],pl_att04:[4,2],pl_att05:[5,2],pl_att06:[6,2],pl_blk00:[0,3],pl_blk01:[1,3],pl_blk02:[2,3],pl_blk03:[3,3],pl_blk04:[4,3],pl_blk05:[5,3],pl_blk06:[6,3]}},player_zero:{file:s.IMG_SPR_PLAYER_ZERO,tile:80,tileh:72,elements:{plz_st0:[0,0],plz_st1:[0,1],plz_st2:[0,2],plz_st3:[0,3],plz_st4:[0,4],plz_att00:[1,0],plz_att01:[1,1],plz_att02:[1,2],plz_att03:[1,3],plz_att04:[1,4],plz_att05:[1,5],plz_att06:[1,6],plz_att07:[1,7],plz_att08:[1,8],plz_att10:[2,0],plz_att11:[2,1],plz_att12:[2,2],plz_att13:[2,3],plz_att14:[2,4],plz_att15:[2,5],plz_att16:[2,6],plz_att20:[3,0],plz_att21:[3,1],plz_att22:[3,2],plz_att23:[3,3],plz_att24:[3,4],plz_att25:[3,5],plz_att26:[3,6],plz_att27:[3,7],plz_att28:[3,8],plz_att30:[4,0],plz_att31:[4,1],plz_att32:[4,2],plz_att33:[4,3],plz_att34:[4,4],plz_att35:[4,5],plz_att36:[4,6],plz_att37:[4,7],plz_att38:[4,8],plz_dodge00:[5,0],plz_dodge01:[5,1],plz_dodge02:[5,2],plz_dodge03:[5,3],plz_dodge04:[5,4],plz_dodge05:[5,5],plz_dodge06:[5,6],plz_dodge07:[5,7],plz_hit00:[6,0],plz_hit01:[6,1],plz_hit10:[7,0],plz_hit11:[7,1],plz_dash0:[8,0],plz_dash1:[8,1],plz_dash2:[8,2],plz_dash3:[8,3],plz_jump0:[9,0],plz_jump1:[9,1],plz_jump2:[9,2],plz_jump3:[9,3],plz_jump4:[9,4],plz_jump5:[9,5],plz_jump6:[9,6],plz_in0:[10,0],plz_in1:[10,1],plz_in2:[10,2],plz_in3:[10,3],plz_in4:[10,4],plz_in5:[10,5],plz_in6:[10,6],plz_in7:[10,7],plz_in8:[10,8],plz_in9:[10,9],plz_in10:[10,10],plz_in11:[10,11],plz_in12:[10,12],plz_in13:[10,13],plz_charge0:[11,0],plz_charge1:[11,1],plz_charge2:[11,2],plz_charge3:[11,3],plz_charge4:[11,4],plz_charge5:[11,5],plz_charge6:[11,6],plz_charge7:[11,7]}},slime:{file:s.IMG_SPR_NPC_SLIME,tile:42,elements:(o={slime_st0:[0,0],slime_st1:[1,0],slime_st2:[2,0],slime_st3:[3,0],slime_st4:[4,0],slime_hit0:[0,1],slime_hit1:[1,1],slime_hit2:[2,1],slime_hit3:[3,1],slime_hit4:[4,1],slime_hit5:[5,1],slime_hit6:[6,1]},r(o,"slime_hit6",[7,1]),r(o,"slime_att00",[0,2]),r(o,"slime_att01",[1,2]),r(o,"slime_att02",[2,2]),r(o,"slime_att03",[3,2]),r(o,"slime_att04",[4,2]),r(o,"slime_att05",[5,2]),r(o,"slime_att06",[6,2]),r(o,"slime_att06",[7,2]),r(o,"slime_blk00",[0,3]),r(o,"slime_blk01",[1,3]),r(o,"slime_blk02",[2,3]),r(o,"slime_blk03",[3,3]),r(o,"slime_blk04",[4,3]),r(o,"slime_blk05",[5,3]),r(o,"slime_blk06",[6,3]),r(o,"slime_blk07",[7,3]),r(o,"slime_att200",[0,4]),r(o,"slime_att201",[1,4]),r(o,"slime_att202",[2,4]),r(o,"slime_att203",[3,4]),r(o,"slime_att204",[4,4]),r(o,"slime_att205",[5,4]),r(o,"slime_att206",[6,4]),r(o,"slime_att207",[7,4]),o)}},c=function(){function t(){n(this,t)}return a(t,null,[{key:"create",value:function(t){var e;return void 0!=t&&(e=l[t],void 0==e.tileh?Crafty.sprite(e.tile,e.file,e.elements):Crafty.sprite(e.tile,e.tileh,e.file,e.elements),!0)}},{key:"getPaths",value:function(){var t=[],e=0;return _.each(l,function(i,n){t[e]=i.file,e++}),t}}]),t}();e.default=c},function(t,e){Crafty.c("BattleBackground",{_height:void 0,_width:void 0,_path:"",init:function(){this.requires("2D, DOM, Image")},battleBackground:function(t,e,i){return this.h=e,this.w=i,this.image(t,"no-repeat"),this}})},function(t,e){Crafty.c("BattleEffectable",{init:function(){this._effectQueue=[]},battleEffectable:function(){return this},getEffectQueue:function(){return this._effectQueue},setEffectQueue:function(t){this._effectQueue=t}})},function(t,e,i){i(68),Crafty.c("BattleNPCSkillManager",{_skills:null,_skillset:null,_skillQueue:null,init:function(){},battleNPCSkillManager:function(){return this},getSkillQueue:function(){return this._skillQueue},getSkillset:function(){return this._skillset},getSkills:function(){return this._skills},setSkillQueue:function(t){this._skillQueue=t},setSkills:function(t){this._skills=t},setSkillset:function(t){this._skillset=t}})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(0),r=i.n(n),o=i(1),s=r.a.View.extend({tagName:"div",className:"defense-tutorial-notification",id:"defense-tutorial-notification",_templateId:"#defense-tutorial-notif-template",initialize:function(){console.log("DEBUG: initializing tutorial notification view"),this._template=o.compile($(this._templateId).html())},render:function(t){var e={count:t};console.log("DEBUG: rendering tutorial notif view.  With count -> ",e),this.$el.html(this._template(e)),$("#"+this.id).length<1&&$("#typewar-game").prepend(this.$el)}});Crafty.c("DefenseTutorial",{init:function(){this._defendedCount=0},defenseTutorial:function(t){return this._defendedGoal=t,this._view=new s,this._view.render(t),this},cleanup:function(){this._view.remove()},getDefenseGoal:function(){return this._defendedGoal},getDefendedCount:function(){return this._defendedCount},getView:function(){return this._view},incrementDefendedCount:function(){this._defendedCount+=1}})},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){return[_.random(-t,t),_.random(-e,e)]}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s={duration:60,range:2,timing:4},a=function(){function t(e){n(this,t),this.options=_.cloneDeep(e),this._initViewport(),this._initBackground()}return o(t,[{key:"shake",value:function(t){var e,i,n;for(n=this,e=_.merge(s,t),i=0,this._setBackgroundOffsetAsPixels();;){if(i>=e.duration)return void window.setTimeout(function(){Crafty.viewport.x=n.originalViewportX,Crafty.viewport.y=n.originalViewportY,Crafty.stage.elem.style.backgroundPositionX=n.originalBackgroundOffsetX,Crafty.stage.elem.style.backgroundPositionY=n.originalBackgroundOffsetY},(i+2)*e.timing);window.setTimeout(function(){var t,i,n;t=r(e.range,e.range),Crafty.viewport.x=Crafty.viewport._x+t[0],Crafty.viewport.y=Crafty.viewport._y+t[1],i=_.parseInt(Crafty.stage.elem.style.backgroundPositionX),n=_.parseInt(Crafty.stage.elem.style.backgroundPositionY),i+=t[0],n+=t[1],Crafty.stage.elem.style.backgroundPositionX=i+"%",Crafty.stage.elem.style.backgroundPositionY=n+"%"},(i+1)*e.timing),i+=e.timing}}},{key:"_initBackground",value:function(){this.backgroundOffsetX=Crafty.stage.elem.style.backgroundPositionX,this.backgroundOffsetY=Crafty.stage.elem.style.backgroundPositionY,this.originalBackgroundOffsetX=this.backgroundOffsetX,this.originalBackgroundOffsetY=this.backgroundOffsetY}},{key:"_initViewport",value:function(){Crafty.viewport.scale(this.options.scale),Crafty.viewport.x+=this.options.offsetX,Crafty.viewport.y+=this.options.offsetY,this.originalViewportX=Crafty.viewport._x,this.originalViewportY=Crafty.viewport._y}},{key:"_setBackgroundOffsetAsPixels",value:function(){var t,e;t=Crafty.stage.elem.style.backgroundPositionX,e=Crafty.stage.elem.style.backgroundPositionY,"center"==t&&(t="50%"),"center"==e&&(e="50%"),Crafty.stage.elem.style.backgroundPositionX=t,Crafty.stage.elem.style.backgroundPositionY=e}}]),t}();e.default=a},function(t,e,i){"use strict";function n(t){var e,i;return e="2D, DOM, BattleEffectable, BattleCharacter, BattlePlayer, PlayerSkillManager, Collision, BattleStatus, BattleStance",e+=", "+t.spriteFrame,e+=", "+t.animationComponent,i=Crafty.e(e),i.attr({w:t.width,h:t.height}).battleCharacter(t.charSheet).battlePlayer().battleStatus().battleStance(t.initialStance).collision(new Crafty.polygon(t.hitbox)),i[_.lowerFirst(t.animationComponent)].call(i),r(i)}function r(t){return o(t)}function o(t){return window.serverCaller?serverCaller.getVocabulariesPromise().then(function(e,i,n){return t.charSheet.data.vocabulary=e,t}):new Promise(function(e,i){t.charSheet.data.vocabulary=s.DUMMY_TEXT_LIBRARY,e(t)})}Object.defineProperty(e,"__esModule",{value:!0});var s=i(57);e.default=n,i(37),i(74),i(70),i(69),i(56)},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(11),r={name:"player_died",filepath:n.IMG_BG_PL_DIED,width:800,height:336,css:"url("+n.IMG_BG_PL_DIED+") center center / 110% no-repeat rgb(255, 255, 255)",offsetX:"center",offsetY:"center",size:"110%"};e.default=r},function(t,e,i){"use strict";function n(t){var e,i;e=t("TextFragment DefendableAttack").get(),i=_.filter(e,function(t){return t.isComplete()}),_.each(i,function(e){t.trigger(r.PLAYER_DEFENDED_ATTACK_EVT)})}Object.defineProperty(e,"__esModule",{value:!0});var r=i(2);e.triggerPlayerDefendedEventSystem=n},function(t,e,i){"use strict";function n(t){var e,i;e=t("BattlePCSkill TextFragment").get(),i=_.filter(e,function(t){return t.isComplete()}),_.each(i,function(e){t.trigger(r.PLAYER_USED_SKILL_EVT)})}Object.defineProperty(e,"__esModule",{value:!0});var r=i(2);e.triggerPlayerSkillEventSystem=n},function(t,e,i){"use strict";function n(t){var e,i,n;e=t("BattleInput BattleStance").get(),e.length<1||(i=e[0],n=i.getInputQueue(),0!=n.length&&n.forEach(function(e){e==r.CMD_CHANGE_STANCE&&t.trigger(o.PLAYER_SWITCHED_TO_OFFENSE_EVT)}))}Object.defineProperty(e,"__esModule",{value:!0});var r=i(16),o=i(2);e.triggerPlayerSwitchedToOffenseEventSystem=n},function(t,e,i){"use strict";function n(t){t.e("DefenseTutorial").defenseTutorial(5)}function r(t){var e,i;e=t("DefenseTutorial"),i=_.filter(t("TextFragment DefendableAttack").get(),function(t){return t.isComplete()}),i.length>=1&&(e.incrementDefendedCount(),e.getView().render(e.getDefenseGoal()-e.getDefendedCount())),e.getDefendedCount()>=e.getDefenseGoal()&&t.trigger(s.TRAINING_TUTORIAL_COMPLETED_EVT)}function o(t){_.each(t("DefenseTutorial").get(),function(t){t.cleanup(),t.destroy()})}Object.defineProperty(e,"__esModule",{value:!0});var s=i(2);e.initTutorialDefendWinSystem=n,e.tutorialDefendWinSystem=r,e.teardownTutorialDefendWinSystem=o,i(79)},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(21),r=i(52),o=i(20),s=(i(15),i(3)),a=i(54),l=_.cloneDeep(r.default);l.charSheet.status.hp=6,l.charSheet.status.maxHp=6;var c={id:"prototype_battle",name:"prototype battle scene",width:450,height:240,borders:{left:3,right:510,floor:240},background:o.default,combatants:{player:n.default,npc:l},audio:{sounds:[s.SOUND_LETTER_TYPED,s.SOUND_SWORD_SLASH]},systems:a.default};e.default=c},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(21),r=i(52),o=i(20),s=(i(22),i(15)),a=i(3),l=i(54),c=_.cloneDeep(r.default),u=_.cloneDeep(s.SlimeGlobAttack);u.effects[0].textOptions.minLength=3,u.effects[0].textOptions.maxLength=6,c.charSheet.status.maxHp=30,c.charSheet.status.hp=30,c.charSheet.skills=[s.SlimeStandardAttack,u];var h={id:"prototype_battle",name:"prototype battle scene",width:450,height:240,borders:{left:3,right:510,floor:240},background:o.default,combatants:{player:n.default,npc:c},audio:{sounds:[a.SOUND_LETTER_TYPED,a.SOUND_SWORD_SLASH]},systems:l.default};e.default=h},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(21),r=i(52),o=i(20),s=i(15),a=i(3),l=i(54),c=_.cloneDeep(r.default);c.charSheet.status.maxHp=18,c.charSheet.status.hp=18,c.charSheet.skills=[s.SlimeScatterAttack];var u={id:"prototype_battle",name:"prototype battle scene",width:450,height:240,borders:{left:3,right:510,floor:240},background:o.default,combatants:{player:n.default,npc:c},audio:{sounds:[a.SOUND_LETTER_TYPED,a.SOUND_SWORD_SLASH]},systems:l.default};e.default=u},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(21),r=i(53),o=i(20),s=i(22),a=i(3),l=i(2),c=i(26),u=i(27),h=i(29),p=i(33),m=i(31),f=i(30),d=i(34),y=i(36),g=i(28),v=i(35),x=i(25),b=i(32),w=i(55),C=i(59),S=_.cloneDeep(n.default);S.charSheet.skills=[s.ZeroLightSlash],S.initialStance="offense";var A=_.cloneDeep(r.default);A.charSheet.status.hp=1,A.charSheet.status.maxHp=1;var D={id:l.SID_TRAINING1,name:"Training scene 1",width:450,height:240,borders:{left:3,right:510,floor:240},background:o.default,combatants:{player:S,npc:A},audio:{sounds:[a.SOUND_LETTER_TYPED,a.SOUND_SWORD_SLASH]},systems:{initializers:[{system:x.initAudioSystem,options:{audioData:["audio"]}},{system:u.initBattleStatusSystem},{system:h.initInputSystem},{system:p.initPlayerSkillSystem},{system:m.initNPCSkillSystem},{system:f.initNPCAISystem},{system:b.initParticleSystem},{system:w.initTutorialSystem,options:{tutorialData:["tutorial"]}}],runners:[{system:w.tutorialSystem},{system:h.inputSystem},{system:p.playerSkillSystem},{system:m.npcSkillSystem},{system:f.nPCAISystem},{system:v.textFragmentAttackDisplaySystem},{system:g.defendableSkillSystem},{system:d.projectileSystem},{system:y.triggerEffectOnCollideSystem},{system:c.battleEffectSystem},{system:u.battleStatusSystem},{system:b.particleSystem},{system:x.audioSystem},{system:C.npcDiedTutorialSystem}],cleanup:[{system:u.teardownBattleStatusSystem},{system:x.teardownAudioSystem},{system:w.teardownTutorialSystem}]},tutorial:{steps:[{type:"wait",duration:1e3},{type:"modal",modalData:{headerContent:"Welcome to Typewarrior!",modalContent:"This is a fighting game featuring typing.",footerContent:"Press space to continue..."}},{type:"wait_input",input:"SPACE"},{type:"modal",modalData:{headerContent:"How to Play: Defeat Your Opponent!",modalContent:"Type the words to attack and defend.  Successful attacks will deplete the enemy's health.  Successful attacks against you will deplete your health.  Reduce the enemy's health to zero before you are defeated. In this stage we'll show you how to attack.",footerContent:"Press space to continue..."}},{type:"wait_input",input:"SPACE"},{type:"modal",modalData:{headerContent:"How to Play: Opponent's Health",modalContent:"Here's your opponent's health bar.  As you attack, this bar will deplete.  Bring it to zero and you've won!",footerContent:"Press space to continue..."},highlightSelectors:".entity-status-training-dummy"},{type:"wait_input",input:"SPACE"},{type:"modal",modalData:{headerContent:"How to Play: Your Skills",modalContent:"Here are your skills, type the word or words shown here to attack.  There will be a cooldown after you've used a given skill where it won't yet be ready.",footerContent:"Press space to continue..."},highlightSelectors:".battle-skill"},{type:"wait_input",input:"SPACE"},{type:"modal",modalData:{headerContent:"How to Play: Prepare to Fight",modalContent:"This training dummy won't fight back.  Just keep hitting it to get the hang of attacking.",footerContent:"Ready? Press space to continue..."}},{type:"wait_input",input:"SPACE"},{type:"wait_event",eventTarget:"tutorial_completed"},{type:"end"}]}};e.default=D},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(21),r=i(53),o=i(20),s=i(15),a=i(3),l=i(2),c=i(26),u=i(27),h=i(29),p=i(33),m=i(31),f=i(30),d=i(34),y=i(36),g=i(28),v=i(35),x=i(25),b=i(32),w=i(55),C=i(86),S=_.cloneDeep(n.default);S.charSheet.skills=[];var A=_.cloneDeep(r.default);A.charSheet.skills=[s.SlimeStandardAttack];var D={id:"training_scene_1",name:"Training scene 1",width:450,height:240,borders:{left:3,right:510,floor:240},background:o.default,combatants:{player:S,npc:A},audio:{sounds:[a.SOUND_LETTER_TYPED,a.SOUND_SWORD_SLASH]},systems:{initializers:[{system:x.initAudioSystem,options:{audioData:["audio"]}},{system:u.initBattleStatusSystem},{system:h.initInputSystem},{system:p.initPlayerSkillSystem},{system:m.initNPCSkillSystem},{system:f.initNPCAISystem},{system:b.initParticleSystem},{system:C.initTutorialDefendWinSystem},{system:w.initTutorialSystem,options:{tutorialData:["tutorial"]}}],runners:[{system:w.tutorialSystem},{system:h.inputSystem},{system:p.playerSkillSystem},{system:m.npcSkillSystem},{system:f.nPCAISystem},{system:v.textFragmentAttackDisplaySystem},{system:C.tutorialDefendWinSystem},{system:g.defendableSkillSystem},{system:d.projectileSystem},{system:y.triggerEffectOnCollideSystem},{system:c.battleEffectSystem},{system:u.battleStatusSystem},{system:b.particleSystem},{system:x.audioSystem}],cleanup:[{system:u.teardownBattleStatusSystem},{system:x.teardownAudioSystem},{system:w.teardownTutorialSystem},{system:C.teardownTutorialDefendWinSystem}]},tutorial:{steps:[{type:"modal",modalData:{headerContent:"Defend Yourself!",modalContent:"Now we'll practice defense.  The training dummy will attempt to attack you by sending words your way. Type the words successfully to guard against them.  If they hit you, you will receive damage.",footerContent:"Press space to continue..."}},{type:"wait_input",input:"SPACE"},{type:"modal",modalData:{headerContent:"Defend Yourself!",modalContent:"Defend against 5 attacks to complete the training.",footerContent:"Press space to continue..."}},{type:"wait_input",input:"SPACE"},{type:"wait_event",eventTarget:l.TRAINING_TUTORIAL_COMPLETED_EVT},{type:"end"}]}};e.default=D},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(21),r=i(53),o=i(20),s=i(22),a=i(15),l=i(3),c=i(2),u=i(26),h=i(27),p=i(29),m=i(33),f=i(31),d=i(30),y=i(34),g=i(36),v=i(28),x=i(35),b=i(25),w=i(32),C=i(55),S=i(59),A=i(83),D=i(85),M=i(84),T=_.cloneDeep(n.default);T.charSheet.skills=[s.ZeroLightSlash];var k=_.cloneDeep(r.default);k.charSheet.skills=[a.SlimeStandardAttack],k.charSheet.status.hp=5,k.charSheet.status.maxHp=5;var I={id:"training_scene_1",name:"Training scene 1",width:450,height:240,borders:{left:3,right:510,floor:240},background:o.default,combatants:{player:T,npc:k},audio:{sounds:[l.SOUND_LETTER_TYPED,l.SOUND_SWORD_SLASH]},systems:{initializers:[{system:b.initAudioSystem,options:{audioData:["audio"]}},{system:h.initBattleStatusSystem},{system:p.initInputSystem},{system:m.initPlayerSkillSystem},{system:f.initNPCSkillSystem},{system:d.initNPCAISystem},{system:w.initParticleSystem},{system:C.initTutorialSystem,options:{tutorialData:["tutorial"]}}],runners:[{system:C.tutorialSystem},{system:A.triggerPlayerDefendedEventSystem},{system:D.triggerPlayerSwitchedToOffenseEventSystem},{system:p.inputSystem},{system:M.triggerPlayerSkillEventSystem},{system:m.playerSkillSystem},{system:f.npcSkillSystem},{system:d.nPCAISystem},{system:x.textFragmentAttackDisplaySystem},{system:A.triggerPlayerDefendedEventSystem},{system:v.defendableSkillSystem},{system:y.projectileSystem},{system:g.triggerEffectOnCollideSystem},{system:u.battleEffectSystem},{system:h.battleStatusSystem},{system:w.particleSystem},{system:b.audioSystem},{system:S.npcDiedTutorialSystem}],cleanup:[{system:h.teardownBattleStatusSystem},{system:b.teardownAudioSystem},{system:C.teardownTutorialSystem}]},tutorial:{steps:[{type:"modal",modalData:{headerContent:"Mock Battle",modalContent:"Here's where you'll put what you've learned in the past two training exercises together.  Try defending against the dummy's attack.",footerContent:"Press space to continue..."}},{type:"wait_input",input:"SPACE"},{type:"wait_event",eventTarget:c.PLAYER_DEFENDED_ATTACK_EVT},{type:"modal",modalData:{headerContent:"Switching Defense to Offense",modalContent:"Now we'll switch from defending against attacks to using our skills to hit the dummy.",footerContent:"Press space to continue..."}},{type:"wait_input",input:"SPACE"},{type:"modal",modalData:{headerContent:"Switching Defense to Offense",modalContent:"These icons indicate the stance that each character is in.  The shield above your character indicates that you are defending.  You can switch stances with tab.",footerContent:"Press space to continue..."},highlightEntities:"ModeIcon"},{type:"wait_input",input:"SPACE"},{type:"modal",modalData:{headerContent:"Switching Defense to Offense",modalContent:"Press tab now to switch to offense.",footerContent:"Press space to continue..."},highlightEntities:"ModeIcon"},{type:"wait_input",input:"SPACE"},{type:"wait_event",eventTarget:c.PLAYER_SWITCHED_TO_OFFENSE_EVT},{type:"modal",modalData:{headerContent:"Switching Defense to Offense",modalContent:"See how the icon above your character has changed to crossed swords?",footerContent:"Press space to continue..."},highlightEntities:"ModeIcon"},{type:"wait_input",input:"SPACE"},{type:"modal",modalData:{headerContent:"Ready to Attack",modalContent:"Now you're ready to start typing the words here (your skills) ",footerContent:"Press space to continue..."},highlightSelectors:".battle-skill"},{type:"wait_input",input:"SPACE"},{type:"wait_event",eventTarget:c.PLAYER_USED_SKILL_EVT},{type:"modal",modalData:{headerContent:"Finish Your Training",modalContent:"Great! You've defended against the dummy's attacks, then switched to an offensive stance and struck the dummy.",footerContent:"Press space to continue..."}},{type:"wait_input",input:"SPACE"},{type:"modal",modalData:{headerContent:"Finish Your Training",modalContent:"Now use the skills you've learned to protect yourself as you break the practice dummy.  Keep switching to defense to prevent yourself from being hit.  Keep switching back to offense to deal damage when it's safe. These are the fundamentals of battle.  Now, have at it!",footerContent:"Press space to continue..."}},{type:"wait_input",input:"SPACE"},{type:"wait_event",eventTarget:c.TRAINING_TUTORIAL_COMPLETED_EVT},{type:"end"}]}};e.default=I},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=i(2),o=i(82),s=i(66),a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=function(){function t(){n(this,t),Crafty.scene(r.SID_PL_LOSE,this.init.bind(this),function(){})}return a(t,[{key:"play",value:function(){Crafty.scene(r.SID_PL_LOSE)}},{key:"init",value:function(){this._initFadeIn(),this._setBackground()}},{key:"stop",value:function(){throw new Error("Stop method not implemented on PlayerLoseScene")}},{key:"_initFadeIn",value:function(){s.Fadein.execute({})}},{key:"_setBackground",value:function(){Crafty.background('#000 url("'+o.default.filepath+'") no-repeat center center')}},{key:"sceneId",get:function(){return r.SID_PL_LOSE}}]),t}();e.default=l},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=i(67),a=i(58),l=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),c=function(t){function e(t,i){return n(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i))}return o(e,t),l(e,[{key:"init",value:function(){var t;t=this,t.initSprites(),t.initBackground(),t.initStageEdges(),t.initCombatants().then(function(e){console.log("DEBUG: in the 'then' after trainingScene#initCombatants"),t.initSystems(),t.registerSystems(),t.initCamera()},function(t){throw console.log("DEBUG: FAILED TO INITIALIZE COMBATANTS FOR SOME REASON..."),t}).catch(function(t){throw console.log("DEBUG: ERROR IN PROMISE GROUP~~~~~~~---->",t),t})}},{key:"initEnemyNPC",value:function(){var t;return t=i.i(a.default)(this._sceneData.combatants.npc),t.then(function(t){return t.x=390,t.y=210,t})}}]),e}(s.default);e.default=c},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(){return new Promise(function(t,e){y.Fadeout.execute({fulfill:t,reject:e})})}function o(){var t=this;return new Promise(function(e,i){t.playScene(t._currentSceneIndex+1),e()})}function s(){var t=this;return new Promise(function(e,i){t.playScene(g.SID_PL_LOSE)})}Object.defineProperty(e,"__esModule",{value:!0});var a=i(67),l=i(94),c=i(93),u=i(87),h=i(89),p=i(88),m=i(90),f=i(91),d=i(92),y=i(66),g=i(2),v=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),x=[{id:g.SID_TRAINING1,sceneKlass:l.default,sceneData:m.default,transitions:{victory:[g.TRN_FADEOUT,g.TRN_NEXT],defeat:[g.TRN_LOSE]}},{id:g.SID_TRAINING2,sceneKlass:l.default,sceneData:f.default,transitions:{victory:[g.TRN_FADEOUT,g.TRN_NEXT],defeat:[g.TRN_LOSE]}},{id:g.SID_TRAINING3,sceneKlass:l.default,sceneData:d.default,transitions:{victory:[g.TRN_FADEOUT,g.TRN_NEXT],defeat:[g.TRN_LOSE]}},{id:g.SID_BABY_SLIME,sceneKlass:a.default,sceneData:u.default,transitions:{victory:[g.TRN_NEXT],defeat:[g.TRN_LOSE]}},{id:g.SID_SLIME_BLAST,sceneKlass:a.default,sceneData:h.default,transitions:{victory:[g.TRN_NEXT],defeat:[g.TRN_LOSE]}},{id:g.SID_PROTOTYPE_BATTLE,sceneKlass:a.default,sceneData:p.default,transitions:{victory:[g.TRN_NEXT],defeat:[g.TRN_LOSE]}},{id:g.SID_PL_LOSE,sceneKlass:c.default}],b=function(){function t(){n(this,t),this._initSceneGraph(),this._bindSceneListeners()}return v(t,[{key:"playScene",value:function(t){t||this.loadScene(this._sceneGraph[0]),"number"==typeof t&&this.loadScene(this._sceneGraph[t]),"string"==typeof t&&this.loadScene(this._findSceneFromId(t)),this._currentScene.play()}},{key:"loadScene",value:function(t){this._currentScene=new t.sceneKlass(t.id,t.sceneData),this._currentSceneIndex=_.indexOf(this._sceneGraph,t)}},{key:"_bindSceneListeners",value:function(){Crafty.bind(g.SCENE_TRANSITION_EVT,this._handleSceneTransition.bind(this))}},{key:"_findSceneFromId",value:function(t){return _.find(this._sceneGraph,function(e){return e.id==t})}},{key:"_getCurrentSceneId",value:function(){return this._currentScene.get("scene_id")}},{key:"_handleSceneTransition",value:function(t){var e;e=this._sceneGraph[this._currentSceneIndex].transitions[t],this._playTransitionSequence(e,0)}},{key:"_playTransitionSequence",value:function(t,e){var i,n,r;if(i=this,!t)return void console.log("DEBUG: there is no transition directive declared for the event");n=_.map(t,function(t){return i._promiseFromTransition(t)}),r=Promise.resolve(),_.each(n,function(t){r=r.then(t.bind(i))})}},{key:"_initSceneGraph",value:function(){this._sceneGraph=x}},{key:"_promiseFromTransition",value:function(t){switch(t){case g.TRN_FADEOUT:return r;case g.TRN_NEXT:if(!this._sceneGraph[this._currentSceneIndex+1])throw new Error("This is the end of the game! we're working on new levels");return o;case g.TRN_LOSE:return s;case"default":throw new Error("Error, invalid transition declared ---> ",t)}}},{key:"currentScene",get:function(){return this._currentScene}}]),t}();e.default=b},function(t,e){function i(t,e,i){if(i)return Crafty.e("2D, Canvas, Particles").attr({x:t,y:e,w:10,h:10}).particles(i)}var n={maxParticles:150,size:18,sizeRandom:4,speed:1,speedRandom:1.2,lifeSpan:29,lifeSpanRandom:25,angle:65,angleRandom:34,startColour:[255,131,0,1],startColourRandom:[48,50,45,0],endColour:[245,35,0,0],endColourRandom:[60,60,60,0],sharpness:20,sharpnessRandom:10,spread:10,duration:5,fastMode:!1,gravity:{x:0,y:.1},jitter:3,originOffset:{x:0,y:0}};window.d_particle_options=_.cloneDeep(n),window.particleFactory=i},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),o=function(){function t(e){n(this,t),this._storeOptions(e)}return r(t,[{key:"getVocabularies",value:function(t){this.getVocabulariesPromise().done(function(e,i,n){t()})}},{key:"getVocabulariesPromise",value:function(){return $.ajax(this.urls.vocabulariesUrl,{dataType:"json"})}},{key:"_storeOptions",value:function(t){console.log("DEBUG: initializing typewar server caller"),_.isEmpty(t)||(this.urls={vocabulariesUrl:t.vocabulariesUrl||null})}}]),t}();e.default=o},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=i(95),o=i(97),s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();i(96);var a=function(){function t(e,i){if(n(this,t),!e)throw new Error("No container provided to house the game window");this.container=e,this.$container=$(this.container),this.options=i||{},this._setupApi(i),this._setupContainer(),this._initCrafty(),this._initManagers(),this.sceneManager.playScene()}return s(t,[{key:"_initCrafty",value:function(){console.log("DEBUG: initializing Crafty"),Crafty.init(this.viewportWidth,this.viewportHeight),Crafty.viewport.init(this.viewportWidth,this.viewportHeight),Crafty.background("blue")}},{key:"_initManagers",value:function(){this.managers={},this.sceneManager=new r.default}},{key:"_setupApi",value:function(t){window.serverCaller=new o.default(t)}},{key:"_setupContainer",value:function(){switch(this.options.containerSize){case"standard":this.viewportWidth=1080,this.viewportHeight=480;break;default:this.viewportWidth=1080,this.viewportHeight=480}this.$container.css({margin:"auto",width:this.viewportWidth+"px"})}}]),t}();e.default=a},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(98);window.onload=function(t){var e,i;e=$("[data-typewar-container]"),1==e.length&&(i=e.data(),new n.default(e[0],i))}},function(t,e,i){var n,n,r,o,s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function t(e,i,r){function o(a,l){if(!i[a]){if(!e[a]){var c="function"==typeof n&&n;if(!l&&c)return n(a,!0);if(s)return s(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var h=i[a]={exports:{}};e[a][0].call(h.exports,function(t){var i=e[a][1][t];return o(i||t)},h,h.exports,t,e,i,r)}return i[a].exports}for(var s="function"==typeof n&&n,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(t,e,i){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(t){if(h===setTimeout)return setTimeout(t,0);if((h===n||!h)&&setTimeout)return h=setTimeout,setTimeout(t,0);try{return h(t,0)}catch(e){try{return h.call(null,t,0)}catch(e){return h.call(this,t,0)}}}function s(t){if(p===clearTimeout)return clearTimeout(t);if((p===r||!p)&&clearTimeout)return p=clearTimeout,clearTimeout(t);try{return p(t)}catch(e){try{return p.call(null,t)}catch(e){return p.call(this,t)}}}function a(){d&&f&&(d=!1,f.length?_=f.concat(_):y=-1,_.length&&l())}function l(){if(!d){var t=o(a);d=!0;for(var e=_.length;e;){for(f=_,_=[];++y<e;)f&&f[y].run();y=-1,e=_.length}f=null,d=!1,s(t)}}function c(t,e){this.fun=t,this.array=e}function u(){}var h,p,m=e.exports={};!function(){try{h="function"==typeof setTimeout?setTimeout:n}catch(t){h=n}try{p="function"==typeof clearTimeout?clearTimeout:r}catch(t){p=r}}();var f,_=[],d=!1,y=-1;m.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];_.push(new c(t,e)),1!==_.length||d||o(l)},c.prototype.run=function(){this.fun.apply(null,this.array)},m.title="browser",m.browser=!0,m.env={},m.argv=[],m.version="",m.versions={},m.on=u,m.addListener=u,m.once=u,m.off=u,m.removeListener=u,m.removeAllListeners=u,m.emit=u,m.binding=function(t){throw new Error("process.binding is not supported")},m.cwd=function(){return"/"},m.chdir=function(t){throw new Error("process.chdir is not supported")},m.umask=function(){return 0}},{}],2:[function(t,e,i){function n(t,e,i){Object.defineProperty(t,e,{enumerable:!1,configurable:!1,get:function(){return t[i]},set:function(e){t[i]=e}})}e.exports={defineAliases:function(t){n(t,"image_whitelist","imageWhitelist")}}},{}],3:[function(t,e,i){function n(t){s.mouseObjs++,this.button=t}function r(t){this.key=t}function o(t){this.inputs=t}var s=t("../core/core.js");n.prototype={isDown:function(){return s.mouseButtonsDown[this.button]},destroy:function(){s.mouseObjs--}},r.prototype={isDown:function(){return s.keydown[this.key]}},o.prototype={timeDown:null,isActive:function(){for(var t in this.inputs){if(this.inputs[t].isDown())return this.timeDown||(this.timeDown=Date.now()),!0}return delete this.timeDown,!1},destroy:function(){for(var t in this.inputs)"function"==typeof this.inputs[t].destroy&&this.inputs[t].destroy()}},s.s("Controls",{init:function(){this._dpads={},this._triggers={}},events:{EnterFrameInput:function(){this.runEvents()},KeyDown:function(){this.updateTriggers()},KeyUp:function(){this.updateTriggers()},MouseDown:function(t){this.updateTriggers()},MouseUp:function(t){this.updateTriggers()}},updateTriggers:function(t){for(var e in this._triggers){var i=this._triggers[e];this.updateTriggerInput(i)}},runEvents:function(){for(var t in this._dpads){var e=this._dpads[t];e.oldX=e.x,e.oldY=e.y,this.updateDpadInput(e,e.multipleDirectionBehavior),this.updateActiveDirection(e,e.normalize),e.event.x=e.x,e.event.y=e.y,e.x===e.oldX&&e.y===e.oldY||s.trigger("DirectionalInput",e.event)}},getDpad:function(t){return this._dpads[t]},isTriggerDown:function(t){return this._triggers[t].active},defineTriggerGroup:function(t,e){var i;if(Array.isArray(e))i=e;else{if(i=[],e.mouseButtons)for(var s in e.mouseButtons)i.push(new n(e.mouseButtons[s]));if(e.keys)for(var a in e.keys)i.push(new r(e.keys[a]))}this._triggers[t]&&this._triggers[t].input.destroy(),this._triggers[t]={name:t,input:new o(i),downFor:0,active:!1}},defineDpad:function(t,e,i){var n={};for(var a in e){var l=e[a],c=s.keys[a]||a;n[l]||(n[l]=[]),n[l].push(new r(c))}var u={};for(var h in n)u[h]={input:new o(n[h]),active:!1,n:this.parseDirection(h)};if(void 0===i&&(i={}),void 0===i.normalize&&(i.normalize=!1),void 0===i.multipleDirectionBehavior&&(i.multipleDirectionBehavior="all"),this._dpads[t]){for(h in this._dpads[t].parsedDefinition)this._dpads[t].parsedDefinition[h].input.destroy();delete this._dpads[t]}this._dpads[t]={name:t,directions:u,x:0,y:0,oldX:0,oldY:0,event:{x:0,y:0,name:t},normalize:i.normalize,multipleDirectionBehavior:i.multipleDirectionBehavior}},parseDirection:function(t){return{x:Math.round(1e3*Math.cos(t*(Math.PI/180)))/1e3,y:Math.round(1e3*Math.sin(t*(Math.PI/180)))/1e3}},updateActiveDirection:function(t,e){t.x=0,t.y=0;for(var i in t.directions){var n=t.directions[i];n.active&&(t.x+=n.n.x,t.y+=n.n.y)}if(e){var r=Math.sqrt(t.x*t.x+t.y*t.y);r>0&&(t.x=t.x/r,t.y=t.y/r)}},updateTriggerInput:function(t){t.active?t.input.isActive()||(t.active=!1,s.trigger("TriggerInputUp",t),t.downFor=0):t.input.isActive()&&(t.downFor=Date.now()-t.input.timeDown,t.active=!0,s.trigger("TriggerInputDown",t))},updateDpadInput:function(t,e){var i,n,r;for(i in t.directions)n=t.directions[i],n.active=!1,n.input.isActive()&&("all"===e?n.active=!0:r?("first"===e&&r.input.timeDown>n.input.timeDown&&(r=n),"last"===e&&r.input.timeDown<n.input.timeDown&&(r=n)):r=n);r&&(r.active=!0)}})},{"../core/core.js":9}],4:[function(t,e,i){var n=t("../core/core.js");n.c("Draggable",{_origX:null,_origY:null,_oldX:null,_oldY:null,_dir:null,init:function(){this.requires("MouseDrag"),this.bind("StartDrag",this._startDrag).bind("Dragging",this._drag)},remove:function(){this.unbind("StartDrag",this._startDrag).unbind("Dragging",this._drag)},enableDrag:function(){return this.uniqueBind("Dragging",this._drag),this},disableDrag:function(){return this.unbind("Dragging",this._drag),this},dragDirection:function(t){if(void 0===t)this._dir=null;else if(+t===t)this._dir={x:Math.cos(t/180*Math.PI),y:Math.sin(t/180*Math.PI)};else if(0===t.x&&0===t.y)this._dir={x:0,y:0};else{var e=Math.sqrt(t.x*t.x+t.y*t.y);this._dir={x:t.x/e,y:t.y/e}}return this},_startDrag:function(t){this._origX=t.realX,this._origY=t.realY,this._oldX=this._x,this._oldY=this._y},_drag:function(t){if(this._dir){if(0!==this._dir.x||0!==this._dir.y){var e=(t.realX-this._origX)*this._dir.x+(t.realY-this._origY)*this._dir.y;this.x=this._oldX+e*this._dir.x,this.y=this._oldY+e*this._dir.y}}else this.x=this._oldX+(t.realX-this._origX),this.y=this._oldY+(t.realY-this._origY)}}),n.c("Controllable",{init:function(){this._inputBindings={DirectionalInput:{},TriggerInputDown:{},TriggerInputUp:{}}},events:{DirectionalInput:function(t){this._inputBindings.DirectionalInput[t.name]&&this._inputBindings.DirectionalInput[t.name].call(this,t)},TriggerInputDown:function(t){this._inputBindings.TriggerInputDown[t.name]&&this._inputBindings.TriggerInputDown[t.name].call(this,t)},TriggerInputUp:function(t){this._inputBindings.TriggerInputUp[t.name]&&this._inputBindings.TriggerInputUp[t.name].call(this,t)}},linkInput:function(t,e,i){this._inputBindings[t][e]=i},unlinkInput:function(t,e){delete this._inputBindings[t][e]},disableControls:!1,enableControl:function(){return this.disableControls=!1,this},disableControl:function(){return this.disableControls=!0,this}}),n.c("Multiway",{_speed:null,init:function(){this.requires("Motion, Controllable"),this._dpadName="MultiwayDpad"+this[0],this._speed={x:150,y:150},this._direction={x:0,y:0}},remove:function(){this.disableControls||(this.vx=this.vy=0)},events:{EnterFrame:function(){this.disableControls||(void 0!==this._speed.x&&null!==this._speed.x&&(this.vx=this._speed.x*this._direction.x),void 0!==this._speed.y&&null!==this._speed.y&&(this.vy=this._speed.y*this._direction.y))}},_updateDirection:function(t){this._direction.x=t.x,this._direction.y=t.y},multiway:function(t,e,i){var r=n.s("Controls");return e?this.speed(t):e=t,r.defineDpad(this._dpadName,e,i),this.linkInput("DirectionalInput",this._dpadName,this._updateDirection),this},speed:function(t){return"object"===(void 0===t?"undefined":s(t))?(this._speed.x=t.x,this._speed.y=t.y):(this._speed.x=t,this._speed.y=t),this}}),n.c("Jumper",{_jumpSpeed:300,canJump:!0,init:function(){this.requires("Supportable, Motion, Controllable")},remove:function(){this.unlinkInput("TriggerInputDown",this._jumpTriggerName)},_keydown_jumper:function(t){this.disableControls||this.jump()},jump:function(){var t=this.ground;return this.canJump=!!t,this.trigger("CheckJumping",t),this.canJump&&(this.vy=-this._jumpSpeed),this},jumper:function(t,e){if(e?this._jumpSpeed=t:e=t,this._jumpTriggerName="JumpTrigger"+this[0],Array.isArray(e)){for(var i=[],r=0;r<e.length;++r){var o=e[r],s=n.keys[o]||o;i.push(s)}n.s("Controls").defineTriggerGroup(this._jumpTriggerName,{keys:i})}else n.s("Controls").defineTriggerGroup(this._jumpTriggerName,e);return this.linkInput("TriggerInputDown",this._jumpTriggerName,this._keydown_jumper),this},jumpSpeed:function(t){return this._jumpSpeed=t,this}}),n.c("Fourway",{init:function(){this.requires("Multiway")},fourway:function(t){return this.multiway(t||this._speed,{UP_ARROW:-90,DOWN_ARROW:90,RIGHT_ARROW:0,LEFT_ARROW:180,W:-90,S:90,D:0,A:180,Z:-90,Q:180}),this}}),n.c("Twoway",{init:function(){this.requires("Multiway, Jumper")},twoway:function(t,e){var i=t||this._speed;return this.multiway({x:i},{RIGHT_ARROW:0,LEFT_ARROW:180,D:0,A:180,Q:180}),this.jumper(e||2*t||this._jumpSpeed,[n.keys.UP_ARROW,n.keys.W,n.keys.Z]),this}})},{"../core/core.js":9}],5:[function(t,e,i){var n=t("../core/core.js");n.extend({device:{_deviceOrientationCallback:!1,_deviceMotionCallback:!1,_normalizeDeviceOrientation:function(t){var e;window.DeviceOrientationEvent?e={tiltLR:t.gamma,tiltFB:t.beta,dir:t.alpha,motUD:null}:window.OrientationEvent&&(e={tiltLR:90*t.x,tiltFB:-90*t.y,dir:null,motUD:t.z}),n.device._deviceOrientationCallback(e)},_normalizeDeviceMotion:function(t){var e=t.accelerationIncludingGravity,i=e.z>0?1:-1,r={acceleration:e,rawAcceleration:"["+Math.round(e.x)+", "+Math.round(e.y)+", "+Math.round(e.z)+"]",facingUp:i,tiltLR:Math.round(e.x/9.81*-90),tiltFB:Math.round((e.y+9.81)/9.81*90*i)};n.device._deviceMotionCallback(r)},deviceOrientation:function(t){this._deviceOrientationCallback=t,n.support.deviceorientation&&(window.DeviceOrientationEvent?n.addEvent(this,window,"deviceorientation",this._normalizeDeviceOrientation):window.OrientationEvent&&n.addEvent(this,window,"MozOrientation",this._normalizeDeviceOrientation))},deviceMotion:function(t){this._deviceMotionCallback=t,n.support.devicemotion&&window.DeviceMotionEvent&&n.addEvent(this,window,"devicemotion",this._normalizeDeviceMotion)}}})},{"../core/core.js":9}],6:[function(t,e,i){var n=t("../core/core.js"),r=window.document;n.extend({over:null,mouseObjs:0,mousePos:{},touchObjs:0,lastEvent:null,keydown:{},selected:!1,detectBlur:function(t){var e=t.clientX>n.stage.x&&t.clientX<n.stage.x+n.viewport.width&&t.clientY>n.stage.y&&t.clientY<n.stage.y+n.viewport.height;!n.selected&&e&&n.trigger("CraftyFocus"),n.selected&&!e&&n.trigger("CraftyBlur"),n.selected=e},multitouch:function(t){if("boolean"!=typeof t)return this._touchHandler.multitouch;this._touchHandler.multitouch=t},resetKeyDown:function(){for(var t in n.keys)n.keydown[n.keys[t]]&&this.trigger("KeyUp",{key:n.keys[t]});n.keydown={}},mouseButtonsDown:{},mouseDispatch:function(t){if(n.mouseObjs){n.lastEvent=t;var e,i=t.target?t.target:t.srcElement,r=n.domHelper.translate(t.clientX,t.clientY),o=t.type;void 0===t.which?t.mouseButton=t.button<2?n.mouseButtons.LEFT:4===t.button?n.mouseButtons.MIDDLE:n.mouseButtons.RIGHT:t.mouseButton=t.which<2?n.mouseButtons.LEFT:2===t.which?n.mouseButtons.MIDDLE:n.mouseButtons.RIGHT,n.mousePos.x=r.x,n.mousePos.y=r.y,"mousedown"===o&&(this.mouseButtonsDown[t.mouseButton]=!0),"mouseup"===o&&delete this.mouseButtonsDown[t.mouseButton],e=n.findPointerEventTargetByComponent("Mouse",t,i),e?"mousedown"===o?e.trigger("MouseDown",t):"mouseup"===o?e.trigger("MouseUp",t):"dblclick"===o?e.trigger("DoubleClick",t):"click"===o?e.trigger("Click",t):"mousemove"===o?(e.trigger("MouseMove",t),this.over!==e&&(this.over&&(this.over.trigger("MouseOut",t),this.over=null),this.over=e,e.trigger("MouseOver",t))):e.trigger(o,t):("mousemove"===o&&this.over&&(this.over.trigger("MouseOut",t),this.over=null),"mousedown"===o?n.viewport.mouselook("start",t):"mousemove"===o?n.viewport.mouselook("drag",t):"mouseup"===o&&n.viewport.mouselook("stop"),"mousedown"===o?n.s("Controls").trigger("MouseDown",t):"mouseup"===o?n.s("Controls").trigger("MouseUp",t):"dblclick"===o?n.s("Controls").trigger("DoubleClick",t):"click"===o&&n.s("Controls").trigger("Click",t)),"mousemove"===o&&(this.lastEvent=t)}},touchDispatch:function(t){if(n.touchObjs||n.mouseObjs){if(this._touchHandler.multitouch)switch(t.type){case"touchstart":this._touchHandler.handleStart(t);break;case"touchmove":this._touchHandler.handleMove(t);break;case"touchleave":case"touchcancel":case"touchend":this._touchHandler.handleEnd(t)}else this._touchHandler.mimicMouse(t);t.target&&"INPUT"!==t.target.nodeName&&"TEXTAREA"!==t.target.nodeName&&(t.preventDefault?t.preventDefault():t.returnValue=!1)}},_touchHandler:{fingers:[],multitouch:!1,handleStart:function(t){for(var e=t.changedTouches,i=0,n=e.length;i<n;i++){var r,o=!1,s=t.target?t.target:t.srcElement;r=this.findClosestTouchEntity(e[i],s),r&&(r.trigger("TouchStart",e[i]),o=this.fingerDownIndexByEntity(r));var a=this.setTouch(e[i],r);!1!==o&&o>=0?this.fingers[o]=a:this.fingers.push(a)}},handleMove:function(t){for(var e=t.changedTouches,i=0,n=e.length;i<n;i++){var r=this.fingerDownIndexById(e[i].identifier),o=t.target?t.target:t.srcElement,a=this.findClosestTouchEntity(e[i],o);if(r>=0){var l=this.fingers[r];void 0!==l.entity&&(l.entity===a?l.entity.trigger("TouchMove",e[i]):("object"===(void 0===a?"undefined":s(a))&&a.trigger("TouchStart",e[i]),l.entity.trigger("TouchEnd"))),l.entity=a,l.realX=e[i].realX,l.realY=e[i].realY}}},handleEnd:function(t){for(var e=t.changedTouches,i="touchcancel"===t.type?"TouchCancel":"TouchEnd",n=0,r=e.length;n<r;n++){var o=this.fingerDownIndexById(e[n].identifier);o>=0&&(this.fingers[o].entity&&this.fingers[o].entity.trigger(i),this.fingers.splice(o,1))}},setTouch:function(t,e){return{identifier:t.identifier,realX:t.realX,realY:t.realY,entity:e}},findClosestTouchEntity:function(t,e){return n.findPointerEventTargetByComponent("Touch",t,e)},fingerDownIndexById:function(t){for(var e=0,i=this.fingers.length;e<i;e++){if(this.fingers[e].identifier===t)return e}return-1},fingerDownIndexByEntity:function(t){for(var e=0,i=this.fingers.length;e<i;e++){if(this.fingers[e].entity===t)return e}return-1},mimicMouse:function(t){var e,i,o=n.lastEvent;"touchstart"===t.type?e="mousedown":"touchmove"===t.type?e="mousemove":"touchend"===t.type?e="mouseup":"touchcancel"===t.type?e="mouseup":"touchleave"===t.type&&(e="mouseup"),t.touches&&t.touches.length?i=t.touches[0]:t.changedTouches&&t.changedTouches.length&&(i=t.changedTouches[0]);var s=r.createEvent("MouseEvent");s.initMouseEvent(e,!0,!0,window,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,t.relatedTarget),i.target.dispatchEvent(s),null!==o&&"mousedown"===o.type&&"mouseup"===e&&(e="click",s=r.createEvent("MouseEvent"),s.initMouseEvent(e,!0,!0,window,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,t.relatedTarget),i.target.dispatchEvent(s))}},findPointerEventTargetByComponent:function(t,e,i){var r,o,s,a,l,c,u,h=i||n.stage.elem,p=-1/0,m=e.clientX,f=e.clientY;if("CANVAS"!==h.nodeName){for(;"string"!=typeof h.id&&-1===h.id.indexOf("ent");)h=h.parentNode;var _=n(parseInt(h.id.replace("ent",""),10));c=n.domHelper.translate(m,f,_._drawLayer),_.__c[t]&&_.isAt(c.x,c.y)&&(r=_,u=c)}if(!r)for(var d in n._drawLayers){var y=n._drawLayers[d];if(!(y._pointerEntities<=0))for(c=n.domHelper.translate(m,f,y),s=n.map.search({_x:c.x,_y:c.y,_w:1,_h:1},!1),l=0,a=s.length;l<a;++l)o=s[l],o._visible&&o._drawLayer===y&&o._globalZ>p&&o.__c[t]&&o.isAt(c.x,c.y)&&(p=o._globalZ,r=o,u=c)}return u||(u=n.domHelper.translate(m,f)),e.realX=u.x,e.realY=u.y,r},mouseWheelDispatch:function(t){t.direction=t.detail<0||t.wheelDelta>0?1:-1,n.trigger("MouseWheelScroll",t)},keyboardDispatch:function(t){for(var e=t,i={},r="char charCode keyCode type shiftKey ctrlKey metaKey timestamp".split(" "),o=r.length;o;){var s=r[--o];i[s]=e[s]}if(i.which=null!==e.charCode?e.charCode:e.keyCode,i.key=e.keyCode||e.which,i.originalEvent=e,t=i,"keydown"===t.type?!0!==n.keydown[t.key]&&(n.keydown[t.key]=!0,n.trigger("KeyDown",t)):"keyup"===t.type&&(delete n.keydown[t.key],n.trigger("KeyUp",t)),n.selected&&!(8===t.key||t.key>=112&&t.key<=135))return e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,e.target&&"INPUT"!==e.target.nodeName&&"TEXTAREA"!==e.target.nodeName&&(e.preventDefault?e.preventDefault():e.returnValue=!1),!1}}),n._preBind("Load",function(){n.addEvent(this,"keydown",n.keyboardDispatch),n.addEvent(this,"keyup",n.keyboardDispatch),n.addEvent(this,n.stage.elem,"mousedown",n.mouseDispatch),n.addEvent(this,n.stage.elem,"mouseup",n.mouseDispatch),n.addEvent(this,r.body,"mouseup",n.detectBlur),n.addEvent(this,window,"blur",n.resetKeyDown),n.addEvent(this,n.stage.elem,"mousemove",n.mouseDispatch),n.addEvent(this,n.stage.elem,"click",n.mouseDispatch),n.addEvent(this,n.stage.elem,"dblclick",n.mouseDispatch),n.addEvent(this,n.stage.elem,"touchstart",n.touchDispatch),n.addEvent(this,n.stage.elem,"touchmove",n.touchDispatch),n.addEvent(this,n.stage.elem,"touchend",n.touchDispatch),n.addEvent(this,n.stage.elem,"touchcancel",n.touchDispatch),n.addEvent(this,n.stage.elem,"touchleave",n.touchDispatch),"Moz"===n.support.prefix?n.addEvent(this,n.stage.elem,"DOMMouseScroll",n.mouseWheelDispatch):n.addEvent(this,n.stage.elem,"mousewheel",n.mouseWheelDispatch)}),n._preBind("CraftyStop",function(){n.removeEvent(this,"keydown",n.keyboardDispatch),n.removeEvent(this,"keyup",n.keyboardDispatch),n.stage&&(n.removeEvent(this,n.stage.elem,"mousedown",n.mouseDispatch),n.removeEvent(this,n.stage.elem,"mouseup",n.mouseDispatch),n.removeEvent(this,n.stage.elem,"mousemove",n.mouseDispatch),n.removeEvent(this,n.stage.elem,"click",n.mouseDispatch),n.removeEvent(this,n.stage.elem,"dblclick",n.mouseDispatch),n.removeEvent(this,n.stage.elem,"touchstart",n.touchDispatch),n.removeEvent(this,n.stage.elem,"touchmove",n.touchDispatch),n.removeEvent(this,n.stage.elem,"touchend",n.touchDispatch),n.removeEvent(this,n.stage.elem,"touchcancel",n.touchDispatch),n.removeEvent(this,n.stage.elem,"touchleave",n.touchDispatch),"Moz"===n.support.prefix?n.removeEvent(this,n.stage.elem,"DOMMouseScroll",n.mouseWheelDispatch):n.removeEvent(this,n.stage.elem,"mousewheel",n.mouseWheelDispatch)),n.removeEvent(this,r.body,"mouseup",n.detectBlur),n.removeEvent(this,window,"blur",n.resetKeyDown)}),n.c("Mouse",{init:function(){n.mouseObjs++,this.requires("AreaMap").bind("Remove",function(){n.mouseObjs--})}}),n.c("Touch",{init:function(){n.touchObjs++,this.requires("AreaMap").bind("Remove",function(){n.touchObjs--})}}),n.c("AreaMap",{init:function(){this.has("Renderable")&&this._drawLayer&&this._drawLayer._pointerEntities++},remove:function(){this.has("Renderable")&&this._drawLayer&&this._drawLayer._pointerEntities--},events:{LayerAttached:function(t){t._pointerEntities++},LayerDetached:function(t){t._pointerEntities--}},areaMap:function(t){if(arguments.length>1){var e=Array.prototype.slice.call(arguments,0);t=new n.polygon(e)}else t=t.constructor===Array?new n.polygon(t.slice()):t.clone();return t.shift(this._x,this._y),this.mapArea=t,this.attach(this.mapArea),this.trigger("NewAreaMap",t),this}}),n.c("Button",{init:function(){var t=!n.mobile||n.mobile&&!n.multitouch()?"Mouse":"Touch";this.requires(t)}}),n.c("MouseDrag",{_dragging:!1,init:function(){this.requires("Mouse"),this.bind("MouseDown",this._ondown)},remove:function(){this.unbind("MouseDown",this._ondown)},_ondown:function(t){t.mouseButton===n.mouseButtons.LEFT&&this.startDrag(t)},_ondrag:function(t){if(!this._dragging||0===t.realX||0===t.realY)return!1;this.trigger("Dragging",t)},_onup:function(t){t.mouseButton===n.mouseButtons.LEFT&&this.stopDrag(t)},startDrag:function(t){if(!this._dragging)return this._dragging=!0,n.addEvent(this,n.stage.elem,"mousemove",this._ondrag),n.addEvent(this,n.stage.elem,"mouseup",this._onup),this.trigger("StartDrag",t||n.lastEvent),this},stopDrag:function(t){if(this._dragging)return this._dragging=!1,n.removeEvent(this,n.stage.elem,"mousemove",this._ondrag),n.removeEvent(this,n.stage.elem,"mouseup",this._onup),this.trigger("StopDrag",t||n.lastEvent),this}}),n.c("Keyboard",{isDown:function(t){return"string"==typeof t&&(t=n.keys[t]),!!n.keydown[t]}})},{"../core/core.js":9}],7:[function(t,e,i){t("../core/core.js").extend({keys:{BACKSPACE:8,TAB:9,ENTER:13,PAUSE:19,CAPS:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,INSERT:45,DELETE:46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,NUMPAD_0:96,NUMPAD_1:97,NUMPAD_2:98,NUMPAD_3:99,NUMPAD_4:100,NUMPAD_5:101,NUMPAD_6:102,NUMPAD_7:103,NUMPAD_8:104,NUMPAD_9:105,MULTIPLY:106,ADD:107,SUBSTRACT:109,DECIMAL:110,DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,SHIFT:16,CTRL:17,ALT:18,PLUS:187,COMMA:188,MINUS:189,PERIOD:190,PULT_UP:29460,PULT_DOWN:29461,PULT_LEFT:4,PULT_RIGHT:5},mouseButtons:{LEFT:0,MIDDLE:1,RIGHT:2}})},{"../core/core.js":9}],8:[function(t,e,i){var n=t("../core/core.js"),r=function(t,e){this.timePerFrame=1e3/n.timer.FPS(),this.duration=t,"function"==typeof e?this.easing_function=e:"string"==typeof e&&this.standardEasingFunctions[e]?this.easing_function=this.standardEasingFunctions[e]:this.easing_function=this.standardEasingFunctions.linear,this.reset()};r.prototype={duration:0,clock:0,steps:null,complete:!1,paused:!1,reset:function(){this.loops=1,this.clock=0,this.complete=!1,this.paused=!1},repeat:function(t){this.loops=t},setProgress:function(t,e){this.clock=this.duration*t,void 0!==e&&(this.loops=e)},pause:function(){this.paused=!0},resume:function(){this.paused=!1,this.complete=!1},tick:function(t){if(!this.paused&&!this.complete)for(this.clock+=t,this.frames=Math.floor(this.clock/this.timePerFrame);this.clock>=this.duration&&!1===this.complete;)this.loops--,this.loops>0?this.clock-=this.duration:this.complete=!0},time:function(){return Math.min(this.clock/this.duration,1)},value:function(){return this.easing_function(this.time())},standardEasingFunctions:{linear:function(t){return t},smoothStep:function(t){return(3-2*t)*t*t},smootherStep:function(t){return(6*t*t-15*t+10)*t*t*t},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return t*(2-t)},easeInOutQuad:function(t){return t<.5?2*t*t:(4-2*t)*t-1}}},e.exports=r},{"../core/core.js":9}],9:[function(t,e,i){function n(){var t=l++;return t in h?n():t}function a(t){if(null===t||"object"!==(void 0===t?"undefined":s(t)))return t;var e=t.constructor();for(var i in t)e[i]=a(t[i]);return e}var l,c,u,h,p,m,f,_,d,y=t("./version"),g=function t(e){return new t.fn.init(e)};u={},f=Array.prototype.slice,_=/\s*,\s*/,d=/\s+/;var v=function(){l=1,c=0,h={},p={},m=[]};v(),g.fn=g.prototype={init:function(t){if("string"!=typeof t)return t||(t=0)in h||(h[t]=this),t in h?(this[0]=t,this.length=1,this.__c||(this.__c={}),this._callbacks||g._addCallbackMethods(this),h[t]||(h[t]=this),h[t]):(this.length=0,this);var e,i,n,r,o,s,a,l=0,c=!1,p=!1;if("*"===t){s=0;for(e in h)this[s]=+e,s++;return this.length=s,1===s?h[this[0]]:this}-1!==t.indexOf(",")?(p=!0,n=_):-1!==t.indexOf(" ")&&(c=!0,n=d);for(e in h)if(h.hasOwnProperty(e))if(i=h[e],c||p){for(r=t.split(n),s=0,a=r.length,o=0;s<a;s++)i.__c[r[s]]&&o++;(c&&o===a||p&&o>0)&&(this[l++]=+e)}else i.__c[t]&&(this[l++]=+e);if(l>0&&!c&&!p&&this.extend(u[t]),r&&c)for(s=0;s<a;s++)this.extend(u[r[s]]);return this.length=l,1===l?h[this[l-1]]:(g._addCallbackMethods(this),this)},setName:function(t){var e=String(t);return this._entityName=e,this.trigger("NewEntityName",e),this},getName:function(t){return this._entityName},addComponent:function(t){var e,i,n=0;for(e=1===arguments.length&&-1!==t.indexOf(",")?t.split(_):arguments;n<e.length;n++)if(!0!==this.__c[e[n]]&&(this.__c[e[n]]=!0,i=u[e[n]],this.extend(i),i&&"required"in i&&this.requires(i.required),i&&"init"in i&&i.init.call(this),i&&"events"in i)){var r=i.events;for(var o in r){var s="function"==typeof r[o]?r[o]:i[r[o]];this.bind(o,s)}}return this.trigger("NewComponent",e),this},toggleComponent:function(t){var e,i,n=0;if(arguments.length>1)for(e=arguments.length;n<e;n++)this.has(arguments[n])?this.removeComponent(arguments[n]):this.addComponent(arguments[n]);else if(-1!==t.indexOf(","))for(i=t.split(_),e=i.length;n<e;n++)this.has(i[n])?this.removeComponent(i[n]):this.addComponent(i[n]);else this.has(t)?this.removeComponent(t):this.addComponent(t);return this},requires:function(t){return this.addComponent(t)},removeComponent:function(t,e){var i=u[t];if(this.trigger("RemoveComponent",t),i&&"events"in i){var n=i.events;for(var r in n){var o="function"==typeof n[r]?n[r]:i[n[r]];this.unbind(r,o)}}if(i&&"remove"in i&&i.remove.call(this,!1),!1===e&&i)for(var s in i)delete this[s];return delete this.__c[t],this},getId:function(){return this[0]},has:function(t){return!!this.__c[t]},attr:function(t,e,i,n){return 1===arguments.length&&"string"==typeof arguments[0]?this._attr_get(t):this._attr_set(t,e,i,n)},_attr_get:function(t,e){var i,n;return void 0!==e&&null!==e||(e=this),t.indexOf(".")>-1?(n=t.split("."),i=n.shift(),n.join("."),this._attr_get(n.join("."),e[i])):e[t]},_attr_set:function(){var t,e,i;return"string"==typeof arguments[0]?(t=this._set_create_object(arguments[0],arguments[1]),e=!!arguments[2],i=arguments[3]||arguments[0].indexOf(".")>-1):(t=arguments[0],e=!!arguments[1],i=!!arguments[2]),e||this.trigger("Change",t),i?this._recursive_extend(t,this):this.extend.call(this,t),this},_set_create_object:function(t,e){var i,n,r,o={};return t.indexOf(".")>-1?(i=t.split("."),n=i.shift(),r=i.join("."),o[n]=this._set_create_object(r,e)):o[t]=e,o},_recursive_extend:function(t,e){var i;for(i in t)t[i].constructor===Object?e[i]=this._recursive_extend(t[i],e[i]):e[i]=t[i];return e},toArray:function(){return f.call(this,0)},timeout:function(t,e){return this.each(function(){var i=this;setTimeout(function(){t.call(i)},e)}),this},bind:function(t,e){if(1===this.length)this._bindCallback(t,e);else for(var i=0;i<this.length;i++){var n=h[this[i]];n&&n._bindCallback(t,e)}return this},uniqueBind:function(t,e){this.unbind(t,e),this.bind(t,e)},one:function(t,e){var i=this,n=function n(r){e.call(i,r),i.unbind(t,n)};return i.bind(t,n)},unbind:function(t,e){var i,n;for(i=0;i<this.length;i++)(n=h[this[i]])&&n._unbindCallbacks(t,e);return this},trigger:function(t,e){if(1===this.length)this._runCallbacks(t,e);else for(var i=0;i<this.length;i++){var n=h[this[i]];n&&n._runCallbacks(t,e)}return this},each:function(t){for(var e=0,i=this.length;e<i;e++)h[this[e]]&&t.call(h[this[e]],e);return this},get:function(t){var e=this.length;if(void 0!==t){if(t>=e||t+e<0)return;return t>=0?h[this[t]]:h[this[t+e]]}for(var i=0,n=[];i<e;i++)h[this[i]]&&n.push(h[this[i]]);return n},clone:function(){var t,e,i=this.__c,n=g.e();for(t in i)n.addComponent(t);for(e in this)"0"!==e&&"_global"!==e&&"_changed"!==e&&"function"!=typeof this[e]&&"object"!==s(this[e])&&(n[e]=this[e]);return n},setter:function(t,e){return this.defineField(t,function(){},e)},defineField:function(t,e,i){return g.defineField(this,t,e,i),this},destroy:function(){this.each(function(){var t;this.trigger("Remove");for(var e in this.__c)(t=u[e])&&"remove"in t&&t.remove.call(this,!0);this._unbindAll(),delete h[this[0]]})}},g.fn.init.prototype=g.fn,g.extend=g.fn.extend=function(t){var e,i=this;if(!t)return i;for(e in t)i!==t[e]&&(i[e]=t[e]);return i},g._callbackMethods={_bindCallback:function(t,e){var i=this._callbacks[t];i||(i=this._callbacks[t]=(p[t]||(p[t]={}))[this[0]]=[],i.context=this,i.depth=0),i.push(e)},_runCallbacks:function(t,e){if(this._callbacks[t]){var i,n=this._callbacks[t],r=n.length;for(n.depth++,i=0;i<r;i++)void 0===n[i]?n.depth<=1&&(n.splice(i,1),i--,r--,0===n.length&&(delete this._callbacks[t],delete p[t][this[0]])):n[i].call(this,e);n.depth--}},_unbindCallbacks:function(t,e){if(this._callbacks[t])for(var i=this._callbacks[t],n=0;n<i.length;n++)e&&i[n]!==e||delete i[n]},_unbindAll:function(){if(this._callbacks)for(var t in this._callbacks)this._callbacks[t]&&(this._unbindCallbacks(t),delete p[t][this[0]])}},g._addCallbackMethods=function(t){t.extend(g._callbackMethods),t._callbacks={}},g._addCallbackMethods(g),g.extend({0:"global",init:function(t,e,i){if(!this._preBindDone)for(var n=0;n<this._bindOnInit.length;n++){var r=this._bindOnInit[n];g.bind(r.event,r.handler)}return g.viewport.init(t,e,i),this.trigger("Load"),this.timer.init(),this},_bindOnInit:[],_preBindDone:!1,_preBind:function(t,e){this._bindOnInit.push({event:t,handler:e})},getVersion:function(){return y},stop:function(t){if(g.trigger("CraftyStop",t),this.timer.stop(),t){g.audio.remove();for(var e in g._systems)g._systems[e].destroy();if(g.stage&&g.stage.elem.parentNode){var i=document.createElement("div");i.id=g.stage.elem.id,g.stage.elem.parentNode.replaceChild(i,g.stage.elem)}g._unbindAll(),g._addCallbackMethods(g),this._preBindDone=!1,v()}return this},pause:function(t){return(1===arguments.length?t:!this._paused)?(this.trigger("Pause"),this._paused=!0,setTimeout(function(){g.timer.stop()},0),g.keydown={}):(this.trigger("Unpause"),this._paused=!1,setTimeout(function(){g.timer.init()},0)),this},isPaused:function(){return this._paused},timer:function(){var t,e,i,n="fixed",r=5,o=40,s=0,a=0,l=50,u=1e3/l;return{init:function(){void 0===i&&(i=(new Date).getTime()-u);var n="undefined"!=typeof window&&(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||null);n?(t=function(){g.timer.step(),null!==t&&(e=n(t))})():t=setInterval(function(){g.timer.step()},1e3/l)},stop:function(){g.trigger("CraftyStopTimer"),"function"!=typeof t&&clearInterval(t);var i="undefined"!=typeof window&&(window.cancelAnimationFrame||window.cancelRequestAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||null);i&&i(e),t=null},steptype:function(t,e){if("variable"===t||"semifixed"===t)n=t,e&&(o=e),g.trigger("NewSteptype",{mode:n,maxTimeStep:o});else{if("fixed"!==t){if(void 0!==t)throw"Invalid step type specified";return{mode:n,maxTimeStep:"variable"===n||"semifixed"===n?o:r}}n="fixed",e&&(r=e),g.trigger("NewSteptype",{mode:n,maxTimeStep:r})}},step:function(){var t,e,l,h=0,p=(new Date).getTime();if(s>0&&g.trigger("MeasureWaitTime",p-s),i+a>=p)return void(s=p);var m=p-(i+a);m>20*u&&(a+=m-u,m=u),"fixed"===n?(h=Math.ceil(m/u),h=Math.min(h,r),e=u):"variable"===n?(h=1,e=m,e=Math.min(e,o)):"semifixed"===n&&(h=Math.ceil(m/o),e=m/h);for(var f=0;f<h;f++){l=p;var _={frame:c++,dt:e,gameTime:i};g.trigger("EnterFrameInput",_),g.trigger("EnterFrame",_),g.trigger("ExitFrame",_),i+=e,p=(new Date).getTime(),g.trigger("MeasureFrameTime",p-l)}h>0&&(t=p,g.trigger("PreRender"),g.trigger("RenderScene"),g.trigger("PostRender"),p=(new Date).getTime(),g.trigger("MeasureRenderTime",p-t)),s=p},FPS:function(t){if(void 0===t)return l;l=t,u=1e3/l,g.trigger("FPSChange",t)},simulateFrames:function(t,e){for(e=e||u;t-- >0;){var i={frame:c++,dt:e};g.trigger("EnterFrameInput",i),g.trigger("EnterFrame",i),g.trigger("ExitFrame",i)}g.trigger("PreRender"),g.trigger("RenderScene"),g.trigger("PostRender")}}}(),e:function(){var t=n();return h[t]=null,h[t]=g(t),arguments.length>0&&h[t].addComponent.apply(h[t],arguments),h[t].setName("Entity #"+t),h[t].addComponent("obj"),g.trigger("NewEntity",{id:t}),h[t]},c:function(t,e){u[t]=e},trigger:function(t,e){var i,n,r=p[t]||(p[t]={});for(i in r)r.hasOwnProperty(i)&&(n=r[i])&&0!==n.length&&n.context._runCallbacks(t,e)},bind:function(t,e){return this._bindCallback(t,e),e},uniqueBind:function(t,e){return this.unbind(t,e),this.bind(t,e)},one:function(t,e){var i=this,n=function n(r){e.call(i,r),i.unbind(t,n)};return i.bind(t,n)},unbind:function(t,e){this._unbindCallbacks(t,e)},frame:function(){return c},components:function(){return u},isComp:function(t){return t in u},debug:function(t){return"handlers"===t?p:h},settings:function(){var t={},e={};return{register:function(t,i){e[t]=i},modify:function(i,n){e[i]&&(e[i].call(t[i],n),t[i]=n)},get:function(e){return t[e]}}}(),defineField:function(t,e,i,n){Object.defineProperty(t,e,{get:i,set:n,configurable:!1,enumerable:!0})},clone:a}),r=[],void 0!==(o=function(){return g}.apply(i,r))&&(e.exports=o),e.exports=g},{"./version":18}],10:[function(t,e,i){(function(i){var n=t("../core/core.js"),r="undefined"!=typeof window&&window.document;!function(){var t=n.support={},e="undefined"!=typeof navigator&&navigator.userAgent.toLowerCase()||void 0!==i&&i.version,o=/(webkit)[ \/]([\w.]+)/.exec(e)||/(o)pera(?:.*version)?[ \/]([\w.]+)/.exec(e)||/(ms)ie ([\w.]+)/.exec(e)||/(moz)illa(?:.*? rv:([\w.]+))?/.exec(e)||/(v)\d+\.(\d+)/.exec(e)||[],s=/iPad|iPod|iPhone|Android|webOS|IEMobile/i.exec(e);if(s&&(n.mobile=s[0]),t.defineProperty=function(){if(!("defineProperty"in Object))return!1;try{Object.defineProperty({},"x",{})}catch(t){return!1}return!0}(),t.audio="undefined"!=typeof window&&"canPlayType"in r.createElement("audio"),t.prefix=o[1]||o[0],"moz"===t.prefix&&(t.prefix="Moz"),"o"===t.prefix&&(t.prefix="O"),"v"===t.prefix&&(t.prefix="node"),o[2]&&(t.versionName=o[2],t.version=+o[2].split(".")[0]),t.canvas="undefined"!=typeof window&&"getContext"in r.createElement("canvas"),t.canvas){var a;try{var l=r.createElement("canvas");a=l.getContext("webgl")||l.getContext("experimental-webgl"),a.viewportWidth=t.canvas.width,a.viewportHeight=t.canvas.height}catch(t){}t.webgl=!!a}else t.webgl=!1;t.css3dtransform="undefined"!=typeof window&&(void 0!==r.createElement("div").style.Perspective||void 0!==r.createElement("div").style[t.prefix+"Perspective"]),t.deviceorientation="undefined"!=typeof window&&(void 0!==window.DeviceOrientationEvent||void 0!==window.OrientationEvent),t.devicemotion="undefined"!=typeof window&&void 0!==window.DeviceMotionEvent}(),e.exports={_events:{},addEvent:function(t,e,i,n){3===arguments.length&&(n=i,i=e,e=window.document);var r=function(e){n.call(t,e)},o=t[0]||"";this._events[o+e+i+n]||(this._events[o+e+i+n]=r,e.addEventListener(i,r,!1))},removeEvent:function(t,e,i,n){3===arguments.length&&(n=i,i=e,e=window.document);var r=t[0]||"",o=this._events[r+e+i+n];o&&(e.removeEventListener(i,o,!1),delete this._events[r+e+i+n])},background:function(t){n.stage.elem.style.background=t}}}).call(this,t("_process"))},{"../core/core.js":9,_process:1}],11:[function(t,e,i){var n=t("../core/core.js");e.exports={assets:{},__paths:{audio:"",images:""},paths:function(t){if(void 0===t)return this.__paths;t.audio&&(this.__paths.audio=t.audio),t.images&&(this.__paths.images=t.images)},asset:function(t,e){return 1===arguments.length?n.assets[t]:n.assets[t]?void 0:(n.assets[t]=e,this.trigger("NewAsset",{key:t,value:e}),e)},imageWhitelist:["jpg","jpeg","gif","png","svg"],load:function(t,e,i,r){function o(){var t=this.src;this.removeEventListener&&this.removeEventListener("canplaythrough",o,!1),m++,i&&i({loaded:m,total:f,percent:m/f*100,src:t}),m===f&&e&&e()}function a(){var t=this.src;r&&r({loaded:m,total:f,percent:m/f*100,src:t}),++m===f&&e&&e()}if(Array.isArray(t))return void n.log("Calling Crafty.load with an array of assets no longer works; see the docs for more details.");t="string"==typeof t?JSON.parse(t):t;var l,c,u,h,p,m=0,f=(t.audio?Object.keys(t.audio).length:0)+(t.images?Object.keys(t.images).length:0)+(t.sprites?Object.keys(t.sprites).length:0),_=n.paths(),d=function(t){return t.substr(t.lastIndexOf(".")+1).toLowerCase()},y=function(t,e){return-1===e.search("://")?"audio"===t?_.audio+e:_.images+e:e},g=function(t){return n.asset(t)||null},v=function(t){return n.support.audio&&n.audio.supports(d(t))};for(h in t)for(p in t[h])if(t[h].hasOwnProperty(p)){if(l=t[h][p],u=null,"audio"===h){if("object"===(void 0===l?"undefined":s(l))){var x=[];for(var b in l)c=y(h,l[b]),g(c)||!v(l[b])||n.audio.sounds[p]||x.push(c);x.length>0&&(u=n.audio.add(p,x))}else"string"==typeof l&&(c=y(h,l),g(c)||!v(l)||n.audio.sounds[p]||(u=n.audio.add(p,c)));u&&(u=u.obj),u&&u.addEventListener&&u.addEventListener("canplaythrough",o,!1)}else p="sprites"===h?p:l,c=y(h,p),!g(c)&&function(t){return-1!==n.imageWhitelist.indexOf(d(t))}(p)&&(u=new Image,"sprites"===h&&n.sprite(l.tile,l.tileh,c,l.map,l.paddingX,l.paddingY,l.paddingAroundBorder),n.asset(c,u),function(t,e){t.onload=o,"webkit"===n.support.prefix&&(t.src=""),t.src=e}(u,c));u?u.onerror=a:a.call({src:c})}0===f&&e&&e()},removeAssets:function(t){t="string"==typeof t?JSON.parse(t):t;var e,i,r,o,a=n.paths(),l=function(t,e){return-1===e.search("://")?"audio"===t?a.audio+e:a.images+e:e};for(r in t)for(o in t[r])if(t[r].hasOwnProperty(o))if(e=t[r][o],"audio"===r)if("object"===(void 0===e?"undefined":s(e)))for(var c in e)i=l(r,e[c]),n.asset(i)&&n.audio.remove(o);else"string"==typeof e&&(i=l(r,e),n.asset(i)&&n.audio.remove(o));else if(o="sprites"===r?o:e,i=l(r,o),n.asset(i)){if("sprites"===r)for(var u in e.map)delete n.components()[u];delete n.assets[i]}}}},{"../core/core.js":9}],12:[function(t,e,i){var n=t("../core/core.js");e.exports={init:function(){this.changed=[],this.bind("Change",this._changed_attributes),this.bind("Change",this._changed_triggers)},_changed_triggers:function(t,e){var i;e=n.extend.call({pre:""},e);for(i in t)this.trigger("Change["+e.pre+i+"]",t[i]),t[i].constructor===Object&&this._changed_triggers(t[i],{pre:e.pre+i+"."})},_changed_attributes:function(t){var e;for(e in t)this.changed.push(e);return this},is_dirty:function(t){return 0===arguments.length?!!this.changed.length:this.changed.indexOf(t)>-1}}},{"../core/core.js":9}],13:[function(t,e,i){var n=t("../core/core.js");e.exports={_scenes:{},_current:null,scene:function(t,e,i){if(1===arguments.length||"function"!=typeof arguments[1])return void n.enterScene(t,arguments[1]);n.defineScene(t,e,i)},defineScene:function(t,e,i){if("function"!=typeof e)throw"Init function is the wrong type.";this._scenes[t]={},this._scenes[t].initialize=e,void 0!==i&&(this._scenes[t].uninitialize=i)},enterScene:function(t,e){if("function"==typeof e)throw"Scene data cannot be a function";n.trigger("SceneDestroy",{newScene:t}),n.viewport.reset(),n("2D").each(function(){this.has("Persist")||this.destroy()}),null!==this._current&&"uninitialize"in this._scenes[this._current]&&this._scenes[this._current].uninitialize.call(this);var i=this._current;this._current=t,n.trigger("SceneChange",{oldScene:i,newScene:t}),this._scenes.hasOwnProperty(t)?this._scenes[t].initialize.call(this,e):n.error('The scene "'+t+'" does not exist')}}},{"../core/core.js":9}],14:[function(t,e,i){var n=t("../core/core.js");try{var r="undefined"!=typeof window&&window.localStorage||new t("node-localstorage").LocalStorage("./localStorage")}catch(t){var r=null}var o=function(t,e){var i=e;if(!r)return n.error("Local storage is not accessible.  (Perhaps you are including crafty.js cross-domain?)"),!1;if(1===arguments.length)try{return JSON.parse(r.getItem(t))}catch(e){return r.getItem(t)}else"object"===(void 0===e?"undefined":s(e))&&(i=JSON.stringify(e)),r.setItem(t,i)};o.remove=function(t){if(!r)return void n.error("Local storage is not accessible.  (Perhaps you are including crafty.js cross-domain?)");r.removeItem(t)},e.exports=o},{"../core/core.js":9}],15:[function(t,e,i){function n(t,e){var i={};for(var n in e)i[n]=e[n];for(n in t)n in e||(i[n]=t[n]);return i}var r=t("../core/core.js");r._systems={},r.s=function(t,e,i,n){if(!e)return r._systems[t];"boolean"==typeof i&&(n=i,i=null),!1===n?(r._systems[t]=new r.CraftySystem(t,e,i),r.trigger("SystemLoaded",t)):r._registerLazySystem(t,e,i)},r._registerLazySystem=function(t,e,i){Object.defineProperty(r._systems,t,{get:function(){return Object.defineProperty(r._systems,t,{value:new r.CraftySystem(t,e,i),writable:!0,enumerable:!0,configurable:!0}),r.trigger("SystemLoaded",t),r._systems[t]},configurable:!0})},r.CraftySystem=function(){var t=1;return function(e,i,o){if(this.name=e,!i)return this;if(this._systemTemplate=i,this.extend(i),this.options=n(this.options,o),r._addCallbackMethods(this),this[0]="system"+t++,"function"==typeof this.init&&this.init(e),"events"in i){var s=i.events;for(var a in s){var l="function"==typeof s[a]?s[a]:i[s[a]];this.bind(a,l)}}}}(),r.CraftySystem.prototype={extend:function(t){for(var e in t)void 0===this[e]&&(this[e]=t[e])},bind:function(t,e){return this._bindCallback(t,e),this},trigger:function(t,e){return this._runCallbacks(t,e),this},unbind:function(t,e){return this._unbindCallbacks(t,e),this},one:function(t,e){var i=this,n=function n(r){e.call(i,r),i.unbind(t,n)};return i.bind(t,n)},uniqueBind:function(t,e){return this.unbind(t,e),this.bind(t,e)},destroy:function(){r.trigger("SystemDestroyed",this),"function"==typeof this.remove&&this.remove(),this._unbindAll(),delete r._systems[this.name]}}},{"../core/core.js":9}],16:[function(t,e,i){e.exports={init:function(){this._delays=[],this._delaysPaused=!1,this.bind("EnterFrame",function(t){if(!this._delaysPaused)for(var e=this._delays.length;--e>=0;){var i=this._delays[e];if(!1===i)this._delays.splice(e,1);else{for(i.accumulator+=t.dt;i.accumulator>=i.delay&&i.repeat>=0;)i.accumulator-=i.delay,i.repeat--,i.callback.call(this);i.repeat<0&&(this._delays.splice(e,1),"function"==typeof i.callbackOff&&i.callbackOff.call(this))}}})},delay:function(t,e,i,n){return this._delays.push({accumulator:0,callback:t,callbackOff:n,delay:e,repeat:(i<0?1/0:i)||0}),this},cancelDelay:function(t){for(var e=this._delays.length;--e>=0;){var i=this._delays[e];i&&i.callback===t&&(this._delays[e]=!1)}return this},pauseDelays:function(){this._delaysPaused=!0},resumeDelays:function(){this._delaysPaused=!1}}},{}],17:[function(t,e,i){var n=t("../core/core.js");e.exports={init:function(){this.tweenGroup={},this.tweenStart={},this.tweens=[],this.uniqueBind("EnterFrame",this._tweenTick)},_tweenTick:function(t){var e,i,n;for(n=this.tweens.length-1;n>=0;n--)e=this.tweens[n],e.easing.tick(t.dt),i=e.easing.value(),this._doTween(e.props,i),e.easing.complete&&(this.tweens.splice(n,1),this._endTween(e.props))},_doTween:function(t,e){for(var i in t)this[i]=(1-e)*this.tweenStart[i]+e*t[i]},tween:function(t,e,i){var r={props:t,easing:new n.easing(e,i)};for(var o in t)void 0!==this.tweenGroup[o]&&this.cancelTween(o),this.tweenStart[o]=this[o],this.tweenGroup[o]=t;return this.tweens.push(r),this},cancelTween:function(t){if("string"==typeof t)"object"===s(this.tweenGroup[t])&&delete this.tweenGroup[t][t];else if("object"===(void 0===t?"undefined":s(t)))for(var e in t)this.cancelTween(e);return this},pauseTweens:function(){this.tweens.map(function(t){t.easing.pause()})},resumeTweens:function(){this.tweens.map(function(t){t.easing.resume()})},_endTween:function(t){for(var e in t)delete this.tweenGroup[e];this.trigger("TweenEnd",t)}}},{"../core/core.js":9}],18:[function(t,e,i){e.exports="0.8.0"},{}],19:[function(t,e,i){var n=t("./core/core");n.easing=t("./core/animation"),n.extend(t("./core/extensions")),n.extend(t("./core/loader")),n.c("Model",t("./core/model")),n.extend(t("./core/scenes")),n.storage=t("./core/storage"),n.c("Delay",t("./core/time")),n.c("Tween",t("./core/tween")),t("./core/systems"),t("./spatial/2d"),t("./spatial/motion"),t("./spatial/platform"),t("./spatial/collision"),t("./spatial/spatial-grid"),t("./spatial/rect-manager"),t("./spatial/math"),t("./graphics/layers"),t("./graphics/canvas"),t("./graphics/canvas-layer"),t("./graphics/webgl"),t("./graphics/webgl-layer"),t("./graphics/color"),t("./graphics/dom"),t("./graphics/dom-helper"),t("./graphics/dom-layer"),t("./graphics/drawing"),t("./graphics/gl-textures"),t("./graphics/renderable"),t("./graphics/html"),t("./graphics/image"),t("./graphics/particles"),t("./graphics/sprite-animation"),t("./graphics/sprite"),t("./graphics/text"),t("./graphics/viewport"),t("./isometric/diamond-iso"),t("./isometric/isometric"),t("./controls/inputs"),t("./controls/controls-system"),t("./controls/controls"),t("./controls/device"),t("./controls/keycodes"),t("./sound/sound"),t("./debug/debug-layer"),t("./debug/logging"),t("./aliases").defineAliases(n),window&&(window.Crafty=n),e.exports=n},{"./aliases":2,"./controls/controls":4,"./controls/controls-system":3,"./controls/device":5,"./controls/inputs":6,"./controls/keycodes":7,"./core/animation":8,"./core/core":9,"./core/extensions":10,"./core/loader":11,"./core/model":12,"./core/scenes":13,"./core/storage":14,"./core/systems":15,"./core/time":16,"./core/tween":17,"./debug/debug-layer":20,"./debug/logging":21,"./graphics/canvas":23,"./graphics/canvas-layer":22,"./graphics/color":24,"./graphics/dom":27,"./graphics/dom-helper":25,"./graphics/dom-layer":26,"./graphics/drawing":28,"./graphics/gl-textures":29,"./graphics/html":30,"./graphics/image":31,"./graphics/layers":32,"./graphics/particles":33,"./graphics/renderable":34,"./graphics/sprite":36,"./graphics/sprite-animation":35,"./graphics/text":37,"./graphics/viewport":38,"./graphics/webgl":40,"./graphics/webgl-layer":39,"./isometric/diamond-iso":41,"./isometric/isometric":42,"./sound/sound":43,"./spatial/2d":44,"./spatial/collision":45,"./spatial/math":46,"./spatial/motion":47,"./spatial/platform":48,"./spatial/rect-manager":49,"./spatial/spatial-grid":50}],20:[function(t,e,i){var n=t("../core/core.js"),r=window.document;n.c("DebugCanvas",{init:function(){this.requires("2D"),n.DebugCanvas.context||n.DebugCanvas.init(),n.DebugCanvas.add(this),this._debug={alpha:1,lineWidth:1},this.bind("RemoveComponent",this.onDebugRemove),this.bind("Remove",this.onDebugDestroy)},onDebugRemove:function(t){"DebugCanvas"===t&&n.DebugCanvas.remove(this)},onDebugDestroy:function(t){n.DebugCanvas.remove(this)},debugAlpha:function(t){return this._debug.alpha=t,this},debugFill:function(t){return void 0===t&&(t="red"),this._debug.fillStyle=t,this},debugStroke:function(t){return void 0===t&&(t="red"),this._debug.strokeStyle=t,this},debugDraw:function(t){var e=t.globalAlpha,i=this._debug;i.alpha&&(t.globalAlpha=this._debug.alpha),i.strokeStyle&&(t.strokeStyle=i.strokeStyle),i.lineWidth&&(t.lineWidth=i.lineWidth),i.fillStyle&&(t.fillStyle=i.fillStyle),this.trigger("DebugDraw",t),t.globalAlpha=e}}),n.c("DebugRectangle",{init:function(){this.requires("2D, DebugCanvas")},debugRectangle:function(t){return this.debugRect=t,this.unbind("DebugDraw",this.drawDebugRect),this.bind("DebugDraw",this.drawDebugRect),this},drawDebugRect:function(t){var e=this.debugRect;null!==e&&void 0!==e&&e._h&&e._w&&(this._debug.fillStyle&&t.fillRect(e._x,e._y,e._w,e._h),this._debug.strokeStyle&&t.strokeRect(e._x,e._y,e._w,e._h))}}),n.c("VisibleMBR",{init:function(){this.requires("DebugRectangle").debugFill("purple").bind("EnterFrame",this._assignRect)},_assignRect:function(){this._mbr?this.debugRectangle(this._mbr):this.debugRectangle(this)}}),n.c("DebugPolygon",{init:function(){this.requires("2D, DebugCanvas")},debugPolygon:function(t){return this.polygon=t,this.unbind("DebugDraw",this.drawDebugPolygon),this.bind("DebugDraw",this.drawDebugPolygon),this},drawDebugPolygon:function(t){if(void 0!==this.polygon){t.beginPath();for(var e=this.polygon.points,i=e.length,n=0;n<i;n+=2)t.lineTo(e[n],e[n+1]);t.closePath(),this._debug.fillStyle&&t.fill(),this._debug.strokeStyle&&t.stroke()}}}),n.c("WiredHitBox",{init:function(){this.requires("DebugPolygon").debugStroke("red").matchHitBox(),this.bind("NewHitbox",this.matchHitBox)},matchHitBox:function(){this.debugPolygon(this.map)}}),n.c("SolidHitBox",{init:function(){this.requires("Collision, DebugPolygon").debugFill("orange").debugAlpha(.7).matchHitBox(),this.bind("NewHitbox",this.matchHitBox)},matchHitBox:function(){this.debugPolygon(this.map)}}),n.c("WiredAreaMap",{init:function(){this.requires("DebugPolygon").debugStroke("green").matchAreaMap(),this.bind("NewAreaMap",this.matchAreaMap)},matchAreaMap:function(){this.debugPolygon(this.mapArea)}}),n.c("SolidAreaMap",{init:function(){this.requires("DebugPolygon").debugFill("lime").debugAlpha(.7).matchAreaMap(),this.bind("NewAreaMap",this.matchAreaMap)},matchAreaMap:function(){this.debugPolygon(this.mapArea)}}),n.DebugCanvas={context:null,entities:[],onetimeEntities:[],add:function(t){this.entities.push(t)},remove:function(t){for(var e=this.entities,i=e.length-1;i>=0;i--)e[i]===t&&e.splice(i,1)},init:function(){if(!n.DebugCanvas.context){if(!n.support.canvas)return n.trigger("NoCanvas"),void n.stop();var t;t=r.createElement("canvas"),t.width=n.viewport.width,t.height=n.viewport.height,t.style.position="absolute",t.style.left="0px",t.style.top="0px",t.id="debug-canvas",t.style.zIndex=1e5,n.stage.elem.appendChild(t),n.DebugCanvas.context=t.getContext("2d"),n.DebugCanvas._canvas=t}n.unbind("RenderScene",n.DebugCanvas.renderScene),n.bind("RenderScene",n.DebugCanvas.renderScene)},renderScene:function(t){t=t||n.viewport.rect();var e,i=n.DebugCanvas.entities,r=0,o=i.length,s=n.DebugCanvas.context,a=n.viewport;s.setTransform(a._scale,0,0,a._scale,Math.round(a._x*a._scale),Math.round(a._y*a._scale)),s.clearRect(t._x,t._y,t._w,t._h);for(var l=null;r<o;r++)e=i[r],l!==e._drawlayer&&(a=e._drawLayer._viewportRect(),s.setTransform(a._scale,0,0,a._scale,Math.round(-a._x*a._scale),Math.round(-a._y*a._scale)),l=e._drawLayer),e.debugDraw(s)}}},{"../core/core.js":9}],21:[function(t,e,i){var n=t("../core/core.js");n.extend({loggingEnabled:!0,log:function(){n.loggingEnabled&&("undefined"!=typeof window?window.console:console)&&console.log&&console.log.apply(console,arguments)},error:function(){n.loggingEnabled&&("undefined"!=typeof window?window.console:console)&&console.error&&console.error.apply(console,arguments)}})},{"../core/core.js":9}],22:[function(t,e,i){var n=t("../core/core.js");n._registerLayerTemplate("Canvas",{type:"Canvas",options:{xResponse:1,yResponse:1,scaleResponse:1,z:0},_dirtyRects:[],_changedObjs:[],layerCount:0,_dirtyViewport:!1,_sort:function(t,e){return t._globalZ-e._globalZ},dirty:function(t){this._changedObjs.push(t)},attach:function(t){t._drawContext=this.context,this.layerCount++},detach:function(t){this.dirty(t),t._drawContext=null,this.layerCount--},context:null,_canvas:null,init:function(){if(!n.support.canvas)return n.trigger("NoCanvas"),void n.stop();this._dirtyRects=[],this._changedObjs=[];var t;t=document.createElement("canvas"),t.width=n.viewport.width,t.height=n.viewport.height,t.style.position="absolute",t.style.left="0px",t.style.top="0px",t.style.zIndex=this.options.z,n.stage.elem.appendChild(t),this.context=t.getContext("2d"),this._canvas=t;var e=n.viewport._scale;1!==e&&this.context.scale(e,e),this._setPixelart(n._pixelartEnabled),this.uniqueBind("PixelartSet",this._setPixelart),this.uniqueBind("RenderScene",this._render),this.uniqueBind("ViewportResize",this._resize),this.bind("InvalidateViewport",function(){this._dirtyViewport=!0}),n._addDrawLayerInstance(this)},remove:function(){this._canvas.parentNode.removeChild(this._canvas),n._removeDrawLayerInstance(this)},_render:function(){var t=this._dirtyViewport,e=this._changedObjs.length,i=this.context;if(e||t){var n=this.options;if(t&&n){var r=this._viewportRect(),o=r._scale,s=-r._x*o,a=-r._y*o;i.setTransform(o,0,0,o,Math.round(s),Math.round(a))}e/this.layerCount>.6||t?this._drawAll():this._drawDirty(),this._clean()}},_drawDirty:function(t){t=t||this._viewportRect();var e,i,r,o,s,a,l=this._changedObjs,c=l.length,u=this._dirtyRects,h=n.rectManager,p=h.overlap,m=this.context,f=[],_=[];for(t=h.integerBounds(t),e=0;e<c;e++)this._createDirty(l[e]);for(h.mergeSet(u),c=u.length,e=0;e<c;++e)if(o=u[e],f.length=0,_.length=0,o&&(o=h.integerBounds(o),p(o,t))){for(r=n.map.search(o,!1),m.clearRect(o._x,o._y,o._w,o._h),m.save(),m.beginPath(),m.rect(o._x,o._y,o._w,o._h),m.clip(),i=0,s=r.length;i<s;++i)a=r[i],!f[a[0]]&&a._visible&&a._drawLayer===this&&(f[a[0]]=!0,_.push(a));for(_.sort(this._sort),i=0,s=_.length;i<s;++i){a=_[i];var d=a._mbr||a;p(d,o)&&a.draw(),a._changed=!1}m.closePath(),m.restore()}if(!0===this.debugDirty)for(m.strokeStyle="red",e=0,c=u.length;e<c;++e)o=u[e],m.strokeRect(o._x,o._y,o._w,o._h)},_drawAll:function(t){t=t||this._viewportRect(),t=n.rectManager.integerBounds(t);var e,i=n.map.search(t),r=0,o=i.length,s=this.context;for(s.clearRect(t._x,t._y,t._w,t._h),i.sort(this._sort);r<o;r++)e=i[r],e._visible&&e._drawContext===this.context&&(e.draw(this.context),e._changed=!1)},debug:function(){n.log(this._changedObjs)},_clean:function(){var t,e,i,n,r=this._changedObjs;for(i=0,n=r.length;i<n;i++)e=r[i],t=e._mbr||e,void 0===e.staleRect&&(e.staleRect={}),e.staleRect._x=t._x,e.staleRect._y=t._y,e.staleRect._w=t._w,e.staleRect._h=t._h,e._changed=!1;r.length=0,this._dirtyRects.length=0,this._dirtyViewport=!1},_createDirty:function(t){var e=t._mbr||t,i=this._dirtyRects,r=n.rectManager;if(t.staleRect){if(r.overlap(t.staleRect,e))return r.merge(t.staleRect,e,t.staleRect),void i.push(t.staleRect);i.push(t.staleRect)}t.currentRect._x=e._x,t.currentRect._y=e._y,t.currentRect._w=e._w,t.currentRect._h=e._h,i.push(t.currentRect)},_resize:function(){var t=this._canvas;t.width=n.viewport.width,t.height=n.viewport.height},_setPixelart:function(t){var e=this.context;e.imageSmoothingEnabled=!t,e.mozImageSmoothingEnabled=!t,e.webkitImageSmoothingEnabled=!t,e.oImageSmoothingEnabled=!t,e.msImageSmoothingEnabled=!t}})},{"../core/core.js":9}],23:[function(t,e,i){var n=t("../core/core.js");n.c("Canvas",{init:function(){this.requires("Renderable"),this.currentRect={},this._customLayer||this._attachToLayer(n.s("DefaultCanvasLayer"))},remove:function(){this._detachFromLayer()},drawVars:{type:"canvas",pos:{},ctx:null,coord:[0,0,0,0],co:{x:0,y:0,w:0,h:0}},draw:function(t,e,i,n,r){if(this.ready){4===arguments.length&&(r=n,n=i,i=e,e=t,t=this._drawContext);var o=this.drawVars.pos;o._x=this._x+(e||0),o._y=this._y+(i||0),o._w=n||this._w,o._h=r||this._h;var s=t||this._drawContext,a=this.__coord||[0,0,0,0],l=this.drawVars.co;l.x=a[0]+(e||0),l.y=a[1]+(i||0),l.w=n||a[2],l.h=r||a[3],(this._flipX||this._flipY||this._rotation)&&s.save(),0!==this._rotation&&(s.translate(this._origin.x+this._x,this._origin.y+this._y),o._x=-this._origin.x,o._y=-this._origin.y,s.rotate(this._rotation%360*(Math.PI/180))),(this._flipX||this._flipY)&&(s.scale(this._flipX?-1:1,this._flipY?-1:1),this._flipX&&(o._x=-(o._x+o._w)),this._flipY&&(o._y=-(o._y+o._h)));var c;return this._alpha<1&&(c=s.globalAlpha,s.globalAlpha=this._alpha),this.drawVars.ctx=s,this.trigger("Draw",this.drawVars),(0!==this._rotation||this._flipX||this._flipY)&&s.restore(),c&&(s.globalAlpha=c),this}}})},{"../core/core.js":9}],24:[function(t,e,i){var n=t("../core/core.js"),r=window.document;n.extend({assignColor:function(){function t(t){return t._red=t._blue=t._green=0,t}function e(t){var e=t.toString(16);return 1===e.length&&(e="0"+e),e}function i(t,i,n){return"#"+e(t)+e(i)+e(n)}function n(e,i){var n,r,o,s=e.length;if(7===s)n=e.substr(1,2),r=e.substr(3,2),o=e.substr(5,2);else{if(4!==s)return t(i);n=e.substr(1,1),n+=n,r=e.substr(2,1),r+=r,o=e.substr(3,1),o+=o}return i._red=parseInt(n,16),i._green=parseInt(r,16),i._blue=parseInt(o,16),i}function o(e,i){var n=h.exec(e);return null===n||4!==n.length&&5!==n.length?t(i):(i._red=Math.round(parseFloat(n[1])),i._green=Math.round(parseFloat(n[2])),i._blue=Math.round(parseFloat(n[3])),n[4]&&(i._strength=parseFloat(n[4])),i)}function s(t,e){if(void 0===u[t]){!1===c&&(window.document.body.appendChild(l),c=!0),l.style.color=t;o(window.getComputedStyle(l).color,e),u[t]=i(e._red,e._green,e._blue)}else n(u[t],e);return e}function a(t){return"rgba("+t._red+", "+t._green+", "+t._blue+", "+t._strength+")"}var l=r.createElement("div");l.style.display="none";var c=!1,u={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#00ff00",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",orange:"#ffa500",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00"},h=/rgba?\s*\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,?\s*([0-9.]+)?\)/;return function(t,e){e=e||{},t=t.trim().toLowerCase();"#"===t[0]?n(t,e):"r"===t[0]&&"g"===t[1]&&"b"===t[2]?o(t,e):s(t,e),e._strength=e._strength||1,e._color=a(e)}}()}),n.defaultShader("Color",new n.WebGLShader("attribute vec2 aPosition;\nattribute vec3 aOrientation;\nattribute vec2 aLayer;\nattribute vec4 aColor;\n\nvarying lowp vec4 vColor;\n\nuniform  vec4 uViewport;\n\nmat4 viewportScale = mat4(2.0 / uViewport.z, 0, 0, 0,    0, -2.0 / uViewport.w, 0,0,    0, 0,1,0,    -1,+1,0,1);\nvec4 viewportTranslation = vec4(uViewport.xy, 0, 0);\n\nvoid main() {\n  vec2 pos = aPosition;\n  vec2 entityOrigin = aOrientation.xy;\n  mat2 entityRotationMatrix = mat2(cos(aOrientation.z), sin(aOrientation.z), -sin(aOrientation.z), cos(aOrientation.z));\n\n  pos = entityRotationMatrix * (pos - entityOrigin) + entityOrigin;\n  gl_Position = viewportScale * (viewportTranslation + vec4(pos, 1.0/(1.0+exp(aLayer.x) ), 1) );\n  vColor = vec4(aColor.rgb*aColor.a*aLayer.y, aColor.a*aLayer.y);\n}","precision mediump float;\nvarying lowp vec4 vColor;\nvoid main(void) {\n\tgl_FragColor = vColor;\n}",[{name:"aPosition",width:2},{name:"aOrientation",width:3},{name:"aLayer",width:2},{name:"aColor",width:4}],function(t,e){t.program.writeVector("aColor",e._red/255,e._green/255,e._blue/255,e._strength)})),n.c("Color",{_red:0,_green:0,_blue:0,_strength:1,_color:"",ready:!0,init:function(){this.bind("Draw",this._drawColor),this._drawLayer&&this._setupColor(this._drawLayer),this.trigger("Invalidate")},events:{LayerAttached:"_setupColor"},remove:function(){this.unbind("Draw",this._drawColor),this.has("DOM")&&(this._element.style.backgroundColor="transparent"),this.trigger("Invalidate")},_setupColor:function(t){"WebGL"===t.type&&this._establishShader("Color",n.defaultShader("Color"))},_drawColor:function(t){this._color&&("DOM"===t.type?(t.style.backgroundColor=this._color,t.style.lineHeight=0):"canvas"===t.type?(t.ctx.fillStyle=this._color,t.ctx.fillRect(t.pos._x,t.pos._y,t.pos._w,t.pos._h)):"webgl"===t.type&&t.program.draw(t,this))},color:function(t){return 0===arguments.length?this._color:(arguments.length>=3?(this._red=arguments[0],this._green=arguments[1],this._blue=arguments[2],"number"==typeof arguments[3]&&(this._strength=arguments[3])):(n.assignColor(t,this),"number"==typeof arguments[1]&&(this._strength=arguments[1])),this._color="rgba("+this._red+", "+this._green+", "+this._blue+", "+this._strength+")",this.trigger("Invalidate"),this)}})},{"../core/core.js":9}],25:[function(t,e,i){var n=t("../core/core.js"),r=window.document;n.extend({domHelper:{innerPosition:function(t){var e=t.getBoundingClientRect(),i=e.left+(window.pageXOffset?window.pageXOffset:r.body.scrollLeft),n=e.top+(window.pageYOffset?window.pageYOffset:r.body.scrollTop),o=parseInt(this.getStyle(t,"border-left-width")||0,10)||parseInt(this.getStyle(t,"borderLeftWidth")||0,10)||0,s=parseInt(this.getStyle(t,"border-top-width")||0,10)||parseInt(this.getStyle(t,"borderTopWidth")||0,10)||0;return i+=o,n+=s,{x:i,y:n}},getStyle:function(t,e){var i;return t.currentStyle?i=t.currentStyle[this.camelize(e)]:window.getComputedStyle&&(i=r.defaultView.getComputedStyle(t,null).getPropertyValue(this.csselize(e))),i},camelize:function(t){return t.replace(/-+(.)?/g,function(t,e){return e?e.toUpperCase():""})},csselize:function(t){return t.replace(/[A-Z]/g,function(t){return t?"-"+t.toLowerCase():""})},translate:function(t,e,i){var o,s=r.documentElement,a=r.body;return i?(o=i._viewportRect(),{x:(t-n.stage.x+(s&&s.scrollLeft||a&&a.scrollLeft||0))/o._scale+o._x,y:(e-n.stage.y+(s&&s.scrollTop||a&&a.scrollTop||0))/o._scale+o._y}):(o=n.viewport,{x:(t-n.stage.x+(s&&s.scrollLeft||a&&a.scrollLeft||0))/o._scale-o._x,y:(e-n.stage.y+(s&&s.scrollTop||a&&a.scrollTop||0))/o._scale-o._y})}}})},{"../core/core.js":9}],26:[function(t,e,i){var n=t("../core/core.js"),r=window.document;n._registerLayerTemplate("DOM",{type:"DOM",options:{xResponse:1,yResponse:1,scaleResponse:1,z:0},_changedObjs:[],_dirtyViewport:!1,_div:null,init:function(){this._changedObjs=[];var t=this._div=r.createElement("div");n.stage.elem.appendChild(t),t.style.position="absolute",t.style.zIndex=this.options.z,t.style.transformStyle="preserve-3d",this.uniqueBind("RenderScene",this._render),this.uniqueBind("PixelartSet",this._setPixelArt),this.uniqueBind("InvalidateViewport",function(){this._dirtyViewport=!0}),n._addDrawLayerInstance(this)},remove:function(){this._div.parentNode.removeChild(this._div),n._removeDrawLayerInstance(this)},_setPixelArt:function(t){var e=this._div.style,i=n.domHelper.camelize;t?(e[i("image-rendering")]="optimizeSpeed",e[i("image-rendering")]="-moz-crisp-edges",e[i("image-rendering")]="-o-crisp-edges",e[i("image-rendering")]="-webkit-optimize-contrast",e[i("-ms-interpolation-mode")]="nearest-neighbor",e[i("image-rendering")]="optimize-contrast",e[i("image-rendering")]="pixelated",e[i("image-rendering")]="crisp-edges"):(e[i("image-rendering")]="optimizeQuality",e[i("-ms-interpolation-mode")]="bicubic",e[i("image-rendering")]="auto")},debug:function(){n.log(this._changedObjs)},_render:function(){var t=this._changedObjs;if(this._dirtyViewport&&(this._setViewport(),this._dirtyViewport=!1),t.length){for(var e=0,i=t.length;e<i;++e)t[e].draw()._changed=!1;t.length=0}},dirty:function(t){this._changedObjs.push(t)},attach:function(t){t._drawContext=this.context,this._div.appendChild(t._element),t._element.style.position="absolute",t._element.id="ent"+t[0]},detach:function(t){this._div.removeChild(t._element)},_setViewport:function(){var t=this._div.style,e=this._viewportRect(),i=e._scale,r=-e._x*i,o=-e._y*i;t.transform=t[n.support.prefix+"Transform"]="scale("+i+", "+i+")",t.left=Math.round(r)+"px",t.top=Math.round(o)+"px",t.zIndex=this.options.z}})},{"../core/core.js":9}],27:[function(t,e,i){var n=t("../core/core.js"),r=window.document;n.c("DOM",{_element:null,_cssStyles:null,avoidCss3dTransforms:!1,init:function(){this.requires("Renderable"),this._cssStyles={visibility:"",left:"",top:"",width:"",height:"",zIndex:"",opacity:"",transformOrigin:"",transform:""},this._element=r.createElement("div"),this._customLayer||this._attachToLayer(n.s("DefaultDOMLayer")),this.bind("NewComponent",this._updateClass),this.bind("RemoveComponent",this._removeClass)},remove:function(){this._detachFromLayer(),this.unbind("NewComponent",this._updateClass),this.unbind("RemoveComponent",this._removeClass)},getDomId:function(){return this._element.id},_removeClass:function(t){var e,i=this.__c,n="";for(e in i)e!==t&&(n+=" "+e);n=n.substr(1),this._element.className=n},_updateClass:function(){var t,e=this.__c,i="";for(t in e)i+=" "+t;i=i.substr(1),this._element.className=i},DOM:function(t){if(t&&t.nodeType){var e=this._drawLayer;this._detachFromLayer(),this._element=t,this._attachToLayer(e)}return this},draw:function(){var t=this._element.style,e=this.__coord||[0,0,0,0],i={x:e[0],y:e[1],w:e[2],h:e[3]},r=n.support.prefix,o=[];if(this._cssStyles.visibility!==this._visible&&(this._cssStyles.visibility=this._visible,this._visible?t.visibility="visible":t.visibility="hidden"),n.support.css3dtransform&&!this.avoidCss3dTransforms?o.push("translate3d("+~~this._x+"px,"+~~this._y+"px,0)"):(this._cssStyles.left!==this._x&&(this._cssStyles.left=this._x,t.left=~~this._x+"px"),this._cssStyles.top!==this._y&&(this._cssStyles.top=this._y,t.top=~~this._y+"px")),this._cssStyles.width!==this._w&&(this._cssStyles.width=this._w,t.width=~~this._w+"px"),this._cssStyles.height!==this._h&&(this._cssStyles.height=this._h,t.height=~~this._h+"px"),this._cssStyles.zIndex!==this._z&&(this._cssStyles.zIndex=this._z,t.zIndex=this._z),this._cssStyles.opacity!==this._alpha&&(this._cssStyles.opacity=this._alpha,t.opacity=this._alpha,t[r+"Opacity"]=this._alpha),this._mbr){var s=this._origin.x+"px "+this._origin.y+"px";t.transformOrigin=s,t[r+"TransformOrigin"]=s,n.support.css3dtransform?o.push("rotateZ("+this._rotation+"deg)"):o.push("rotate("+this._rotation+"deg)")}return this._flipX&&o.push("scaleX(-1)"),this._flipY&&o.push("scaleY(-1)"),this._cssStyles.transform!==o.join(" ")&&(this._cssStyles.transform=o.join(" "),t.transform=this._cssStyles.transform,t[r+"Transform"]=this._cssStyles.transform),this.trigger("Draw",{style:t,type:"DOM",co:i}),this},css:function(t,e){var i,r,o=this._element,a=o.style;if("object"===(void 0===t?"undefined":s(t)))for(i in t)t.hasOwnProperty(i)&&(r=t[i],"number"==typeof r&&(r+="px"),a[n.domHelper.camelize(i)]=r);else{if(!e)return n.domHelper.getStyle(o,t);"number"==typeof e&&(e+="px"),a[n.domHelper.camelize(t)]=e}return this.trigger("Invalidate"),this}})},{"../core/core.js":9}],28:[function(t,e,i){var n=t("../core/core.js");n.extend({_pixelartEnabled:!1,pixelart:function(t){n._pixelartEnabled=t,n.trigger("PixelartSet",t)}})},{"../core/core.js":9}],29:[function(t,e,i){function n(t,e){this.gl=t,this.webgl=e,this.max_units=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS),this.bound_textures=[],this.registered_textures={},this.active=null}function r(t,e){this.manager=t,this.gl=t.gl,this.glTexture=this.gl.createTexture(),this.id=e,this.active=!1,this.unit=null,this.powerOfTwo=!1}var o=t("../core/core.js");o.TextureManager=n,n.prototype={reset:function(){for(var t,e=0;e<this.bound_textures.length;e++)t=this.bound_textures[e],t.unbind();this.bound_textures=[],this.active=null},makeTexture:function(t,e,i){var n=this.webgl,o="texture-(r:"+i+")-"+t;if(void 0!==this.registered_textures[o])return this.registered_textures[o];var s=new r(this,o);return this.registered_textures[o]=s,this.bindTexture(s),s.setImage(e),s.setFilter(n.texture_filter),s.setRepeat(i),s},smallest:function(){for(var t=1/0,e=null,i=0;i<this.bound_textures.length;i++){var n=this.bound_textures[i];n.size<t&&(t=n.size,e=i)}return e},getAvailableUnit:function(){return this.bound_textures.length<this.max_units?this.bound_textures.length:this.smallest()},bindTexture:function(t){if(null===t.unit){var e=this.getAvailableUnit();this.bound_textures[e]&&this.unbindTexture(this.bound_textures[e]),this.bound_textures[e]=t,t.bind(e)}},unbindTexture:function(t){t.unbind()},setActiveTexture:function(t){this.active!==t.id&&(this.gl.activeTexture(this.gl[t.name]),this.active=t.unit)}},o.TextureWrapper=r,r.prototype={bind:function(t){var e=this.gl;this.unit=t,this.name="TEXTURE"+t,this.manager.setActiveTexture(this),e.bindTexture(e.TEXTURE_2D,this.glTexture)},isActive:function(){return this.manager.active===this.unit},unbind:function(){this.unit=null,this.name=null,this.isActive()&&(this.manager.active=null)},setImage:function(t){if(!this.isActive())throw"Trying to set image of texture that isn't active";this.width=t.width,this.height=t.height,this.size=t.width*t.height,this.powerOfTwo=!(Math.log(t.width)/Math.LN2!==Math.floor(Math.log(t.width)/Math.LN2)||Math.log(t.height)/Math.LN2!==Math.floor(Math.log(t.height)/Math.LN2));var e=this.gl;e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t)},setFilter:function(t){if(!this.isActive())throw"Trying to set filter of texture that isn't active";var e=this.gl;e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,t)},setRepeat:function(t){if(!this.isActive())throw"Trying to set repeat property of texture that isn't active";if(t&&!this.powerOfTwo)throw"Can't create a repeating image whose dimensions aren't a power of 2 in WebGL contexts";var e=this.gl;this.repeatMode=t?e.REPEAT:e.CLAMP_TO_EDGE,e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,this.repeatMode),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,this.repeatMode)},setToProgram:function(t,e,i){if(null===this.unit)throw"Trying to use texture not set to a texture unit.";var n=this.gl;n.useProgram(t),n.uniform1i(n.getUniformLocation(t,e),this.unit),n.uniform2f(n.getUniformLocation(t,i),this.width,this.height)}}},{"../core/core.js":9}],30:[function(t,e,i){t("../core/core.js").c("HTML",{inner:"",init:function(){this.requires("2D, DOM")},replace:function(t){return this.inner=t,this._element.innerHTML=t,this},append:function(t){return this.inner+=t,this._element.innerHTML+=t,this},prepend:function(t){return this.inner=t+this.inner,this._element.innerHTML=t+this.inner,this}})},{"../core/core.js":9}],31:[function(t,e,i){var n=t("../core/core.js");n.defaultShader("Image",new n.WebGLShader("attribute vec2 aPosition;\nattribute vec3 aOrientation;\nattribute vec2 aLayer;\nattribute vec2 aTextureCoord;\n\nvarying mediump vec3 vTextureCoord;\n\nuniform vec4 uViewport;\nuniform mediump vec2 uTextureDimensions;\n\nmat4 viewportScale = mat4(2.0 / uViewport.z, 0, 0, 0,    0, -2.0 / uViewport.w, 0,0,    0, 0,1,0,    -1,+1,0,1);\nvec4 viewportTranslation = vec4(uViewport.xy, 0, 0);\n\nvoid main() {\n  vec2 pos = aPosition;\n  vec2 entityOrigin = aOrientation.xy;\n  mat2 entityRotationMatrix = mat2(cos(aOrientation.z), sin(aOrientation.z), -sin(aOrientation.z), cos(aOrientation.z));\n  \n  pos = entityRotationMatrix * (pos - entityOrigin) + entityOrigin ;\n  gl_Position = viewportScale * (viewportTranslation + vec4(pos, 1.0/(1.0+exp(aLayer.x) ), 1) );\n  vTextureCoord = vec3(aTextureCoord, aLayer.y);\n}","varying mediump vec3 vTextureCoord;\n  \nuniform sampler2D uSampler;\nuniform mediump vec2 uTextureDimensions;\n\nvoid main(void) {\n  highp vec2 coord =   vTextureCoord.xy / uTextureDimensions;\n  mediump vec4 base_color = texture2D(uSampler, coord);\n  gl_FragColor = vec4(base_color.rgb*base_color.a*vTextureCoord.z, base_color.a*vTextureCoord.z);\n}",[{name:"aPosition",width:2},{name:"aOrientation",width:3},{name:"aLayer",width:2},{name:"aTextureCoord",width:2}],function(t,e){var i=t.pos;t.program.writeVector("aTextureCoord",0,0,0,i._h,i._w,0,i._w,i._h)})),n.c("Image",{_repeat:"repeat",ready:!1,init:function(){this.bind("Draw",this._drawImage),this.bind("LayerAttached",this._setupImage)},remove:function(){this.unbind("LayerAttached",this._setupImage),this.unbind("Draw",this._drawImage)},image:function(t,e){if(this.__image=t,this._repeat=e||"no-repeat",this.img=n.asset(t),this.img)this._setupImage(this._drawLayer);else{this.img=new Image,n.asset(t,this.img),this.img.src=t;var i=this;this.img.onload=function(){i._setupImage(i._drawLayer)}}return this.trigger("Invalidate"),this},_setupImage:function(t){this.img&&t&&("Canvas"===t.type?this._pattern=this._drawContext.createPattern(this.img,this._repeat):"WebGL"===t.type&&(this._establishShader("image:"+this.__image,n.defaultShader("Image")),this.program.setTexture(this._drawLayer.makeTexture(this.__image,this.img,"no-repeat"!==this._repeat))),"no-repeat"===this._repeat&&(this.w=this.w||this.img.width,this.h=this.h||this.img.height),this.ready=!0,this.trigger("Invalidate"))},_drawImage:function(t){if("canvas"===t.type){if(!this.ready||!this._pattern)return;var e=t.ctx;e.fillStyle=this._pattern,e.save(),e.translate(t.pos._x,t.pos._y),e.fillRect(0,0,t.pos._w,t.pos._h),e.restore()}else"DOM"===t.type?this.__image&&(t.style.backgroundImage="url("+this.__image+")",t.style.backgroundRepeat=this._repeat):"webgl"===t.type&&t.program.draw(t,this)}})},{"../core/core.js":9}],32:[function(t,e,i){var n=t("../core/core.js");n.extend({_drawLayerTemplates:{},_drawLayers:[],_addDrawLayerInstance:function(t){n._drawLayers.push(t),this._drawLayers.sort(function(t,e){return t.options.z-e.options.z})},_removeDrawLayerInstance:function(t){var e=this._drawLayers.indexOf(t);e>=0&&this._drawLayers.splice(e,1),this._drawLayers.sort(function(t,e){return t.options.z-e.options.z})},_registerLayerTemplate:function(t,e){this._drawLayerTemplates[t]=e;var i=this._commonLayerProperties;for(var n in i)e[n]||(e[n]=i[n]);e._viewportRectHolder={}},_commonLayerProperties:{_viewportRect:function(){var t=this.options,e=this._viewportRectHolder,i=Math.pow(n.viewport._scale,t.scaleResponse),r=n.viewport;return e._scale=i,e._w=r._width/i,e._h=r._height/i,e._x=t.xResponse*-r._x-.5*(t.xResponse-1)*(1-1/i)*r._width,e._y=t.yResponse*-r._y-.5*(t.yResponse-1)*(1-1/i)*r._height,e},_pointerEntities:0},createLayer:function(t,e,i){var r=this._drawLayerTemplates[e];n.s(t,r,i),n.c(t,{init:function(){this.requires("Renderable"),this._customLayer=!0,this.requires(r.type),this._attachToLayer(n.s(t))},remove:function(){this._detachFromLayer()}})}})},{"../core/core.js":9}],33:[function(t,e,i){var n=t("../core/core.js"),r=window.document;n.c("Particles",{init:function(){this._Particles=n.clone(this._Particles),this._Particles.parentEntity=this,this._particlesPaused=!1},particles:function(t){if(!n.support.canvas||n.deactivateParticles)return this;var e,i,o,s,a;e=r.createElement("canvas"),e.width=n.viewport.width,e.height=n.viewport.height,e.style.position="absolute",e.style.left="0px",e.style.top="0px",n.stage.elem.appendChild(e),i=e.getContext("2d"),this._Particles.init(t),this.bind("Remove",function(){n.stage.elem.removeChild(e)}).bind("RemoveComponent",function(t){"particles"===t&&n.stage.elem.removeChild(e)}),o=this.x+n.viewport.x,s=this.y+n.viewport.y,this._Particles.position=this._Particles.vectorHelpers.create(o,s);var l={x:n.viewport.x,y:n.viewport.y};return this.bind("EnterFrame",function(){this._particlesPaused||(o=this.x+n.viewport.x,s=this.y+n.viewport.y,this._Particles.viewportDelta={x:n.viewport.x-l.x,y:n.viewport.y-l.y},l={x:n.viewport.x,y:n.viewport.y},this._Particles.position=this._Particles.vectorHelpers.create(o,s),"function"==typeof n.rectManager.boundingRect?(a=n.rectManager.boundingRect(this._Particles.register))&&i.clearRect(a._x,a._y,a._w,a._h):i.clearRect(0,0,n.viewport.width,n.viewport.height),this._Particles.update(),this._Particles.render(i))}),this},_Particles:{presets:{maxParticles:150,size:18,sizeRandom:4,speed:1,speedRandom:1.2,lifeSpan:29,lifeSpanRandom:7,angle:65,angleRandom:34,startColour:[255,131,0,1],startColourRandom:[48,50,45,0],endColour:[245,35,0,0],endColourRandom:[60,60,60,0],sharpness:20,sharpnessRandom:10,spread:10,duration:-1,fastMode:!1,gravity:{x:0,y:.1},jitter:0,originOffset:{x:0,y:0},particles:[],active:!0,particleCount:0,elapsedFrames:0,emissionRate:0,emitCounter:0,particleIndex:0},init:function(t){this.position=this.vectorHelpers.create(0,0),void 0===t&&(t={});for(var e in this.presets)void 0!==t[e]?this[e]=t[e]:this[e]=this.presets[e];this.emissionRate=this.maxParticles/this.lifeSpan,this.positionRandom=this.vectorHelpers.create(this.spread,this.spread)},addParticle:function(){if(this.particleCount===this.maxParticles)return!1;var t=new this.particle(this.vectorHelpers);return this.initParticle(t),this.particles[this.particleCount]=t,this.particleCount++,!0},RANDM1TO1:function(){return 2*Math.random()-1},initParticle:function(t){t.position.x=n.viewport._scale*(this.position.x+this.originOffset.x+this.positionRandom.x*this.RANDM1TO1()),t.position.y=n.viewport._scale*(this.position.y+this.originOffset.y+this.positionRandom.y*this.RANDM1TO1());var e=(this.angle+this.angleRandom*this.RANDM1TO1())*(Math.PI/180),i=this.vectorHelpers.create(Math.sin(e),-Math.cos(e)),r=this.speed+this.speedRandom*this.RANDM1TO1();t.direction=this.vectorHelpers.multiply(i,r),t.size=n.viewport._scale*(this.size+this.sizeRandom*this.RANDM1TO1()),t.size=t.size<0?0:~~t.size,t.timeToLive=this.lifeSpan+this.lifeSpanRandom*this.RANDM1TO1(),t.sharpness=this.sharpness+this.sharpnessRandom*this.RANDM1TO1(),t.sharpness=t.sharpness>100?100:t.sharpness<0?0:t.sharpness,t.sizeSmall=~~(t.size/200*t.sharpness);var o=[this.startColour[0]+this.startColourRandom[0]*this.RANDM1TO1(),this.startColour[1]+this.startColourRandom[1]*this.RANDM1TO1(),this.startColour[2]+this.startColourRandom[2]*this.RANDM1TO1(),this.startColour[3]+this.startColourRandom[3]*this.RANDM1TO1()],s=[this.endColour[0]+this.endColourRandom[0]*this.RANDM1TO1(),this.endColour[1]+this.endColourRandom[1]*this.RANDM1TO1(),this.endColour[2]+this.endColourRandom[2]*this.RANDM1TO1(),this.endColour[3]+this.endColourRandom[3]*this.RANDM1TO1()];t.colour=o,t.deltaColour[0]=(s[0]-o[0])/t.timeToLive,t.deltaColour[1]=(s[1]-o[1])/t.timeToLive,t.deltaColour[2]=(s[2]-o[2])/t.timeToLive,t.deltaColour[3]=(s[3]-o[3])/t.timeToLive},update:function(){if(this.active&&this.emissionRate>0){var t=1/this.emissionRate;for(this.emitCounter++;this.particleCount<this.maxParticles&&this.emitCounter>t;)this.addParticle(),this.emitCounter-=t;this.elapsedFrames++,-1!==this.duration&&this.duration<this.elapsedFrames&&this.stop()}this.particleIndex=0,this.register=[];for(var e;this.particleIndex<this.particleCount;){var i=this.particles[this.particleIndex];if(i.timeToLive>0){i.direction=this.vectorHelpers.add(i.direction,this.gravity),i.position=this.vectorHelpers.add(i.position,i.direction),i.position=this.vectorHelpers.add(i.position,this.viewportDelta),this.jitter&&(i.position.x+=this.jitter*this.RANDM1TO1(),i.position.y+=this.jitter*this.RANDM1TO1()),i.timeToLive--;var n=i.colour[0]+=i.deltaColour[0],r=i.colour[1]+=i.deltaColour[1],o=i.colour[2]+=i.deltaColour[2],s=i.colour[3]+=i.deltaColour[3];e=[],e.push("rgba("+(n>255?255:n<0?0:~~n)),e.push(r>255?255:r<0?0:~~r),e.push(o>255?255:o<0?0:~~o),e.push((s>1?1:s<0?0:s.toFixed(2))+")"),i.drawColour=e.join(","),this.fastMode||(e[3]="0)",i.drawColourEnd=e.join(",")),this.particleIndex++}else this.particleIndex!==this.particleCount-1&&(this.particles[this.particleIndex]=this.particles[this.particleCount-1]),this.particleCount--;var a={};a._x=~~i.position.x,a._y=~~i.position.y,a._w=i.size,a._h=i.size,this.register.push(a)}},stop:function(){this.active=!1,this.elapsedFrames=0,this.emitCounter=0,this.parentEntity.trigger("ParticleEnd")},render:function(t){for(var e=0,i=this.particleCount;e<i;e++){var r=this.particles[e],o=r.size,s=o>>1;if(!(r.position.x+o<0||r.position.y+o<0||r.position.x-o>n.viewport.width||r.position.y-o>n.viewport.height)){var a=~~r.position.x,l=~~r.position.y;if(this.fastMode)t.fillStyle=r.drawColour;else{var c=t.createRadialGradient(a+s,l+s,r.sizeSmall,a+s,l+s,s);c.addColorStop(0,r.drawColour),c.addColorStop(.9,r.drawColourEnd),t.fillStyle=c}t.fillRect(a,l,o,o)}}},particle:function(t){this.position=t.create(0,0),this.direction=t.create(0,0),this.size=0,this.sizeSmall=0,this.timeToLive=0,this.colour=[],this.drawColour="",this.deltaColour=[],this.sharpness=0},vectorHelpers:{create:function(t,e){return{x:t,y:e}},multiply:function(t,e){return t.x*=e,t.y*=e,t},add:function(t,e){return t.x+=e.x,t.y+=e.y,t}}},pauseParticles:function(){this._particlesPaused=!0},resumeParticles:function(){this._particlesPaused=!1}})},{"../core/core.js":9}],34:[function(t,e,i){t("../core/core.js").c("Renderable",{_changed:!1,_alpha:1,_visible:!0,_setterRenderable:function(t,e){this[t]!==e&&(this[t]=e,this.trigger("Invalidate"))},_graphics_property_definitions:{alpha:{set:function(t){this._setterRenderable("_alpha",t)},get:function(){return this._alpha},configurable:!0,enumerable:!0},_alpha:{enumerable:!1},visible:{set:function(t){this._setterRenderable("_visible",t)},get:function(){return this._visible},configurable:!0,enumerable:!0},_visible:{enumerable:!1}},_defineRenderableProperites:function(){for(var t in this._graphics_property_definitions)Object.defineProperty(this,t,this._graphics_property_definitions[t])},init:function(){this._defineRenderableProperites()},_invalidateRenderable:function(){!1===this._changed&&(this._changed=!0,this._drawLayer.dirty(this))},_attachToLayer:function(t){this._drawLayer&&this._detachFromLayer(),this._drawLayer=t,t.attach(this),this.bind("Invalidate",this._invalidateRenderable),this.trigger("LayerAttached",t),this.trigger("Invalidate")},_detachFromLayer:function(){this._drawLayer&&(this._drawLayer.detach(this),this.unbind("Invalidate",this._invalidateRenderable),this.trigger("LayerDetached",this._drawLayer),delete this._drawLayer)},flip:function(t){return t=t||"X",this["_flip"+t]||(this["_flip"+t]=!0,this.trigger("Invalidate")),this},unflip:function(t){return t=t||"X",this["_flip"+t]&&(this["_flip"+t]=!1,this.trigger("Invalidate")),this}})},{"../core/core.js":9}],35:[function(t,e,i){var n=t("../core/core.js");n.c("SpriteAnimation",{_reels:null,_currentReelId:null,_currentReel:null,_isPlaying:!1,animationSpeed:1,init:function(){this._reels={}},reel:function(t,e,i,r,o,a){if(0===arguments.length)return this._currentReelId;if(1===arguments.length&&"string"==typeof t){if(void 0===this._reels[t])throw"The specified reel "+t+" is undefined.";return this.pauseAnimation(),this._currentReelId!==t&&(this._currentReelId=t,this._currentReel=this._reels[t],this._updateSprite(),this.trigger("ReelChange",this._currentReel)),this}var l,c;if(l={id:t,frames:[],currentFrame:0,easing:new n.easing(e),defaultLoops:1},l.duration=l.easing.duration,"number"==typeof i)if(a=a||1/0,o>=0)for(c=0;c<o;++c)l.frames.push([i,r]),++i>=a&&(i=0,r++);else for(c=0;c>o;--c)l.frames.push([i,r]),--i<0&&(i=a-1,r--);else{if(3!==arguments.length||"object"!==(void 0===i?"undefined":s(i)))throw"Unrecognized arguments. Please see the documentation for 'reel(...)'.";l.frames=i}return this._reels[t]=l,this},animate:function(t,e){"string"==typeof t&&this.reel(t);var i=this._currentReel;if(void 0===i||null===i)throw"No reel is specified, and there is no currently active reel.";return this.pauseAnimation(),void 0===e&&(e="number"==typeof t?t:1),i.easing.reset(),this.loops(e),this._setFrame(0),this.bind("EnterFrame",this._animationTick),this._isPlaying=!0,this.trigger("StartAnimation",i),this},resumeAnimation:function(){return!1===this._isPlaying&&null!==this._currentReel&&(this.bind("EnterFrame",this._animationTick),this._isPlaying=!0,this._currentReel.easing.resume(),this.trigger("StartAnimation",this._currentReel)),this},pauseAnimation:function(){return!0===this._isPlaying&&(this.unbind("EnterFrame",this._animationTick),this._isPlaying=!1,this._reels[this._currentReelId].easing.pause()),this},resetAnimation:function(){var t=this._currentReel;if(null===t)throw"No active reel to reset.";return this.reelPosition(0),t.easing.repeat(t.defaultLoops),this},loops:function(t){return 0===arguments.length?null!==this._currentReel?this._currentReel.easing.loops:0:(null!==this._currentReel&&(t<0&&(t=1/0),this._currentReel.easing.repeat(t),this._currentReel.defaultLoops=t),this)},reelPosition:function(t){if(null===this._currentReel)throw"No active reel.";if(0===arguments.length)return this._currentReel.currentFrame;var e,i=this._currentReel.frames.length;if("end"===t&&(t=i-1),t<1&&t>0)e=t,t=Math.floor(i*e);else{if(t!==Math.floor(t))throw"Position "+t+" is invalid.";t<0&&(t=i-1+t),e=t/i}return t=Math.min(t,i-1),t=Math.max(t,0),this._setProgress(e),this._setFrame(t),this},_animationTick:function(t){var e=this._reels[this._currentReelId];e.easing.tick(t.dt*this.animationSpeed);var i=e.easing.value(),n=Math.min(Math.floor(e.frames.length*i),e.frames.length-1);this._setFrame(n),!0===e.easing.complete&&(this.pauseAnimation(),this.trigger("AnimationEnd",this._currentReel))},_setFrame:function(t){var e=this._currentReel;t!==e.currentFrame&&(e.currentFrame=t,this._updateSprite(),this.trigger("FrameChange",e))},_updateSprite:function(){var t=this._currentReel,e=t.frames[t.currentFrame];this.sprite(e[0],e[1])},_setProgress:function(t,e){this._currentReel.easing.setProgress(t,e)},isPlaying:function(t){return!!this._isPlaying&&(t?this._currentReelId===t:!!this._currentReelId)},getReel:function(t){if(0===arguments.length){if(!this._currentReelId)return null;t=this._currentReelId}return this._reels[t]}})},{"../core/core.js":9}],36:[function(t,e,i){var n=t("../core/core.js");n.defaultShader("Sprite",new n.WebGLShader("attribute vec2 aPosition;\nattribute vec3 aOrientation;\nattribute vec2 aLayer;\nattribute vec2 aTextureCoord;\n\nvarying mediump vec3 vTextureCoord;\n\nuniform vec4 uViewport;\nuniform mediump vec2 uTextureDimensions;\n\nmat4 viewportScale = mat4(2.0 / uViewport.z, 0, 0, 0,    0, -2.0 / uViewport.w, 0,0,    0, 0,1,0,    -1,+1,0,1);\nvec4 viewportTranslation = vec4(uViewport.xy, 0, 0);\n\nvoid main() {\n  vec2 pos = aPosition;\n  vec2 entityOrigin = aOrientation.xy;\n  mat2 entityRotationMatrix = mat2(cos(aOrientation.z), sin(aOrientation.z), -sin(aOrientation.z), cos(aOrientation.z));\n  \n  pos = entityRotationMatrix * (pos - entityOrigin) + entityOrigin ;\n  gl_Position = viewportScale * (viewportTranslation + vec4(pos, 1.0/(1.0+exp(aLayer.x) ), 1) );\n  vTextureCoord = vec3(aTextureCoord, aLayer.y);\n}","varying mediump vec3 vTextureCoord;\n  \nuniform sampler2D uSampler;\nuniform mediump vec2 uTextureDimensions;\n\nvoid main(void) {\n  highp vec2 coord =   vTextureCoord.xy / uTextureDimensions;\n  mediump vec4 base_color = texture2D(uSampler, coord);\n  gl_FragColor = vec4(base_color.rgb*base_color.a*vTextureCoord.z, base_color.a*vTextureCoord.z);\n}",[{name:"aPosition",width:2},{name:"aOrientation",width:3},{name:"aLayer",width:2},{name:"aTextureCoord",width:2}],function(t,e){var i=t.co;t.program.writeVector("aTextureCoord",i.x,i.y,i.x,i.y+i.h,i.x+i.w,i.y,i.x+i.w,i.y+i.h)})),n.extend({sprite:function(t,e,i,r,o,s,a){var l,c,u;"string"==typeof t&&(s=o,o=r,r=e,i=t,t=1,e=1),"string"==typeof e&&(s=o,o=r,r=i,i=e,e=t),!s&&o&&(s=o),o=parseInt(o||0,10),s=parseInt(s||0,10);var h=function(){this.ready=!0,this.trigger("Invalidate")};(u=n.asset(i))||(u=new Image,u.src=i,n.asset(i,u),u.onload=function(){for(var t in r)n(t).each(h)});var p=function(){this.requires("2D, Sprite"),this.__trim=[0,0,0,0],this.__image=i,this.__map=r,this.__coord=[this.__coord[0],this.__coord[1],this.__coord[2],this.__coord[3]],this.__tile=t,this.__tileh=e,this.__padding=[o,s],this.__padBorder=a,this.sprite(this.__coord[0],this.__coord[1],this.__coord[2],this.__coord[3]),this.img=u,this.img.complete&&this.img.width>0&&(this.ready=!0,this.trigger("Invalidate")),this.w=this.__coord[2],this.h=this.__coord[3],this._setupSpriteImage(this._drawLayer)};for(l in r)r.hasOwnProperty(l)&&(c=r[l],n.c(l,{ready:!1,__coord:[c[0],c[1],c[2]||1,c[3]||1],init:p}));return this}}),n.c("Sprite",{__image:"",__tile:0,__tileh:0,__padding:null,__trim:null,img:null,ready:!1,init:function(){this.__trim=[0,0,0,0],this.bind("Draw",this._drawSprite),this.bind("LayerAttached",this._setupSpriteImage)},remove:function(){this.unbind("Draw",this._drawSprite),this.unbind("LayerAttached",this._setupSpriteImage)},_setupSpriteImage:function(t){this.__image&&this.img&&t&&"WebGL"===t.type&&(this._establishShader(this.__image,n.defaultShader("Sprite")),this.program.setTexture(t.makeTexture(this.__image,this.img,!1)))},_drawSprite:function(t){var e=t.co,i=t.pos,n=t.ctx;if("canvas"===t.type)n.drawImage(this.img,e.x,e.y,e.w,e.h,i._x,i._y,i._w,i._h);else if("DOM"===t.type){var r=this._h/e.h,o=this._w/e.w,s=this._element.style,a=s.backgroundColor;"initial"===a&&(a="");var l=a+" url('"+this.__image+"') no-repeat";l!==s.background&&(s.background=l),s.backgroundPosition="-"+e.x*o+"px -"+e.y*r+"px",1===r&&1===o||(s.backgroundSize=this.img.width*o+"px "+this.img.height*r+"px")}else"webgl"===t.type&&t.program.draw(t,this)},sprite:function(t,e,i,n){if("string"==typeof t){var r=this.__map[t];if(!r)return this;t=r[0],e=r[1],i=r[2]||1,n=r[3]||1}return this.__coord=this.__coord||[0,0,0,0],this.__coord[0]=t*(this.__tile+this.__padding[0])+(this.__padBorder?this.__padding[0]:0)+this.__trim[0],this.__coord[1]=e*(this.__tileh+this.__padding[1])+(this.__padBorder?this.__padding[1]:0)+this.__trim[1],void 0!==i&&void 0!==n&&(this.__coord[2]=this.__trim[2]||i*this.__tile||this.__tile,this.__coord[3]=this.__trim[3]||n*this.__tileh||this.__tileh),this.trigger("Invalidate"),this},crop:function(t,e,i,n){var r=this._mbr||this.pos();return this.__trim=[],this.__trim[0]=t,this.__trim[1]=e,this.__trim[2]=i,this.__trim[3]=n,this.__coord[0]+=t,this.__coord[1]+=e,this.__coord[2]=i,this.__coord[3]=n,this._w=i,this._h=n,this.trigger("Invalidate",r),this}})},{"../core/core.js":9}],37:[function(t,e,i){var n=t("../core/core.js");n.c("Text",{_text:"",defaultSize:"10px",defaultFamily:"sans-serif",defaultVariant:"normal",defaultLineHeight:"normal",defaultTextAlign:"left",ready:!0,init:function(){this.requires("2D"),this._textFont={type:"",weight:"",size:this.defaultSize,lineHeight:this.defaultLineHeight,family:this.defaultFamily,variant:this.defaultVariant},this._textAlign=this.defaultTextAlign},events:{Draw:function(t){var e=this._fontString();if("DOM"===t.type){var i=this._element,n=i.style;n.color=this._textColor,n.font=e,n.textAlign=this._textAlign,i.innerHTML=this._text}else if("canvas"===t.type){var r=t.ctx;r.save(),r.textBaseline="top",r.fillStyle=this._textColor||"rgb(0,0,0)",r.font=e,r.textAlign=this._textAlign,r.fillText(this._text,t.pos._x,t.pos._y),r.restore()}}},remove:function(){this.unbind(this._textUpdateEvent,this._dynamicTextUpdate)},_getFontHeight:function(){var t=/([a-zA-Z]+)\b/,e={px:1,pt:4/3,pc:16,cm:96/2.54,mm:96/25.4,in:96,em:void 0,ex:void 0};return function(i){var n=parseFloat(i),r=t.exec(i),o=r?r[1]:"px";return void 0!==e[o]?Math.ceil(n*e[o]):Math.ceil(n)}}(),_textGenerator:null,text:function(t){return void 0===t||null===t?this._text:("function"==typeof t?(this._text=t.call(this),this._textGenerator=t):(this._text=t,this._textGenerator=null),this.has("Canvas")&&this._resizeForCanvas(),this.trigger("Invalidate"),this)},_dynamicTextOn:!1,_textUpdateEvent:null,_dynamicTextUpdate:function(){this._textGenerator&&this.text(this._textGenerator)},dynamicTextGeneration:function(t,e){return this.unbind(this._textUpdateEvent,this._dynamicTextUpdate),t&&(this._textUpdateEvent=e||"EnterFrame",this.bind(this._textUpdateEvent,this._dynamicTextUpdate)),this},_resizeForCanvas:function(){var t=this._drawContext;t.font=this._fontString(),this.w=t.measureText(this._text).width;var e=this._textFont.size||this.defaultSize;this.h=1.1*this._getFontHeight(e),"left"===this._textAlign||"start"===this._textAlign?this.offsetBoundary(0,0,0,0):"center"===this._textAlign?this.offsetBoundary(this.w/2,0,-this.w/2,0):"end"!==this._textAlign&&"right"!==this._textAlign||this.offsetBoundary(this.w,0,-this.w,0)},_fontString:function(){return this._textFont.type+" "+this._textFont.variant+" "+this._textFont.weight+" "+this._textFont.size+" / "+this._textFont.lineHeight+" "+this._textFont.family},textColor:function(t){return n.assignColor(t,this),this._textColor="rgba("+this._red+", "+this._green+", "+this._blue+", "+this._strength+")",this.trigger("Invalidate"),this},textAlign:function(t){return this._textAlign=t,this.has("Canvas")&&this._resizeForCanvas(),this.trigger("Invalidate"),this},textFont:function(t,e){if(1===arguments.length){if("string"==typeof t)return this._textFont[t];if("object"===(void 0===t?"undefined":s(t)))for(var i in t)this._textFont[i]="family"===i?"'"+t[i]+"'":t[i]}else this._textFont[t]=e;return this.has("Canvas")&&this._resizeForCanvas(),this.trigger("Invalidate"),this},unselectable:function(){return this.has("DOM")&&(this.css({"-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",cursor:"default"}),this.trigger("Invalidate")),this}})},{"../core/core.js":9}],38:[function(t,e,i){var n=t("../core/core.js"),r=window.document;n.extend({viewport:{clampToEntities:!0,_width:0,_height:0,_x:0,_y:0,_scale:1,bounds:null,scroll:function(t,e){this[t]=e,n.trigger("ViewportScroll"),n.trigger("InvalidateViewport")},rect_object:{_x:0,_y:0,_w:0,_h:0},rect:function(t){return t=t||this.rect_object,t._x=-this._x,t._y=-this._y,t._w=this._width/this._scale,t._h=this._height/this._scale,t},pan:function(){function t(t){a.tick(t.dt);var l=a.value();n.viewport.x=(1-l)*o+l*i,n.viewport.y=(1-l)*s+l*r,n.viewport._clamp(),a.complete&&(e(),n.trigger("CameraAnimationDone"))}function e(){n.unbind("EnterFrame",t)}var i,r,o,s,a;return n._preBind("StopCamera",e),function(e,l,c,u){n.trigger("StopCamera"),"reset"!==e&&(o=n.viewport._x,s=n.viewport._y,i=o-e,r=s-l,a=new n.easing(c,u),n.uniqueBind("EnterFrame",t))}}(),follow:function(){function t(){var t=n.viewport._scale;n.viewport.scroll("_x",-(this.x+this.w/2-n.viewport.width/2/t-r*t)),n.viewport.scroll("_y",-(this.y+this.h/2-n.viewport.height/2/t-o*t)),n.viewport._clamp()}function e(){i&&(i.unbind("Move",t),i.unbind("ViewportScale",t),i.unbind("ViewportResize",t))}var i,r,o;return n._preBind("StopCamera",e),function(e,s,a){e&&e.has("2D")&&(n.trigger("StopCamera"),i=e,r=void 0!==s?s:0,o=void 0!==a?a:0,e.bind("Move",t),e.bind("ViewportScale",t),e.bind("ViewportResize",t),t.call(e))}}(),centerOn:function(t,e){var i=t.x+n.viewport.x,r=t.y+n.viewport.y,o=t.w/2,s=t.h/2,a=n.viewport.width/2/n.viewport._scale,l=n.viewport.height/2/n.viewport._scale,c=i+o-a,u=r+s-l;n.viewport.pan(c,u,e)},zoom:function(){function t(){n.unbind("EnterFrame",e)}function e(e){var r,h;u.tick(e.dt),r=Math.pow(o,u.value()),h=1===o?u.value():(1/r-1)/(1/o-1),n.viewport.scale(r*i),n.viewport.scroll("_x",s*(1-h)+a*h),n.viewport.scroll("_y",l*(1-h)+c*h),n.viewport._clamp(),u.complete&&(t(),n.trigger("CameraAnimationDone"))}n._preBind("StopCamera",t);var i,r,o,s,a,l,c,u;return function(t,h,p,m,f){if(!t)return void n.viewport.scale(1);arguments.length<=2&&(m=h,h=n.viewport.x-n.viewport.width,p=n.viewport.y-n.viewport.height),n.trigger("StopCamera"),i=n.viewport._scale,o=t,r=i*o,s=n.viewport.x,l=n.viewport.y,a=-(h-n.viewport.width/(2*r)),c=-(p-n.viewport.height/(2*r)),u=new n.easing(m,f),n.uniqueBind("EnterFrame",e)}}(),scale:function(){return function(t){this._scale=t||1,n.trigger("InvalidateViewport"),n.trigger("ViewportScale")}}(),mouselook:function(){var t=!1,e=!1,i={};return function(r,o){if("boolean"==typeof r)return t=r,void(t?n.mouseObjs++:n.mouseObjs=Math.max(0,n.mouseObjs-1));if(t)switch(r){case"move":case"drag":if(!e)return;var s={x:o.clientX-i.x,y:o.clientY-i.y};i.x=o.clientX,i.y=o.clientY,n.viewport.x+=s.x,n.viewport.y+=s.y,n.viewport._clamp();break;case"start":n.trigger("StopCamera"),i.x=o.clientX,i.y=o.clientY,e=!0;break;case"stop":e=!1}}}(),_clamp:function(){if(this.clampToEntities){var t=n.clone(this.bounds)||n.clone(n.map.boundaries());t.max.x*=this._scale,t.min.x*=this._scale,t.max.y*=this._scale,t.min.y*=this._scale,t.max.x-t.min.x>n.viewport.width?n.viewport.x<(-t.max.x+n.viewport.width)/this._scale?n.viewport.x=(-t.max.x+n.viewport.width)/this._scale:n.viewport.x>-t.min.x&&(n.viewport.x=-t.min.x):n.viewport.x=-1*(t.min.x+(t.max.x-t.min.x)/2-n.viewport.width/2),t.max.y-t.min.y>n.viewport.height?n.viewport.y<(-t.max.y+n.viewport.height)/this._scale?n.viewport.y=(-t.max.y+n.viewport.height)/this._scale:n.viewport.y>-t.min.y&&(n.viewport.y=-t.min.y):n.viewport.y=-1*(t.min.y+(t.max.y-t.min.y)/2-n.viewport.height/2)}},init:function(t,e,i){n.createLayer("DefaultCanvasLayer","Canvas",{z:20}),n.createLayer("DefaultDOMLayer","DOM",{z:30}),n.createLayer("DefaultWebGLLayer","WebGL",{z:10}),this._defineViewportProperties(),this._x=0,this._y=0,this._scale=1,this.bounds=null,this._width=t||window.innerWidth,this._height=e||window.innerHeight,void 0===i&&(i="cr-stage");var o;if("string"==typeof i)o=r.getElementById(i);else{if(!("undefined"!=typeof HTMLElement?i instanceof HTMLElement:i instanceof Element))throw new TypeError("stage_elem must be a string or an HTMLElement");o=i}n.stage={x:0,y:0,fullscreen:!1,elem:o||r.createElement("div")},t||e||(r.body.style.overflow="hidden",n.stage.fullscreen=!0),n.addEvent(this,window,"resize",n.viewport.reload),n.addEvent(this,window,"blur",function(){n.settings.get("autoPause")&&(n._paused||n.pause())}),n.addEvent(this,window,"focus",function(){n._paused&&n.settings.get("autoPause")&&n.pause()}),n.settings.register("stageSelectable",function(t){n.stage.elem.onselectstart=t?function(){return!0}:function(){return!1}}),n.settings.modify("stageSelectable",!1),n.settings.register("stageContextMenu",function(t){n.stage.elem.oncontextmenu=t?function(){return!0}:function(){return!1}}),n.settings.modify("stageContextMenu",!1),n.settings.register("autoPause",function(){}),n.settings.modify("autoPause",!1),o||(r.body.appendChild(n.stage.elem),n.stage.elem.id=i);var a,l=n.stage.elem.style;if(l.width=this.width+"px",l.height=this.height+"px",l.overflow="hidden",n.bind("ViewportResize",function(){n.trigger("InvalidateViewport")}),n.mobile){void 0!==s(l.webkitTapHighlightColor)&&(l.webkitTapHighlightColor="rgba(0,0,0,0)");var c=r.createElement("meta"),u=r.getElementsByTagName("head")[0];c=r.createElement("meta"),c.setAttribute("name","apple-mobile-web-app-capable"),c.setAttribute("content","yes"),u.appendChild(c),n.addEvent(this,n.stage.elem,"touchmove",function(t){t.preventDefault()})}l.position="relative",a=n.domHelper.innerPosition(n.stage.elem),n.stage.x=a.x,n.stage.y=a.y,n.uniqueBind("ViewportResize",this._resize)},_resize:function(){n.stage.elem.style.width=n.viewport.width+"px",n.stage.elem.style.height=n.viewport.height+"px"},_defineViewportProperties:function(){Object.defineProperty(this,"x",{set:function(t){this.scroll("_x",t)},get:function(){return this._x},configurable:!0}),Object.defineProperty(this,"y",{set:function(t){this.scroll("_y",t)},get:function(){return this._y},configurable:!0}),Object.defineProperty(this,"width",{set:function(t){this._width=t,n.trigger("ViewportResize")},get:function(){return this._width},configurable:!0}),Object.defineProperty(this,"height",{set:function(t){this._height=t,n.trigger("ViewportResize")},get:function(){return this._height},configurable:!0})},reload:function(){var t,e=window.innerWidth,i=window.innerHeight;n.stage.fullscreen&&(this._width=e,this._height=i,n.trigger("ViewportResize")),t=n.domHelper.innerPosition(n.stage.elem),n.stage.x=t.x,n.stage.y=t.y},reset:function(){n.viewport.mouselook("stop"),n.trigger("StopCamera"),n.viewport.scroll("_x",0),n.viewport.scroll("_y",0),n.viewport.scale(1)},onScreen:function(t){return n.viewport._x+t._x+t._w>0&&n.viewport._y+t._y+t._h>0&&n.viewport._x+t._x<n.viewport.width&&n.viewport._y+t._y<n.viewport.height}}})},{"../core/core.js":9}],39:[function(t,e,i){function n(t,e){this.shader=e,this.layer=t,this.context=t.context,this.draw=function(){},this.array_size=16,this.max_size=1024,this._indexArray=new Uint16Array(6*this.array_size),this._indexBuffer=t.context.createBuffer()}var r=t("../core/core.js"),o=window.document;n.prototype={initAttributes:function(t){this.attributes=t,this._attribute_table={};for(var e=0,i=0;i<t.length;i++){var n=t[i];this._attribute_table[n.name]=n,n.bytes=n.bytes||Float32Array.BYTES_PER_ELEMENT,n.type=n.type||this.context.FLOAT,n.offset=e,n.location=this.context.getAttribLocation(this.shader,n.name),this.context.enableVertexAttribArray(n.location),e+=n.width}this.stride=e,this._attributeArray=new Float32Array(4*this.array_size*this.stride),this._attributeBuffer=this.context.createBuffer(),this._registryHoles=[],this._registrySize=0},growArrays:function(t){if(!(this.array_size>=this.max_size)){var e=Math.min(t,this.max_size),i=new Float32Array(4*e*this.stride),n=new Uint16Array(6*e);i.set(this._attributeArray),n.set(this._indexArray),this._attributeArray=i,this._indexArray=n,this.array_size=e}},registerEntity:function(t){if(0===this._registryHoles.length){if(this._registrySize>=this.max_size)throw"Number of entities exceeds maximum limit.";this._registrySize>=this.array_size&&this.growArrays(2*this.array_size),t._glBufferIndex=this._registrySize,this._registrySize++}else t._glBufferIndex=this._registryHoles.pop()},unregisterEntity:function(t){"number"==typeof t._glBufferIndex&&this._registryHoles.push(t._glBufferIndex),t._glBufferIndex=null},resetRegistry:function(){this._maxElement=0,this._registryHoles.length=0},setCurrentEntity:function(t){this.ent_offset=4*t._glBufferIndex,this.ent=t},switchTo:function(){var t=this.context;t.useProgram(this.shader),t.bindBuffer(t.ARRAY_BUFFER,this._attributeBuffer);for(var e,i=this.attributes,n=0;n<i.length;n++)e=i[n],t.vertexAttribPointer(e.location,e.width,e.type,!1,this.stride*e.bytes,e.offset*e.bytes);var r=this.texture_obj;r&&null===r.unit&&this.layer.texture_manager.bindTexture(r),this.index_pointer=0},setTexture:function(t){void 0===this.texture_obj&&(t.setToProgram(this.shader,"uSampler","uTextureDimensions"),this.texture_obj=t)},addIndices:function(t){var e=this._indexArray,i=this.index_pointer;e[0+i]=0+t,e[1+i]=1+t,e[2+i]=2+t,e[3+i]=1+t,e[4+i]=2+t,e[5+i]=3+t,this.index_pointer+=6},renderBatch:function(){var t=this.context;t.bindBuffer(t.ARRAY_BUFFER,this._attributeBuffer),t.bufferData(t.ARRAY_BUFFER,this._attributeArray,t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this._indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this._indexArray,t.STATIC_DRAW),t.drawElements(t.TRIANGLES,this.index_pointer,t.UNSIGNED_SHORT,0)},setViewportUniforms:function(t,e){var i=this.context;i.useProgram(this.shader),i.uniform4f(this.shader.viewport,-t._x,-t._y,t._w,t._h)},writeVector:function(t,e,i){for(var n=this._attribute_table[t],r=this.stride,o=n.offset+this.ent_offset*r,s=n.width,a=arguments.length-1,l=this._attributeArray,c=0;c<4;c++)for(var u=0;u<s;u++)l[o+r*c+u]=arguments[(s*c+u)%a+1]}},r._registerLayerTemplate("WebGL",{type:"WebGL",options:{xResponse:1,yResponse:1,scaleResponse:1,z:0},context:null,changed_objects:[],_compileShader:function(t,e){var i=this.context,n=i.createShader(e);if(i.shaderSource(n,t),i.compileShader(n),!i.getShaderParameter(n,i.COMPILE_STATUS))throw i.getShaderInfoLog(n);return n},_makeProgram:function(t){var e=this.context,i=this._compileShader(t.fragmentCode,e.FRAGMENT_SHADER),n=this._compileShader(t.vertexCode,e.VERTEX_SHADER),r=e.createProgram();if(e.attachShader(r,n),e.attachShader(r,i),e.linkProgram(r),!e.getProgramParameter(r,e.LINK_STATUS))throw"Could not initialise shaders";return r.viewport=e.getUniformLocation(r,"uViewport"),r},getProgramWrapper:function(t,e){if(void 0===this.programs[t]){var i=this._makeProgram(e),r=new n(this,i);r.name=t,r.initAttributes(e.attributeList),r.draw=e.drawCallback,r.setViewportUniforms(this._viewportRect(),this.options),this.programs[t]=r}return this.programs[t]},makeTexture:function(t,e,i){return this.texture_manager.makeTexture(t,e,i)},init:function(){if(!r.support.webgl)return r.trigger("NoWebGL"),void r.stop();this.changed_objects=[],this.programs={};var t;t=o.createElement("canvas"),t.width=r.viewport.width,t.height=r.viewport.height,t.style.position="absolute",t.style.left="0px",t.style.top="0px",t.style.zIndex=this.options.z,r.stage.elem.appendChild(t);var e;try{e=t.getContext("webgl",{premultipliedalpha:!0})||t.getContext("experimental-webgl",{premultipliedalpha:!0}),e.viewportWidth=t.width,e.viewportHeight=t.height}catch(t){return r.trigger("NoWebGL"),void r.stop()}this.context=e,this._canvas=t,e.clearColor(0,0,0,0),e.disable(e.DEPTH_TEST),e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA),e.enable(e.BLEND),this.uniqueBind("RenderScene",this.render),this.uniqueBind("ViewportResize",this._resize),this.uniqueBind("InvalidateViewport",function(){this.dirtyViewport=!0}),this.uniqueBind("PixelartSet",this._setPixelart),this._setPixelart(r._pixelartEnabled),this.dirtyViewport=!0,this.texture_manager=new r.TextureManager(e,this),r._addDrawLayerInstance(this)},remove:function(){this._canvas.parentNode.removeChild(this._canvas),r._removeDrawLayerInstance(this)},_resize:function(){var t=this._canvas;t.width=r.viewport.width,t.height=r.viewport.height;var e=this.context;e.viewportWidth=t.width,e.viewportHeight=t.height},_setPixelart:function(t){var e=this.context;this.texture_filter=t?e.NEAREST:e.LINEAR},zsort:function(t,e){return t._globalZ-e._globalZ},visible_gl:[],render:function(t){t=t||this._viewportRect();var e=this.context;e.viewport(0,0,e.viewportWidth,e.viewportHeight),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);var i=this.programs;if(this.dirtyViewport){var n=this._viewportRect();for(var o in i)i[o].setViewportUniforms(n,this.options);this.dirtyViewport=!1}var s,a=r.map.search(t),l=0,c=a.length,u=this.visible_gl;for(u.length=0,l=0;l<c;l++)s=a[l],s._visible&&s.program&&s._drawLayer===this&&u.push(s);u.sort(this.zsort),c=u.length;var h=null;for(l=0;l<c;l++)s=u[l],h!==s.program&&(null!==h&&h.renderBatch(),h=s.program,h.index_pointer=0,h.switchTo()),s.draw(),s._changed=!1;null!==h&&h.renderBatch()},dirty:function(t){},attach:function(t){t._drawContext=this.context},detach:function(t){t.program&&t.program.unregisterEntity(t)}})},{"../core/core.js":9}],40:[function(t,e,i){var n=t("../core/core.js");n.extend({WebGLShader:function(t,e,i,n){this.vertexCode=t,this.fragmentCode=e,this.attributeList=i,this.drawCallback=n},defaultShader:function(t,e){if(this._defaultShaders=this._defaultShaders||{},1===arguments.length)return this._defaultShaders[t];this._defaultShaders[t]=e}}),n.c("WebGL",{init:function(){this.requires("Renderable"),this._customLayer||this._attachToLayer(n.s("DefaultWebGLLayer"))},remove:function(){this._detachFromLayer()},drawVars:{type:"webgl",pos:{},ctx:null,coord:[0,0,0,0],co:{x:0,y:0,w:0,h:0}},draw:function(t,e,i,n,r){if(this.ready){4===arguments.length&&(r=n,n=i,i=e,e=t,t=this._drawLayer.context);var o=this.drawVars.pos;o._x=this._x+(e||0),o._y=this._y+(i||0),o._w=n||this._w,o._h=r||this._h;var s=this.__coord||[0,0,0,0],a=this.drawVars.co;a.x=s[0]+(e||0),a.y=s[1]+(i||0),a.w=n||s[2],a.h=r||s[3],this._flipX&&(a.x=a.x+a.w,a.w=-a.w),this._flipY&&(a.y=a.y+a.h,a.h=-a.h);var l=this._drawContext;this.drawVars.gl=l;var c=this.drawVars.program=this.program;return c.setCurrentEntity(this),c.writeVector("aPosition",this._x,this._y,this._x,this._y+this._h,this._x+this._w,this._y,this._x+this._w,this._y+this._h),c.writeVector("aOrientation",this._origin.x+this._x,this._origin.y+this._y,this._rotation*Math.PI/180),c.writeVector("aLayer",this._globalZ,this._alpha),this.trigger("Draw",this.drawVars),c.addIndices(c.ent_offset),this}},_establishShader:function(t,e){this.program=this._drawLayer.getProgramWrapper(t,e),this.program.registerEntity(this),this.ready=!0}})},{"../core/core.js":9}],41:[function(t,e,i){var n=t("../core/core.js");n.extend({diamondIso:{_tile:{width:0,height:0},getTileDimensions:function(){return{w:this._tile.width,h:this._tile.height}},_map:{width:0,height:0},_origin:{x:0,y:0},_tiles:[],getTile:function(t,e,i){return this._tiles[t][e][i]},init:function(t,e,i,n,r,o){this._tile.width=parseInt(t,10),this._tile.height=parseInt(e,10)||parseInt(t,10)/2,this._tile.r=this._tile.width/this._tile.height,this._map.width=parseInt(i,10),this._map.height=parseInt(n,10)||parseInt(i,10);for(var s=0;s<i;s++){this._tiles[s]=Array();for(var a=0;a<n;a++)this._tiles[s][a]=Array()}return this.x=parseInt(r,10)||0,this.y=parseInt(o,10)||0,this.layerZLevel=i+n+1,this},place:function(t,e,i,n){var r=this.pos2px(e,i),o=t.h/this._tile.height;t.x=r.x,t.y=r.y-(o-2)*this._tile.height-this._tile.height*n,t.z=this.getZAtLoc(e,i,n);for(var s=0;s<=o-2;s++){var a=this._tiles[e][i][n+s];a&&a!==t&&a.destroy(),this._tiles[e][i][n+s]=t}return this},detachTile:function(t){for(var e=0;e<this._map.width;e++)for(var i=0;i<this._map.height;i++)for(var n=this._tiles[e][i].length,r=0;r<n;r++)if(this._tiles[e][i][r]&&t===this._tiles[e][i][r]){for(var o=t.h/this._tile.height,s=0;s<o;s++)this._tiles[e][i][r+s]=void 0;return{x:e,y:i,z:r}}return!1},centerAt:function(t,e){var i=this.pos2px(t,e);n.viewport.x=-i.x+n.viewport.width/2-this._tile.width,n.viewport.y=-i.y+n.viewport.height/2},getZAtLoc:function(t,e,i){return this.layerZLevel*i+t+e},pos2px:function(t,e){return{x:this.x+(t-e-1)*this._tile.width/2,y:this.y+(t+e)*this._tile.height/2}},px2pos:function(t,e){var i=(e-this.y)/this._tile.height,n=(t-this.x)/this._tile.width,r=i+n,o=i-n,s=r>0&&r<this._map.width,a=o>0&&o<this._map.height;if(s&&a)return{x:~~r,y:~~o}},getOverlappingTiles:function(t,e){var i=this.px2pos(t,e),n=[],r=~~i.x,o=~~i.y,s=this._map.width-r,a=this._map.height-o,l=Math.min(s,a),c=this._tiles[r][o][1];c&&n.push(c);for(var u=1;u<l;u++){var h=this._tiles[r+u][o+u][u];h&&n.push(h)}return n},polygon:function(t){t.requires("Collision");var e=[0,t.h-0-this._tile.height/2,0-this._tile.width/2,t.h-0-0,0-this._tile.width,t.h-0-this._tile.height/2,0-this._tile.width/2,t.h-0-this._tile.height];return new n.polygon(e)}}})},{"../core/core.js":9}],42:[function(t,e,i){var n=t("../core/core.js");n.extend({isometric:{_tile:{width:0,height:0},_elements:{},_pos:{x:0,y:0},_z:0,size:function(t,e){return this._tile.width=t,this._tile.height=e>0?e:t/2,this},place:function(t,e,i,r){var o=this.pos2px(t,e);return o.top-=i*(this._tile.height/2),r.x=o.left+n.viewport._x,r.y=o.top+n.viewport._y,r.z+=i,this},pos2px:function(t,e){return{left:t*this._tile.width+(1&e)*(this._tile.width/2),top:e*this._tile.height/2}},px2pos:function(t,e){return{x:-Math.ceil(-t/this._tile.width-.5*(1&e)),y:e/this._tile.height*2}},centerAt:function(t,e){if("number"==typeof t&&"number"==typeof e){var i=this.pos2px(t,e);return n.viewport._x=-i.left+n.viewport.width/2-this._tile.width/2,n.viewport._y=-i.top+n.viewport.height/2-this._tile.height/2,this}return{top:-n.viewport._y+n.viewport.height/2-this._tile.height/2,left:-n.viewport._x+n.viewport.width/2-this._tile.width/2}},area:function(){var t=this.centerAt(),e=this.px2pos(-t.left+n.viewport.width/2,-t.top+n.viewport.height/2),i=this.px2pos(-t.left-n.viewport.width/2,-t.top-n.viewport.height/2);return{x:{start:e.x,end:i.x},y:{start:e.y,end:i.y}}}}})},{"../core/core.js":9}],43:[function(t,e,i){var n=t("../core/core.js"),r=window.document;n.extend({audio:{sounds:{},supported:null,codecs:{ogg:'audio/ogg; codecs="vorbis"',wav:'audio/wav; codecs="1"',webma:'audio/webm; codecs="vorbis"',mp3:'audio/mpeg; codecs="mp3"',m4a:'audio/mp4; codecs="mp4a.40.2"'},volume:1,muted:!1,paused:!1,playCheck:null,_canPlay:function(){if(this.supported={},n.support.audio){var t,e=this.audioElement();for(var i in this.codecs)t=e.canPlayType(this.codecs[i]),this.supported[i]=""!==t&&"no"!==t}},supports:function(t){return null===this.supported&&this._canPlay(),!!this.supported[t]},audioElement:function(){return"undefined"!=typeof Audio?new Audio(""):r.createElement("audio")},create:function(t,e){var i=e.substr(e.lastIndexOf(".")+1).toLowerCase();if(!this.supports(i))return!1;var r=this.audioElement();return r.id=t,r.preload="auto",r.volume=n.audio.volume,r.src=e,n.asset(e,r),this.sounds[t]={obj:r,played:0,volume:n.audio.volume},this.sounds[t]},add:function(t,e){if(n.support.audio){var i,r;if(1===arguments.length&&"object"===(void 0===t?"undefined":s(t)))for(var o in t)for(i in t[o])if(r=n.audio.create(o,t[o][i]))break;if("string"==typeof t&&("string"==typeof e&&(r=n.audio.create(t,e)),"object"===(void 0===e?"undefined":s(e))))for(i in e)if(r=n.audio.create(t,e[i]))break;return r}},play:function(t,e,i){if(0!==e&&n.support.audio&&this.sounds[t]){var r=this.sounds[t],o=this.getOpenChannel();if(!o)return null;o.id=t,o.repeat=e;var s=o.obj;return o.volume=r.volume=r.obj.volume=i||n.audio.volume,s.volume=r.volume,s.src=r.obj.src,this.muted&&(s.volume=0),s.play(),r.played++,o.onEnd=function(){r.played<o.repeat||-1===o.repeat?(this.currentTime&&(this.currentTime=0),this.play(),r.played++):(o.active=!1,this.pause(),this.removeEventListener("ended",o.onEnd,!0),this.currentTime=0,n.trigger("SoundComplete",{id:o.id}))},s.addEventListener("ended",o.onEnd,!0),s}},maxChannels:7,setChannels:function(t){this.maxChannels=t,t<this.channels.length&&(this.channels.length=t)},channels:[],getOpenChannel:function(){for(var t=0;t<this.channels.length;t++){var e=this.channels[t];if(!1===e.active||e.obj.ended&&e.repeat<=this.sounds[e.id].played)return e.active=!0,e}if(t<this.maxChannels){var i={obj:this.audioElement(),active:!0,_is:function(t){return this.id===t&&this.active}};return this.channels.push(i),i}return null},remove:function(t){if(n.support.audio){var e,i,r=n.paths().audio;if(t)this.sounds[t]&&(e=this.sounds[t],i=e.obj.src.split("/").pop(),n.audio.stop(t),delete n.assets[r+i],delete n.assets[e.obj.src],delete n.audio.sounds[t]);else for(var o in this.sounds)e=this.sounds[o],i=e.obj.src.split("/").pop(),n.audio.stop(t),delete n.assets[r+i],delete n.assets[e.obj.src],delete n.audio.sounds[t]}},stop:function(t){if(n.support.audio){var e;for(var i in this.channels)e=this.channels[i],(!t&&e.active||e._is(t))&&(e.active=!1,e.obj.pause())}},_mute:function(t){if(n.support.audio){var e;for(var i in this.channels)e=this.channels[i],e.obj.volume=t?0:e.volume;this.muted=t}},toggleMute:function(){this.muted?this._mute(!1):this._mute(!0)},mute:function(){this._mute(!0)},unmute:function(){this._mute(!1)},pause:function(t){if(n.support.audio&&t&&this.sounds[t]){var e;for(var i in this.channels)e=this.channels[i],e._is(t)&&!e.obj.paused&&e.obj.pause()}},unpause:function(t){if(n.support.audio&&t&&this.sounds[t]){var e;for(var i in this.channels)e=this.channels[i],e._is(t)&&e.obj.paused&&e.obj.play()}},togglePause:function(t){if(n.support.audio&&t&&this.sounds[t]){var e;for(var i in this.channels)e=this.channels[i],e._is(t)&&(e.obj.paused?e.obj.play():e.obj.pause())}},isPlaying:function(t){if(!n.support.audio)return!1;for(var e in this.channels)if(this.channels[e]._is(t))return!0;return!1}}})},{"../core/core.js":9}],44:[function(t,e,i){var n=t("../core/core.js"),r=t("./spatial-grid.js");n.map=new r;var o=Math,a=o.PI,l=a/180;n.c("2D",{_x:0,_y:0,_w:0,_h:0,_z:0,_globalZ:null,_rotation:0,_origin:null,_mbr:null,_entry:null,_children:null,_parent:null,_2D_property_definitions:{x:{set:function(t){this._setter2d("_x",t)},get:function(){return this._x},configurable:!0,enumerable:!0},_x:{enumerable:!1},y:{set:function(t){this._setter2d("_y",t)},get:function(){return this._y},configurable:!0,enumerable:!0},_y:{enumerable:!1},w:{set:function(t){this._setter2d("_w",t)},get:function(){return this._w},configurable:!0,enumerable:!0},_w:{enumerable:!1},h:{set:function(t){this._setter2d("_h",t)},get:function(){return this._h},configurable:!0,enumerable:!0},_h:{enumerable:!1},z:{set:function(t){this._setter2d("_z",t)},get:function(){return this._z},configurable:!0,enumerable:!0},_z:{enumerable:!1},rotation:{set:function(t){this._setter2d("_rotation",t)},get:function(){return this._rotation},configurable:!0,enumerable:!0},_rotation:{enumerable:!1}},_define2DProperties:function(){for(var t in this._2D_property_definitions)Object.defineProperty(this,t,this._2D_property_definitions[t])},init:function(){this._globalZ=this[0],this._origin={x:0,y:0},this._bx1=0,this._bx2=0,this._by1=0,this._by2=0,this._children=[],this._define2DProperties(),this._entry=n.map.insert(this),this.bind("Move",function(t){var e=this._cbr||this._mbr||this;this._entry.update(e),this._children.length>0&&this._cascade(t)}),this.bind("Rotate",function(t){var e=this._cbr||this._mbr||this;this._entry.update(e),this._children.length>0&&this._cascade(t)}),this.bind("Remove",function(){if(this._children){for(var t=0;t<this._children.length;t++)delete this._children[t]._parent,this._children[t].destroy&&this._children[t].destroy();this._children=[]}this._parent&&this._parent.detach(this),n.map.remove(this._entry),this.detach()})},offsetBoundary:function(t,e,i,n){return 1===arguments.length&&(e=i=n=t),this._bx1=t,this._bx2=i,this._by1=e,this._by2=n,this.trigger("BoundaryOffset"),this._calculateMBR(),this},_calculateMBR:function(){var t=this._origin.x+this._x,e=this._origin.y+this._y,i=-this._rotation*l,n=this._x-this._bx1-t,r=this._x+this._w+this._bx2-t,o=this._y-this._by1-e,s=this._y+this._h+this._by2-e,a=Math.cos(i),c=Math.sin(i);a=a<1e-10&&a>-1e-10?0:a,c=c<1e-10&&c>-1e-10?0:c;var u=n*a+o*c,h=-n*c+o*a,p=r*a+o*c,m=-r*c+o*a,f=r*a+s*c,_=-r*c+s*a,d=n*a+s*c,y=-n*c+s*a,g=Math.floor(Math.min(u,p,f,d)+t),v=Math.floor(Math.min(h,m,_,y)+e),x=Math.ceil(Math.max(u,p,f,d)+t),b=Math.ceil(Math.max(h,m,_,y)+e);if(this._mbr?(this._mbr._x=g,this._mbr._y=v,this._mbr._w=x-g,this._mbr._h=b-v):this._mbr={_x:g,_y:v,_w:x-g,_h:b-v},this._cbr){var w=this._cbr,C=w.cx,S=w.cy,A=w.r,D=t+(C+this._x-t)*a+(S+this._y-e)*c,M=e-(C+this._x-t)*c+(S+this._y-e)*a;w._x=Math.min(D-A,g),w._y=Math.min(M-A,v),w._w=Math.max(D+A,x)-w._x,w._h=Math.max(M+A,b)-w._y}},_rotate:function(t){var e=this._rotation-t;if(0!==e){this._rotation=t;var i={x:this._origin.x+this._x,y:this._origin.y+this._y};this._calculateMBR();var n=e*l,r=Math.cos(n),o=Math.sin(n);this.trigger("Rotate",{cos:-1e-10<r&&r<1e-10?0:r,sin:-1e-10<o&&o<1e-10?0:o,deg:e,rad:n,o:i})}},area:function(){return this._w*this._h},intersect:function(t,e,i,n){var r,o=this._mbr||this;return r="object"===(void 0===t?"undefined":s(t))?t:{_x:t,_y:e,_w:i,_h:n},o._x<r._x+r._w&&o._x+o._w>r._x&&o._y<r._y+r._h&&o._y+o._h>r._y},within:function(t,e,i,n){var r,o=this._mbr||this;return r="object"===(void 0===t?"undefined":s(t))?t:{_x:t,_y:e,_w:i,_h:n},r._x<=o._x&&r._x+r._w>=o._x+o._w&&r._y<=o._y&&r._y+r._h>=o._y+o._h},contains:function(t,e,i,n){var r,o=this._mbr||this;return r="object"===(void 0===t?"undefined":s(t))?t:{_x:t,_y:e,_w:i,_h:n},r._x>=o._x&&r._x+r._w<=o._x+o._w&&r._y>=o._y&&r._y+r._h<=o._y+o._h},pos:function(t){return t=t||{},t._x=this._x,t._y=this._y,t._w=this._w,t._h=this._h,t},mbr:function(t){return t=t||{},this._mbr?(t._x=this._mbr._x,t._y=this._mbr._y,t._w=this._mbr._w,t._h=this._mbr._h,t):this.pos(t)},isAt:function(t,e){if(this.mapArea)return this.mapArea.containsPoint(t,e);if(this.map)return this.map.containsPoint(t,e);var i=this._mbr||this;return i._x<=t&&i._x+i._w>=t&&i._y<=e&&i._y+i._h>=e},move:function(t,e){return"n"===t.charAt(0)&&(this.y-=e),"s"===t.charAt(0)&&(this.y+=e),"e"!==t&&"e"!==t.charAt(1)||(this.x+=e),"w"!==t&&"w"!==t.charAt(1)||(this.x-=e),this},shift:function(t,e,i,n){return t&&(this.x+=t),e&&(this.y+=e),i&&(this.w+=i),n&&(this.h+=n),this},_cascade:function(t){if(t){var e,i=0,n=this._children,r=n.length;if("cos"in t||"sin"in t)for(;i<r;++i)"rotate"in(e=n[i])&&e.rotate(t);else for(var o=this._x-t._x,s=this._y-t._y,a=this._w-t._w,l=this._h-t._h;i<r;++i)e=n[i],e.shift(o,s,a,l)}},attach:function(){for(var t,e=0,i=arguments,n=arguments.length;e<n;++e)t=i[e],t._parent&&t._parent.detach(t),t._parent=this,this._children.push(t);return this},detach:function(t){var e;if(!t){for(e=0;e<this._children.length;e++)this._children[e]._parent=null;return this._children=[],this}for(e=0;e<this._children.length;e++)this._children[e]===t&&this._children.splice(e,1);return t._parent=null,this},origin:function(t,e){if("string"==typeof t)if("centre"===t||"center"===t||-1===t.indexOf(" "))t=this._w/2,e=this._h/2;else{var i=t.split(" ");"top"===i[0]?e=0:"bottom"===i[0]?e=this._h:"middle"!==i[0]&&"center"!==i[1]&&"centre"!==i[1]||(e=this._h/2),"center"===i[1]||"centre"===i[1]||"middle"===i[1]?t=this._w/2:"left"===i[1]?t=0:"right"===i[1]&&(t=this._w)}return this._origin.x=t,this._origin.y=e,this},rotate:function(t){var e,i;e=(this._x+this._origin.x-t.o.x)*t.cos+(this._y+this._origin.y-t.o.y)*t.sin+(t.o.x-this._origin.x),i=(this._y+this._origin.y-t.o.y)*t.cos-(this._x+this._origin.x-t.o.x)*t.sin+(t.o.y-this._origin.y),this._setter2d("_rotation",this._rotation-t.deg),this._setter2d("_x",e),this._setter2d("_y",i)},_setter2d:function(t,e){if(this[t]!==e){var i,r=n.rectManager._pool.copy(this);if("_rotation"===t)this._rotate(e);else if("_x"===t||"_y"===t)i=this._mbr,i&&(i[t]-=this[t]-e,this._cbr&&(this._cbr[t]-=this[t]-e)),this[t]=e,this.trigger("Move",r);else if("_h"===t||"_w"===t){i=this._mbr;var o=this[t];this[t]=e,i&&this._calculateMBR(),"_w"===t?this.trigger("Resize",{axis:"w",amount:e-o}):"_h"===t&&this.trigger("Resize",{axis:"h",amount:e-o}),this.trigger("Move",r)}else if("_z"===t){var s=e<<0;e=e===s?s:s+1,this._globalZ=1e5*e+this[0],this[t]=e,this.trigger("Reorder")}this[t]=e,this.trigger("Invalidate"),n.rectManager._pool.recycle(r)}}}),n.polygon=function(t){arguments.length>1&&(t=Array.prototype.slice.call(arguments,0)),this.points=t},n.polygon.prototype={containsPoint:function(t,e){var i,n,r=this.points,o=r.length/2,s=!1;for(i=0,n=o-1;i<o;n=i++)r[2*i+1]>e!=r[2*n+1]>e&&t<(r[2*n]-r[2*i])*(e-r[2*i+1])/(r[2*n+1]-r[2*i+1])+r[2*i]&&(s=!s);return s},shift:function(t,e){for(var i=0,n=this.points,r=n.length;i<r;i+=2)n[i]+=t,n[i+1]+=e},clone:function(){return new n.polygon(this.points.slice(0))},rotate:function(t){for(var e,i,n=0,r=this.points,o=r.length;n<o;n+=2)e=t.o.x+(r[n]-t.o.x)*t.cos+(r[n+1]-t.o.y)*t.sin,i=t.o.y-(r[n]-t.o.x)*t.sin+(r[n+1]-t.o.y)*t.cos,r[n]=e,r[n+1]=i},intersectRay:function(t,e){for(var i,n,r,o,s,a,l,c,u,h=this.points,p=1/0,m=t._x,f=e.x,_=t._y,d=e.y,y=0,g=h.length,v=h[g-2],x=h[g-1];y<g;y+=2)a=h[y],c=h[y+1],l=a-v,u=c-x,n=(v-m)*u-(x-_)*l,o=(v-m)*d-(x-_)*f,s=f*u-d*l,0!==s?(i=n/s,(r=o/s)>=0&&r<=1&&i>=0&&i<p&&(p=i)):0!==n&&0!==o||(i=(v-m)*f+(x-_)*d,i>=0&&i<p&&(p=i),(i=(a-m)*f+(c-_)*d)>=0&&i<p&&(p=i)),v=a,x=c;return p}},n.circle=function(t,e,i){this.x=t,this.y=e,this.radius=i,this.points=[];for(var n,r=0;r<16;r+=2)n=r*Math.PI/8,this.points[r]=this.x+Math.sin(n)*i,this.points[r+1]=this.y+Math.cos(n)*i},n.circle.prototype={containsPoint:function(t,e){var i=this.radius,n=this.x-t,r=this.y-e;return n*n+r*r<i*i},shift:function(t,e){this.x+=t,this.y+=e;for(var i=0,n=this.points,r=n.length;i<r;i+=2)n[i]+=t,n[i+1]+=e},rotate:function(){}},n.matrix=function(t){this.mtx=t,this.width=t[0].length,this.height=t.length},n.matrix.prototype={x:function(t){if(this.width===t.height){for(var e=[],i=0;i<this.height;i++){e[i]=[];for(var r=0;r<t.width;r++){for(var o=0,s=0;s<this.width;s++)o+=this.mtx[i][s]*t.mtx[s][r];e[i][r]=o}}return new n.matrix(e)}},e:function(t,e){return t<1||t>this.mtx.length||e<1||e>this.mtx[0].length?null:this.mtx[t-1][e-1]}}},{"../core/core.js":9,"./spatial-grid.js":50}],45:[function(t,e,i){var n=t("../core/core.js"),r=Math.PI/180;n.extend({raycast:function(t,e){for(var i,r,o="obj",a=1/0,l=!0,c=2,u=arguments.length;c<u;++c)i=arguments[c],r=void 0===i?"undefined":s(i),"number"===r?a=i+1e-6:"string"===r?o=i:"boolean"===r&&(l=i);var h=t._x,p=t._y,m=e.x,f=e.y,_={},d=[];if(a<0){var y=null,g=1/0;n.map.traverseRay(t,e,function(i,n){if(y&&g<n)return d.push({obj:y,distance:g,x:h+g*m,y:p+g*f}),y=null,g=1/0,!0;if(i.map&&i.__c[o]&&!_[i[0]]){_[i[0]]=!0;var r=i.map.intersectRay(t,e);r<g&&(y=i,g=r)}}),y&&d.push({obj:y,distance:g,x:h+g*m,y:p+g*f})}else n.map.traverseRay(t,e,function(i,n){if(n>a)return!0;if(i.map&&i.__c[o]&&!_[i[0]]){_[i[0]]=!0;var r=i.map.intersectRay(t,e);r<a&&d.push({obj:i,distance:r,x:h+r*m,y:p+r*f})}});return l&&d.sort(function(t,e){return t.distance-e.distance}),d}}),n.c("Collision",{init:function(){this.requires("2D"),this._collisionData={},this.collision()},remove:function(){this._cbr=null,this.unbind("Resize",this._resizeMap),this.unbind("Resize",this._checkBounds)},collision:function(t){if(this.unbind("Resize",this._resizeMap),this.unbind("Resize",this._checkBounds),t){if(arguments.length>1){var e=Array.prototype.slice.call(arguments,0);t=new n.polygon(e)}else t=t.constructor===Array?new n.polygon(t.slice()):t.clone();this._findBounds(t.points)}else t=new n.polygon([0,0,this._w,0,this._w,this._h,0,this._h]),this.bind("Resize",this._resizeMap),this._cbr=null;return this.rotation&&t.rotate({cos:Math.cos(-this.rotation*r),sin:Math.sin(-this.rotation*r),o:{x:this._origin.x,y:this._origin.y}}),this.map=t,this.attach(this.map),this.map.shift(this._x,this._y),this.trigger("NewHitbox",t),this},cbr:function(t){return t=t||{},this._cbr?(t._x=this._cbr._x,t._y=this._cbr._y,t._w=this._cbr._w,t._h=this._cbr._h,t):this.mbr(t)},_findBounds:function(t){for(var e=1/0,i=-1/0,n=1/0,r=-1/0,o=t.length,s=0;s<o;s+=2)t[s]<e&&(e=t[s]),t[s]>i&&(i=t[s]),t[s+1]<n&&(n=t[s+1]),t[s+1]>r&&(r=t[s+1]);var a={cx:(e+i)/2,cy:(n+r)/2,r:Math.sqrt((i-e)*(i-e)+(r-n)*(r-n))/2};return e>=0&&n>=0&&(this._checkBounds=function(){null===this._cbr&&this._w<i||this._h<r?(this._cbr=a,this._calculateMBR()):this._cbr&&(this._cbr=null,this._calculateMBR())},this.bind("Resize",this._checkBounds)),e>=0&&n>=0&&i<=this._w&&r<=this._h?(this._cbr=null,!1):(this._cbr=a,this._calculateMBR(),!0)},_resizeMap:function(t){var e,i,n=this.rotation*r,o=this.map.points;"w"===t.axis?(n?(e=t.amount*Math.cos(n),i=t.amount*Math.sin(n)):(e=t.amount,i=0),o[2]+=e,o[3]+=i):(n?(i=t.amount*Math.cos(n),e=-t.amount*Math.sin(n)):(e=0,i=t.amount),o[6]+=e,o[7]+=i),o[4]+=e,o[5]+=i},hit:function(t){var e,i,r,o,s=this._cbr||this._mbr||this,a=n.map.search(s,!1),l=0,c=a.length,u={},h=n.rectManager.overlap,p="map"in this&&"containsPoint"in this.map,m=[];if(!c)return null;for(;l<c;++l)i=a[l],r=i._cbr||i._mbr||i,i&&(e=i[0],!u[e]&&this[0]!==e&&i.__c[t]&&h(r,s)&&(u[e]=i));for(o in u)if(i=u[o],p&&"map"in i){var f=this._SAT(this.map,i.map);f.obj=i,f.type="SAT",f&&m.push(f)}else m.push({obj:i,type:"MBR"});return m.length?m:null},onHit:function(t,e,i){var n=!1;return this.bind("EnterFrame",function(){var r=this.hit(t);r?(e.call(this,r,!n),n=!0):n&&("function"==typeof i&&i.call(this),n=!1)}),this},_createCollisionHandler:function(t,e){return function(){var i=this.hit(t);if(!0===e.occurring){if(null!==i)return;e.occurring=!1,this.trigger("HitOff",t)}else null!==i&&(e.occurring=!0,this.trigger("HitOn",i))}},checkHits:function(){var t=arguments,e=0;for(1===t.length&&(t=t[0].split(/\s*,\s*/));e<t.length;++e){var i=t[e],n=this._collisionData[i];void 0===n&&(this._collisionData[i]=n={occurring:!1,handler:null},n.handler=this._createCollisionHandler(i,n),this.bind("EnterFrame",n.handler))}return this},ignoreHits:function(){var t,e=arguments,i=0;if(0===e.length){for(t in this._collisionData)this.unbind("EnterFrame",t.handler);this._collisionData={}}for(1===e.length&&(e=e[0].split(/\s*,\s*/));i<e.length;++i){var n=e[i];t=this._collisionData[n],void 0!==t&&(this.unbind("EnterFrame",t.handler),delete this._collisionData[n])}return this},resetHitChecks:function(){var t,e=arguments,i=0;if(0===e.length)for(t in this._collisionData)this._collisionData[t].occurring=!1;for(1===e.length&&(e=e[0].split(/\s*,\s*/));i<e.length;++i){var n=e[i];t=this._collisionData[n],void 0!==t&&(t.occurring=!1)}return this},_SAT:function(t,e){for(var i,n,r,o,s,a,l,c,u,h=0,p=t.points,m=e.points,f=p.length/2,_=m.length/2,d=0,y=0,g=-1/0,v=null,x=null;h<f;h++){for(u=h===f-1?0:h+1,d=-(p[2*h+1]-p[2*u+1]),y=p[2*h]-p[2*u],n=Math.sqrt(d*d+y*y),d/=n,y/=n,r=o=1/0,s=a=-1/0,i=0;i<f;++i)c=p[2*i]*d+p[2*i+1]*y,c>s&&(s=c),c<r&&(r=c);for(i=0;i<_;++i)c=m[2*i]*d+m[2*i+1]*y,c>a&&(a=c),c<o&&(o=c);if(r<o?(l=o-s,d=-d,y=-y):l=r-a,l>=0)return!1;l>g&&(g=l,v=d,x=y)}for(h=0;h<_;h++){for(u=h===_-1?0:h+1,d=-(m[2*h+1]-m[2*u+1]),y=m[2*h]-m[2*u],n=Math.sqrt(d*d+y*y),d/=n,y/=n,r=o=1/0,s=a=-1/0,i=0;i<f;++i)c=p[2*i]*d+p[2*i+1]*y,c>s&&(s=c),c<r&&(r=c);for(i=0;i<_;++i)c=m[2*i]*d+m[2*i+1]*y,c>a&&(a=c),c<o&&(o=c);if(r<o?(l=o-s,d=-d,y=-y):l=r-a,l>=0)return!1;l>g&&(g=l,v=d,x=y)}return{overlap:g,normal:{x:v,y:x}}}})},{"../core/core.js":9}],46:[function(t,e,i){var n=t("../core/core.js");n.math={abs:function(t){return t<0?-t:t},amountOf:function(t,e,i){return e<i?(t-e)/(i-e):(t-i)/(e-i)},clamp:function(t,e,i){return t>i?i:t<e?e:t},degToRad:function(t){return t*Math.PI/180},distance:function(t,e,i,r){var o=n.math.squaredDistance(t,e,i,r);return Math.sqrt(parseFloat(o))},lerp:function(t,e,i){return t+(e-t)*i},negate:function(t){return Math.random()<t?-1:1},radToDeg:function(t){return 180*t/Math.PI},randomElementOfArray:function(t){return t[Math.floor(t.length*Math.random())]},randomInt:function(t,e){return t+Math.floor((1+e-t)*Math.random())},randomNumber:function(t,e){return t+(e-t)*Math.random()},squaredDistance:function(t,e,i,n){return(t-i)*(t-i)+(e-n)*(e-n)},withinRange:function(t,e,i){return t>=e&&t<=i}},n.math.Vector2D=function(){function t(e,i){if(e instanceof t)this.x=e.x,this.y=e.y;else if(2===arguments.length)this.x=e,this.y=i;else if(arguments.length>0)throw"Unexpected number of arguments for Vector2D()"}return t.prototype.x=0,t.prototype.y=0,t.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},t.prototype.angleBetween=function(t){return Math.atan2(this.x*t.y-this.y*t.x,this.x*t.x+this.y*t.y)},t.prototype.angleTo=function(t){return Math.atan2(t.y-this.y,t.x-this.x)},t.prototype.clone=function(){return new t(this)},t.prototype.distance=function(t){return Math.sqrt((t.x-this.x)*(t.x-this.x)+(t.y-this.y)*(t.y-this.y))},t.prototype.distanceSq=function(t){return(t.x-this.x)*(t.x-this.x)+(t.y-this.y)*(t.y-this.y)},t.prototype.divide=function(t){return this.x/=t.x,this.y/=t.y,this},t.prototype.dotProduct=function(t){return this.x*t.x+this.y*t.y},t.prototype.crossProduct=function(t){return this.x*t.y-this.y*t.x},t.prototype.equals=function(e){return e instanceof t&&this.x===e.x&&this.y===e.y},t.prototype.perpendicular=function(e){return e=e||new t,e.setValues(-this.y,this.x)},t.prototype.getNormal=function(e,i){return i=i||new t,i.setValues(e.y-this.y,this.x-e.x).normalize()},t.prototype.isZero=function(){return 0===this.x&&0===this.y},t.prototype.magnitude=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},t.prototype.magnitudeSq=function(){return this.x*this.x+this.y*this.y},t.prototype.multiply=function(t){return this.x*=t.x,this.y*=t.y,this},t.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this},t.prototype.normalize=function(){var t=Math.sqrt(this.x*this.x+this.y*this.y);return 0===t?(this.x=1,this.y=0):(this.x/=t,this.y/=t),this},t.prototype.scale=function(t,e){return void 0===e&&(e=t),this.x*=t,this.y*=e,this},t.prototype.scaleToMagnitude=function(t){var e=t/this.magnitude();return this.x*=e,this.y*=e,this},t.prototype.setValues=function(e,i){return e instanceof t?(this.x=e.x,this.y=e.y):(this.x=e,this.y=i),this},t.prototype.subtract=function(t){return this.x-=t.x,this.y-=t.y,this},t.prototype.toString=function(){return"Vector2D("+this.x+", "+this.y+")"},t.prototype.translate=function(t,e){return void 0===e&&(e=t),this.x+=t,this.y+=e,this},t.tripleProduct=function(t,e,i,r){r=r||new n.math.Vector2D;var o=t.dotProduct(i),s=e.dotProduct(i);return r.setValues(e.x*o-t.x*s,e.y*o-t.y*s)},t}(),n.math.Matrix2D=function(){function t(e,i,n,r,o,s){if(e instanceof t)this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.e=e.e,this.f=e.f;else if(6===arguments.length)this.a=e,this.b=i,this.c=n,this.d=r,this.e=o,this.f=s;else if(arguments.length>0)throw"Unexpected number of arguments for Matrix2D()"}return t.prototype.a=1,t.prototype.b=0,t.prototype.c=0,t.prototype.d=1,t.prototype.e=0,t.prototype.f=0,t.prototype.apply=function(t){var e=t.x;return t.x=e*this.a+t.y*this.c+this.e,t.y=e*this.b+t.y*this.d+this.f,t},t.prototype.clone=function(){return new t(this)},t.prototype.combine=function(t){var e=this.a;return this.a=e*t.a+this.b*t.c,this.b=e*t.b+this.b*t.d,e=this.c,this.c=e*t.a+this.d*t.c,this.d=e*t.b+this.d*t.d,e=this.e,this.e=e*t.a+this.f*t.c+t.e,this.f=e*t.b+this.f*t.d+t.f,this},t.prototype.equals=function(e){return e instanceof t&&this.a===e.a&&this.b===e.b&&this.c===e.c&&this.d===e.d&&this.e===e.e&&this.f===e.f},t.prototype.determinant=function(){return this.a*this.d-this.b*this.c},t.prototype.invert=function(){var t=this.determinant();if(0!==t){var e={a:this.a,b:this.b,c:this.c,d:this.d,e:this.e,f:this.f};this.a=e.d/t,this.b=-e.b/t,this.c=-e.c/t,this.d=e.a/t,this.e=(e.c*e.f-e.e*e.d)/t,this.f=(e.e*e.b-e.a*e.f)/t}return this},t.prototype.isIdentity=function(){return 1===this.a&&0===this.b&&0===this.c&&1===this.d&&0===this.e&&0===this.f},t.prototype.isInvertible=function(){return 0!==this.determinant()},t.prototype.preRotate=function(t){var e=Math.cos(t),i=Math.sin(t),n=this.a;return this.a=e*n-i*this.b,this.b=i*n+e*this.b,n=this.c,this.c=e*n-i*this.d,this.d=i*n+e*this.d,this},t.prototype.preScale=function(t,e){return void 0===e&&(e=t),this.a*=t,this.b*=e,this.c*=t,this.d*=e,this},t.prototype.preTranslate=function(t,e){return"number"==typeof t?(this.e+=t,this.f+=e):(this.e+=t.x,this.f+=t.y),this},t.prototype.rotate=function(t){var e=Math.cos(t),i=Math.sin(t),n=this.a;return this.a=e*n-i*this.b,this.b=i*n+e*this.b,n=this.c,this.c=e*n-i*this.d,this.d=i*n+e*this.d,n=this.e,this.e=e*n-i*this.f,this.f=i*n+e*this.f,this},t.prototype.scale=function(t,e){return void 0===e&&(e=t),this.a*=t,this.b*=e,this.c*=t,this.d*=e,this.e*=t,this.f*=e,this},t.prototype.setValues=function(e,i,n,r,o,s){return e instanceof t?(this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.e=e.e,this.f=e.f):(this.a=e,this.b=i,this.c=n,this.d=r,this.e=o,this.f=s),this},t.prototype.toString=function(){return"Matrix2D(["+this.a+", "+this.c+", "+this.e+"] ["+this.b+", "+this.d+", "+this.f+"] [0, 0, 1])"},t.prototype.translate=function(t,e){return"number"==typeof t?(this.e+=this.a*t+this.c*e,this.f+=this.b*t+this.d*e):(this.e+=this.a*t.x+this.c*t.y,this.f+=this.b*t.x+this.d*t.y),this},t}()},{"../core/core.js":9}],47:[function(t,e,i){var n=t("../core/core.js"),r=function(t,e,i,r){var o=e+i,s="_"+o,a={key:"",oldValue:0};r?n.defineField(t,o,function(){return this[s]},function(t){var e=this[s];t!==e&&(this[s]=t,a.key=o,a.oldValue=e,this.trigger("MotionChange",a))}):n.defineField(t,o,function(){return this[s]},function(t){}),Object.defineProperty(t,s,{value:0,writable:!0,enumerable:!1,configurable:!1})},o=function(t,e,i,r){var o=e+"x",s=e+"y",a="_"+o,l="_"+s;return i?(n.defineField(r,"x",function(){return t[a]},function(e){t[o]=e}),n.defineField(r,"y",function(){return t[l]},function(e){t[s]=e})):(n.defineField(r,"x",function(){return t[a]},function(t){}),n.defineField(r,"y",function(){return t[l]},function(t){})),Object.seal&&Object.seal(r),r};n.c("AngularMotion",{_vrotation:0,_arotation:0,_drotation:0,init:function(){this.requires("2D"),r(this,"v","rotation",!0),r(this,"a","rotation",!0),r(this,"d","rotation",!1),this.__oldRotationDirection=0,this.bind("EnterFrame",this._angularMotionTick)},remove:function(t){this.unbind("EnterFrame",this._angularMotionTick)},resetAngularMotion:function(){return this._drotation=0,this.vrotation=0,this.arotation=0,this},_angularMotionTick:function(t){var e=t.dt/1e3,i=this._rotation,n=this._vrotation,r=this._arotation,o=i+n*e+.5*r*e*e;this.vrotation=n+r*e;var s=this._vrotation,a=s?s<0?-1:1:0;this.__oldRotationDirection!==a&&(this.__oldRotationDirection=a,this.trigger("NewRotationDirection",a)),this._drotation=o-i,0!==this._drotation&&(this.rotation=o,this.trigger("Rotated",i))}}),n.c("Motion",{_vx:0,_vy:0,_ax:0,_ay:0,_dx:0,_dy:0,init:function(){this.requires("2D"),r(this,"v","x",!0),r(this,"v","y",!0),this._velocity=o(this,"v",!0,new n.math.Vector2D),r(this,"a","x",!0),r(this,"a","y",!0),this._acceleration=o(this,"a",!0,new n.math.Vector2D),r(this,"d","x",!1),r(this,"d","y",!1),this._motionDelta=o(this,"d",!1,new n.math.Vector2D),this.__movedEvent={axis:"",oldValue:0},this.__oldDirection={x:0,y:0},this.bind("EnterFrame",this._linearMotionTick)},remove:function(t){this.unbind("EnterFrame",this._linearMotionTick)},resetMotion:function(){return this.vx=0,this.vy=0,this.ax=0,this.ay=0,this._dx=0,this._dy=0,this},motionDelta:function(){return this._motionDelta},velocity:function(){return this._velocity},acceleration:function(){return this._acceleration},ccdbr:function(t){var e=this._cbr||this._mbr||this,i=this._dx,n=this._dy,r=0,o=0,s=i>0?r=i:-i,a=n>0?o=n:-n;return t=t||{},t._x=e._x-r,t._y=e._y-o,t._w=e._w+s,t._h=e._h+a,t},_linearMotionTick:function(t){var e=t.dt/1e3,i=this._x,n=this._vx,r=this._ax,o=this._y,s=this._vy,a=this._ay,l=i+n*e+.5*r*e*e,c=o+s*e+.5*a*e*e;this.vx=n+r*e,this.vy=s+a*e;var u=this.__oldDirection,h=this._vx,p=h?h<0?-1:1:0,m=this._vy,f=m?m<0?-1:1:0;u.x===p&&u.y===f||(u.x=p,u.y=f,this.trigger("NewDirection",u));var _=this.__movedEvent;this._dx=l-i,this._dy=c-o,0!==this._dx&&(this.x=l,_.axis="x",_.oldValue=i,this.trigger("Moved",_)),0!==this._dy&&(this.y=c,_.axis="y",_.oldValue=o,this.trigger("Moved",_))}})},{"../core/core.js":9}],48:[function(t,e,i){var n=t("../core/core.js");n.c("Supportable",{_ground:null,_groundComp:null,_preventGroundTunneling:!1,canLand:!0,init:function(){this.requires("2D"),this.__area={_x:0,_y:0,_w:0,_h:0},this.defineField("ground",function(){return this._ground},function(t){})},remove:function(t){this.unbind("EnterFrame",this._detectGroundTick)},startGroundDetection:function(t){return t&&(this._groundComp=t),this.uniqueBind("EnterFrame",this._detectGroundTick),this},stopGroundDetection:function(){return this.unbind("EnterFrame",this._detectGroundTick),this},preventGroundTunneling:function(t){return void 0===t&&(t=!0),t&&this.requires("Motion"),this._preventGroundTunneling=t,this},_detectGroundTick:function(){var t,e=this._groundComp,i=this._ground,r=n.rectManager.overlap;if(this._preventGroundTunneling)t=this.ccdbr(this.__area);else{var o=this._cbr||this._mbr||this;t=this.__area,t._x=o._x,t._y=o._y,t._w=o._w,t._h=o._h}if(t._h++,i){var s=i._cbr||i._mbr||i;i.__c[e]&&n(i[0])===i&&r(s,t)||(this._ground=null,this.trigger("LiftedOffGround",i),i=null)}if(!i)for(var a,l,c=n.map.search(t,!1),u=0,h=c.length;u<h;++u)if(a=c[u],l=a._cbr||a._mbr||a,a!==this&&a.__c[e]&&r(l,t)&&(this.canLand=!0,this.trigger("CheckLanding",a),this.canLand)){this._ground=i=a,this.y=i._y-this._h,this._x>i._x+i._w?this.x=i._x+i._w-1:this._x+this._w<i._x&&(this.x=i._x-this._w+1),this.trigger("LandedOnGround",i);break}}}),n.c("GroundAttacher",{_groundAttach:function(t){t.attach(this)},_groundDetach:function(t){t.detach(this)},init:function(){this.requires("Supportable"),this.bind("LandedOnGround",this._groundAttach),this.bind("LiftedOffGround",this._groundDetach)},remove:function(t){this.unbind("LandedOnGround",this._groundAttach),this.unbind("LiftedOffGround",this._groundDetach)}}),n.c("Gravity",{_gravityConst:500,_gravityActive:!1,init:function(){this.requires("2D, Supportable, Motion"),this.bind("LiftedOffGround",this._startGravity),this.bind("LandedOnGround",this._stopGravity)},remove:function(t){this.unbind("LiftedOffGround",this._startGravity),this.unbind("LandedOnGround",this._stopGravity)},_gravityCheckLanding:function(t){this._dy<0&&(this.canLand=!1)},gravity:function(t){return this.uniqueBind("CheckLanding",this._gravityCheckLanding),this.startGroundDetection(t),this._startGravity(),this},antigravity:function(){return this._stopGravity(),this.stopGroundDetection(),this.unbind("CheckLanding",this._gravityCheckLanding),this},gravityConst:function(t){return this._gravityActive&&(this.ay-=this._gravityConst,this.ay+=t),this._gravityConst=t,this},_startGravity:function(){this._gravityActive||(this._gravityActive=!0,this.ay+=this._gravityConst)},_stopGravity:function(){this._gravityActive&&(this._gravityActive=!1,this.ay=0,this.vy=0)}})},{"../core/core.js":9}],49:[function(t,e,i){t("../core/core.js").extend({rectManager:{merge:function(t,e,i){return void 0===i&&(i={}),i._h=Math.max(t._y+t._h,e._y+e._h),i._w=Math.max(t._x+t._w,e._x+e._w),i._x=Math.min(t._x,e._x),i._y=Math.min(t._y,e._y),i._w-=i._x,i._h-=i._y,i},overlap:function(t,e){return t._x<e._x+e._w&&t._x+t._w>e._x&&t._y<e._y+e._h&&t._y+t._h>e._y},integerBounds:function(t){return t._w=t._x+t._w,t._h=t._y+t._h,t._x=t._x>0?0|t._x:(0|t._x)-1,t._y=t._y>0?0|t._y:(0|t._y)-1,t._w-=t._x,t._h-=t._y,t._w=t._w===(0|t._w)?t._w:1+(0|t._w),t._h=t._h===(0|t._h)?t._h:1+(0|t._h),t},mergeSet:function(t){for(var e=0;e<t.length-1;)this.overlap(t[e],t[e+1])?(this.merge(t[e],t[e+1],t[e]),t.splice(e+1,1),e>0&&e--):e++;return t},boundingRect:function(t){if(t&&t.length){var e,i,n=1,r=t.length,o=t[0];for(o=[o._x,o._y,o._x+o._w,o._y+o._h];n<r;)e=t[n],i=[e._x,e._y,e._x+e._w,e._y+e._h],i[0]<o[0]&&(o[0]=i[0]),i[1]<o[1]&&(o[1]=i[1]),i[2]>o[2]&&(o[2]=i[2]),i[3]>o[3]&&(o[3]=i[3]),n++;return i=o,o={_x:i[0],_y:i[1],_w:i[2]-i[0],_h:i[3]-i[1]}}},_pool:function(){var t=[],e=0;return{get:function(i,n,r,o){t.length<=e&&t.push({});var s=t[e++];return s._x=i,s._y=n,s._w=r,s._h=o,s},copy:function(i){t.length<=e&&t.push({});var n=t[e++];return n._x=i._x,n._y=i._y,n._w=i._w,n._h=i._h,n},recycle:function(t){e--}}}()}})},{"../core/core.js":9}],50:[function(t,e,i){function n(t,e,i){this.keys=t,this.map=i,this.obj=e}var r,o=function(t){r=t||64,this.map={},this.boundsDirty=!1,this.boundsHash={max:{x:-1/0,y:-1/0},min:{x:1/0,y:1/0}},this.boundsCoords={max:{x:-1/0,y:-1/0},min:{x:1/0,y:1/0}}},a={};o.prototype={insert:function(t){var e,i,r=o.key(t),s=new n(r,t,this),a=0;for(a=r.x1;a<=r.x2;a++)for(e=r.y1;e<=r.y2;e++)i=a<<16^e,this.map[i]||(this.map[i]=[]),this.map[i].push(t);return this.boundsDirty=!0,s},search:function(t,e){var i,n,r,s,l,c=o.key(t,a),u=[];for(void 0===e&&(e=!0),i=c.x1;i<=c.x2;i++)for(n=c.y1;n<=c.y2;n++)if(l=this.map[i<<16^n])for(r=0;r<l.length;r++)u.push(l[r]);if(e){var h,p,m=[],f={};for(i=0,s=u.length;i<s;i++)(h=u[i])&&(p=h[0],h=h._cbr||h._mbr||h,!f[p]&&h._x<t._x+t._w&&h._x+h._w>t._x&&h._y<t._y+t._h&&h._y+h._h>t._y&&(f[p]=u[i]));for(h in f)m.push(f[h]);return m}return u},remove:function(t){var e,i,n=t.keys,r=t.obj,o=0;for(o=n.x1;o<=n.x2;o++)for(e=n.y1;e<=n.y2;e++)if(i=o<<16^e,this.map[i]){var s,a=this.map[i],l=a.length;for(s=0;s<l;s++)a[s]&&a[s][0]===r[0]&&a.splice(s,1)}this.boundsDirty=!0},refresh:function(t){var e,i,n,r,s,a=t.keys,l=t.obj;for(i=a.x1;i<=a.x2;i++)for(n=a.y1;n<=a.y2;n++)if(e=this.map[i<<16^n])for(s=e.length,r=0;r<s;r++)e[r]&&e[r][0]===l[0]&&e.splice(r,1);for(o.key(l,a),i=a.x1;i<=a.x2;i++)for(n=a.y1;n<=a.y2;n++)e=this.map[i<<16^n],e||(e=this.map[i<<16^n]=[]),e.push(l);return this.boundsDirty=!0,t},boundaries:function(){return this._updateBoundaries(),this.boundsCoords},_keyBoundaries:function(){return this._updateBoundaries(),this.boundsHash},_updateBoundaries:function(){if(this.boundsDirty){var t=this.boundsHash;t.max.x=-1/0,t.max.y=-1/0,t.min.x=1/0,t.min.y=1/0;var e=this.boundsCoords;e.max.x=-1/0,e.max.y=-1/0,e.min.x=1/0,e.min.y=1/0;var i,n;for(var r in this.map)if(this.map[r].length){var o=r>>16,a=r<<16>>16;if(a<0&&(o^=-1),o>=t.max.x){t.max.x=o;for(i in this.map[r])n=this.map[r][i],"object"===(void 0===n?"undefined":s(n))&&"requires"in n&&(e.max.x=Math.max(e.max.x,n.x+n.w))}if(o<=t.min.x){t.min.x=o;for(i in this.map[r])n=this.map[r][i],"object"===(void 0===n?"undefined":s(n))&&"requires"in n&&(e.min.x=Math.min(e.min.x,n.x))}if(a>=t.max.y){t.max.y=a;for(i in this.map[r])n=this.map[r][i],"object"===(void 0===n?"undefined":s(n))&&"requires"in n&&(e.max.y=Math.max(e.max.y,n.y+n.h))}if(a<=t.min.y){t.min.y=a;for(i in this.map[r])n=this.map[r][i],"object"===(void 0===n?"undefined":s(n))&&"requires"in n&&(e.min.y=Math.min(e.min.y,n.y))}}this.boundsDirty=!1}},traverseRay:function(t,e,i){var n=e.x,s=e.y;t={_x:t._x,_y:t._y,_w:0,_h:0};var l,c=this._keyBoundaries(),u=o.key(t,a),h=u.x1,p=u.y1,m=c.min.x,f=c.min.y,_=c.max.x,d=c.max.y,y=n>0?1:n<0?-1:0,g=s>0?1:s<0?-1:0,v=n>=0?(h+1)*r:h*r,x=s>=0?(p+1)*r:p*r,b=-1/0,w=0,C=0,S=1/0,A=1/0;for(0!==n&&(l=1/n,S=(v-t._x)*l,w=r*y*l),0!==s&&(l=1/s,A=(x-t._y)*l,C=r*g*l);1===y&&h<m&&m!==1/0||-1===y&&h>_&&_!==-1/0||1===g&&p<f&&f!==1/0||-1===g&&p>d&&d!==-1/0;)S<A?(b=S,h+=y,S+=w):(b=A,p+=g,A+=C);for(var D;m<=h&&h<=_&&f<=p&&p<=d;){if(D=this.map[h<<16^p])for(var M=0;M<D.length;M++)if(i(D[M],b))return;S<A?(b=S,h+=y,S+=w):(b=A,p+=g,A+=C)}}},o.key=function(t,e){return t=t._cbr||t._mbr||t,e=e||{},e.x1=Math.floor(t._x/r),e.y1=Math.floor(t._y/r),e.x2=Math.floor((t._w+t._x)/r),e.y2=Math.floor((t._h+t._y)/r),e},o.hash=function(t){return t.x1+" "+t.y1+" "+t.x2+" "+t.y2},n.prototype={update:function(t){o.hash(o.key(t,a))!==o.hash(this.keys)&&this.map.refresh(this)}},e.exports=o},{}]},{},[19])},function(t,e,i){(function(e){t.exports=e.$=i(112)}).call(e,i(8))},function(t,e,i){(function(e){t.exports=e._=i(113)}).call(e,i(8))},,function(t,e,i){i(101),i(102),i(100),i(99)},,,,,,,,function(t,e,i){(function(e){t.exports=e.jQuery=i(9)}).call(e,i(8))},function(t,e,i){(function(t,n){var r;(function(){function o(t,e){return t.set(e[0],e[1]),t}function s(t,e){return t.add(e),t}function a(t,e,i){switch(i.length){case 0:return t.call(e);case 1:return t.call(e,i[0]);case 2:return t.call(e,i[0],i[1]);case 3:return t.call(e,i[0],i[1],i[2])}return t.apply(e,i)}function l(t,e,i,n){for(var r=-1,o=null==t?0:t.length;++r<o;){var s=t[r];e(n,s,i(s),t)}return n}function c(t,e){for(var i=-1,n=null==t?0:t.length;++i<n&&!1!==e(t[i],i,t););return t}function u(t,e){for(var i=null==t?0:t.length;i--&&!1!==e(t[i],i,t););return t}function h(t,e){for(var i=-1,n=null==t?0:t.length;++i<n;)if(!e(t[i],i,t))return!1;return!0}function p(t,e){for(var i=-1,n=null==t?0:t.length,r=0,o=[];++i<n;){var s=t[i];e(s,i,t)&&(o[r++]=s)}return o}function m(t,e){return!!(null==t?0:t.length)&&S(t,e,0)>-1}function f(t,e,i){for(var n=-1,r=null==t?0:t.length;++n<r;)if(i(e,t[n]))return!0;return!1}function _(t,e){for(var i=-1,n=null==t?0:t.length,r=Array(n);++i<n;)r[i]=e(t[i],i,t);return r}function d(t,e){for(var i=-1,n=e.length,r=t.length;++i<n;)t[r+i]=e[i];return t}function y(t,e,i,n){var r=-1,o=null==t?0:t.length;for(n&&o&&(i=t[++r]);++r<o;)i=e(i,t[r],r,t);return i}function g(t,e,i,n){var r=null==t?0:t.length;for(n&&r&&(i=t[--r]);r--;)i=e(i,t[r],r,t);return i}function v(t,e){for(var i=-1,n=null==t?0:t.length;++i<n;)if(e(t[i],i,t))return!0;return!1}function x(t){return t.split("")}function b(t){return t.match(Oe)||[]}function w(t,e,i){var n;return i(t,function(t,i,r){if(e(t,i,r))return n=i,!1}),n}function C(t,e,i,n){for(var r=t.length,o=i+(n?1:-1);n?o--:++o<r;)if(e(t[o],o,t))return o;return-1}function S(t,e,i){return e===e?Y(t,e,i):C(t,D,i)}function A(t,e,i,n){for(var r=i-1,o=t.length;++r<o;)if(n(t[r],e))return r;return-1}function D(t){return t!==t}function M(t,e){var i=null==t?0:t.length;return i?B(t,e)/i:Rt}function T(t){return function(e){return null==e?rt:e[t]}}function k(t){return function(e){return null==t?rt:t[e]}}function I(t,e,i,n,r){return r(t,function(t,r,o){i=n?(n=!1,t):e(i,t,r,o)}),i}function P(t,e){var i=t.length;for(t.sort(e);i--;)t[i]=t[i].value;return t}function B(t,e){for(var i,n=-1,r=t.length;++n<r;){var o=e(t[n]);o!==rt&&(i=i===rt?o:i+o)}return i}function E(t,e){for(var i=-1,n=Array(t);++i<t;)n[i]=e(i);return n}function L(t,e){return _(e,function(e){return[e,t[e]]})}function R(t){return function(e){return t(e)}}function V(t,e){return _(e,function(e){return t[e]})}function O(t,e){return t.has(e)}function F(t,e){for(var i=-1,n=t.length;++i<n&&S(e,t[i],0)>-1;);return i}function N(t,e){for(var i=t.length;i--&&S(e,t[i],0)>-1;);return i}function j(t,e){for(var i=t.length,n=0;i--;)t[i]===e&&++n;return n}function G(t){return"\\"+bi[t]}function z(t,e){return null==t?rt:t[e]}function J(t){return pi.test(t)}function H(t){return mi.test(t)}function U(t){for(var e,i=[];!(e=t.next()).done;)i.push(e.value);return i}function q(t){var e=-1,i=Array(t.size);return t.forEach(function(t,n){i[++e]=[n,t]}),i}function W(t,e){return function(i){return t(e(i))}}function $(t,e){for(var i=-1,n=t.length,r=0,o=[];++i<n;){var s=t[i];s!==e&&s!==ut||(t[i]=ut,o[r++]=i)}return o}function K(t){var e=-1,i=Array(t.size);return t.forEach(function(t){i[++e]=t}),i}function X(t){var e=-1,i=Array(t.size);return t.forEach(function(t){i[++e]=[t,t]}),i}function Y(t,e,i){for(var n=i-1,r=t.length;++n<r;)if(t[n]===e)return n;return-1}function Z(t,e,i){for(var n=i+1;n--;)if(t[n]===e)return n;return n}function Q(t){return J(t)?et(t):Fi(t)}function tt(t){return J(t)?it(t):x(t)}function et(t){for(var e=ui.lastIndex=0;ui.test(t);)++e;return e}function it(t){return t.match(ui)||[]}function nt(t){return t.match(hi)||[]}var rt,ot=200,st="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",at="Expected a function",lt="__lodash_hash_undefined__",ct=500,ut="__lodash_placeholder__",ht=1,pt=2,mt=4,ft=1,_t=2,dt=1,yt=2,gt=4,vt=8,xt=16,bt=32,wt=64,Ct=128,St=256,At=512,Dt=30,Mt="...",Tt=800,kt=16,It=1,Pt=2,Bt=1/0,Et=9007199254740991,Lt=1.7976931348623157e308,Rt=NaN,Vt=4294967295,Ot=Vt-1,Ft=Vt>>>1,Nt=[["ary",Ct],["bind",dt],["bindKey",yt],["curry",vt],["curryRight",xt],["flip",At],["partial",bt],["partialRight",wt],["rearg",St]],jt="[object Arguments]",Gt="[object Array]",zt="[object AsyncFunction]",Jt="[object Boolean]",Ht="[object Date]",Ut="[object DOMException]",qt="[object Error]",Wt="[object Function]",$t="[object GeneratorFunction]",Kt="[object Map]",Xt="[object Number]",Yt="[object Null]",Zt="[object Object]",Qt="[object Proxy]",te="[object RegExp]",ee="[object Set]",ie="[object String]",ne="[object Symbol]",re="[object Undefined]",oe="[object WeakMap]",se="[object WeakSet]",ae="[object ArrayBuffer]",le="[object DataView]",ce="[object Float32Array]",ue="[object Float64Array]",he="[object Int8Array]",pe="[object Int16Array]",me="[object Int32Array]",fe="[object Uint8Array]",_e="[object Uint8ClampedArray]",de="[object Uint16Array]",ye="[object Uint32Array]",ge=/\b__p \+= '';/g,ve=/\b(__p \+=) '' \+/g,xe=/(__e\(.*?\)|\b__t\)) \+\n'';/g,be=/&(?:amp|lt|gt|quot|#39);/g,we=/[&<>"']/g,Ce=RegExp(be.source),Se=RegExp(we.source),Ae=/<%=([\s\S]+?)%>/g,De=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Me=/^\w*$/,Te=/^\./,ke=/[\\^$.*+?()[\]{}|]/g,Ie=RegExp(ke.source),Pe=/^\s+|\s+$/g,Be=/^\s+/,Ee=/\s+$/,Le=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Re=/\{\n\/\* \[wrapped with (.+)\] \*/,Ve=/,? & /,Oe=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Fe=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ne=/\w*$/,je=/^[-+]0x[0-9a-f]+$/i,Ge=/^0b[01]+$/i,ze=/^\[object .+?Constructor\]$/,Je=/^0o[0-7]+$/i,He=/^(?:0|[1-9]\d*)$/,Ue=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,qe=/($^)/,We=/['\n\r\u2028\u2029\\]/g,$e="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Ke="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Xe="["+$e+"]",Ye="[a-z\\xdf-\\xf6\\xf8-\\xff]",Ze="[^\\ud800-\\udfff"+Ke+"\\d+\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",Qe="\\ud83c[\\udffb-\\udfff]",ti="(?:\\ud83c[\\udde6-\\uddff]){2}",ei="[\\ud800-\\udbff][\\udc00-\\udfff]",ii="[A-Z\\xc0-\\xd6\\xd8-\\xde]",ni="(?:"+Xe+"|"+Qe+")?",ri="(?:\\u200d(?:"+["[^\\ud800-\\udfff]",ti,ei].join("|")+")[\\ufe0e\\ufe0f]?"+ni+")*",oi="[\\ufe0e\\ufe0f]?"+ni+ri,si="(?:"+["[\\u2700-\\u27bf]",ti,ei].join("|")+")"+oi,ai="(?:"+["[^\\ud800-\\udfff]"+Xe+"?",Xe,ti,ei,"[\\ud800-\\udfff]"].join("|")+")",li=RegExp("['’]","g"),ci=RegExp(Xe,"g"),ui=RegExp(Qe+"(?="+Qe+")|"+ai+oi,"g"),hi=RegExp([ii+"?"+Ye+"+(?:['’](?:d|ll|m|re|s|t|ve))?(?="+["["+Ke+"]",ii,"$"].join("|")+")","(?:"+ii+"|"+Ze+")+(?:['’](?:D|LL|M|RE|S|T|VE))?(?="+["["+Ke+"]",ii+"(?:"+Ye+"|"+Ze+")","$"].join("|")+")",ii+"?(?:"+Ye+"|"+Ze+")+(?:['’](?:d|ll|m|re|s|t|ve))?",ii+"+(?:['’](?:D|LL|M|RE|S|T|VE))?","\\d*(?:(?:1ST|2ND|3RD|(?![123])\\dTH)\\b)","\\d*(?:(?:1st|2nd|3rd|(?![123])\\dth)\\b)","\\d+",si].join("|"),"g"),pi=RegExp("[\\u200d\\ud800-\\udfff"+$e+"\\ufe0e\\ufe0f]"),mi=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,fi=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],_i=-1,di={};di[ce]=di[ue]=di[he]=di[pe]=di[me]=di[fe]=di[_e]=di[de]=di[ye]=!0,di[jt]=di[Gt]=di[ae]=di[Jt]=di[le]=di[Ht]=di[qt]=di[Wt]=di[Kt]=di[Xt]=di[Zt]=di[te]=di[ee]=di[ie]=di[oe]=!1;var yi={};yi[jt]=yi[Gt]=yi[ae]=yi[le]=yi[Jt]=yi[Ht]=yi[ce]=yi[ue]=yi[he]=yi[pe]=yi[me]=yi[Kt]=yi[Xt]=yi[Zt]=yi[te]=yi[ee]=yi[ie]=yi[ne]=yi[fe]=yi[_e]=yi[de]=yi[ye]=!0,yi[qt]=yi[Wt]=yi[oe]=!1;var gi={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"},vi={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},xi={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},bi={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},wi=parseFloat,Ci=parseInt,Si="object"==typeof t&&t&&t.Object===Object&&t,Ai="object"==typeof self&&self&&self.Object===Object&&self,Di=Si||Ai||Function("return this")(),Mi="object"==typeof e&&e&&!e.nodeType&&e,Ti=Mi&&"object"==typeof n&&n&&!n.nodeType&&n,ki=Ti&&Ti.exports===Mi,Ii=ki&&Si.process,Pi=function(){try{return Ii&&Ii.binding&&Ii.binding("util")}catch(t){}}(),Bi=Pi&&Pi.isArrayBuffer,Ei=Pi&&Pi.isDate,Li=Pi&&Pi.isMap,Ri=Pi&&Pi.isRegExp,Vi=Pi&&Pi.isSet,Oi=Pi&&Pi.isTypedArray,Fi=T("length"),Ni=k(gi),ji=k(vi),Gi=k(xi),zi=function t(e){function i(t){if(el(t)&&!pp(t)&&!(t instanceof x)){if(t instanceof r)return t;if(pu.call(t,"__wrapped__"))return Zo(t)}return new r(t)}function n(){}function r(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=rt}function x(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Vt,this.__views__=[]}function k(){var t=new x(this.__wrapped__);return t.__actions__=Er(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=Er(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=Er(this.__views__),t}function Y(){if(this.__filtered__){var t=new x(this);t.__dir__=-1,t.__filtered__=!0}else t=this.clone(),t.__dir__*=-1;return t}function et(){var t=this.__wrapped__.value(),e=this.__dir__,i=pp(t),n=e<0,r=i?t.length:0,o=Co(0,r,this.__views__),s=o.start,a=o.end,l=a-s,c=n?a:s-1,u=this.__iteratees__,h=u.length,p=0,m=zu(l,this.__takeCount__);if(!i||!n&&r==l&&m==l)return fr(t,this.__actions__);var f=[];t:for(;l--&&p<m;){c+=e;for(var _=-1,d=t[c];++_<h;){var y=u[_],g=y.iteratee,v=y.type,x=g(d);if(v==Pt)d=x;else if(!x){if(v==It)continue t;break t}}f[p++]=d}return f}function it(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}function Oe(){this.__data__=Zu?Zu(null):{},this.size=0}function $e(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}function Ke(t){var e=this.__data__;if(Zu){var i=e[t];return i===lt?rt:i}return pu.call(e,t)?e[t]:rt}function Xe(t){var e=this.__data__;return Zu?e[t]!==rt:pu.call(e,t)}function Ye(t,e){var i=this.__data__;return this.size+=this.has(t)?0:1,i[t]=Zu&&e===rt?lt:e,this}function Ze(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}function Qe(){this.__data__=[],this.size=0}function ti(t){var e=this.__data__,i=Ui(e,t);return!(i<0)&&(i==e.length-1?e.pop():Du.call(e,i,1),--this.size,!0)}function ei(t){var e=this.__data__,i=Ui(e,t);return i<0?rt:e[i][1]}function ii(t){return Ui(this.__data__,t)>-1}function ni(t,e){var i=this.__data__,n=Ui(i,t);return n<0?(++this.size,i.push([t,e])):i[n][1]=e,this}function ri(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}function oi(){this.size=0,this.__data__={hash:new it,map:new($u||Ze),string:new it}}function si(t){var e=vo(this,t).delete(t);return this.size-=e?1:0,e}function ai(t){return vo(this,t).get(t)}function ui(t){return vo(this,t).has(t)}function hi(t,e){var i=vo(this,t),n=i.size;return i.set(t,e),this.size+=i.size==n?0:1,this}function pi(t){var e=-1,i=null==t?0:t.length;for(this.__data__=new ri;++e<i;)this.add(t[e])}function mi(t){return this.__data__.set(t,lt),this}function gi(t){return this.__data__.has(t)}function vi(t){var e=this.__data__=new Ze(t);this.size=e.size}function xi(){this.__data__=new Ze,this.size=0}function bi(t){var e=this.__data__,i=e.delete(t);return this.size=e.size,i}function Si(t){return this.__data__.get(t)}function Ai(t){return this.__data__.has(t)}function Mi(t,e){var i=this.__data__;if(i instanceof Ze){var n=i.__data__;if(!$u||n.length<ot-1)return n.push([t,e]),this.size=++i.size,this;i=this.__data__=new ri(n)}return i.set(t,e),this.size=i.size,this}function Ti(t,e){var i=pp(t),n=!i&&hp(t),r=!i&&!n&&fp(t),o=!i&&!n&&!r&&vp(t),s=i||n||r||o,a=s?E(t.length,ou):[],l=a.length;for(var c in t)!e&&!pu.call(t,c)||s&&("length"==c||r&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||Po(c,l))||a.push(c);return a}function Ii(t){var e=t.length;return e?t[Kn(0,e-1)]:rt}function Pi(t,e){return $o(Er(t),Yi(e,0,t.length))}function Fi(t){return $o(Er(t))}function Ji(t,e,i){(i===rt||Ga(t[e],i))&&(i!==rt||e in t)||Ki(t,e,i)}function Hi(t,e,i){var n=t[e];pu.call(t,e)&&Ga(n,i)&&(i!==rt||e in t)||Ki(t,e,i)}function Ui(t,e){for(var i=t.length;i--;)if(Ga(t[i][0],e))return i;return-1}function qi(t,e,i,n){return uh(t,function(t,r,o){e(n,t,i(t),o)}),n}function Wi(t,e){return t&&Lr(e,Vl(e),t)}function $i(t,e){return t&&Lr(e,Ol(e),t)}function Ki(t,e,i){"__proto__"==e&&Iu?Iu(t,e,{configurable:!0,enumerable:!0,value:i,writable:!0}):t[e]=i}function Xi(t,e){for(var i=-1,n=e.length,r=Zc(n),o=null==t;++i<n;)r[i]=o?rt:El(t,e[i]);return r}function Yi(t,e,i){return t===t&&(i!==rt&&(t=t<=i?t:i),e!==rt&&(t=t>=e?t:e)),t}function Zi(t,e,i,n,r,o){var s,a=e&ht,l=e&pt,u=e&mt;if(i&&(s=r?i(t,n,r,o):i(t)),s!==rt)return s;if(!tl(t))return t;var h=pp(t);if(h){if(s=Do(t),!a)return Er(t,s)}else{var p=wh(t),m=p==Wt||p==$t;if(fp(t))return br(t,a);if(p==Zt||p==jt||m&&!r){if(s=l||m?{}:Mo(t),!a)return l?Vr(t,$i(s,t)):Rr(t,Wi(s,t))}else{if(!yi[p])return r?t:{};s=To(t,p,Zi,a)}}o||(o=new vi);var f=o.get(t);if(f)return f;o.set(t,s);var _=u?l?fo:mo:l?Ol:Vl,d=h?rt:_(t);return c(d||t,function(n,r){d&&(r=n,n=t[r]),Hi(s,r,Zi(n,e,i,r,t,o))}),s}function Qi(t){var e=Vl(t);return function(i){return tn(i,t,e)}}function tn(t,e,i){var n=i.length;if(null==t)return!n;for(t=nu(t);n--;){var r=i[n],o=e[r],s=t[r];if(s===rt&&!(r in t)||!o(s))return!1}return!0}function en(t,e,i){if("function"!=typeof t)throw new su(at);return Ah(function(){t.apply(rt,i)},e)}function nn(t,e,i,n){var r=-1,o=m,s=!0,a=t.length,l=[],c=e.length;if(!a)return l;i&&(e=_(e,R(i))),n?(o=f,s=!1):e.length>=ot&&(o=O,s=!1,e=new pi(e));t:for(;++r<a;){var u=t[r],h=null==i?u:i(u);if(u=n||0!==u?u:0,s&&h===h){for(var p=c;p--;)if(e[p]===h)continue t;l.push(u)}else o(e,h,n)||l.push(u)}return l}function rn(t,e){var i=!0;return uh(t,function(t,n,r){return i=!!e(t,n,r)}),i}function on(t,e,i){for(var n=-1,r=t.length;++n<r;){var o=t[n],s=e(o);if(null!=s&&(a===rt?s===s&&!pl(s):i(s,a)))var a=s,l=o}return l}function sn(t,e,i,n){var r=t.length;for(i=gl(i),i<0&&(i=-i>r?0:r+i),n=n===rt||n>r?r:gl(n),n<0&&(n+=r),n=i>n?0:vl(n);i<n;)t[i++]=e;return t}function an(t,e){var i=[];return uh(t,function(t,n,r){e(t,n,r)&&i.push(t)}),i}function ln(t,e,i,n,r){var o=-1,s=t.length;for(i||(i=Io),r||(r=[]);++o<s;){var a=t[o];e>0&&i(a)?e>1?ln(a,e-1,i,n,r):d(r,a):n||(r[r.length]=a)}return r}function cn(t,e){return t&&ph(t,e,Vl)}function un(t,e){return t&&mh(t,e,Vl)}function hn(t,e){return p(e,function(e){return Ya(t[e])})}function pn(t,e){e=vr(e,t);for(var i=0,n=e.length;null!=t&&i<n;)t=t[Ko(e[i++])];return i&&i==n?t:rt}function mn(t,e,i){var n=e(t);return pp(t)?n:d(n,i(t))}function fn(t){return null==t?t===rt?re:Yt:ku&&ku in nu(t)?wo(t):zo(t)}function _n(t,e){return t>e}function dn(t,e){return null!=t&&pu.call(t,e)}function yn(t,e){return null!=t&&e in nu(t)}function gn(t,e,i){return t>=zu(e,i)&&t<Gu(e,i)}function vn(t,e,i){for(var n=i?f:m,r=t[0].length,o=t.length,s=o,a=Zc(o),l=1/0,c=[];s--;){var u=t[s];s&&e&&(u=_(u,R(e))),l=zu(u.length,l),a[s]=!i&&(e||r>=120&&u.length>=120)?new pi(s&&u):rt}u=t[0];var h=-1,p=a[0];t:for(;++h<r&&c.length<l;){var d=u[h],y=e?e(d):d;if(d=i||0!==d?d:0,!(p?O(p,y):n(c,y,i))){for(s=o;--s;){var g=a[s];if(!(g?O(g,y):n(t[s],y,i)))continue t}p&&p.push(y),c.push(d)}}return c}function xn(t,e,i,n){return cn(t,function(t,r,o){e(n,i(t),r,o)}),n}function bn(t,e,i){e=vr(e,t),t=Ho(t,e);var n=null==t?t:t[Ko(ys(e))];return null==n?rt:a(n,t,i)}function wn(t){return el(t)&&fn(t)==jt}function Cn(t){return el(t)&&fn(t)==ae}function Sn(t){return el(t)&&fn(t)==Ht}function An(t,e,i,n,r){return t===e||(null==t||null==e||!el(t)&&!el(e)?t!==t&&e!==e:Dn(t,e,i,n,An,r))}function Dn(t,e,i,n,r,o){var s=pp(t),a=pp(e),l=s?Gt:wh(t),c=a?Gt:wh(e);l=l==jt?Zt:l,c=c==jt?Zt:c;var u=l==Zt,h=c==Zt,p=l==c;if(p&&fp(t)){if(!fp(e))return!1;s=!0,u=!1}if(p&&!u)return o||(o=new vi),s||vp(t)?co(t,e,i,n,r,o):uo(t,e,l,i,n,r,o);if(!(i&ft)){var m=u&&pu.call(t,"__wrapped__"),f=h&&pu.call(e,"__wrapped__");if(m||f){var _=m?t.value():t,d=f?e.value():e;return o||(o=new vi),r(_,d,i,n,o)}}return!!p&&(o||(o=new vi),ho(t,e,i,n,r,o))}function Mn(t){return el(t)&&wh(t)==Kt}function Tn(t,e,i,n){var r=i.length,o=r,s=!n;if(null==t)return!o;for(t=nu(t);r--;){var a=i[r];if(s&&a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++r<o;){a=i[r];var l=a[0],c=t[l],u=a[1];if(s&&a[2]){if(c===rt&&!(l in t))return!1}else{var h=new vi;if(n)var p=n(c,u,l,t,e,h);if(!(p===rt?An(u,c,ft|_t,n,h):p))return!1}}return!0}function kn(t){return!(!tl(t)||Vo(t))&&(Ya(t)?gu:ze).test(Xo(t))}function In(t){return el(t)&&fn(t)==te}function Pn(t){return el(t)&&wh(t)==ee}function Bn(t){return el(t)&&Qa(t.length)&&!!di[fn(t)]}function En(t){return"function"==typeof t?t:null==t?Dc:"object"==typeof t?pp(t)?Nn(t[0],t[1]):Fn(t):Lc(t)}function Ln(t){if(!Oo(t))return ju(t);var e=[];for(var i in nu(t))pu.call(t,i)&&"constructor"!=i&&e.push(i);return e}function Rn(t){if(!tl(t))return Go(t);var e=Oo(t),i=[];for(var n in t)("constructor"!=n||!e&&pu.call(t,n))&&i.push(n);return i}function Vn(t,e){return t<e}function On(t,e){var i=-1,n=za(t)?Zc(t.length):[];return uh(t,function(t,r,o){n[++i]=e(t,r,o)}),n}function Fn(t){var e=xo(t);return 1==e.length&&e[0][2]?No(e[0][0],e[0][1]):function(i){return i===t||Tn(i,t,e)}}function Nn(t,e){return Eo(t)&&Fo(e)?No(Ko(t),e):function(i){var n=El(i,t);return n===rt&&n===e?Rl(i,t):An(e,n,ft|_t)}}function jn(t,e,i,n,r){t!==e&&ph(e,function(o,s){if(tl(o))r||(r=new vi),Gn(t,e,s,i,jn,n,r);else{var a=n?n(t[s],o,s+"",t,e,r):rt;a===rt&&(a=o),Ji(t,s,a)}},Ol)}function Gn(t,e,i,n,r,o,s){var a=t[i],l=e[i],c=s.get(l);if(c)return void Ji(t,i,c);var u=o?o(a,l,i+"",t,e,s):rt,h=u===rt;if(h){var p=pp(l),m=!p&&fp(l),f=!p&&!m&&vp(l);u=l,p||m||f?pp(a)?u=a:Ja(a)?u=Er(a):m?(h=!1,u=br(l,!0)):f?(h=!1,u=Tr(l,!0)):u=[]:cl(l)||hp(l)?(u=a,hp(a)?u=bl(a):(!tl(a)||n&&Ya(a))&&(u=Mo(l))):h=!1}h&&(s.set(l,u),r(u,l,n,o,s),s.delete(l)),Ji(t,i,u)}function zn(t,e){var i=t.length;if(i)return e+=e<0?i:0,Po(e,i)?t[e]:rt}function Jn(t,e,i){var n=-1;return e=_(e.length?e:[Dc],R(go())),P(On(t,function(t,i,r){return{criteria:_(e,function(e){return e(t)}),index:++n,value:t}}),function(t,e){return Ir(t,e,i)})}function Hn(t,e){return Un(t,e,function(e,i){return Rl(t,i)})}function Un(t,e,i){for(var n=-1,r=e.length,o={};++n<r;){var s=e[n],a=pn(t,s);i(a,s)&&er(o,vr(s,t),a)}return o}function qn(t){return function(e){return pn(e,t)}}function Wn(t,e,i,n){var r=n?A:S,o=-1,s=e.length,a=t;for(t===e&&(e=Er(e)),i&&(a=_(t,R(i)));++o<s;)for(var l=0,c=e[o],u=i?i(c):c;(l=r(a,u,l,n))>-1;)a!==t&&Du.call(a,l,1),Du.call(t,l,1);return t}function $n(t,e){for(var i=t?e.length:0,n=i-1;i--;){var r=e[i];if(i==n||r!==o){var o=r;Po(r)?Du.call(t,r,1):hr(t,r)}}return t}function Kn(t,e){return t+Ru(Uu()*(e-t+1))}function Xn(t,e,i,n){for(var r=-1,o=Gu(Lu((e-t)/(i||1)),0),s=Zc(o);o--;)s[n?o:++r]=t,t+=i;return s}function Yn(t,e){var i="";if(!t||e<1||e>Et)return i;do{e%2&&(i+=t),(e=Ru(e/2))&&(t+=t)}while(e);return i}function Zn(t,e){return Dh(Jo(t,e,Dc),t+"")}function Qn(t){return Ii(Kl(t))}function tr(t,e){var i=Kl(t);return $o(i,Yi(e,0,i.length))}function er(t,e,i,n){if(!tl(t))return t;e=vr(e,t);for(var r=-1,o=e.length,s=o-1,a=t;null!=a&&++r<o;){var l=Ko(e[r]),c=i;if(r!=s){var u=a[l];c=n?n(u,l,a):rt,c===rt&&(c=tl(u)?u:Po(e[r+1])?[]:{})}Hi(a,l,c),a=a[l]}return t}function ir(t){return $o(Kl(t))}function nr(t,e,i){var n=-1,r=t.length;e<0&&(e=-e>r?0:r+e),i=i>r?r:i,i<0&&(i+=r),r=e>i?0:i-e>>>0,e>>>=0;for(var o=Zc(r);++n<r;)o[n]=t[n+e];return o}function rr(t,e){var i;return uh(t,function(t,n,r){return!(i=e(t,n,r))}),!!i}function or(t,e,i){var n=0,r=null==t?n:t.length;if("number"==typeof e&&e===e&&r<=Ft){for(;n<r;){var o=n+r>>>1,s=t[o];null!==s&&!pl(s)&&(i?s<=e:s<e)?n=o+1:r=o}return r}return sr(t,e,Dc,i)}function sr(t,e,i,n){e=i(e);for(var r=0,o=null==t?0:t.length,s=e!==e,a=null===e,l=pl(e),c=e===rt;r<o;){var u=Ru((r+o)/2),h=i(t[u]),p=h!==rt,m=null===h,f=h===h,_=pl(h);if(s)var d=n||f;else d=c?f&&(n||p):a?f&&p&&(n||!m):l?f&&p&&!m&&(n||!_):!m&&!_&&(n?h<=e:h<e);d?r=u+1:o=u}return zu(o,Ot)}function ar(t,e){for(var i=-1,n=t.length,r=0,o=[];++i<n;){var s=t[i],a=e?e(s):s;if(!i||!Ga(a,l)){var l=a;o[r++]=0===s?0:s}}return o}function lr(t){return"number"==typeof t?t:pl(t)?Rt:+t}function cr(t){if("string"==typeof t)return t;if(pp(t))return _(t,cr)+"";if(pl(t))return lh?lh.call(t):"";var e=t+"";return"0"==e&&1/t==-Bt?"-0":e}function ur(t,e,i){var n=-1,r=m,o=t.length,s=!0,a=[],l=a;if(i)s=!1,r=f;else if(o>=ot){var c=e?null:gh(t);if(c)return K(c);s=!1,r=O,l=new pi}else l=e?[]:a;t:for(;++n<o;){var u=t[n],h=e?e(u):u;if(u=i||0!==u?u:0,s&&h===h){for(var p=l.length;p--;)if(l[p]===h)continue t;e&&l.push(h),a.push(u)}else r(l,h,i)||(l!==a&&l.push(h),a.push(u))}return a}function hr(t,e){return e=vr(e,t),null==(t=Ho(t,e))||delete t[Ko(ys(e))]}function pr(t,e,i,n){return er(t,e,i(pn(t,e)),n)}function mr(t,e,i,n){for(var r=t.length,o=n?r:-1;(n?o--:++o<r)&&e(t[o],o,t););return i?nr(t,n?0:o,n?o+1:r):nr(t,n?o+1:0,n?r:o)}function fr(t,e){var i=t;return i instanceof x&&(i=i.value()),y(e,function(t,e){return e.func.apply(e.thisArg,d([t],e.args))},i)}function _r(t,e,i){var n=t.length;if(n<2)return n?ur(t[0]):[];for(var r=-1,o=Zc(n);++r<n;)for(var s=t[r],a=-1;++a<n;)a!=r&&(o[r]=nn(o[r]||s,t[a],e,i));return ur(ln(o,1),e,i)}function dr(t,e,i){for(var n=-1,r=t.length,o=e.length,s={};++n<r;){var a=n<o?e[n]:rt;i(s,t[n],a)}return s}function yr(t){return Ja(t)?t:[]}function gr(t){return"function"==typeof t?t:Dc}function vr(t,e){return pp(t)?t:Eo(t,e)?[t]:Mh(Cl(t))}function xr(t,e,i){var n=t.length;return i=i===rt?n:i,!e&&i>=n?t:nr(t,e,i)}function br(t,e){if(e)return t.slice();var i=t.length,n=wu?wu(i):new t.constructor(i);return t.copy(n),n}function wr(t){var e=new t.constructor(t.byteLength);return new bu(e).set(new bu(t)),e}function Cr(t,e){var i=e?wr(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.byteLength)}function Sr(t,e,i){return y(e?i(q(t),ht):q(t),o,new t.constructor)}function Ar(t){var e=new t.constructor(t.source,Ne.exec(t));return e.lastIndex=t.lastIndex,e}function Dr(t,e,i){return y(e?i(K(t),ht):K(t),s,new t.constructor)}function Mr(t){return ah?nu(ah.call(t)):{}}function Tr(t,e){var i=e?wr(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.length)}function kr(t,e){if(t!==e){var i=t!==rt,n=null===t,r=t===t,o=pl(t),s=e!==rt,a=null===e,l=e===e,c=pl(e);if(!a&&!c&&!o&&t>e||o&&s&&l&&!a&&!c||n&&s&&l||!i&&l||!r)return 1;if(!n&&!o&&!c&&t<e||c&&i&&r&&!n&&!o||a&&i&&r||!s&&r||!l)return-1}return 0}function Ir(t,e,i){for(var n=-1,r=t.criteria,o=e.criteria,s=r.length,a=i.length;++n<s;){var l=kr(r[n],o[n]);if(l){if(n>=a)return l;return l*("desc"==i[n]?-1:1)}}return t.index-e.index}function Pr(t,e,i,n){for(var r=-1,o=t.length,s=i.length,a=-1,l=e.length,c=Gu(o-s,0),u=Zc(l+c),h=!n;++a<l;)u[a]=e[a];for(;++r<s;)(h||r<o)&&(u[i[r]]=t[r]);for(;c--;)u[a++]=t[r++];return u}function Br(t,e,i,n){for(var r=-1,o=t.length,s=-1,a=i.length,l=-1,c=e.length,u=Gu(o-a,0),h=Zc(u+c),p=!n;++r<u;)h[r]=t[r];for(var m=r;++l<c;)h[m+l]=e[l];for(;++s<a;)(p||r<o)&&(h[m+i[s]]=t[r++]);return h}function Er(t,e){var i=-1,n=t.length;for(e||(e=Zc(n));++i<n;)e[i]=t[i];return e}function Lr(t,e,i,n){var r=!i;i||(i={});for(var o=-1,s=e.length;++o<s;){var a=e[o],l=n?n(i[a],t[a],a,i,t):rt;l===rt&&(l=t[a]),r?Ki(i,a,l):Hi(i,a,l)}return i}function Rr(t,e){return Lr(t,xh(t),e)}function Vr(t,e){return Lr(t,bh(t),e)}function Or(t,e){return function(i,n){var r=pp(i)?l:qi,o=e?e():{};return r(i,t,go(n,2),o)}}function Fr(t){return Zn(function(e,i){var n=-1,r=i.length,o=r>1?i[r-1]:rt,s=r>2?i[2]:rt;for(o=t.length>3&&"function"==typeof o?(r--,o):rt,s&&Bo(i[0],i[1],s)&&(o=r<3?rt:o,r=1),e=nu(e);++n<r;){var a=i[n];a&&t(e,a,n,o)}return e})}function Nr(t,e){return function(i,n){if(null==i)return i;if(!za(i))return t(i,n);for(var r=i.length,o=e?r:-1,s=nu(i);(e?o--:++o<r)&&!1!==n(s[o],o,s););return i}}function jr(t){return function(e,i,n){for(var r=-1,o=nu(e),s=n(e),a=s.length;a--;){var l=s[t?a:++r];if(!1===i(o[l],l,o))break}return e}}function Gr(t,e,i){function n(){return(this&&this!==Di&&this instanceof n?o:t).apply(r?i:this,arguments)}var r=e&dt,o=Hr(t);return n}function zr(t){return function(e){e=Cl(e);var i=J(e)?tt(e):rt,n=i?i[0]:e.charAt(0),r=i?xr(i,1).join(""):e.slice(1);return n[t]()+r}}function Jr(t){return function(e){return y(bc(ec(e).replace(li,"")),t,"")}}function Hr(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var i=ch(t.prototype),n=t.apply(i,e);return tl(n)?n:i}}function Ur(t,e,i){function n(){for(var o=arguments.length,s=Zc(o),l=o,c=yo(n);l--;)s[l]=arguments[l];var u=o<3&&s[0]!==c&&s[o-1]!==c?[]:$(s,c);return(o-=u.length)<i?io(t,e,$r,n.placeholder,rt,s,u,rt,rt,i-o):a(this&&this!==Di&&this instanceof n?r:t,this,s)}var r=Hr(t);return n}function qr(t){return function(e,i,n){var r=nu(e);if(!za(e)){var o=go(i,3);e=Vl(e),i=function(t){return o(r[t],t,r)}}var s=t(e,i,n);return s>-1?r[o?e[s]:s]:rt}}function Wr(t){return po(function(e){var i=e.length,n=i,o=r.prototype.thru;for(t&&e.reverse();n--;){var s=e[n];if("function"!=typeof s)throw new su(at);if(o&&!a&&"wrapper"==_o(s))var a=new r([],!0)}for(n=a?n:i;++n<i;){s=e[n];var l=_o(s),c="wrapper"==l?vh(s):rt;a=c&&Ro(c[0])&&c[1]==(Ct|vt|bt|St)&&!c[4].length&&1==c[9]?a[_o(c[0])].apply(a,c[3]):1==s.length&&Ro(s)?a[l]():a.thru(s)}return function(){var t=arguments,n=t[0];if(a&&1==t.length&&pp(n))return a.plant(n).value();for(var r=0,o=i?e[r].apply(this,t):n;++r<i;)o=e[r].call(this,o);return o}})}function $r(t,e,i,n,r,o,s,a,l,c){function u(){for(var y=arguments.length,g=Zc(y),v=y;v--;)g[v]=arguments[v];if(f)var x=yo(u),b=j(g,x);if(n&&(g=Pr(g,n,r,f)),o&&(g=Br(g,o,s,f)),y-=b,f&&y<c){var w=$(g,x);return io(t,e,$r,u.placeholder,i,g,w,a,l,c-y)}var C=p?i:this,S=m?C[t]:t;return y=g.length,a?g=Uo(g,a):_&&y>1&&g.reverse(),h&&l<y&&(g.length=l),this&&this!==Di&&this instanceof u&&(S=d||Hr(S)),S.apply(C,g)}var h=e&Ct,p=e&dt,m=e&yt,f=e&(vt|xt),_=e&At,d=m?rt:Hr(t);return u}function Kr(t,e){return function(i,n){return xn(i,t,e(n),{})}}function Xr(t,e){return function(i,n){var r;if(i===rt&&n===rt)return e;if(i!==rt&&(r=i),n!==rt){if(r===rt)return n;"string"==typeof i||"string"==typeof n?(i=cr(i),n=cr(n)):(i=lr(i),n=lr(n)),r=t(i,n)}return r}}function Yr(t){return po(function(e){return e=_(e,R(go())),Zn(function(i){var n=this;return t(e,function(t){return a(t,n,i)})})})}function Zr(t,e){e=e===rt?" ":cr(e);var i=e.length;if(i<2)return i?Yn(e,t):e;var n=Yn(e,Lu(t/Q(e)));return J(e)?xr(tt(n),0,t).join(""):n.slice(0,t)}function Qr(t,e,i,n){function r(){for(var e=-1,l=arguments.length,c=-1,u=n.length,h=Zc(u+l),p=this&&this!==Di&&this instanceof r?s:t;++c<u;)h[c]=n[c];for(;l--;)h[c++]=arguments[++e];return a(p,o?i:this,h)}var o=e&dt,s=Hr(t);return r}function to(t){return function(e,i,n){return n&&"number"!=typeof n&&Bo(e,i,n)&&(i=n=rt),e=yl(e),i===rt?(i=e,e=0):i=yl(i),n=n===rt?e<i?1:-1:yl(n),Xn(e,i,n,t)}}function eo(t){return function(e,i){return"string"==typeof e&&"string"==typeof i||(e=xl(e),i=xl(i)),t(e,i)}}function io(t,e,i,n,r,o,s,a,l,c){var u=e&vt,h=u?s:rt,p=u?rt:s,m=u?o:rt,f=u?rt:o;e|=u?bt:wt,(e&=~(u?wt:bt))&gt||(e&=~(dt|yt));var _=[t,e,r,m,h,f,p,a,l,c],d=i.apply(rt,_);return Ro(t)&&Sh(d,_),d.placeholder=n,qo(d,t,e)}function no(t){var e=iu[t];return function(t,i){if(t=xl(t),i=null==i?0:zu(gl(i),292)){var n=(Cl(t)+"e").split("e");return n=(Cl(e(n[0]+"e"+(+n[1]+i)))+"e").split("e"),+(n[0]+"e"+(+n[1]-i))}return e(t)}}function ro(t){return function(e){var i=wh(e);return i==Kt?q(e):i==ee?X(e):L(e,t(e))}}function oo(t,e,i,n,r,o,s,a){var l=e&yt;if(!l&&"function"!=typeof t)throw new su(at);var c=n?n.length:0;if(c||(e&=~(bt|wt),n=r=rt),s=s===rt?s:Gu(gl(s),0),a=a===rt?a:gl(a),c-=r?r.length:0,e&wt){var u=n,h=r;n=r=rt}var p=l?rt:vh(t),m=[t,e,i,n,r,u,h,o,s,a];if(p&&jo(m,p),t=m[0],e=m[1],i=m[2],n=m[3],r=m[4],a=m[9]=m[9]===rt?l?0:t.length:Gu(m[9]-c,0),!a&&e&(vt|xt)&&(e&=~(vt|xt)),e&&e!=dt)f=e==vt||e==xt?Ur(t,e,a):e!=bt&&e!=(dt|bt)||r.length?$r.apply(rt,m):Qr(t,e,i,n);else var f=Gr(t,e,i);return qo((p?fh:Sh)(f,m),t,e)}function so(t,e,i,n){return t===rt||Ga(t,cu[i])&&!pu.call(n,i)?e:t}function ao(t,e,i,n,r,o){return tl(t)&&tl(e)&&(o.set(e,t),jn(t,e,rt,ao,o),o.delete(e)),t}function lo(t){return cl(t)?rt:t}function co(t,e,i,n,r,o){var s=i&ft,a=t.length,l=e.length;if(a!=l&&!(s&&l>a))return!1;var c=o.get(t);if(c&&o.get(e))return c==e;var u=-1,h=!0,p=i&_t?new pi:rt;for(o.set(t,e),o.set(e,t);++u<a;){var m=t[u],f=e[u];if(n)var _=s?n(f,m,u,e,t,o):n(m,f,u,t,e,o);if(_!==rt){if(_)continue;h=!1;break}if(p){if(!v(e,function(t,e){if(!O(p,e)&&(m===t||r(m,t,i,n,o)))return p.push(e)})){h=!1;break}}else if(m!==f&&!r(m,f,i,n,o)){h=!1;break}}return o.delete(t),o.delete(e),h}function uo(t,e,i,n,r,o,s){switch(i){case le:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case ae:return!(t.byteLength!=e.byteLength||!o(new bu(t),new bu(e)));case Jt:case Ht:case Xt:return Ga(+t,+e);case qt:return t.name==e.name&&t.message==e.message;case te:case ie:return t==e+"";case Kt:var a=q;case ee:var l=n&ft;if(a||(a=K),t.size!=e.size&&!l)return!1;var c=s.get(t);if(c)return c==e;n|=_t,s.set(t,e);var u=co(a(t),a(e),n,r,o,s);return s.delete(t),u;case ne:if(ah)return ah.call(t)==ah.call(e)}return!1}function ho(t,e,i,n,r,o){var s=i&ft,a=mo(t),l=a.length;if(l!=mo(e).length&&!s)return!1;for(var c=l;c--;){var u=a[c];if(!(s?u in e:pu.call(e,u)))return!1}var h=o.get(t);if(h&&o.get(e))return h==e;var p=!0;o.set(t,e),o.set(e,t);for(var m=s;++c<l;){u=a[c];var f=t[u],_=e[u];if(n)var d=s?n(_,f,u,e,t,o):n(f,_,u,t,e,o);if(!(d===rt?f===_||r(f,_,i,n,o):d)){p=!1;break}m||(m="constructor"==u)}if(p&&!m){var y=t.constructor,g=e.constructor;y!=g&&"constructor"in t&&"constructor"in e&&!("function"==typeof y&&y instanceof y&&"function"==typeof g&&g instanceof g)&&(p=!1)}return o.delete(t),o.delete(e),p}function po(t){return Dh(Jo(t,rt,cs),t+"")}function mo(t){return mn(t,Vl,xh)}function fo(t){return mn(t,Ol,bh)}function _o(t){for(var e=t.name+"",i=th[e],n=pu.call(th,e)?i.length:0;n--;){var r=i[n],o=r.func;if(null==o||o==t)return r.name}return e}function yo(t){return(pu.call(i,"placeholder")?i:t).placeholder}function go(){var t=i.iteratee||Mc;return t=t===Mc?En:t,arguments.length?t(arguments[0],arguments[1]):t}function vo(t,e){var i=t.__data__;return Lo(e)?i["string"==typeof e?"string":"hash"]:i.map}function xo(t){for(var e=Vl(t),i=e.length;i--;){var n=e[i],r=t[n];e[i]=[n,r,Fo(r)]}return e}function bo(t,e){var i=z(t,e);return kn(i)?i:rt}function wo(t){var e=pu.call(t,ku),i=t[ku];try{t[ku]=rt}catch(t){}var n=_u.call(t);return e?t[ku]=i:delete t[ku],n}function Co(t,e,i){for(var n=-1,r=i.length;++n<r;){var o=i[n],s=o.size;switch(o.type){case"drop":t+=s;break;case"dropRight":e-=s;break;case"take":e=zu(e,t+s);break;case"takeRight":t=Gu(t,e-s)}}return{start:t,end:e}}function So(t){var e=t.match(Re);return e?e[1].split(Ve):[]}function Ao(t,e,i){e=vr(e,t);for(var n=-1,r=e.length,o=!1;++n<r;){var s=Ko(e[n]);if(!(o=null!=t&&i(t,s)))break;t=t[s]}return o||++n!=r?o:!!(r=null==t?0:t.length)&&Qa(r)&&Po(s,r)&&(pp(t)||hp(t))}function Do(t){var e=t.length,i=t.constructor(e);return e&&"string"==typeof t[0]&&pu.call(t,"index")&&(i.index=t.index,i.input=t.input),i}function Mo(t){return"function"!=typeof t.constructor||Oo(t)?{}:ch(Cu(t))}function To(t,e,i,n){var r=t.constructor;switch(e){case ae:return wr(t);case Jt:case Ht:return new r(+t);case le:return Cr(t,n);case ce:case ue:case he:case pe:case me:case fe:case _e:case de:case ye:return Tr(t,n);case Kt:return Sr(t,n,i);case Xt:case ie:return new r(t);case te:return Ar(t);case ee:return Dr(t,n,i);case ne:return Mr(t)}}function ko(t,e){var i=e.length;if(!i)return t;var n=i-1;return e[n]=(i>1?"& ":"")+e[n],e=e.join(i>2?", ":" "),t.replace(Le,"{\n/* [wrapped with "+e+"] */\n")}function Io(t){return pp(t)||hp(t)||!!(Mu&&t&&t[Mu])}function Po(t,e){return!!(e=null==e?Et:e)&&("number"==typeof t||He.test(t))&&t>-1&&t%1==0&&t<e}function Bo(t,e,i){if(!tl(i))return!1;var n=typeof e;return!!("number"==n?za(i)&&Po(e,i.length):"string"==n&&e in i)&&Ga(i[e],t)}function Eo(t,e){if(pp(t))return!1;var i=typeof t;return!("number"!=i&&"symbol"!=i&&"boolean"!=i&&null!=t&&!pl(t))||(Me.test(t)||!De.test(t)||null!=e&&t in nu(e))}function Lo(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}function Ro(t){var e=_o(t),n=i[e];if("function"!=typeof n||!(e in x.prototype))return!1;if(t===n)return!0;var r=vh(n);return!!r&&t===r[0]}function Vo(t){return!!fu&&fu in t}function Oo(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||cu)}function Fo(t){return t===t&&!tl(t)}function No(t,e){return function(i){return null!=i&&(i[t]===e&&(e!==rt||t in nu(i)))}}function jo(t,e){var i=t[1],n=e[1],r=i|n,o=r<(dt|yt|Ct),s=n==Ct&&i==vt||n==Ct&&i==St&&t[7].length<=e[8]||n==(Ct|St)&&e[7].length<=e[8]&&i==vt;if(!o&&!s)return t;n&dt&&(t[2]=e[2],r|=i&dt?0:gt);var a=e[3];if(a){var l=t[3];t[3]=l?Pr(l,a,e[4]):a,t[4]=l?$(t[3],ut):e[4]}return a=e[5],a&&(l=t[5],t[5]=l?Br(l,a,e[6]):a,t[6]=l?$(t[5],ut):e[6]),a=e[7],a&&(t[7]=a),n&Ct&&(t[8]=null==t[8]?e[8]:zu(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=r,t}function Go(t){var e=[];if(null!=t)for(var i in nu(t))e.push(i);return e}function zo(t){return _u.call(t)}function Jo(t,e,i){return e=Gu(e===rt?t.length-1:e,0),function(){for(var n=arguments,r=-1,o=Gu(n.length-e,0),s=Zc(o);++r<o;)s[r]=n[e+r];r=-1;for(var l=Zc(e+1);++r<e;)l[r]=n[r];return l[e]=i(s),a(t,this,l)}}function Ho(t,e){return e.length<2?t:pn(t,nr(e,0,-1))}function Uo(t,e){for(var i=t.length,n=zu(e.length,i),r=Er(t);n--;){var o=e[n];t[n]=Po(o,i)?r[o]:rt}return t}function qo(t,e,i){var n=e+"";return Dh(t,ko(n,Yo(So(n),i)))}function Wo(t){var e=0,i=0;return function(){var n=Ju(),r=kt-(n-i);if(i=n,r>0){if(++e>=Tt)return arguments[0]}else e=0;return t.apply(rt,arguments)}}function $o(t,e){var i=-1,n=t.length,r=n-1;for(e=e===rt?n:e;++i<e;){var o=Kn(i,r),s=t[o];t[o]=t[i],t[i]=s}return t.length=e,t}function Ko(t){if("string"==typeof t||pl(t))return t;var e=t+"";return"0"==e&&1/t==-Bt?"-0":e}function Xo(t){if(null!=t){try{return hu.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function Yo(t,e){return c(Nt,function(i){var n="_."+i[0];e&i[1]&&!m(t,n)&&t.push(n)}),t.sort()}function Zo(t){if(t instanceof x)return t.clone();var e=new r(t.__wrapped__,t.__chain__);return e.__actions__=Er(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}function Qo(t,e,i){e=(i?Bo(t,e,i):e===rt)?1:Gu(gl(e),0);var n=null==t?0:t.length;if(!n||e<1)return[];for(var r=0,o=0,s=Zc(Lu(n/e));r<n;)s[o++]=nr(t,r,r+=e);return s}function ts(t){for(var e=-1,i=null==t?0:t.length,n=0,r=[];++e<i;){var o=t[e];o&&(r[n++]=o)}return r}function es(){var t=arguments.length;if(!t)return[];for(var e=Zc(t-1),i=arguments[0],n=t;n--;)e[n-1]=arguments[n];return d(pp(i)?Er(i):[i],ln(e,1))}function is(t,e,i){var n=null==t?0:t.length;return n?(e=i||e===rt?1:gl(e),nr(t,e<0?0:e,n)):[]}function ns(t,e,i){var n=null==t?0:t.length;return n?(e=i||e===rt?1:gl(e),e=n-e,nr(t,0,e<0?0:e)):[]}function rs(t,e){return t&&t.length?mr(t,go(e,3),!0,!0):[]}function os(t,e){return t&&t.length?mr(t,go(e,3),!0):[]}function ss(t,e,i,n){var r=null==t?0:t.length;return r?(i&&"number"!=typeof i&&Bo(t,e,i)&&(i=0,n=r),sn(t,e,i,n)):[]}function as(t,e,i){var n=null==t?0:t.length;if(!n)return-1;var r=null==i?0:gl(i);return r<0&&(r=Gu(n+r,0)),C(t,go(e,3),r)}function ls(t,e,i){var n=null==t?0:t.length;if(!n)return-1;var r=n-1;return i!==rt&&(r=gl(i),r=i<0?Gu(n+r,0):zu(r,n-1)),C(t,go(e,3),r,!0)}function cs(t){return(null==t?0:t.length)?ln(t,1):[]}function us(t){return(null==t?0:t.length)?ln(t,Bt):[]}function hs(t,e){return(null==t?0:t.length)?(e=e===rt?1:gl(e),ln(t,e)):[]}function ps(t){for(var e=-1,i=null==t?0:t.length,n={};++e<i;){var r=t[e];n[r[0]]=r[1]}return n}function ms(t){return t&&t.length?t[0]:rt}function fs(t,e,i){var n=null==t?0:t.length;if(!n)return-1;var r=null==i?0:gl(i);return r<0&&(r=Gu(n+r,0)),S(t,e,r)}function _s(t){return(null==t?0:t.length)?nr(t,0,-1):[]}function ds(t,e){return null==t?"":Nu.call(t,e)}function ys(t){var e=null==t?0:t.length;return e?t[e-1]:rt}function gs(t,e,i){var n=null==t?0:t.length;if(!n)return-1;var r=n;return i!==rt&&(r=gl(i),r=r<0?Gu(n+r,0):zu(r,n-1)),e===e?Z(t,e,r):C(t,D,r,!0)}function vs(t,e){return t&&t.length?zn(t,gl(e)):rt}function xs(t,e){return t&&t.length&&e&&e.length?Wn(t,e):t}function bs(t,e,i){return t&&t.length&&e&&e.length?Wn(t,e,go(i,2)):t}function ws(t,e,i){return t&&t.length&&e&&e.length?Wn(t,e,rt,i):t}function Cs(t,e){var i=[];if(!t||!t.length)return i;var n=-1,r=[],o=t.length;for(e=go(e,3);++n<o;){var s=t[n];e(s,n,t)&&(i.push(s),r.push(n))}return $n(t,r),i}function Ss(t){return null==t?t:qu.call(t)}function As(t,e,i){var n=null==t?0:t.length;return n?(i&&"number"!=typeof i&&Bo(t,e,i)?(e=0,i=n):(e=null==e?0:gl(e),i=i===rt?n:gl(i)),nr(t,e,i)):[]}function Ds(t,e){return or(t,e)}function Ms(t,e,i){return sr(t,e,go(i,2))}function Ts(t,e){var i=null==t?0:t.length;if(i){var n=or(t,e);if(n<i&&Ga(t[n],e))return n}return-1}function ks(t,e){return or(t,e,!0)}function Is(t,e,i){return sr(t,e,go(i,2),!0)}function Ps(t,e){if(null==t?0:t.length){var i=or(t,e,!0)-1;if(Ga(t[i],e))return i}return-1}function Bs(t){return t&&t.length?ar(t):[]}function Es(t,e){return t&&t.length?ar(t,go(e,2)):[]}function Ls(t){var e=null==t?0:t.length;return e?nr(t,1,e):[]}function Rs(t,e,i){return t&&t.length?(e=i||e===rt?1:gl(e),nr(t,0,e<0?0:e)):[]}function Vs(t,e,i){var n=null==t?0:t.length;return n?(e=i||e===rt?1:gl(e),e=n-e,nr(t,e<0?0:e,n)):[]}function Os(t,e){return t&&t.length?mr(t,go(e,3),!1,!0):[]}function Fs(t,e){return t&&t.length?mr(t,go(e,3)):[]}function Ns(t){return t&&t.length?ur(t):[]}function js(t,e){return t&&t.length?ur(t,go(e,2)):[]}function Gs(t,e){return e="function"==typeof e?e:rt,t&&t.length?ur(t,rt,e):[]}function zs(t){if(!t||!t.length)return[];var e=0;return t=p(t,function(t){if(Ja(t))return e=Gu(t.length,e),!0}),E(e,function(e){return _(t,T(e))})}function Js(t,e){if(!t||!t.length)return[];var i=zs(t);return null==e?i:_(i,function(t){return a(e,rt,t)})}function Hs(t,e){return dr(t||[],e||[],Hi)}function Us(t,e){return dr(t||[],e||[],er)}function qs(t){var e=i(t);return e.__chain__=!0,e}function Ws(t,e){return e(t),t}function $s(t,e){return e(t)}function Ks(){return qs(this)}function Xs(){return new r(this.value(),this.__chain__)}function Ys(){this.__values__===rt&&(this.__values__=dl(this.value()));var t=this.__index__>=this.__values__.length;return{done:t,value:t?rt:this.__values__[this.__index__++]}}function Zs(){return this}function Qs(t){for(var e,i=this;i instanceof n;){var r=Zo(i);r.__index__=0,r.__values__=rt,e?o.__wrapped__=r:e=r;var o=r;i=i.__wrapped__}return o.__wrapped__=t,e}function ta(){var t=this.__wrapped__;if(t instanceof x){var e=t;return this.__actions__.length&&(e=new x(this)),e=e.reverse(),e.__actions__.push({func:$s,args:[Ss],thisArg:rt}),new r(e,this.__chain__)}return this.thru(Ss)}function ea(){return fr(this.__wrapped__,this.__actions__)}function ia(t,e,i){var n=pp(t)?h:rn;return i&&Bo(t,e,i)&&(e=rt),n(t,go(e,3))}function na(t,e){return(pp(t)?p:an)(t,go(e,3))}function ra(t,e){return ln(ua(t,e),1)}function oa(t,e){return ln(ua(t,e),Bt)}function sa(t,e,i){return i=i===rt?1:gl(i),ln(ua(t,e),i)}function aa(t,e){return(pp(t)?c:uh)(t,go(e,3))}function la(t,e){return(pp(t)?u:hh)(t,go(e,3))}function ca(t,e,i,n){t=za(t)?t:Kl(t),i=i&&!n?gl(i):0;var r=t.length;return i<0&&(i=Gu(r+i,0)),hl(t)?i<=r&&t.indexOf(e,i)>-1:!!r&&S(t,e,i)>-1}function ua(t,e){return(pp(t)?_:On)(t,go(e,3))}function ha(t,e,i,n){return null==t?[]:(pp(e)||(e=null==e?[]:[e]),i=n?rt:i,pp(i)||(i=null==i?[]:[i]),Jn(t,e,i))}function pa(t,e,i){var n=pp(t)?y:I,r=arguments.length<3;return n(t,go(e,4),i,r,uh)}function ma(t,e,i){var n=pp(t)?g:I,r=arguments.length<3;return n(t,go(e,4),i,r,hh)}function fa(t,e){return(pp(t)?p:an)(t,Ta(go(e,3)))}function _a(t){return(pp(t)?Ii:Qn)(t)}function da(t,e,i){return e=(i?Bo(t,e,i):e===rt)?1:gl(e),(pp(t)?Pi:tr)(t,e)}function ya(t){return(pp(t)?Fi:ir)(t)}function ga(t){if(null==t)return 0;if(za(t))return hl(t)?Q(t):t.length;var e=wh(t);return e==Kt||e==ee?t.size:Ln(t).length}function va(t,e,i){var n=pp(t)?v:rr;return i&&Bo(t,e,i)&&(e=rt),n(t,go(e,3))}function xa(t,e){if("function"!=typeof e)throw new su(at);return t=gl(t),function(){if(--t<1)return e.apply(this,arguments)}}function ba(t,e,i){return e=i?rt:e,e=t&&null==e?t.length:e,oo(t,Ct,rt,rt,rt,rt,e)}function wa(t,e){var i;if("function"!=typeof e)throw new su(at);return t=gl(t),function(){return--t>0&&(i=e.apply(this,arguments)),t<=1&&(e=rt),i}}function Ca(t,e,i){e=i?rt:e;var n=oo(t,vt,rt,rt,rt,rt,rt,e);return n.placeholder=Ca.placeholder,n}function Sa(t,e,i){e=i?rt:e;var n=oo(t,xt,rt,rt,rt,rt,rt,e);return n.placeholder=Sa.placeholder,n}function Aa(t,e,i){function n(e){var i=p,n=m;return p=m=rt,g=e,_=t.apply(n,i)}function r(t){return g=t,d=Ah(a,e),v?n(t):_}function o(t){var i=t-y,n=t-g,r=e-i;return x?zu(r,f-n):r}function s(t){var i=t-y,n=t-g;return y===rt||i>=e||i<0||x&&n>=f}function a(){var t=tp();if(s(t))return l(t);d=Ah(a,o(t))}function l(t){return d=rt,b&&p?n(t):(p=m=rt,_)}function c(){d!==rt&&yh(d),g=0,p=y=m=d=rt}function u(){return d===rt?_:l(tp())}function h(){var t=tp(),i=s(t);if(p=arguments,m=this,y=t,i){if(d===rt)return r(y);if(x)return d=Ah(a,e),n(y)}return d===rt&&(d=Ah(a,e)),_}var p,m,f,_,d,y,g=0,v=!1,x=!1,b=!0;if("function"!=typeof t)throw new su(at);return e=xl(e)||0,tl(i)&&(v=!!i.leading,x="maxWait"in i,f=x?Gu(xl(i.maxWait)||0,e):f,b="trailing"in i?!!i.trailing:b),h.cancel=c,h.flush=u,h}function Da(t){return oo(t,At)}function Ma(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new su(at);var i=function(){var n=arguments,r=e?e.apply(this,n):n[0],o=i.cache;if(o.has(r))return o.get(r);var s=t.apply(this,n);return i.cache=o.set(r,s)||o,s};return i.cache=new(Ma.Cache||ri),i}function Ta(t){if("function"!=typeof t)throw new su(at);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}function ka(t){return wa(2,t)}function Ia(t,e){if("function"!=typeof t)throw new su(at);return e=e===rt?e:gl(e),Zn(t,e)}function Pa(t,e){if("function"!=typeof t)throw new su(at);return e=null==e?0:Gu(gl(e),0),Zn(function(i){var n=i[e],r=xr(i,0,e);return n&&d(r,n),a(t,this,r)})}function Ba(t,e,i){var n=!0,r=!0;if("function"!=typeof t)throw new su(at);return tl(i)&&(n="leading"in i?!!i.leading:n,r="trailing"in i?!!i.trailing:r),Aa(t,e,{leading:n,maxWait:e,trailing:r})}function Ea(t){return ba(t,1)}function La(t,e){return sp(gr(e),t)}function Ra(){if(!arguments.length)return[];var t=arguments[0];return pp(t)?t:[t]}function Va(t){return Zi(t,mt)}function Oa(t,e){return e="function"==typeof e?e:rt,Zi(t,mt,e)}function Fa(t){return Zi(t,ht|mt)}function Na(t,e){return e="function"==typeof e?e:rt,Zi(t,ht|mt,e)}function ja(t,e){return null==e||tn(t,e,Vl(e))}function Ga(t,e){return t===e||t!==t&&e!==e}function za(t){return null!=t&&Qa(t.length)&&!Ya(t)}function Ja(t){return el(t)&&za(t)}function Ha(t){return!0===t||!1===t||el(t)&&fn(t)==Jt}function Ua(t){return el(t)&&1===t.nodeType&&!cl(t)}function qa(t){if(null==t)return!0;if(za(t)&&(pp(t)||"string"==typeof t||"function"==typeof t.splice||fp(t)||vp(t)||hp(t)))return!t.length;var e=wh(t);if(e==Kt||e==ee)return!t.size;if(Oo(t))return!Ln(t).length;for(var i in t)if(pu.call(t,i))return!1;return!0}function Wa(t,e){return An(t,e)}function $a(t,e,i){i="function"==typeof i?i:rt;var n=i?i(t,e):rt;return n===rt?An(t,e,rt,i):!!n}function Ka(t){if(!el(t))return!1;var e=fn(t);return e==qt||e==Ut||"string"==typeof t.message&&"string"==typeof t.name&&!cl(t)}function Xa(t){return"number"==typeof t&&Fu(t)}function Ya(t){if(!tl(t))return!1;var e=fn(t);return e==Wt||e==$t||e==zt||e==Qt}function Za(t){return"number"==typeof t&&t==gl(t)}function Qa(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=Et}function tl(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function el(t){return null!=t&&"object"==typeof t}function il(t,e){return t===e||Tn(t,e,xo(e))}function nl(t,e,i){return i="function"==typeof i?i:rt,Tn(t,e,xo(e),i)}function rl(t){return ll(t)&&t!=+t}function ol(t){if(Ch(t))throw new tu(st);return kn(t)}function sl(t){return null===t}function al(t){return null==t}function ll(t){return"number"==typeof t||el(t)&&fn(t)==Xt}function cl(t){if(!el(t)||fn(t)!=Zt)return!1;var e=Cu(t);if(null===e)return!0;var i=pu.call(e,"constructor")&&e.constructor;return"function"==typeof i&&i instanceof i&&hu.call(i)==du}function ul(t){return Za(t)&&t>=-Et&&t<=Et}function hl(t){return"string"==typeof t||!pp(t)&&el(t)&&fn(t)==ie}function pl(t){return"symbol"==typeof t||el(t)&&fn(t)==ne}function ml(t){return t===rt}function fl(t){return el(t)&&wh(t)==oe}function _l(t){return el(t)&&fn(t)==se}function dl(t){if(!t)return[];if(za(t))return hl(t)?tt(t):Er(t);if(Tu&&t[Tu])return U(t[Tu]());var e=wh(t);return(e==Kt?q:e==ee?K:Kl)(t)}function yl(t){if(!t)return 0===t?t:0;if((t=xl(t))===Bt||t===-Bt){return(t<0?-1:1)*Lt}return t===t?t:0}function gl(t){var e=yl(t),i=e%1;return e===e?i?e-i:e:0}function vl(t){return t?Yi(gl(t),0,Vt):0}function xl(t){if("number"==typeof t)return t;if(pl(t))return Rt;if(tl(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=tl(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(Pe,"");var i=Ge.test(t);return i||Je.test(t)?Ci(t.slice(2),i?2:8):je.test(t)?Rt:+t}function bl(t){return Lr(t,Ol(t))}function wl(t){return t?Yi(gl(t),-Et,Et):0===t?t:0}function Cl(t){return null==t?"":cr(t)}function Sl(t,e){var i=ch(t);return null==e?i:Wi(i,e)}function Al(t,e){return w(t,go(e,3),cn)}function Dl(t,e){return w(t,go(e,3),un)}function Ml(t,e){return null==t?t:ph(t,go(e,3),Ol)}function Tl(t,e){return null==t?t:mh(t,go(e,3),Ol)}function kl(t,e){return t&&cn(t,go(e,3))}function Il(t,e){return t&&un(t,go(e,3))}function Pl(t){return null==t?[]:hn(t,Vl(t))}function Bl(t){return null==t?[]:hn(t,Ol(t))}function El(t,e,i){var n=null==t?rt:pn(t,e);return n===rt?i:n}function Ll(t,e){return null!=t&&Ao(t,e,dn)}function Rl(t,e){return null!=t&&Ao(t,e,yn)}function Vl(t){return za(t)?Ti(t):Ln(t)}function Ol(t){return za(t)?Ti(t,!0):Rn(t)}function Fl(t,e){var i={};return e=go(e,3),cn(t,function(t,n,r){Ki(i,e(t,n,r),t)}),i}function Nl(t,e){var i={};return e=go(e,3),cn(t,function(t,n,r){Ki(i,n,e(t,n,r))}),i}function jl(t,e){return Gl(t,Ta(go(e)))}function Gl(t,e){if(null==t)return{};var i=_(fo(t),function(t){return[t]});return e=go(e),Un(t,i,function(t,i){return e(t,i[0])})}function zl(t,e,i){e=vr(e,t);var n=-1,r=e.length;for(r||(r=1,t=rt);++n<r;){var o=null==t?rt:t[Ko(e[n])];o===rt&&(n=r,o=i),t=Ya(o)?o.call(t):o}return t}function Jl(t,e,i){return null==t?t:er(t,e,i)}function Hl(t,e,i,n){return n="function"==typeof n?n:rt,null==t?t:er(t,e,i,n)}function Ul(t,e,i){var n=pp(t),r=n||fp(t)||vp(t);if(e=go(e,4),null==i){var o=t&&t.constructor;i=r?n?new o:[]:tl(t)&&Ya(o)?ch(Cu(t)):{}}return(r?c:cn)(t,function(t,n,r){return e(i,t,n,r)}),i}function ql(t,e){return null==t||hr(t,e)}function Wl(t,e,i){return null==t?t:pr(t,e,gr(i))}function $l(t,e,i,n){return n="function"==typeof n?n:rt,null==t?t:pr(t,e,gr(i),n)}function Kl(t){return null==t?[]:V(t,Vl(t))}function Xl(t){return null==t?[]:V(t,Ol(t))}function Yl(t,e,i){return i===rt&&(i=e,e=rt),i!==rt&&(i=xl(i),i=i===i?i:0),e!==rt&&(e=xl(e),e=e===e?e:0),Yi(xl(t),e,i)}function Zl(t,e,i){return e=yl(e),i===rt?(i=e,e=0):i=yl(i),t=xl(t),gn(t,e,i)}function Ql(t,e,i){if(i&&"boolean"!=typeof i&&Bo(t,e,i)&&(e=i=rt),i===rt&&("boolean"==typeof e?(i=e,e=rt):"boolean"==typeof t&&(i=t,t=rt)),t===rt&&e===rt?(t=0,e=1):(t=yl(t),e===rt?(e=t,t=0):e=yl(e)),t>e){var n=t;t=e,e=n}if(i||t%1||e%1){var r=Uu();return zu(t+r*(e-t+wi("1e-"+((r+"").length-1))),e)}return Kn(t,e)}function tc(t){return Up(Cl(t).toLowerCase())}function ec(t){return(t=Cl(t))&&t.replace(Ue,Ni).replace(ci,"")}function ic(t,e,i){t=Cl(t),e=cr(e);var n=t.length;i=i===rt?n:Yi(gl(i),0,n);var r=i;return(i-=e.length)>=0&&t.slice(i,r)==e}function nc(t){return t=Cl(t),t&&Se.test(t)?t.replace(we,ji):t}function rc(t){return t=Cl(t),t&&Ie.test(t)?t.replace(ke,"\\$&"):t}function oc(t,e,i){t=Cl(t),e=gl(e);var n=e?Q(t):0;if(!e||n>=e)return t;var r=(e-n)/2;return Zr(Ru(r),i)+t+Zr(Lu(r),i)}function sc(t,e,i){t=Cl(t),e=gl(e);var n=e?Q(t):0;return e&&n<e?t+Zr(e-n,i):t}function ac(t,e,i){t=Cl(t),e=gl(e);var n=e?Q(t):0;return e&&n<e?Zr(e-n,i)+t:t}function lc(t,e,i){return i||null==e?e=0:e&&(e=+e),Hu(Cl(t).replace(Be,""),e||0)}function cc(t,e,i){return e=(i?Bo(t,e,i):e===rt)?1:gl(e),Yn(Cl(t),e)}function uc(){var t=arguments,e=Cl(t[0]);return t.length<3?e:e.replace(t[1],t[2])}function hc(t,e,i){return i&&"number"!=typeof i&&Bo(t,e,i)&&(e=i=rt),(i=i===rt?Vt:i>>>0)?(t=Cl(t),t&&("string"==typeof e||null!=e&&!yp(e))&&!(e=cr(e))&&J(t)?xr(tt(t),0,i):t.split(e,i)):[]}function pc(t,e,i){return t=Cl(t),i=null==i?0:Yi(gl(i),0,t.length),e=cr(e),t.slice(i,i+e.length)==e}function mc(t,e,n){var r=i.templateSettings;n&&Bo(t,e,n)&&(e=rt),t=Cl(t),e=Sp({},e,r,so);var o,s,a=Sp({},e.imports,r.imports,so),l=Vl(a),c=V(a,l),u=0,h=e.interpolate||qe,p="__p += '",m=ru((e.escape||qe).source+"|"+h.source+"|"+(h===Ae?Fe:qe).source+"|"+(e.evaluate||qe).source+"|$","g"),f="//# sourceURL="+("sourceURL"in e?e.sourceURL:"lodash.templateSources["+ ++_i+"]")+"\n";t.replace(m,function(e,i,n,r,a,l){return n||(n=r),p+=t.slice(u,l).replace(We,G),i&&(o=!0,p+="' +\n__e("+i+") +\n'"),a&&(s=!0,p+="';\n"+a+";\n__p += '"),n&&(p+="' +\n((__t = ("+n+")) == null ? '' : __t) +\n'"),u=l+e.length,e}),p+="';\n";var _=e.variable;_||(p="with (obj) {\n"+p+"\n}\n"),p=(s?p.replace(ge,""):p).replace(ve,"$1").replace(xe,"$1;"),p="function("+(_||"obj")+") {\n"+(_?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(s?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+p+"return __p\n}";var d=qp(function(){return eu(l,f+"return "+p).apply(rt,c)});if(d.source=p,Ka(d))throw d;return d}function fc(t){return Cl(t).toLowerCase()}function _c(t){return Cl(t).toUpperCase()}function dc(t,e,i){if((t=Cl(t))&&(i||e===rt))return t.replace(Pe,"");if(!t||!(e=cr(e)))return t;var n=tt(t),r=tt(e);return xr(n,F(n,r),N(n,r)+1).join("")}function yc(t,e,i){if((t=Cl(t))&&(i||e===rt))return t.replace(Ee,"");if(!t||!(e=cr(e)))return t;var n=tt(t);return xr(n,0,N(n,tt(e))+1).join("")}function gc(t,e,i){if((t=Cl(t))&&(i||e===rt))return t.replace(Be,"");if(!t||!(e=cr(e)))return t;var n=tt(t);return xr(n,F(n,tt(e))).join("")}function vc(t,e){var i=Dt,n=Mt;if(tl(e)){var r="separator"in e?e.separator:r;i="length"in e?gl(e.length):i,n="omission"in e?cr(e.omission):n}t=Cl(t);var o=t.length;if(J(t)){var s=tt(t);o=s.length}if(i>=o)return t;var a=i-Q(n);if(a<1)return n;var l=s?xr(s,0,a).join(""):t.slice(0,a);if(r===rt)return l+n;if(s&&(a+=l.length-a),yp(r)){if(t.slice(a).search(r)){var c,u=l;for(r.global||(r=ru(r.source,Cl(Ne.exec(r))+"g")),r.lastIndex=0;c=r.exec(u);)var h=c.index;l=l.slice(0,h===rt?a:h)}}else if(t.indexOf(cr(r),a)!=a){var p=l.lastIndexOf(r);p>-1&&(l=l.slice(0,p))}return l+n}function xc(t){return t=Cl(t),t&&Ce.test(t)?t.replace(be,Gi):t}function bc(t,e,i){return t=Cl(t),e=i?rt:e,e===rt?H(t)?nt(t):b(t):t.match(e)||[]}function wc(t){var e=null==t?0:t.length,i=go();return t=e?_(t,function(t){if("function"!=typeof t[1])throw new su(at);return[i(t[0]),t[1]]}):[],Zn(function(i){for(var n=-1;++n<e;){var r=t[n];if(a(r[0],this,i))return a(r[1],this,i)}})}function Cc(t){return Qi(Zi(t,ht))}function Sc(t){return function(){return t}}function Ac(t,e){return null==t||t!==t?e:t}function Dc(t){return t}function Mc(t){return En("function"==typeof t?t:Zi(t,ht))}function Tc(t){return Fn(Zi(t,ht))}function kc(t,e){return Nn(t,Zi(e,ht))}function Ic(t,e,i){var n=Vl(e),r=hn(e,n);null!=i||tl(e)&&(r.length||!n.length)||(i=e,e=t,t=this,r=hn(e,Vl(e)));var o=!(tl(i)&&"chain"in i&&!i.chain),s=Ya(t);return c(r,function(i){var n=e[i];t[i]=n,s&&(t.prototype[i]=function(){var e=this.__chain__;if(o||e){var i=t(this.__wrapped__);return(i.__actions__=Er(this.__actions__)).push({func:n,args:arguments,thisArg:t}),i.__chain__=e,i}return n.apply(t,d([this.value()],arguments))})}),t}function Pc(){return Di._===this&&(Di._=yu),this}function Bc(){}function Ec(t){return t=gl(t),Zn(function(e){return zn(e,t)})}function Lc(t){return Eo(t)?T(Ko(t)):qn(t)}function Rc(t){return function(e){return null==t?rt:pn(t,e)}}function Vc(){return[]}function Oc(){return!1}function Fc(){return{}}function Nc(){return""}function jc(){return!0}function Gc(t,e){if((t=gl(t))<1||t>Et)return[];var i=Vt,n=zu(t,Vt);e=go(e),t-=Vt;for(var r=E(n,e);++i<t;)e(i);return r}function zc(t){return pp(t)?_(t,Ko):pl(t)?[t]:Er(Mh(Cl(t)))}function Jc(t){var e=++mu;return Cl(t)+e}function Hc(t){return t&&t.length?on(t,Dc,_n):rt}function Uc(t,e){return t&&t.length?on(t,go(e,2),_n):rt}function qc(t){return M(t,Dc)}function Wc(t,e){return M(t,go(e,2))}function $c(t){return t&&t.length?on(t,Dc,Vn):rt}function Kc(t,e){return t&&t.length?on(t,go(e,2),Vn):rt}function Xc(t){return t&&t.length?B(t,Dc):0}function Yc(t,e){return t&&t.length?B(t,go(e,2)):0}e=null==e?Di:zi.defaults(Di.Object(),e,zi.pick(Di,fi));var Zc=e.Array,Qc=e.Date,tu=e.Error,eu=e.Function,iu=e.Math,nu=e.Object,ru=e.RegExp,ou=e.String,su=e.TypeError,au=Zc.prototype,lu=eu.prototype,cu=nu.prototype,uu=e["__core-js_shared__"],hu=lu.toString,pu=cu.hasOwnProperty,mu=0,fu=function(){var t=/[^.]+$/.exec(uu&&uu.keys&&uu.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),_u=cu.toString,du=hu.call(nu),yu=Di._,gu=ru("^"+hu.call(pu).replace(ke,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),vu=ki?e.Buffer:rt,xu=e.Symbol,bu=e.Uint8Array,wu=vu?vu.allocUnsafe:rt,Cu=W(nu.getPrototypeOf,nu),Su=nu.create,Au=cu.propertyIsEnumerable,Du=au.splice,Mu=xu?xu.isConcatSpreadable:rt,Tu=xu?xu.iterator:rt,ku=xu?xu.toStringTag:rt,Iu=function(){try{var t=bo(nu,"defineProperty");return t({},"",{}),t}catch(t){}}(),Pu=e.clearTimeout!==Di.clearTimeout&&e.clearTimeout,Bu=Qc&&Qc.now!==Di.Date.now&&Qc.now,Eu=e.setTimeout!==Di.setTimeout&&e.setTimeout,Lu=iu.ceil,Ru=iu.floor,Vu=nu.getOwnPropertySymbols,Ou=vu?vu.isBuffer:rt,Fu=e.isFinite,Nu=au.join,ju=W(nu.keys,nu),Gu=iu.max,zu=iu.min,Ju=Qc.now,Hu=e.parseInt,Uu=iu.random,qu=au.reverse,Wu=bo(e,"DataView"),$u=bo(e,"Map"),Ku=bo(e,"Promise"),Xu=bo(e,"Set"),Yu=bo(e,"WeakMap"),Zu=bo(nu,"create"),Qu=Yu&&new Yu,th={},eh=Xo(Wu),ih=Xo($u),nh=Xo(Ku),rh=Xo(Xu),oh=Xo(Yu),sh=xu?xu.prototype:rt,ah=sh?sh.valueOf:rt,lh=sh?sh.toString:rt,ch=function(){function t(){}return function(e){if(!tl(e))return{};if(Su)return Su(e);t.prototype=e;var i=new t;return t.prototype=rt,i}}();i.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:Ae,variable:"",imports:{_:i}},i.prototype=n.prototype,i.prototype.constructor=i,r.prototype=ch(n.prototype),r.prototype.constructor=r,x.prototype=ch(n.prototype),x.prototype.constructor=x,it.prototype.clear=Oe,it.prototype.delete=$e,it.prototype.get=Ke,it.prototype.has=Xe,it.prototype.set=Ye,Ze.prototype.clear=Qe,Ze.prototype.delete=ti,Ze.prototype.get=ei,Ze.prototype.has=ii,Ze.prototype.set=ni,ri.prototype.clear=oi,ri.prototype.delete=si,ri.prototype.get=ai,ri.prototype.has=ui,ri.prototype.set=hi,pi.prototype.add=pi.prototype.push=mi,pi.prototype.has=gi,vi.prototype.clear=xi,vi.prototype.delete=bi,vi.prototype.get=Si,vi.prototype.has=Ai,vi.prototype.set=Mi;var uh=Nr(cn),hh=Nr(un,!0),ph=jr(),mh=jr(!0),fh=Qu?function(t,e){return Qu.set(t,e),t}:Dc,_h=Iu?function(t,e){return Iu(t,"toString",{configurable:!0,enumerable:!1,value:Sc(e),writable:!0})}:Dc,dh=Zn,yh=Pu||function(t){return Di.clearTimeout(t)},gh=Xu&&1/K(new Xu([,-0]))[1]==Bt?function(t){return new Xu(t)}:Bc,vh=Qu?function(t){return Qu.get(t)}:Bc,xh=Vu?function(t){return null==t?[]:(t=nu(t),p(Vu(t),function(e){return Au.call(t,e)}))}:Vc,bh=Vu?function(t){for(var e=[];t;)d(e,xh(t)),t=Cu(t);return e}:Vc,wh=fn;(Wu&&wh(new Wu(new ArrayBuffer(1)))!=le||$u&&wh(new $u)!=Kt||Ku&&"[object Promise]"!=wh(Ku.resolve())||Xu&&wh(new Xu)!=ee||Yu&&wh(new Yu)!=oe)&&(wh=function(t){var e=fn(t),i=e==Zt?t.constructor:rt,n=i?Xo(i):"";if(n)switch(n){case eh:return le;case ih:return Kt;case nh:return"[object Promise]";case rh:return ee;case oh:return oe}return e});var Ch=uu?Ya:Oc,Sh=Wo(fh),Ah=Eu||function(t,e){return Di.setTimeout(t,e)},Dh=Wo(_h),Mh=function(t){var e=Ma(t,function(t){return i.size===ct&&i.clear(),t}),i=e.cache;return e}(function(t){var e=[];return Te.test(t)&&e.push(""),t.replace(/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,function(t,i,n,r){e.push(n?r.replace(/\\(\\)?/g,"$1"):i||t)}),e}),Th=Zn(function(t,e){return Ja(t)?nn(t,ln(e,1,Ja,!0)):[]}),kh=Zn(function(t,e){var i=ys(e);return Ja(i)&&(i=rt),Ja(t)?nn(t,ln(e,1,Ja,!0),go(i,2)):[]}),Ih=Zn(function(t,e){var i=ys(e);return Ja(i)&&(i=rt),Ja(t)?nn(t,ln(e,1,Ja,!0),rt,i):[]}),Ph=Zn(function(t){var e=_(t,yr);return e.length&&e[0]===t[0]?vn(e):[]}),Bh=Zn(function(t){var e=ys(t),i=_(t,yr);return e===ys(i)?e=rt:i.pop(),i.length&&i[0]===t[0]?vn(i,go(e,2)):[]}),Eh=Zn(function(t){var e=ys(t),i=_(t,yr);return e="function"==typeof e?e:rt,e&&i.pop(),i.length&&i[0]===t[0]?vn(i,rt,e):[]}),Lh=Zn(xs),Rh=po(function(t,e){var i=null==t?0:t.length,n=Xi(t,e);return $n(t,_(e,function(t){return Po(t,i)?+t:t}).sort(kr)),n}),Vh=Zn(function(t){return ur(ln(t,1,Ja,!0))}),Oh=Zn(function(t){var e=ys(t);return Ja(e)&&(e=rt),ur(ln(t,1,Ja,!0),go(e,2))}),Fh=Zn(function(t){var e=ys(t);return e="function"==typeof e?e:rt,ur(ln(t,1,Ja,!0),rt,e)}),Nh=Zn(function(t,e){return Ja(t)?nn(t,e):[]}),jh=Zn(function(t){return _r(p(t,Ja))}),Gh=Zn(function(t){var e=ys(t);return Ja(e)&&(e=rt),_r(p(t,Ja),go(e,2))}),zh=Zn(function(t){var e=ys(t);return e="function"==typeof e?e:rt,_r(p(t,Ja),rt,e)}),Jh=Zn(zs),Hh=Zn(function(t){var e=t.length,i=e>1?t[e-1]:rt;return i="function"==typeof i?(t.pop(),i):rt,Js(t,i)}),Uh=po(function(t){var e=t.length,i=e?t[0]:0,n=this.__wrapped__,o=function(e){return Xi(e,t)};return!(e>1||this.__actions__.length)&&n instanceof x&&Po(i)?(n=n.slice(i,+i+(e?1:0)),n.__actions__.push({func:$s,args:[o],thisArg:rt}),new r(n,this.__chain__).thru(function(t){return e&&!t.length&&t.push(rt),t})):this.thru(o)}),qh=Or(function(t,e,i){pu.call(t,i)?++t[i]:Ki(t,i,1)}),Wh=qr(as),$h=qr(ls),Kh=Or(function(t,e,i){pu.call(t,i)?t[i].push(e):Ki(t,i,[e])}),Xh=Zn(function(t,e,i){var n=-1,r="function"==typeof e,o=za(t)?Zc(t.length):[];return uh(t,function(t){o[++n]=r?a(e,t,i):bn(t,e,i)}),o}),Yh=Or(function(t,e,i){Ki(t,i,e)}),Zh=Or(function(t,e,i){t[i?0:1].push(e)},function(){return[[],[]]}),Qh=Zn(function(t,e){if(null==t)return[];var i=e.length;return i>1&&Bo(t,e[0],e[1])?e=[]:i>2&&Bo(e[0],e[1],e[2])&&(e=[e[0]]),Jn(t,ln(e,1),[])}),tp=Bu||function(){return Di.Date.now()},ep=Zn(function(t,e,i){var n=dt;if(i.length){var r=$(i,yo(ep));n|=bt}return oo(t,n,e,i,r)}),ip=Zn(function(t,e,i){var n=dt|yt;if(i.length){var r=$(i,yo(ip));n|=bt}return oo(e,n,t,i,r)}),np=Zn(function(t,e){return en(t,1,e)}),rp=Zn(function(t,e,i){return en(t,xl(e)||0,i)});Ma.Cache=ri;var op=dh(function(t,e){e=1==e.length&&pp(e[0])?_(e[0],R(go())):_(ln(e,1),R(go()));var i=e.length;return Zn(function(n){for(var r=-1,o=zu(n.length,i);++r<o;)n[r]=e[r].call(this,n[r]);return a(t,this,n)})}),sp=Zn(function(t,e){var i=$(e,yo(sp));return oo(t,bt,rt,e,i)}),ap=Zn(function(t,e){var i=$(e,yo(ap));return oo(t,wt,rt,e,i)}),lp=po(function(t,e){return oo(t,St,rt,rt,rt,e)}),cp=eo(_n),up=eo(function(t,e){return t>=e}),hp=wn(function(){return arguments}())?wn:function(t){return el(t)&&pu.call(t,"callee")&&!Au.call(t,"callee")},pp=Zc.isArray,mp=Bi?R(Bi):Cn,fp=Ou||Oc,_p=Ei?R(Ei):Sn,dp=Li?R(Li):Mn,yp=Ri?R(Ri):In,gp=Vi?R(Vi):Pn,vp=Oi?R(Oi):Bn,xp=eo(Vn),bp=eo(function(t,e){return t<=e}),wp=Fr(function(t,e){if(Oo(e)||za(e))return void Lr(e,Vl(e),t);for(var i in e)pu.call(e,i)&&Hi(t,i,e[i])}),Cp=Fr(function(t,e){Lr(e,Ol(e),t)}),Sp=Fr(function(t,e,i,n){Lr(e,Ol(e),t,n)}),Ap=Fr(function(t,e,i,n){Lr(e,Vl(e),t,n)}),Dp=po(Xi),Mp=Zn(function(t){return t.push(rt,so),a(Sp,rt,t)}),Tp=Zn(function(t){return t.push(rt,ao),a(Ep,rt,t)}),kp=Kr(function(t,e,i){t[e]=i},Sc(Dc)),Ip=Kr(function(t,e,i){pu.call(t,e)?t[e].push(i):t[e]=[i]},go),Pp=Zn(bn),Bp=Fr(function(t,e,i){jn(t,e,i)}),Ep=Fr(function(t,e,i,n){jn(t,e,i,n)}),Lp=po(function(t,e){var i={};if(null==t)return i;var n=!1;e=_(e,function(e){return e=vr(e,t),n||(n=e.length>1),e}),Lr(t,fo(t),i),n&&(i=Zi(i,ht|pt|mt,lo));for(var r=e.length;r--;)hr(i,e[r]);return i}),Rp=po(function(t,e){return null==t?{}:Hn(t,e)}),Vp=ro(Vl),Op=ro(Ol),Fp=Jr(function(t,e,i){return e=e.toLowerCase(),t+(i?tc(e):e)}),Np=Jr(function(t,e,i){return t+(i?"-":"")+e.toLowerCase()}),jp=Jr(function(t,e,i){return t+(i?" ":"")+e.toLowerCase()}),Gp=zr("toLowerCase"),zp=Jr(function(t,e,i){return t+(i?"_":"")+e.toLowerCase()}),Jp=Jr(function(t,e,i){return t+(i?" ":"")+Up(e)}),Hp=Jr(function(t,e,i){return t+(i?" ":"")+e.toUpperCase()}),Up=zr("toUpperCase"),qp=Zn(function(t,e){try{return a(t,rt,e)}catch(t){return Ka(t)?t:new tu(t)}}),Wp=po(function(t,e){return c(e,function(e){e=Ko(e),Ki(t,e,ep(t[e],t))}),t}),$p=Wr(),Kp=Wr(!0),Xp=Zn(function(t,e){return function(i){return bn(i,t,e)}}),Yp=Zn(function(t,e){return function(i){return bn(t,i,e)}}),Zp=Yr(_),Qp=Yr(h),tm=Yr(v),em=to(),im=to(!0),nm=Xr(function(t,e){return t+e},0),rm=no("ceil"),om=Xr(function(t,e){return t/e},1),sm=no("floor"),am=Xr(function(t,e){return t*e},1),lm=no("round"),cm=Xr(function(t,e){return t-e},0);return i.after=xa,i.ary=ba,i.assign=wp,i.assignIn=Cp,i.assignInWith=Sp,i.assignWith=Ap,i.at=Dp,i.before=wa,i.bind=ep,i.bindAll=Wp,i.bindKey=ip,i.castArray=Ra,i.chain=qs,i.chunk=Qo,i.compact=ts,i.concat=es,i.cond=wc,i.conforms=Cc,i.constant=Sc,i.countBy=qh,i.create=Sl,i.curry=Ca,i.curryRight=Sa,i.debounce=Aa,i.defaults=Mp,i.defaultsDeep=Tp,i.defer=np,i.delay=rp,i.difference=Th,i.differenceBy=kh,i.differenceWith=Ih,i.drop=is,i.dropRight=ns,i.dropRightWhile=rs,i.dropWhile=os,i.fill=ss,i.filter=na,i.flatMap=ra,i.flatMapDeep=oa,i.flatMapDepth=sa,i.flatten=cs,i.flattenDeep=us,i.flattenDepth=hs,i.flip=Da,i.flow=$p,i.flowRight=Kp,i.fromPairs=ps,i.functions=Pl,i.functionsIn=Bl,i.groupBy=Kh,i.initial=_s,i.intersection=Ph,i.intersectionBy=Bh,i.intersectionWith=Eh,i.invert=kp,i.invertBy=Ip,i.invokeMap=Xh,i.iteratee=Mc,i.keyBy=Yh,i.keys=Vl,i.keysIn=Ol,i.map=ua,i.mapKeys=Fl,i.mapValues=Nl,i.matches=Tc,i.matchesProperty=kc,i.memoize=Ma,i.merge=Bp,i.mergeWith=Ep,i.method=Xp,i.methodOf=Yp,i.mixin=Ic,i.negate=Ta,i.nthArg=Ec,i.omit=Lp,i.omitBy=jl,i.once=ka,i.orderBy=ha,i.over=Zp,i.overArgs=op,i.overEvery=Qp,i.overSome=tm,i.partial=sp,i.partialRight=ap,i.partition=Zh,i.pick=Rp,i.pickBy=Gl,i.property=Lc,i.propertyOf=Rc,i.pull=Lh,i.pullAll=xs,i.pullAllBy=bs,i.pullAllWith=ws,i.pullAt=Rh,i.range=em,i.rangeRight=im,i.rearg=lp,i.reject=fa,i.remove=Cs,i.rest=Ia,i.reverse=Ss,i.sampleSize=da,i.set=Jl,i.setWith=Hl,i.shuffle=ya,i.slice=As,i.sortBy=Qh,i.sortedUniq=Bs,i.sortedUniqBy=Es,i.split=hc,i.spread=Pa,i.tail=Ls,i.take=Rs,i.takeRight=Vs,i.takeRightWhile=Os,i.takeWhile=Fs,i.tap=Ws,i.throttle=Ba,i.thru=$s,i.toArray=dl,i.toPairs=Vp,i.toPairsIn=Op,i.toPath=zc,i.toPlainObject=bl,i.transform=Ul,i.unary=Ea,i.union=Vh,i.unionBy=Oh,i.unionWith=Fh,i.uniq=Ns,i.uniqBy=js,i.uniqWith=Gs,i.unset=ql,i.unzip=zs,i.unzipWith=Js,i.update=Wl,i.updateWith=$l,i.values=Kl,i.valuesIn=Xl,i.without=Nh,i.words=bc,i.wrap=La,i.xor=jh,i.xorBy=Gh,i.xorWith=zh,i.zip=Jh,i.zipObject=Hs,i.zipObjectDeep=Us,i.zipWith=Hh,i.entries=Vp,i.entriesIn=Op,i.extend=Cp,i.extendWith=Sp,Ic(i,i),i.add=nm,i.attempt=qp,i.camelCase=Fp,i.capitalize=tc,i.ceil=rm,i.clamp=Yl,i.clone=Va,i.cloneDeep=Fa,i.cloneDeepWith=Na,i.cloneWith=Oa,i.conformsTo=ja,i.deburr=ec,i.defaultTo=Ac,i.divide=om,i.endsWith=ic,i.eq=Ga,i.escape=nc,i.escapeRegExp=rc,i.every=ia,i.find=Wh,i.findIndex=as,i.findKey=Al,i.findLast=$h,i.findLastIndex=ls,i.findLastKey=Dl,i.floor=sm,i.forEach=aa,i.forEachRight=la,i.forIn=Ml,i.forInRight=Tl,i.forOwn=kl,i.forOwnRight=Il,i.get=El,i.gt=cp,i.gte=up,i.has=Ll,i.hasIn=Rl,i.head=ms,i.identity=Dc,i.includes=ca,i.indexOf=fs,i.inRange=Zl,i.invoke=Pp,i.isArguments=hp,i.isArray=pp,i.isArrayBuffer=mp,i.isArrayLike=za,i.isArrayLikeObject=Ja,i.isBoolean=Ha,i.isBuffer=fp,i.isDate=_p,i.isElement=Ua,i.isEmpty=qa,i.isEqual=Wa,i.isEqualWith=$a,i.isError=Ka,i.isFinite=Xa,i.isFunction=Ya,i.isInteger=Za,i.isLength=Qa,i.isMap=dp,i.isMatch=il,i.isMatchWith=nl,i.isNaN=rl,i.isNative=ol,i.isNil=al,i.isNull=sl,i.isNumber=ll,i.isObject=tl,i.isObjectLike=el,i.isPlainObject=cl,i.isRegExp=yp,i.isSafeInteger=ul,i.isSet=gp,i.isString=hl,i.isSymbol=pl,i.isTypedArray=vp,i.isUndefined=ml,i.isWeakMap=fl,i.isWeakSet=_l,i.join=ds,i.kebabCase=Np,i.last=ys,i.lastIndexOf=gs,i.lowerCase=jp,i.lowerFirst=Gp,i.lt=xp,i.lte=bp,i.max=Hc,i.maxBy=Uc,i.mean=qc,i.meanBy=Wc,i.min=$c,i.minBy=Kc,i.stubArray=Vc,i.stubFalse=Oc,i.stubObject=Fc,i.stubString=Nc,i.stubTrue=jc,i.multiply=am,i.nth=vs,i.noConflict=Pc,i.noop=Bc,i.now=tp,i.pad=oc,i.padEnd=sc,i.padStart=ac,i.parseInt=lc,i.random=Ql,i.reduce=pa,i.reduceRight=ma,i.repeat=cc,i.replace=uc,i.result=zl,i.round=lm,i.runInContext=t,i.sample=_a,i.size=ga,i.snakeCase=zp,i.some=va,i.sortedIndex=Ds,i.sortedIndexBy=Ms,i.sortedIndexOf=Ts,i.sortedLastIndex=ks,i.sortedLastIndexBy=Is,i.sortedLastIndexOf=Ps,i.startCase=Jp,i.startsWith=pc,i.subtract=cm,i.sum=Xc,i.sumBy=Yc,i.template=mc,i.times=Gc,i.toFinite=yl,i.toInteger=gl,i.toLength=vl,i.toLower=fc,i.toNumber=xl,i.toSafeInteger=wl,i.toString=Cl,i.toUpper=_c,i.trim=dc,i.trimEnd=yc,i.trimStart=gc,i.truncate=vc,i.unescape=xc,i.uniqueId=Jc,i.upperCase=Hp,i.upperFirst=Up,i.each=aa,i.eachRight=la,i.first=ms,Ic(i,function(){var t={};return cn(i,function(e,n){pu.call(i.prototype,n)||(t[n]=e)}),t}(),{chain:!1}),i.VERSION="4.17.4",c(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){i[t].placeholder=i}),c(["drop","take"],function(t,e){x.prototype[t]=function(i){i=i===rt?1:Gu(gl(i),0);var n=this.__filtered__&&!e?new x(this):this.clone();return n.__filtered__?n.__takeCount__=zu(i,n.__takeCount__):n.__views__.push({size:zu(i,Vt),type:t+(n.__dir__<0?"Right":"")}),n},x.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}}),c(["filter","map","takeWhile"],function(t,e){var i=e+1,n=i==It||3==i;x.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:go(t,3),type:i}),e.__filtered__=e.__filtered__||n,e}}),c(["head","last"],function(t,e){var i="take"+(e?"Right":"");x.prototype[t]=function(){return this[i](1).value()[0]}}),c(["initial","tail"],function(t,e){var i="drop"+(e?"":"Right");x.prototype[t]=function(){return this.__filtered__?new x(this):this[i](1)}}),x.prototype.compact=function(){return this.filter(Dc)},x.prototype.find=function(t){return this.filter(t).head()},x.prototype.findLast=function(t){return this.reverse().find(t)},x.prototype.invokeMap=Zn(function(t,e){return"function"==typeof t?new x(this):this.map(function(i){return bn(i,t,e)})}),x.prototype.reject=function(t){return this.filter(Ta(go(t)))},x.prototype.slice=function(t,e){t=gl(t);var i=this;return i.__filtered__&&(t>0||e<0)?new x(i):(t<0?i=i.takeRight(-t):t&&(i=i.drop(t)),e!==rt&&(e=gl(e),i=e<0?i.dropRight(-e):i.take(e-t)),i)},x.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},x.prototype.toArray=function(){return this.take(Vt)},cn(x.prototype,function(t,e){var n=/^(?:filter|find|map|reject)|While$/.test(e),o=/^(?:head|last)$/.test(e),s=i[o?"take"+("last"==e?"Right":""):e],a=o||/^find/.test(e);s&&(i.prototype[e]=function(){var e=this.__wrapped__,l=o?[1]:arguments,c=e instanceof x,u=l[0],h=c||pp(e),p=function(t){var e=s.apply(i,d([t],l));return o&&m?e[0]:e};h&&n&&"function"==typeof u&&1!=u.length&&(c=h=!1);var m=this.__chain__,f=!!this.__actions__.length,_=a&&!m,y=c&&!f;if(!a&&h){e=y?e:new x(this);var g=t.apply(e,l);return g.__actions__.push({func:$s,args:[p],thisArg:rt}),new r(g,m)}return _&&y?t.apply(this,l):(g=this.thru(p),_?o?g.value()[0]:g.value():g)})}),c(["pop","push","shift","sort","splice","unshift"],function(t){var e=au[t],n=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",r=/^(?:pop|shift)$/.test(t);i.prototype[t]=function(){var t=arguments;if(r&&!this.__chain__){var i=this.value();return e.apply(pp(i)?i:[],t)}return this[n](function(i){return e.apply(pp(i)?i:[],t)})}}),cn(x.prototype,function(t,e){var n=i[e];if(n){var r=n.name+"";(th[r]||(th[r]=[])).push({name:e,func:n})}}),th[$r(rt,yt).name]=[{name:"wrapper",func:rt}],x.prototype.clone=k,x.prototype.reverse=Y,x.prototype.value=et,i.prototype.at=Uh,i.prototype.chain=Ks,i.prototype.commit=Xs,i.prototype.next=Ys,i.prototype.plant=Qs,i.prototype.reverse=ta,i.prototype.toJSON=i.prototype.valueOf=i.prototype.value=ea,i.prototype.first=i.prototype.head,Tu&&(i.prototype[Tu]=Zs),i}();Di._=zi,(r=function(){return zi}.call(e,i,e,n))!==rt&&(n.exports=r)}).call(this)}).call(e,i(8),i(114)(t))},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}}]);